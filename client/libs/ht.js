!function(g,e,d){"use strict";function z(){this.el=[1,0,0,0,1,0,0,0,1]}function w(f){var I={};return{get:function(o){if(I[o]!==d)return I[o];var g;switch(o){case"WEBGL_depth_texture":g=f.getExtension("WEBGL_depth_texture")||f.getExtension("MOZ_WEBGL_depth_texture")||f.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=f.getExtension("WEBGL_compressed_texture_s3tc")||f.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=f.getExtension("WEBGL_compressed_texture_pvrtc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":g=f.getExtension("WEBGL_compressed_texture_etc1");break;default:g=f.getExtension(o)}return I[o]=g,g}}}function Q(E,n,W){function X(){if(r!==d)return r;var h=n.get("EXT_texture_filter_anisotropic");return r=null!==h?E.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function Q(h){if("highp"===h){if(E.getShaderPrecisionFormat(E.VERTEX_SHADER,E.HIGH_FLOAT).precision>0&&E.getShaderPrecisionFormat(E.FRAGMENT_SHADER,E.HIGH_FLOAT).precision>0)return"highp";h="mediump"}return"mediump"===h&&E.getShaderPrecisionFormat(E.VERTEX_SHADER,E.MEDIUM_FLOAT).precision>0&&E.getShaderPrecisionFormat(E.FRAGMENT_SHADER,E.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var r;W=W||{};var o="undefined"!=typeof WebGL2RenderingContext&&E instanceof WebGL2RenderingContext,l=W.precision!==d?W.precision:"highp",y=Q(l);y!==l&&(console.warn("WebGL:",l,"not supported, using",y,"instead."),l=y);var L=W.logarithmicDepthBuffer===!0,G=E.getParameter(E.MAX_TEXTURE_IMAGE_UNITS),s=E.getParameter(E.MAX_VERTEX_TEXTURE_IMAGE_UNITS),e=E.getParameter(E.MAX_TEXTURE_SIZE),D=E.getParameter(E.MAX_CUBE_MAP_TEXTURE_SIZE),h=E.getParameter(E.MAX_VERTEX_ATTRIBS),H=E.getParameter(E.MAX_VERTEX_UNIFORM_VECTORS),c=E.getParameter(E.MAX_VARYING_VECTORS),A=E.getParameter(E.MAX_FRAGMENT_UNIFORM_VECTORS),P=s>0,I=o||!!n.get("OES_texture_float"),M=P&&I,$=o?E.getParameter(E.MAX_SAMPLES):0;return{getMaxAnisotropy:X,getMaxPrecision:Q,precision:l,logarithmicDepthBuffer:L,maxTextures:G,maxVertexTextures:s,maxTextureSize:e,maxCubemapSize:D,maxAttributes:h,maxVertexUniforms:H,maxVaryings:c,maxFragmentUniforms:A,vertexTextures:P,floatFragmentTextures:I,floatVertexTextures:M,maxSamples:$}}var A="ht";if(!g[A]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),g.performance&&g.performance.now||function(){var K=Date.now();g.performance||(g.performance={}),g.performance.now=function(){return Date.now()-K}}();for(var u=Date.now(),$=16,X=["ms","moz","webkit","o"],y=0;y<X.length&&!g.requestAnimationFrame;++y)g.requestAnimationFrame=g[X[y]+"RequestAnimationFrame"],g.cancelAnimationFrame=g[X[y]+"CancelAnimationFrame"]||g[X[y]+"CancelRequestAnimationFrame"];g.requestAnimationFrame||(g.requestAnimationFrame=function(M){var f=Date.now(),i=$+u-f;return 0>i&&(i=0),u=f,g.setTimeout(function(){u=Date.now(),M(performance.now())},i)}),g.cancelAnimationFrame||(g.cancelAnimationFrame=function(k){return g.clearTimeout(k)}),e.assign===d&&(e.assign=function(H){if(H===d||null===H)throw new TypeError("Cannot convert undefined or null to object");for(var l=e(H),Q=1;Q<arguments.length;Q++){var m=arguments[Q];if(m!==d&&null!==m)for(var p in m)e.prototype.hasOwnProperty.call(m,p)&&(l[p]=m[p])}return l})}();var m=g.document,s=null,l=g[A]={},D=g[A+"config"],k=l.Default=D&&D.Default||{},i=l.Style=D&&D.Style||{},V=l.Attr=D&&D.Attr||{},P=l.Color=D&&D.Color||{},R=l.IsGetter=D&&D.IsGetter||{};!function(){var A=!1;try{var p=e.defineProperty({},"passive",{get:function(){A=!0}});g.addEventListener("test",p,p),g.removeEventListener("test",p,p)}catch(U){A=!1}k.passiveSupported=A}();var F,o,v,h,x=k.passiveSupported,u=k.eventListenerOptionsFalse=x?{passive:!1,capture:!1}:!1,Y=k.eventListenerOptionsTrue=x?{passive:!1,capture:!0}:!0,K=function(S,k,t,f){S.addEventListener(k,t,f?Y:u)},f=function(S,y,O,n){S.removeEventListener(y,O,n?Y:u)},E=Math,t=E.round,G=E.floor,y=E.ceil,r=E.sqrt,I=E.max,B=E.min,J=E.abs,O=E.cos,M=E.acos,L=E.sin,S=E.pow,W=E.asin,N=E.PI,p=2*N,X=N/2,q=E.tan,c=E.atan2,T=E.random,$=E.log,U=!1,Z=!1,H=g.parseInt||global.parseInt,b="2020-02-25",_=g.navigator?g.navigator.platform.indexOf("Win")>-1:!1,C=function(n){return n*n},j=g.setTimeout,n=g.clearTimeout,a=g.location,rb=g.navigator?g.navigator.userAgent.toLowerCase():"",zb=function(k){return k.test(rb)},Rr=zb(/msie/),$l=zb(/msie/)||zb(/trident/),Kp=zb(/msie 10/),lk=zb(/edge/),Cm=zb(/firefox/),kd=zb(/mac/),mo=k.isTouchable===d?_?!1:m?"ontouchend"in m:!1:k.isTouchable,ef="default",Vd="single",Rn="multiple",Oh="front",ss="back",xb="left",cr="right",rg="top",Rc="bottom",zc="center",kh="eye",Ef="middle",Kg="east",uf="west",Hq="north",Xo="none",Se="px",Pe="absolute",kp="border",_c="triangle",Vc="rect",Lm="circle",Zp="cylinder",mj="shape",Mr="items",Xe="normal",ij="remove",vj="clear",vs="width",Vk="height",Er="ingroup",de="check",dk="uncheck",il="radio",Hd="radioOn",kr="radioOff",Xh="points",ce="values",Wn="series",qn="body",sk="label",vf="label2",am="note",vm="note2",rl="icons",Bf="labelFont",_b="labelColor",Fi="labelSelectColor",hg="note.expanded",qk="note2.expanded",oh="edge.expanded",fd="edge.points",Oe="edge.type",cf="rotation",_n="hidden",Wm="visible",_p="tuv",yh="no",lo="draw",Xb="select",se="currentSubGraph",ul="selectBackground",Yb="autoMakeVisible",jm="autoHideScrollBar",Ce="scrollBarColor",mm="scrollBarSize",Rk="indent",es="rowHeight",vd="columnLineColor",pm="rowLineColor",Qn="columnLineVisible",Jo="rowLineVisible",mb="visibleFunc",gl="expandIcon",Jc="collapseIcon",vq="checkMode",Ch="sortFunc",fs="editable",Io="batchEditable",Nb="tristate",rd="asc",xe="desc",go="position",Tp="elevation",Qq="children",Mi="translateX",qc="translateY",df="dataModel",Ze="maxSize",rp="state",vl="shape3d",Kd="shape3d.resolution",Bj="shape3d.visible",If="shape3d.from.visible",bn="shape3d.to.visible",xc="shape3d.top.visible",Cg="shape3d.bottom.visible",Sb="repeat.uv.length",Eg="serializeValue",Jl="deserializeValue",Gl="centerUniform",Bb="uniform",sf="rgba(255,255,255,0)",Lg="style",Ci="attr",ts="field",Ol="string",hm="boolean",Ld="color",af="int",br="number",up="ew-resize",Sk="ns-resize",ro="pointer",ye="auto",sd="mousedown",$g="mousemove",Un="mouseup",zf="mouseout",Oq="touchstart",Bi="touchmove",pq="touchend",bi="keydown",Qo="keyup",sp=["DOMMouseScroll","mousewheel"],tc=Cm?sp[0]:sp[1],qf=mo?[Oq,Bi,pq,bi,Qo,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[bi,Qo,"keypress","input",sd,$g,Un,zf,tc,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Jm=s,fo=s,Kf=s,Ee=Un.length,np=function(){Kf&&(n(Kf.timeout),Kf=s)},Ve=function(){Kf&&Hj(Kf.e,Kf.info)};g.addEventListener&&(mo||(K(g,zf,function(){np()}),K(g,tc,function(){en()})),K(g,Qo,function(l){91===l.keyCode?Ob={}:delete Ob[l.keyCode]},!0),K(g,bi,function(E){Ob[E.keyCode]=!0},!0),K(g,"blur",function(){Ob={}}));var bo,dm,mq,ie=0,Ck=s,Xj=function(F,d){var f=j(function(){delete Ck[f],ol(Ck)&&(Ck=s),F()},d);return f},Co=s,jd=s,um={},jl={},al={},Rg={},Tl={},Ob={},sh={},ph={},Bp={},Db={},Ub=/.json$/,fl=/^data:image\/svg\+xml/,dn={},gj=[],md={},gk=s,Id=s,qd=function(){},pb=function(){throw"Oops!"},Qh=[0,0,0],sc={x:0,y:0,width:0,height:0},Fm=s,wk=s,xf=s,yn=function(b,y){jl[b]=y,y&&y.comps&&!y.uuid&&(y.uuid=l.Math.generateUUID()),Xk[b]&&(y.cacheRule=Xk[b],delete Xk[b])},jc=function(C){wk&&!C._72O&&(xf||(xf={}),xf[C._72O=Dd()]=C),bo!=s?Cf()<.05&&h&&!dm&&(gh=np):gh=Zl},vo=function(h,L,P,E){wk||(wk={});var Z=wk[h];if(Z){if(Z.url===L)return;Z.image?(Z.image.onload=qd,Z.image.onerror=qd):Z.request&&(Z.request.onload=qd,Z.request.onerror=qd)}if(Ub.test(L)){var V=new Yp;if(wk[h]={request:V,url:L},L=k.beforeLoadURL(L),L.data){var T=k.parse(L.data);Zn(h,T),k.handleImageLoaded(h,T)}else{V.onload=function(){if(200===this.status||0===this.status){var E=k.parse(V.getResponseText());Zn(h,E),k.handleImageLoaded(h,E)}else Zn(h,k.handleUnfoundImage(h,L)||s)},V.onerror=function(){Zn(h,k.handleUnfoundImage(h,L)||s)};var Y={};Y.url=encodeURI(L),Y.sync=!1,V.send(Y)}}else{var T=new Image;wk[h]={image:T,url:L},/^data:image/.test(L)||(L=k.beforeLoadURL(L),L=k.appendTimeStamp(L),L=encodeURI(L),T.crossOrigin=k.crossOrigin),k.convertImageSrc(L,function(x){$l&&(L.toLowerCase().indexOf(".svg")>0||fl.test(L))?(m.body.appendChild(T),T.style.visibility="hidden",T.onload=function(){j(function(){if(P&&(T.width=P),E&&(T.height=E),!T.width||!T.height){var j=T.width||T.clientWidth,t=T.height||T.clientHeight;T.width=j,T.height=t}k.handleImageLoaded(h,T),Zn(h,T),m.body.removeChild(T),T.style.visibility=""},180)},T.onerror=function(){Zn(h,k.handleUnfoundImage(h,L)||s),m.body.removeChild(T),T.style.visibility=""}):(T.onload=function(){P&&(T.width=P),E&&(T.height=E),k.handleImageLoaded(h,T),Zn(h,T)},T.onerror=function(){Zn(h,k.handleUnfoundImage(h,L)||s)}),T.src=x})}},Zn=function(h,Q){if(yn(h,Q),delete wk[h],ol(wk)&&(wk=s,xf)){for(var R in xf){var B=xf[R];B._2O&&B._2O[h]&&(B.deleteTexture(h),delete B._2O[h]),B.invalidateAll&&B.invalidateAll(d,"imageLoaded",h),B.redraw&&B.redraw(),B.iv(),delete B._72O}xf=s}if(Q&&xf)for(var R in xf){var B=xf[R];B.invalidateAll&&B.invalidateAll(d,"imageLoading",h),B.redraw&&B.redraw(),B.iv()}},Xl=function(){return $=E&&Date,function(){return g.performance&&g.performance.now?g.performance.now():Date.now()}}(),Up=function(U,r,q){return{width:U,height:r,comps:Cq(q)?q:[q]}},sn=function(U,T){return{type:Lm,rect:[U,T,1.6,1.6],borderWidth:1,borderColor:Fj,gradient:wp,gradientColor:oj,background:Fj}},pn=function(z,y){return Up(16,16,{type:_c,rect:[4,4,10,8],background:z,rotation:y?1.57:3.14})},Qi=function(r,T){return Up(16,16,{type:_c,rect:[4,4,8,7],background:r,rotation:T?3.14:0})},op=function(e){var S=e._orientation;return"horizontal"===S||"h"===S},Fn=function(A,B){var h=s||4,Q=s||1,b=s||1;0>h?h=0:h>.25&&(h=.25);var T,f,D,X,g,Y,Z,$=.5,F=[],v=[],d=[],P=p/b,C=p/Q,V=$-h;for(f=0;Q>=f;f++)for(X=-N+f*C,Y=O(X),g=L(X),T=0;b>=T;T++)D=T*P,Z=V+h*Y,F.push(O(D)*Z,g*h,-L(D)*Z),(o=[A,B])&&v.push(T/b,1-f/Q);for(f=0;Q>f;f++){var J=f*(b+1),u=(f+1)*(b+1);for(T=0;b>T;T++)d.push(J+T,u+T+1,u+T,J+T,J+T+1,u+T+1),Nq.z=xp.z=[A,B]}},mr=function(C){var j=2,t=0;for(var M in C)M.length===j&&H(M,32)===Wr&&(gk=Id=C[M]),t++;return t},qb=function(I,z,Z,X){return Z||(Z=mo?5:3,Z/=X||1),{x:I-Z,y:z-Z,width:2*Z,height:2*Z}},Sm=function(I,O,$,p){var E=this;O||(O=mo?5:3,$=20,p=20);var A={x:I,y:O,width:$,height:p};if($)for(var o=0;$>o;o++)if(3===$)p=20;else for(var v=0;p>v;v++)E=g?g:$;var H={x:N,y:2*N};if(Sn(A,H)){var C=Vk[0]+rg[0]+vj[1]+rd.length,B=_n[0]+Nb[0]+vj[1]+qn.length;em[kh]=[E[C],E[B]],E[C]=Wg[kh],E[B]=Wg[vl]}},zl=function(y){return(/ble$/.test(y)||/ed$/.test(y)||R[y]?"is":"get")+y.charAt(0).toUpperCase()+y.slice(1)},Wg=function(a){return"set"+a.charAt(0).toUpperCase()+a.slice(1)},Or=function(O){return typeof O===Ol||O instanceof String},hk=function(C){return typeof C===br},Zl=function(z){return typeof z===hm},qr=function(T){return T&&"object"==typeof T},Lo=function(s){return"function"==typeof s},Cq=function(T){return T instanceof Array},us=function(v){return v instanceof bm},Vn=function(f){return Cq(f)?new bm(f):f},rn=function(A){return A instanceof Hr},jo=function(J){return J instanceof ml},ue=function(o){return o instanceof ao},rk=function(J,d){if(!(J instanceof l.Group))return!1;if(!d)return J.isExpanded();var g=d.getDataUI(J);return g&&g._88I?!0:!1},Uh=function(o){return o instanceof Rl},Pd=function(x){return x&&"IFRAME"===x.tagName},tp=function(e){return e==s||k.numberDigits==s?e:parseFloat(e.toFixed(k.numberDigits))},Hi=function(n,x,G){var z,Z=x.length;if(G)for(var t=0;G>t;t++)if(3===Z)n.push(x[0]),n.push(x[1]),n.push(x[2]);else for(z=0;Z>z;z++)n.push(x[z]);else if(3===Z)n.push(x[0]),n.push(x[1]),n.push(x[2]);else for(z=0;Z>z;z++)n.push(x[z])},jb=function(Z){return Z?qr(Z)?Z:{}:!1},ag=function(N,w,R){var G,i=qr(N)?N:N.prototype;for(G in w)R&&G in i?i[G]===d&&console.warn("class",i,"has own undefined property",G,", keep exist!"):i[G]=w[G];return N},nr=function(J,H){if(!("wheelDelta"in H)){var $=H.deltaMode;H.wheelDelta=$===H.DOM_DELTA_PIXEL?-H.deltaY:$===H.DOM_DELTA_LINE?40*-H.deltaY:120*-H.deltaY}J.handle_mousewheel(H)},Hf=function(r){return String.fromCharCode(r)},Np=function(g){for(var A,I=0,f="";I<g.length;I++)A=g[g.length-1-I],"%"===A?A="'":"a"===A?A='"':"]"===A&&(A="\\"),f+=Hf(A.charCodeAt(0)-1);return f},$d=function(T,G,H){T.superClass.constructor.apply(G,H)},ol=function(F){for(var O in F)return!1;return!0},lp=function($){return $?0===$.length:!0},Ai=function(){var o="";return[dk[0],pm[0],sk[0]].forEach(function(C){o+=Wg(C).slice(3)}),Bb=m&&m[o]||Gl,function(Z,J){return Z===J?!0:Z.x===J.x&&Z.y===J.y&&Z.width===J.width&&Z.height===J.height}}(),vc=function(F,n,C){return n>F?n:F>C?C:F},Pj=function(w){return 0>w?-1:w>0?1:0},Cf=function(){var z=1e4*L(Ee++);return z-G(z)},fk=function(U,f,M){return Br(U.x,U.y,f.x,f.y,M.x,M.y,M.x+M.width,M.y,!0)||Br(U.x,U.y,f.x,f.y,M.x+M.width,M.y,M.x+M.width,M.y+M.height,!0)||Br(U.x,U.y,f.x,f.y,M.x+M.width,M.y+M.height,M.x,M.y+M.height,!0)||Br(U.x,U.y,f.x,f.y,M.x,M.y+M.height,M.x,M.y,!0)},Br=function(A,J,k,H,F,N,W,b,p){var l=(W-F)*(J-N)-(b-N)*(A-F),g=(b-N)*(k-A)-(W-F)*(H-J);if(0!==g){var v=l/g,r=A+v*(k-A),V=J+v*(H-J);return p&&(r+no<B(A,k)||r-no>I(A,k)||r+no<B(F,W)||r-no>I(F,W)||V+no<B(J,H)||V-no>I(J,H)||V+no<B(N,b)||V-no>I(N,b))?s:[r,V]}return s},Wi=function(j,R,S){if(j&&S)if(R){if(R===Lg)return j.getStyle(S);if(R===Ci)return j.getAttr(S);if(R===ts)return j[S]}else if(S=zl(S),j[S])return j[S]();return d},Bn=function(s,L,u,C){if(s&&u)if(L){if(L===Lg)s.s(u,C);else if(L===Ci)s.a(u,C);else if(L===ts){var G=s[u];s[u]=C,s.fp("f:"+u,G,C)}}else u=Wg(u),s[u]&&s[u](C)},Mb=function(f,O,U){return O&&"top"!==O?"bottom"===O?{x:f.x,y:f.y,width:f.width,height:f.height*U}:"right"===O?{x:f.x,y:f.y,width:f.width*U,height:f.height}:"left"===O?{x:f.x+f.width*(1-U),y:f.y,width:f.width*U,height:f.height}:void 0:{x:f.x,y:f.y+f.height*(1-U),width:f.width,height:f.height*U}},Fp=function(D,E,N,g,x){E&&Gn(D,N,g,1,x,E)},nc=function(P,v,T,p){var y=1-P;return y*y*v+2*P*y*T+P*P*p},Nq=function(E,g,N,j,b){var u=1-E;return u*u*u*g+3*u*u*E*N+3*u*E*E*j+E*E*E*b},nm=function(s){var G,b,K,V,D=0;return s.forEach(function(i){if(G=i.length,G>0)for(b=i[0],V=1;G>V;V++)K=i[V],D+=Qd(b,K),b=K}),D},Je=function(t,M,W){var m="__"+t,D=function(x){W.disabled||W["handle_"+t](x)};W[m]||(W[m]=D,K(M,t,D))},Bh=function(X,N,J){var C="__"+X,l=J[C];l&&(f(N,X,l),delete J[C])},Pi=function(i,l){var y="_"+l;i[zl(l)]=function(){return this[y]},i[Wg(l)]=function(r){var O=this[y];this[y]=r,this.fp(l,O,r)}},pf=function(j){return e.create(j)},Fo=function(e){if(!e.element){var Q,g;(Q=e.textField)?g=In(Wl.TextField,Q):(Q=e.textArea)?g=In(Wl.TextArea,Q):(Q=e.button)?g=In(Wl.Button,Q):(Q=e.comboBox)?g=In(Wl.ComboBox,Q):(Q=e.checkBox)?g=In(Wl.CheckBox,Q):(Q=e.radioButton)?g=In(Wl.RadioButton,Q):(Q=e.slider)?g=In(Wl.Slider,Q):(Q=e.colorPicker)?g=In(Wl.ColorPicker,Q):(Q=e.image)&&(g=In(Wl.Image,Q)),g&&(e.element=g)}},Eq=function(U,P){var F=Lp(U);return F._ht=P,F},Lp=function(M,B){var Z=m.createElement("div"),v=Z.style;return Z.tabIndex=-1,Z.onkeydown=yc,v.msTouchAction=Xo,Jr(Z,s,0),mo&&v.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",s),M&&(v.overflow=_n),B&&Dj(B,Z),Z},sb=function(S,H){var W=m.createElement("canvas"),Z=W.style;return Z.msTouchAction=Xo,H||(Z.pointerEvents=Xo),Jr(W,s,0),S&&Dj(S,W),W},Jr=function(u,v,W){var g=u.style;g.border=v?v+" solid 1px":0,g.outline=0,g.padding=W?"0 "+W+Se:0,Sj(u)},Sj=function(R){var r=R.style;r.position=Pe,r.margin=0,r.setProperty("box-sizing","border-box",s),r.setProperty("-moz-box-sizing","border-box",s)},Cd=function(V,f,w,Z){Z||(Z=He),f!=s&&(V.width=f*Z,V.style.width=f+Se),w!=s&&(V.height=w*Z,V.style.height=w+Se)},Dj=function(d,Q,w){d.appendChild(Q),w&&(Q.style.position=Pe)},Sl=function(N,Y){Y.split||(Y+="");for(var u,v=Y.split("\n"),F=0,U=v.length,h=0;U>h;h++){var Z=bk(N.font,v[h]);Z.width>F&&(F=Z.width),u||(u=Z.height)}return N.ss=v,{width:F,height:u*U}},Jk=function(i,c,D,l,h,b){var H=c.length;if(1===H)Eo(i,c[0],D,l,h);else for(var y=D.height/H,k={x:D.x,y:D.y,width:D.width,height:y},z=0;z<c.length;z++)b?xg(i,c[z],l,h,k.x,k.y,k.width,k.height,b):Eo(i,c[z],k,l,h),k.y+=y},Eo=function(E,j,Y,s,f){E.font=s?s:Uj,E.fillStyle=f?f:Vj,E.textAlign=zc,E.textBaseline=Ef;var R,J;Y?Y.width===d?(R=Y.x,J=Y.y):(R=Y.x+Y.width/2,J=Y.y+Y.height/2):(R=0,J=0),E.fillText(j,t(R),t(J))},wn=function(_){_.getView&&(_=_.getView());var S=_.offsetWidth||_.scrollWidth;return!S&&_.style.width&&(S=H(_.style.width)),S},_d=function(v){v.getView&&(v=v.getView());var t=v.offsetHeight||v.scrollHeight;return!t&&v.style.height&&(t=H(v.style.height)),t},kb=function(e,M,E){var t=M[0].toUpperCase()+M.substring(1,M.length);e["webkit"+t]=E,e["moz"+t]=E,e["ms"+t]=E,e["o"+t]=E,e[M]=E},nb=function(){var v=function(w){yc(w),w.stopPropagation()},I=function(f){yc(f)},u=mo?[Oq]:[bi,sd];return function(e,E){var y=Lp(),j=y.style;return j.backgroundColor=k.disabledBackground,e&&(j.backgroundImage="url("+e+")",j.backgroundPosition="50% 50%",j.backgroundRepeat="no-repeat no-repeat"),E===!1?u.forEach(function(Z){K(y,Z,I)}):u.forEach(function(N){K(y,N,v)}),y}}(),wi=function(V){var n=V.getContext("2d");return n.save(),n.lineCap=Dq,n.lineJoin=yd,n},gh=function(I,Q,c,T){bs(I,Q*He,c*He),T*=He,1!==T&&I.scale(T,T)},bs=function(K,z,H){K.translate(z,H)},Dn=function(K,p){p&&K.rotate(p)},Nj=function(Y,K,h){K===d&&(K=1),h===d&&(h=1),(1!==K||1!==h)&&Y.scale(K,h)},rm=!1,Ep=function(d){var s=m.activeElement;if(m.activeElement!==d){s&&s.forceOnblur&&s.forceOnblur();for(var n=[],_=d.parentNode;_;)n.push([_,_.scrollLeft,_.scrollTop]),_=_.parentNode;if(!rm){var A=[],h=[];try{for(var i=g.parent,K=g;i!==K;)A.push([i,i.scrollX,i.scrollY]),K=i,i=g.parent;var Z=g.frameElement;if(Z)for(var U=Z.parentNode;U;)h.push([U,U.scrollLeft,U.scrollTop]),U=U.parentNode}catch(q){rm=!0}}if(mo)d.focus();else{var y=sl(),e=y.target;d.focus(),e.scrollLeft=y.left,e.scrollTop=y.top}n.forEach(function(M){M[0].scrollLeft=M[1],M[0].scrollTop=M[2]}),rm||(A.forEach(function(Y){Y[0].scrollTo(Y[1],Y[2])}),h.forEach(function(U){U[0].scrollLeft=U[1],U[0].scrollTop=U[2]}))}},Zd=function(w){return w&&w.getView?w.getView():w},ci=function(C,R,M,Z,D){if(2===arguments.length&&(M=R.y,Z=R.width,D=R.height,R=R.x),C.isSelfViewEvent)C.setX(R),C.setY(M),C.setWidth(Z),C.setHeight(D);else{var v=Zd(C),z=v.style;if((m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement)!==v)R!==d&&(z.left=R+Se),M!==d&&(z.top=M+Se),Z!==d&&(z.width=Z+Se),D!==d&&(z.height=D+Se);else{var r=k.getWindowInfo();z.left=(R=r.left)+Se,z.top=(M=r.top)+Se,z.width=(Z=r.width)+Se,z.height=(D=r.height)+Se}C.endEditing&&!mo&&C.endEditing(),C.redraw&&C.redraw(),C.invalidate&&C.invalidate(),C.onLayouted&&C.onLayouted(R,M,Z,D),C.fireViewEvent&&C.fireViewEvent("layout")}},Zg=function(k){if(!k.touches)return k;var A=k.touches[0];return A?A:k.changedTouches[0]},bh=function(E){return mo?Zg(E).target:E.target},fi=function(d){k.popup&&k.popup.close(),k.popup=d},uj=s,Qr=function(B){uj.handleWindowTouchMove(B)},mh=function(a){uj.handleWindowTouchEnd(a),f(g,Bi,Qr),f(g,pq,mh),uj=s},el=function(T){uj.handleWindowMouseMove(T)},rs=function(S){uj.handleWindowMouseUp(S),f(g,$g,el),f(g,Un,rs),uj=s},Yj=function(W){return 1===on(W)},Ne=function(t,y){return y?y.keyCode===t:Ob[t]},mg=function(l){return oo(l)&&Ne(65,l)},hj=function(L){return Ne(46,L)||Ne(8,L)},kg=function(v){return function(j){return j?j.keyCode===v:Ob[v]}},Wr=573,Rp=[65,83,68,87,37,38,39,40,32,13,27],$k=kg(Rp[0]),Wk=kg(Rp[1]),Ie=kg(Rp[2]),ic=kg(Rp[3]),lb=kg(Rp[4]),Gj=kg(Rp[5]),si=kg(Rp[6]),ub=kg(Rp[7]),Af=kg(Rp[8]),Cr=kg(Rp[9]),ti=kg(Rp[10]),gq={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Oc=[2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,13,1409],Nr=s,On=s,dp=function(Q,M){Nr||(Nr=sb()),Cd(Nr,Q,M,1);var w=wi(Nr);return w.clearRect(0,0,Q,M),w},$h=function(){var l,Q={};for(var r in g){var z=Rn.length;if(r.length==z&&r[0]===Rn[2]&&r[1]===Xo[1]&&r[4]===Rn[3]&&r[5]===Rn[4]&&r.substr(z-2)===Xo[1]+Xo[2]){var L=g[r];for(var d in L)d.length===z&&d.substr(0,3)===cr[3]+ij[3]+Xb[0]&&d.substr(z-2)===Rn[0]+am[3]&&(sp=L[d])}}return function(q){var _,A=Q[q];return A||(l||(l=sb(),Cd(l,1,1,1)),_=l.getContext("2d"),_.clearRect(0,0,1,1),Gn(_,0,0,1,1,q),A=_.getImageData(0,0,1,1).data,A=Q[q]=[A[0],A[1],A[2],A[3]]),A}}(),id=function(r){if(!Or(r))return r;var v=$h(r);return v.CA||(v.CA=[v[0]/255,v[1]/255,v[2]/255,v[3]/255]),v.CA},Sf=function(e,x,R,t,T){var l=sb();l.width=R,l.height=t;var f=l.getContext("2d");f.drawImage(e,0,0,R,t);try{for(var k=f.getImageData(0,0,R,t),$=k.data,_=0,a=$.length;a>_;_+=4){var J=$[_+0],Q=$[_+1],Z=$[_+2],W=$[_+3];"override_a"===T?$[_+3]=255*x[3]:"override_rgb"===T?($[_+0]=255*x[0],$[_+1]=255*x[1],$[_+2]=255*x[2]):"override"===T?($[_+0]=255*x[0],$[_+1]=255*x[1],$[_+2]=255*x[2],$[_+3]=255*x[3]):($[_+0]=x[0]*J,$[_+1]=x[1]*Q,$[_+2]=x[2]*Z,$[_+3]=x[3]*W)}f.putImageData(k,0,0)}catch(M){return e}return l},em=function(o,G,m){return G&&(G="miter"===m?8*G+20:G+1,o&&ho(o,G)),G},ad=function(_,G){if(G){var e=new vk(G),z=_.width/2,o=_.height/2,s=Bc([e.tf(-z,-o),e.tf(z,-o),e.tf(z,o),e.tf(-z,o)]);return s.x+=_.x+z,s.y+=_.y+o,s}return _},ap=function(L,O,B,Y,$,f,H,x){Y*=Math.PI/180;var V={x:Math.cos(Y)*(L.x-H.x)/2+Math.sin(Y)*(L.y-H.y)/2,y:-Math.sin(Y)*(L.x-H.x)/2+Math.cos(Y)*(L.y-H.y)/2},M=Math.pow(V.x,2)/Math.pow(O,2)+Math.pow(V.y,2)/Math.pow(B,2);M>1&&(O*=Math.sqrt(M),B*=Math.sqrt(M));var l=($==f?-1:1)*Math.sqrt((Math.pow(O,2)*Math.pow(B,2)-Math.pow(O,2)*Math.pow(V.y,2)-Math.pow(B,2)*Math.pow(V.x,2))/(Math.pow(O,2)*Math.pow(V.y,2)+Math.pow(B,2)*Math.pow(V.x,2)));isNaN(l)&&(l=0);var T={x:l*O*V.y/B,y:l*-B*V.x/O},A={x:(L.x+H.x)/2+Math.cos(Y)*T.x-Math.sin(Y)*T.y,y:(L.y+H.y)/2+Math.sin(Y)*T.x+Math.cos(Y)*T.y},p=function(Z){return Math.sqrt(Math.pow(Z[0],2)+Math.pow(Z[1],2))},F=function(k,b){return(k[0]*b[0]+k[1]*b[1])/(p(k)*p(b))},n=function(E,t){return(E[0]*t[1]<E[1]*t[0]?-1:1)*Math.acos(F(E,t))},u=n([1,0],[(V.x-T.x)/O,(V.y-T.y)/B]),X=[(V.x-T.x)/O,(V.y-T.y)/B],Q=[(-V.x-T.x)/O,(-V.y-T.y)/B],U=n(X,Q);F(X,Q)<=-1&&(U=Math.PI),F(X,Q)>=1&&(U=0);var F=O>B?O:B,S=O>B?1:O/B,Z=O>B?B/O:1;if(null==x){var N={x:0,y:0,width:0,height:0};ho(N,F),N.x*=S,N.width*=S,N.y*=Z,N.height*=Z;var J=new vk(Y);return N=Bc([J.tf(N.x,N.y),J.tf(N.x+N.width,N.y),J.tf(N.x+N.width,N.y+N.height),J.tf(N.x,N.y+N.height)]),N.x+=A.x,N.y+=A.y,[{x:N.x,y:N.y},{x:N.x+N.width,y:N.y},{x:N.x+N.width,y:N.y+N.height},{x:N.x,y:N.y+N.height}]}x.translate(A.x,A.y),x.rotate(Y),x.scale(S,Z),x.arc(0,0,F,u,u+U,1-f),x.scale(1/S,1/Z),x.rotate(-Y),x.translate(-A.x,-A.y)},xn=function(u,X){u&&u.beginPath();for(var l,D,q,f=[],b=function(O){for(var p,F=/(\-{0,1}[\d\.]+)/gi,I=[];p=F.exec(O);)I.push(parseFloat(p[0]));return I},c=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,L={x:0,y:0};l=c.exec(X);){var H=l[0],W=H.substr(0,1);if("M"===W||"m"===W){for(var t=b(H),I=0;I<t.length;I+=2){var Y=t[I],x=t[I+1];"m"===W&&(Y+=L.x,x+=L.y),u&&u.moveTo(Y,x),f.push({x:Y,y:x}),L.x=Y,L.y=x}D=q=null}else if("H"===W||"h"===W){for(var t=b(H),I=0;I<t.length;I+=1){var Y=t[I];"h"===W&&(Y+=L.x),u&&u.lineTo(Y,L.y),f.push({x:Y,y:L.y}),L.x=Y}D=q=null}else if("C"===W||"c"===W){for(var t=b(H),I=0;I<t.length;I+=6){var U=t[I],K=t[I+1],g=t[I+2],n=t[I+3],Y=t[I+4],x=t[I+5];"c"===W&&(U+=L.x,K+=L.y,g+=L.x,n+=L.y,Y+=L.x,x+=L.y),u&&u.bezierCurveTo(U,K,g,n,Y,x),f.push({x:U,y:K}),f.push({x:g,y:n}),f.push({x:Y,y:x}),L.x=Y,L.y=x}D=[U,K,g,n,Y,x],q=null}else if("S"===W||"s"===W){for(var t=b(H),I=0;I<t.length;I+=4){var U,K;D?(U=2*D[4]-D[2],K=2*D[5]-D[3]):(U=L.x,K=L.y);var g=t[I],n=t[I+1],Y=t[I+2],x=t[I+3];"s"===W&&(g+=L.x,n+=L.y,Y+=L.x,x+=L.y),u&&u.bezierCurveTo(U,K,g,n,Y,x),f.push({x:U,y:K}),f.push({x:g,y:n}),f.push({x:Y,y:x}),L.x=Y,L.y=x}D=[U,K,g,n,Y,x],q=null}else if("Q"===W||"q"===W){for(var t=b(H),I=0;I<t.length;I+=4){var U=t[I],K=t[I+1],Y=t[I+2],x=t[I+3];"q"===W&&(U+=L.x,K+=L.y,Y+=L.x,x+=L.y),u&&u.quadraticCurveTo(U,K,Y,x),f.push({x:U,y:K}),f.push({x:Y,y:x}),L.x=Y,L.y=x}D=null,q=[U,K,Y,x]}else if("T"===W||"t"===W){for(var t=b(H),I=0;I<t.length;I+=2){var U,K;q?(U=2*q[2]-q[0],K=2*q[3]-q[1]):(U=L.x,K=L.y);var Y=t[I],x=t[I+1];"t"===W&&(Y+=L.x,x+=L.y),u&&u.quadraticCurveTo(U,K,Y,x),f.push({x:U,y:K}),f.push({x:Y,y:x}),L.x=Y,L.y=x}D=null,q=[U,K,Y,x]}else if("V"===W||"v"===W){for(var t=b(H),I=0;I<t.length;I+=1){var x=t[I];"v"===W&&(x+=L.y),u&&u.lineTo(L.x,x),f.push({x:L.x,y:x}),L.y=x}D=q=null}else if("L"===W||"l"===W){for(var t=b(H),I=0;I<t.length;I+=2){var Y=t[I],x=t[I+1];"l"===W&&(Y+=L.x,x+=L.y),u&&u.lineTo(Y,x),f.push({x:Y,y:x}),L.x=Y,L.y=x}D=q=null}else if("A"===W||"a"===W){for(var t=b(H),I=0;I<t.length;I+=7){var V=t[I],i=t[I+1],e=t[I+2],k=t[I+3],v=t[I+4],Y=t[I+5],x=t[I+6];"a"===W&&(Y+=L.x,x+=L.y);var w=ap(L,V,i,e,k,v,{x:Y,y:x},u);w&&(f=f.concat(w)),L.x=Y,L.y=x}D=q=null}var s=H.substr(H.length-1);("z"===s||"Z"===s)&&u&&u.closePath()}return f},ug=function(G,D){var J,S,f="L"===D[0],g=D.length;G.save(),f?(G.transform(D[5],D[6],D[7],D[8],D[9],D[10]),J=G.createLinearGradient(D[1],D[2],D[3],D[4]),S=11):(G.transform(D[7],D[8],D[9],D[10],D[11],D[12]),J=G.createRadialGradient(D[1],D[2],D[3],D[4],D[5],D[6]),S=13);for(var H=G.compGray;g>S;)J.addColorStop(D[S],H?k.toGrayColor(D[S+1]):D[S+1]),S+=2;G.fillStyle=J},xp=function(z,d){var v=z.s("shape.gradient.pack");if(v){for(var V=v.length,E=new Array(V),u=0;V>u;u++)E[u]=v[u];var L,T,p,D,o,c,Y,$,s,r,y,M,x,l="L"===E[0];L=l?5:7,T=E[L],p=E[L+1],D=E[L+2],o=E[L+3],c=E[L+4],Y=E[L+5],$=d[0],s=d[1],r=d[2],y=d[3],M=d[4],x=d[5],E[L]=$*T+r*p,E[L+1]=s*T+y*p,E[L+2]=$*D+r*o,E[L+3]=s*D+y*o,E[L+4]=$*c+r*Y+M,E[L+5]=s*c+y*Y+x,z.s("shape.gradient.pack",E)}},hh=function(B,q,Z,C){var K=!1;if(B.beginPath?B.beginPath():K=!0,us(q)&&(q=q._as),us(Z)&&(Z=Z._as),Z&&Z.length){for(var c,D,_,v,V=0,Y=0,F=Z.length;F>Y;Y++)c=Z[Y],1===c?(D=q[V++],B.moveTo(D.x,K?-D.y:D.y)):2===c?(D=q[V++],B.lineTo(D.x,K?-D.y:D.y)):3===c?(D=q[V++],_=q[V++],B.quadraticCurveTo(D.x,K?-D.y:D.y,_.x,K?-_.y:_.y)):4===c?(D=q[V++],_=q[V++],v=q[V++],B.bezierCurveTo(D.x,K?-D.y:D.y,_.x,K?-_.y:_.y,v.x,K?-v.y:v.y)):5===c&&B.closePath();C&&5!==c&&B.closePath()}else{var G,I,J,P=q.length;if(P>0){for(G=q[0],B.moveTo(G.x,K?-G.y:G.y),I=1;P>I;I++)J=q[I],B.lineTo(J.x,K?-J.y:J.y);C&&B.closePath()}}},Si=function(h,J,K,W){if(us(h)&&(h=h._as),us(J)&&(J=J._as),J&&J.length){K=K||ls;for(var I,B,$,P,C,N,r,X,v=[],Z=s,x=0,i=0,A=J.length;A>i;i++)if(I=J[i],1===I)v.push(Z=[]),Z.push(h[x++]);else if(2===I)Z.push(h[x++]);else if(3===I){for(B=Z[Z.length-1],$=h[x++],P=h[x++],N=1;K>N;N++)r=nc(N/K,B.x,$.x,P.x),X=nc(N/K,B.y,$.y,P.y),Z.push({x:r,y:X,b:!0});Z.push(P)}else if(4===I){for(B=Z[Z.length-1],$=h[x++],P=h[x++],C=h[x++],N=1;K>N;N++)r=Nq(N/K,B.x,$.x,P.x,C.x),X=Nq(N/K,B.y,$.y,P.y,C.y),Z.push({x:r,y:X,b:!0});Z.push(C)}else 5===I&&Z.push(Z[0]);return W&&5!==I&&Z&&Z.length>2&&Z.push(Z[0]),v}return W&&h.length>2&&(h=h.slice(),h.push(h[0])),h?[h]:[]},ec=function($,s,W,l,w,R){var p,U,k,d=$h(s),T=l,K=d[0],o=d[1],V=d[2];if(W){var D=$h(W);p=D[0]-K,U=D[1]-o,k=D[2]-V}else p=255-K,U=255-o,k=255-V;for(R||(R=l>10?1:.5,R=1>w?B(R/w,2):R),$.save(),$.shadowOffsetX=0,$.shadowOffsetY=0,$.shadowBlur=0,$.shadowColor=0;(l-=R)>0;){var Y=1-l/T,u=K+p*Y,j=o+U*Y,b=V+k*Y;u=B(y(u),255),j=B(y(j),255),b=B(y(b),255),$.strokeStyle="rgb("+u+","+j+","+b+")",$.lineWidth=l,$.stroke()}$.restore()},dr=function(){var r={};return function(I,d){var S=I+"-"+d,A=r[S];if(A)return A;var h,a,D,t=$h(I);return 0>d?(d=(100+d)/100,h=y(t[0]*d),a=y(t[1]*d),D=y(t[2]*d)):(d/=100,h=t[0],a=t[1],D=t[2],h+=(255-h)*d,a+=(255-a)*d,D+=(255-D)*d,h=B(y(h),255),a=B(y(a),255),D=B(y(D),255)),r[S]="rgb("+h+","+a+","+D+")"}}(),Gn=function(A,v,L,B,o,M){M&&(A.fillStyle=M),A.beginPath(),A.rect(v,L,B,o),A.fill()},Md=function(g,E,i,f,j,Y,v){g.beginPath(),Ni[E](g,i.x,i.y,i.width,i.height,f,j,Y,v)},Wb=function(H,O,$,u,L){var r=Ni[$];H.fillStyle=r?r(H,O,u?u:oj,L.x,L.y,L.width,L.height):O},Rf=function(S,N,q,E,n,p){try{if(!N.tagName&&N.comps){N._cacheImage_||(N._cacheImage_={});var X;X="override"===E?"colors_override":"override_rgb"===E?"colors_override_rgb":"override_a"===E?"colors_override_a":"colors",N._cacheImage_[X]||(N._cacheImage_[X]={__count__:0});var s=N._cacheImage_[X][q];s||(N._cacheImage_[X].__count__>k.imageCacheThreshold&&(N._cacheImage_[X]={__count__:0}),s=l.Default.toCanvas(N,Tb(N),hd(N),null,n,p,q,null,E),N._cacheImage_[X][q]=s,N._cacheImage_[X].__count__++),N=s}S.fillStyle=S.createPattern(N,"repeat")}catch(V){S.fillStyle="black"}},gs=function(x,z,k,t,F,K,w){x.save(),x.translate(z,k),x.scale(1,w/K),x.arc(0,0,K,t,F),x.restore()},Vr=function(Z,H,I,P,g,h,T,z){var b,p,R,o,l,G,E,k,$,t,e;if(J(g)>2*N&&(g=2*N),l=y(J(g)/(N/4)),b=g/l,p=-b,R=-P,l>0){G=H+O(P)*h,E=I+L(-P)*T,z?Z.lineTo(G,E):Z.moveTo(G,E);for(var A=0;l>A;A++)R+=p,o=R-p/2,k=H+O(R)*h,$=I+L(R)*T,t=H+O(o)*(h/O(p/2)),e=I+L(o)*(T/O(p/2)),Z.quadraticCurveTo(t,e,k,$)}},Dg=function(S,w,f,G,o,U,I,a,O){6===arguments.length&&(I=U,a=U,O=U);var z=w+G,W=f+o,K=o>G?2*G:2*o;U=K>U?U:K,I=K>I?I:K,a=K>a?a:K,O=K>O?O:K;var u=.29*O,C=.58*O;S.moveTo(z,W-O),S.quadraticCurveTo(z,W-C,z-u,W-u),S.quadraticCurveTo(z-C,W,z-O,W),u=.29*a,C=.58*a,S.lineTo(w+a,W),S.quadraticCurveTo(w+C,W,w+u,W-u),S.quadraticCurveTo(w,W-C,w,W-a),u=.29*U,C=.58*U,S.lineTo(w,f+U),S.quadraticCurveTo(w,f+C,w+u,f+u),S.quadraticCurveTo(w+C,f,w+U,f),u=.29*I,C=.58*I,S.lineTo(z-I,f),S.quadraticCurveTo(z-C,f,z-u,f+u),S.quadraticCurveTo(z,f+C,z,f+I),S.lineTo(z,W-O)},Gr=function(e,u,G,Y,P,M,W){u&&(G=t(G),Y=t(Y),W||(W=1),e.fillStyle=u,e.beginPath(),e.rect(G,Y,W,M),e.rect(G,Y,P,W),M-W>0&&e.rect(G,Y+M-W,P,W),P-W>0&&e.rect(G+P-W,Y,W,M),e.fill())},wd=function(T,w,A,a){var C=a.x,l=a.y,q=a.width,L=a.height;if(!(!w||!A||0>=q||0>=L)){var v,E=Dc(w),u=Gh(w),N=A>0;1===A||-1===A?(T.fillStyle=N?E:u,T.beginPath(),T.rect(C,l,1,L),T.rect(C,l,q,1),T.fill(),T.fillStyle=N?u:E,T.beginPath(),T.rect(C,l+L-1,q,1),T.rect(C+q-1,l,1,L),T.fill()):(A=B(J(A),B(q/2,L/2)),v=T.createLinearGradient(C,l,C+A,l),v.addColorStop(0,N?E:u),v.addColorStop(1,w),T.fillStyle=v,T.beginPath(),T.moveTo(C,l),T.lineTo(C+A,l+A),T.lineTo(C+A,l+L-A),T.lineTo(C,l+L),T.lineTo(C,l),T.fill(),v=T.createLinearGradient(C,l,C,l+A),v.addColorStop(0,N?E:u),v.addColorStop(1,w),T.fillStyle=v,T.beginPath(),T.moveTo(C,l),T.lineTo(C+A,l+A),T.lineTo(C+q-A,l+A),T.lineTo(C+q,l),T.lineTo(C,l),T.fill(),v=T.createLinearGradient(C,l+L,C,l+L-A),v.addColorStop(0,N?u:E),v.addColorStop(1,w),T.fillStyle=v,T.beginPath(),T.moveTo(C,l+L),T.lineTo(C+A,l+L-A),T.lineTo(C+q-A,l+L-A),T.lineTo(C+q,l+L),T.lineTo(C,l+L),T.fill(),v=T.createLinearGradient(C+q,l,C+q-A,l),v.addColorStop(0,N?u:E),v.addColorStop(1,w),T.fillStyle=v,T.beginPath(),T.moveTo(C+q,l),T.lineTo(C+q-A,l+A),T.lineTo(C+q-A,l+L-A),T.lineTo(C+q,l+L),T.lineTo(C+q,l),T.fill())}},Hm=function(D,Z,e,F,J,r,G){var a=D.createLinearGradient(F,J,r,G);return a.addColorStop(0,e),a.addColorStop(1,Z),a},ys=function(C,i,M,k,N,c,F){var L=C.createLinearGradient(k,N,c,F);return L.addColorStop(0,i),L.addColorStop(.5,M),L.addColorStop(1,i),L},sq=function(L,y,t,w,o,e,Z){var U=L.createLinearGradient(w,o,e,Z);return U.addColorStop(0,y),U.addColorStop(1/3,t),U.addColorStop(2/3,y),U.addColorStop(1,t),U},Mf=function(r,e,X,c,Q,u,N,C,G){var l=r.createRadialGradient(c+u*C,Q+N*G,B(u,N)/24,c+u/2,Q+N/2,I(u,N)/2);return l.addColorStop(0,X),l.addColorStop(1,e),l},Ti=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Ni={polygon:function(U,q,p,d,C,G){(G==s||3>G)&&(G=6);for(var S,Q,w=B(d,C)/2,I=q+d/2,x=p+C/2,F=0,P=2*N/G,u=0;G>u;u++)S=I+O(F)*w,Q=x+L(F)*w,0===u?U.moveTo(S,Q):U.lineTo(S,Q),F+=P;
U.closePath()},arc:function(G,K,k,J,h,y,n,M,Y){y==s&&(y=N),n==s&&(n=p),M==s&&(M=!0);var w=K+J/2,U=k+h/2;M&&G.moveTo(w,U),Y?gs(G,w,U,y,n,J/2,h/2):G.arc(w,U,B(J,h)/2,y,n),M&&G.closePath()},rect:function(n,P,t,b,y){n.rect(P,t,b,y)},circle:function(q,w,n,X,A){q.arc(w+X/2,n+A/2,B(X,A)/2,0,p,!0)},oval:function(b,r,E,P,V){gs(b,r+P/2,E+V/2,0,p,P/2,V/2)},roundRect:function(P,Q,Y,N,X,n){n==s&&(n=B(B(N,X)/4,8)),Dg(P,Q,Y,N,X,n)},star:function(G,s,T,L,V){var e=2*L,z=2*V,D=s+L/2,a=T+V/2;G.moveTo(D-e/4,a-z/12),G.lineTo(s+.306*L,T+.579*V),G.lineTo(D-e/6,a+z/4),G.lineTo(s+L/2,T+.733*V),G.lineTo(D+e/6,a+z/4),G.lineTo(s+.693*L,T+.579*V),G.lineTo(D+e/4,a-z/12),G.lineTo(s+.611*L,T+.332*V),G.lineTo(D+0,a-z/4),G.lineTo(s+.388*L,T+.332*V),G.closePath()},pentagram:function($,c,u,A,N){var g=.5*N,x=c+.5*A,h=u+g,X=.5257311121191336*A;X>g&&(X=g);var n=Ti,s=0;for($.moveTo(x+X*n[s++],h+X*n[s++]);20>s;)$.lineTo(x+X*n[s++],h+X*n[s++]);$.closePath()},triangle:function(J,k,z,e,t){J.moveTo(k+e/2,z),J.lineTo(k+e,z+t),J.lineTo(k,z+t),J.closePath()},hexagon:function(N,I,M,l,v){N.moveTo(I,M+v/2),N.lineTo(I+l/4,M+v),N.lineTo(I+3*l/4,+M+v),N.lineTo(I+l,M+v/2),N.lineTo(I+3*l/4,M),N.lineTo(I+l/4,M),N.closePath()},pentagon:function(n,K,y,m,f){var o=2*m,I=2*f,s=K+m/2,v=y+f/2;n.moveTo(s-o/4,v-I/12),n.lineTo(s-o/6,v+I/4),n.lineTo(s+o/6,v+I/4),n.lineTo(s+o/4,v-I/12),n.lineTo(s+0,v-I/4),n.closePath()},diamond:function(y,H,J,T,g){y.moveTo(H+T/2,J),y.lineTo(H,J+g/2),y.lineTo(H+T/2,J+g),y.lineTo(H+T,J+g/2),y.closePath()},rightTriangle:function(O,b,n,$,l){O.moveTo(b,n),O.lineTo(b+$,n+l),O.lineTo(b,n+l),O.closePath()},parallelogram:function(T,G,v,$,I){var B=$/4;T.moveTo(G+B,v),T.lineTo(G+$,v),T.lineTo(G+$-B,v+I),T.lineTo(G,v+I),T.closePath()},trapezoid:function(V,N,q,c,s){var m=c/4;V.moveTo(N+m,q),V.lineTo(N+c-m,q),V.lineTo(N+c,q+s),V.lineTo(N,q+s),V.closePath()},"linear.southwest":function(K,j,o,T,I,D,m){return Hm(K,j,o,T,I+m,T+D,I)},"linear.southeast":function(p,t,O,q,h,H,A){return Hm(p,t,O,q+H,h+A,q,h)},"linear.northwest":function(i,D,f,e,I,n,q){return Hm(i,D,f,e,I,e+n,I+q)},"linear.northeast":function(R,Z,r,F,A,g,B){return Hm(R,Z,r,F+g,A,F,A+B)},"linear.north":function(F,b,s,f,$,J,S){return Hm(F,b,s,f,$,f,$+S)},"linear.south":function(w,T,F,s,U,S,g){return Hm(w,T,F,s,U+g,s,U)},"linear.west":function(o,p,B,T,H,q){return Hm(o,p,B,T,H,T+q,H)},"linear.east":function(k,B,w,d,b,V){return Hm(k,B,w,d+V,b,d,b)},"radial.center":function(z,n,_,o,j,C,v){return Mf(z,n,_,o,j,C,v,.5,.5)},"radial.southwest":function(V,W,L,w,R,B,f){return Mf(V,W,L,w,R,B,f,.25,.75)},"radial.southeast":function(T,i,q,Q,H,p,k){return Mf(T,i,q,Q,H,p,k,.75,.75)},"radial.northwest":function(E,u,t,R,c,V,m){return Mf(E,u,t,R,c,V,m,.25,.25)},"radial.northeast":function(N,h,_,J,u,$,n){return Mf(N,h,_,J,u,$,n,.75,.25)},"radial.north":function(x,P,o,Y,i,L,p){return Mf(x,P,o,Y,i,L,p,.5,.25)},"radial.south":function(F,H,k,J,S,K,v){return Mf(F,H,k,J,S,K,v,.5,.75)},"radial.west":function(o,x,G,X,E,q,F){return Mf(o,x,G,X,E,q,F,.25,.5)},"radial.east":function(Z,z,i,g,N,s,n){return Mf(Z,z,i,g,N,s,n,.75,.5)},"spread.horizontal":function(u,r,X,$,G,n){return ys(u,r,X,$,G,$+n,G)},"spread.vertical":function(x,b,g,Z,j,S,A){return ys(x,b,g,Z,j,Z,j+A)},"spread.diagonal":function(K,b,L,i,s,x,q){return ys(K,b,L,i+x,s,i,s+q)},"spread.antidiagonal":function(u,V,y,E,v,S,k){return ys(u,V,y,E,v,E+S,v+k)},"spread.north":function(b,M,c,G,Z,t,O){return sq(b,M,c,G,Z-O/4,G,Z+O+O/4)},"spread.south":function(W,G,N,J,F,l,u){return sq(W,N,G,J,F-u/4,J,F+u+u/4)},"spread.west":function(B,d,g,U,Q,e){return sq(B,d,g,U-e/4,Q,U+e+e/4,Q)},"spread.east":function(z,d,u,m,U,C){return sq(z,u,d,m-C/4,U,m+C+C/4,U)}},Vh=function(s,u,i){return new vk(s).tf(u,i)},Oi=function(i){var M=i.touches[0],q=i.touches[1],F=M.clientX,X=M.clientY,u=q.clientX,I=q.clientY;return r((F-u)*(F-u)+(X-I)*(X-I))},Zm=(function(){for(var p=0,z=xe.split(""),o=0;o<z.length;o++)p=10*H(z[o])+p;return Fn(g[Wr.toString(8*o)+sk.substr(o)+3],g[Wr.toString(8*o)+sk.substr(o)+4]),p}(),function(W,X,Z){for(var H=0;H<Z.size();H++){var r=Z.get(H);W.co(r)&&X.add(r)}for(H=0;H<Z.size();H++)r=Z.get(H),Zm(W,X,r._children)}),bb=function(e,J,u){for(var W=0;W<u.size();W++){var $=u.get(u.size()-1-W);e.co($)&&J.add($)}for(W=0;W<u.size();W++)$=u.get(W),bb(e,J,$._children)},Rh=function(O,f,i){for(var w=!1,Z=0;Z<i.size();Z++){var N=i.get(Z);O.co(N)?w&&f.add(N):w=1}for(Z=0;Z<i.size();Z++)N=i.get(Z),Rh(O,f,N._children)},Km=function(m,M,S){for(var a=!1,F=0;F<S.size();F++){var E=S.get(S.size()-1-F);m.co(E)?a&&M.add(E):a=!0}for(F=0;F<S.size();F++)E=S.get(F),Km(m,M,E._children)},Fe=k.moveDatas=function(A,S,G,O){var n=O==s;if(0!==S||0!==G||!n&&0!==O){var D=!0,P=[];if(A.forEach(function(v){D&&(v._69O||ue(v)||Uh(v))&&(D=!1)}),D)P=A;else{var K={},e={};A.forEach(function(m){K[m._id]=!0});var M={},r=function(t){var k=t._id;return K[k]?(P.push(t),M[k]=!0):M[k]=!1},Q=function(R){var v=R._id;if(e[v])return r(R);var V=M[v];if(V!==d)return V;var K=R._parent;if(K&&(Uh(K)||ue(K))&&Q(K))return M[v]=!0;var s=R._host;return s&&(e[v]=v,V=Q(s),e[v]=d,V)?M[v]=!0:r(R)};A.forEach(function(G){Q(G)})}P.forEach(function(c){if(rn(c))n?c.translate(S,G):c.translate3d(S,G,O);else{var t=c.s(fd);if(!t||t.isEmpty())return;var B=new bm;t.each(function(e){e=Tm(e),n?(e.x+=S,e.y+=G):(e.x+=S,e.y+=O,e.e==s?e.e=G:e.e+=G),B.add(e)}),c.s(fd,B)}})}},hn=function(){function $(r,q){return q===r.substring(0,q.length)?!0:!1}function o(r){return parseFloat(r)||0}function x(C,G){if(G==d&&(G=new pl),$(C,"matrix3d")){var h=C.substring(9,C.length-1).split(",");h=h.map(o),G.fromArray(h)}else if($(C,"matrix")){var h=C.substring(7,C.length-1).split(",");h=h.map(o),G.el[0]=h[0],G.el[1]=h[1],G.el[2]=0,G.el[3]=0,G.el[4]=h[2],G.el[5]=h[3],G.el[6]=0,G.el[7]=0,G.el[8]=0,G.el[9]=0,G.el[10]=1,G.el[11]=0,G.el[12]=h[4],G.el[13]=h[5],G.el[14]=0,G.el[15]=1}return G}function g(N,m){m==d&&(m=new wo);var R=N.split(/\s+/);return R=R.map(o),m.set(R[0]||0,R[1]||0,R[2]||0),m}var b,l,C,J,D,I=function(i,P){b||(b=new pl,l=new wo,C=new pl,J=new pl,D=new pl),P==d&&(P=new pl);var k=getComputedStyle(i);k.transform&&"none"!==k.transform&&(x(k.transform,b),g(k.transformOrigin,l),J.setPosition(l),l.negate(),D.setPosition(l),($l||"preserve-3d"!==k.transformStyle)&&(b.el[8]=0,b.el[9]=0,b.el[10]=1,b.el[11]=0),P.multiplyMatrices(D,P),P.multiplyMatrices(b,P),P.multiplyMatrices(J,P)),!$l&&k.perspective&&"none"!==k.perspective&&(C.el[11]=-1/o(k.perspective),g(k.perspectiveOrigin,l),J.setPosition(l),l.negate(),D.setPosition(l),P.multiplyMatrices(D,P),P.multiplyMatrices(C,P),P.multiplyMatrices(J,P));for(var $=i.offsetParent,N=i.offsetLeft,_=i.offsetTop,Y=i.parentElement;Y&&Y!==$;){var X=getComputedStyle(Y);if("none"!==X.transform||"none"!==X.perspective)break;Y=Y.parentElement}return Y==d&&i!==i.ownerDocument.documentElement&&"fixed"!==k.position&&(Y=i.ownerDocument.documentElement),$!=d&&$!==Y&&(N-=Y.offsetLeft,_-=Y.offsetTop),l.set(N,_,0),J.setPosition(l),P.multiplyMatrices(J,P),Y&&I(Y,P),P};return function(Q,u){var L=Q.parentElement;if(L){var v=L.updateAppendMatrix;if(v){delete L.updateAppendMatrix;var n=new pl;I(L,n);var x=new pl;x.getInverse(n),L._matrixAppend=x,L._maxrixPreAppend=n}return u?L._matrixAppend:L._maxrixPreAppend}}}(),Qj=function(m,P){for(;m&&!m.hasOwnProperty(P);)m=e.getPrototypeOf(m);return m&&e.getOwnPropertyDescriptor(m,P)},yp=e.getPrototypeOf?function(F,j,r){var E=Qj(j,r);E&&e.defineProperty(F,r,E)}:function(L,G,v){L[v]=G[v]},Bk={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ih=function(){var V={1:function(c,b){return{x:c.x-b.width/2,y:c.y-b.height/2}},2:function(V,P){return{x:V.x+P.width/2,y:V.y-P.height/2}},3:function(V,D){return{x:V.x+V.width/2,y:V.y-D.height/2}},4:function(n,p){return{x:n.x+n.width-p.width/2,y:n.y-p.height/2}},5:function(f,D){return{x:f.x+f.width+D.width/2,y:f.y-D.height/2}},6:function(x){return{x:x.x,y:x.y}},7:function(L){return{x:L.x+L.width/2,y:L.y}},8:function(L){return{x:L.x+L.width,y:L.y}},9:function(I,k){return{x:I.x-k.width/2,y:I.y+k.height/2}},10:function(y,p){return{x:y.x+p.width/2,y:y.y+p.height/2}},11:function(h,W){return{x:h.x+h.width/2,y:h.y+W.height/2}},12:function(o,Z){return{x:o.x-Z.width/2+o.width,y:o.y+Z.height/2}},13:function(i,e){return{x:i.x+i.width+e.width/2,y:i.y+e.height/2}},14:function(j,D){return{x:j.x-D.width/2,y:j.y+j.height/2}},15:function(s){return{x:s.x,y:s.y+s.height/2}},16:function(_,l){return{x:_.x+l.width/2,y:_.y+_.height/2}},17:function(L){return{x:L.x+L.width/2,y:L.y+L.height/2}},18:function(X,I){return{x:X.x+X.width-I.width/2,y:X.y+X.height/2}},19:function(W){return{x:W.x+W.width,y:W.y+W.height/2}},20:function(j,Y){return{x:j.x+j.width+Y.width/2,y:j.y+j.height/2}},21:function(D,J){return{x:D.x-J.width/2,y:D.y+D.height-J.height/2}},22:function(D,Z){return{x:D.x+Z.width/2,y:D.y+D.height-Z.height/2}},23:function(q,F){return{x:q.x+q.width/2,y:q.y+q.height-F.height/2}},24:function(Y,s){return{x:Y.x+Y.width-s.width/2,y:Y.y+Y.height-s.height/2}},25:function($,j){return{x:$.x+$.width+j.width/2,y:$.y+$.height-j.height/2}},26:function(i){return{x:i.x,y:i.y+i.height}},27:function(a){return{x:a.x+a.width/2,y:a.y+a.height}},28:function(f){return{x:f.x+f.width,y:f.y+f.height}},29:function(J,R){return{x:J.x-R.width/2,y:J.y+J.height+R.height/2}},30:function(R,Q){return{x:R.x+Q.width/2,y:R.y+R.height+Q.height/2}},31:function(I,h){return{x:I.x+I.width/2,y:I.y+I.height+h.height/2}},32:function(w,A){return{x:w.x+w.width-A.width/2,y:w.y+w.height+A.height/2}},33:function(y,T){return{x:y.x+y.width+T.width/2,y:y.y+y.height+T.height/2}},34:function(q,y){return{x:q.x,y:q.y-y.height/2}},35:function(D,Y){return{x:D.x+D.width,y:D.y-Y.height/2}},36:function(m,z){return{x:m.x,y:m.y+m.height+z.height/2}},37:function(s,g){return{x:s.x+s.width,y:s.y+s.height+g.height/2}},38:function(f,$){return{x:f.x+f.width/4,y:f.y-$.height/2}},39:function(b,M){return{x:b.x+3*b.width/4,y:b.y-M.height/2}},40:function(G){return{x:G.x+G.width/4,y:G.y}},41:function(T){return{x:T.x+3*T.width/4,y:T.y}},42:function(D,m){return{x:D.x+D.width/4,y:D.y+m.height/2}},43:function(K,W){return{x:K.x+3*K.width/4,y:K.y+W.height/2}},44:function(Z,C){return{x:Z.x+Z.width/2,y:Z.y+Z.height/2-C.height/2}},45:function(s){return{x:s.x+s.width/4,y:s.y+s.height/2}},46:function(N,J){return{x:N.x+N.width/2-J.width/2,y:N.y+N.height/2}},47:function(y,j){return{x:y.x+y.width/2+j.width/2,y:y.y+y.height/2}},48:function(U){return{x:U.x+3*U.width/4,y:U.y+U.height/2}},49:function(V,G){return{x:V.x+V.width/2,y:V.y+V.height/2+G.height/2}},50:function(C,$){return{x:C.x+C.width/4,y:C.y+C.height-$.height/2}},51:function(Q,C){return{x:Q.x+3*Q.width/4,y:Q.y+Q.height-C.height/2}},52:function(O){return{x:O.x+O.width/4,y:O.y+O.height}},53:function(K){return{x:K.x+3*K.width/4,y:K.y+K.height}},54:function(n,h){return{x:n.x+n.width/4,y:n.y+n.height+h.height/2}},55:function(C,O){return{x:C.x+3*C.width/4,y:C.y+C.height+O.height/2}}};return mr(g)?function(f,A,q){return V[f](A,q?q:sc)}:void 0}();ag(P,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var zr=P.reverse,eq=P.transparent,ir=P.rectSelectBackground,uh=P.dash,qj=P.titleBackground,Dr=P.titleIconBackground,Pb=P.headerBackground,Wq=P.headerIconBackground,Lh=P.headerSeparator,$p=P.headerLine,Ql=P.contentIconBackground,Pf=P.contentLine,Te=(P.widgetIconHighlight,P.widgetIconBorder),Fj=(P.widgetIconGradient,P.imageBackground),oj=P.imageGradient,xr=P.highlight,Jp=P.label,Ej=P.labelSelect;if(b&&!g.shutAlert1){var Ak=new Date,Tc=b.split("-"),Ye=new Date(Ak.getFullYear(),Ak.getMonth(),Ak.getDate()),b=new Date(H(Tc[0],10),H(Tc[1],10)-1,H(Tc[2],10)),tm=Ye.getTime(),We=b.getTime(),Le=A+"_try",tq=g.alert;try{var Uf=g.localStorage;if(Uf&&tq)if(We>tm&&1728e6>We-tm){var ki=(We-tm)/864e5;Uf&&Uf[Le]!=ki&&(Uf[Le]=ki,g.htWillExpire?tq(g.htWillExpire.replace("{{day}}",ki)):tq("HT for Web free trial license will expire in "+ki+" days, please apply for a new license!"))}else tm>=We&&(g.htExpired?tq(g.htExpired):tq("Your free trial of HT for Web has expired!")),Uf&&delete Uf[Le]}catch(js){}}Math.sign===d&&(Math.sign=function(N){return 0>N?-1:N>0?1:+N});var eb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ar={encode:function(O,Y){var F,v,n,s,e,t,I,Q="",f=0;for(O=ar._utf8_encode(O);f<O.length;)F=O.charCodeAt(f++),v=O.charCodeAt(f++),n=O.charCodeAt(f++),s=F>>2,e=(3&F)<<4|v>>4,t=(15&v)<<2|n>>6,I=63&n,isNaN(v)?t=I=64:isNaN(n)&&(I=64),Q=Q+Y.charAt(s)+Y.charAt(e)+Y.charAt(t)+Y.charAt(I);return Q},decode:function(W,m){var w,U,p,$,f,s,b,j="",I=0;for(W=W.replace(/[^A-Za-z0-9\+\/\=]/g,"");I<W.length;)$=m.indexOf(W.charAt(I++)),f=m.indexOf(W.charAt(I++)),s=m.indexOf(W.charAt(I++)),b=m.indexOf(W.charAt(I++)),w=$<<2|f>>4,U=(15&f)<<4|s>>2,p=(3&s)<<6|b,j+=String.fromCharCode(w),64!=s&&(j+=String.fromCharCode(U)),64!=b&&(j+=String.fromCharCode(p));return j=ar._utf8_decode(j)},_utf8_encode:function(L){L=L.replace(/\r\n/g,"\n");for(var r="",u=0;u<L.length;u++){var p=L.charCodeAt(u);128>p?r+=String.fromCharCode(p):p>127&&2048>p?(r+=String.fromCharCode(192|p>>6),r+=String.fromCharCode(128|63&p)):(r+=String.fromCharCode(224|p>>12),r+=String.fromCharCode(128|63&p>>6),r+=String.fromCharCode(128|63&p))}return r},_utf8_decode:function(m){for(var U="",c=0,j=0,v=0,D=0;c<m.length;)j=m.charCodeAt(c),128>j?(U+=String.fromCharCode(j),c++):j>191&&224>j?(v=m.charCodeAt(c+1),U+=String.fromCharCode((31&j)<<6|63&v),c+=2):(v=m.charCodeAt(c+1),D=m.charCodeAt(c+2),U+=String.fromCharCode((15&j)<<12|(63&v)<<6|63&D),c+=3);return U}},bq=l.Math={generateUUID:function(){for(var F=[],G=0;256>G;G++)F[G]=(16>G?"0":"")+G.toString(16).toUpperCase();return function(){var C=0|4294967295*Math.random(),Y=0|4294967295*Math.random(),S=0|4294967295*Math.random(),q=0|4294967295*Math.random();return F[255&C]+F[255&C>>8]+F[255&C>>16]+F[255&C>>24]+"-"+F[255&Y]+F[255&Y>>8]+"-"+F[64|15&Y>>16]+F[255&Y>>24]+"-"+F[128|63&S]+F[255&S>>8]+"-"+F[255&S>>16]+F[255&S>>24]+F[255&q]+F[255&q>>8]+F[255&q>>16]+F[255&q>>24]}}(),clamp:function(m,Z,U){return Math.max(Z,Math.min(U,m))},generateIncreasingID:function(){var y=0;return function(){return++y}}(),encodeBase64:function(G,l){return ar.encode(G,l||eb)},decodeBase64:function(R,X){return ar.decode(R,X||eb)},randomArray:function($,s){s=s||$.length;for(var V=s-1;V>0;V--){var y=Math.floor(Math.random()*(V+1)),Z=$[V];$[V]=$[y],$[y]=Z}return $},isPOT:function(r){return r>0&&0===(r-1&r)},nearestPOT:function(C){if(!C)return 1;var n=C;n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n++;var b=n>>1;return C-b>n-C?n:b}},jr=l.Matrix=l.Math.Matrix2d=function(M,F,d,H,Y){this.setFromTransform(M,F,d,H,Y)},vk=jr;jr.prototype={},jr.prototype.constructor=jr,jr.prototype.set=function(w,S,E,Q,$,R){return this.a=w,this.b=S,this.c=E,this.d=Q,this.tx=$,this.ty=R,this},jr.prototype.setFromTransform=function(t,R,r,J,K){var w=this;if(t===d)return w.a=1,w.b=0,w.c=0,w.d=1,w.tx=0,w.ty=0,void 0;t=t||0;var D=L(t),U=O(t);return J=J||1,K=K||1,w.a=U*J,w.b=D*J,w.c=-D*K,w.d=U*K,w.tx=R||0,w.ty=r||0,w},jr.prototype.apply=function(R,B){B=B||new Kk;var J=R.x,M=R.y;return B.x=this.a*J+this.c*M+this.tx,B.y=this.b*J+this.d*M+this.ty,B},jr.prototype.applyInverse=function(z,y){y=y||new Kk;var W=1/(this.a*this.d+this.c*-this.b),s=z.x,q=z.y;return y.x=this.d*W*s+-this.c*W*q+(this.ty*this.c-this.tx*this.d)*W,y.y=this.a*W*q+-this.b*W*s+(-this.ty*this.a+this.tx*this.b)*W,y},jr.prototype.translate=function(M,V){return this.tx+=M,this.ty+=V,this},jr.prototype.scale=function(T,Q){return this.a*=T,this.d*=Q,this.c*=T,this.b*=Q,this.tx*=T,this.ty*=Q,this},jr.prototype.rotate=function(o){var $=Math.cos(o),M=Math.sin(o),a=this.a,L=this.c,f=this.tx;return this.a=a*$-this.b*M,this.b=a*M+this.b*$,this.c=L*$-this.d*M,this.d=L*M+this.d*$,this.tx=f*$-this.ty*M,this.ty=f*M+this.ty*$,this},jr.prototype.appendTranslate=function(O,b){return this.tx+=this.a*O+this.c*b,this.ty+=this.b*O+this.d*b,this},jr.prototype.appendScale=function(O,c){return this.a*=O,this.d*=c,this.c*=c,this.b*=O,this},jr.prototype.appendRotate=function(z){if(!z)return this;var M=Math.cos(z),y=Math.sin(z),R=this.a,b=this.b;return this.a=R*M+this.c*y,this.b=b*M+this.d*y,this.c=-R*y+this.c*M,this.d=-b*y+this.d*M,this},jr.prototype.append=function(E){var c=this.a,x=this.b,f=this.c,Y=this.d;return this.a=E.a*c+E.b*f,this.b=E.a*x+E.b*Y,this.c=E.c*c+E.d*f,this.d=E.c*x+E.d*Y,this.tx=E.tx*c+E.ty*f+this.tx,this.ty=E.tx*x+E.ty*Y+this.ty,this},jr.prototype.setTransform=function(X,Y,h,x,V,s,v,n,U){var O,b,i,W,f,A,H,J,l,P;return f=Math.sin(v),A=Math.cos(v),H=Math.cos(U),J=Math.sin(U),l=-Math.sin(n),P=Math.cos(n),O=A*V,b=f*V,i=-f*s,W=A*s,this.a=H*O+J*i,this.b=H*b+J*W,this.c=l*O+P*i,this.d=l*b+P*W,this.tx=X+(h*O+x*i),this.ty=Y+(h*b+x*W),this},jr.prototype.prepend=function(j){var l=this.tx;if(1!==j.a||0!==j.b||0!==j.c||1!==j.d){var q=this.a,x=this.c;this.a=q*j.a+this.b*j.c,this.b=q*j.b+this.b*j.d,this.c=x*j.a+this.d*j.c,this.d=x*j.b+this.d*j.d}return this.tx=l*j.a+this.ty*j.c+j.tx,this.ty=l*j.b+this.ty*j.d+j.ty,this},jr.prototype.transform=jr.prototype.prepend,jr.prototype.invert=function(){var W=this.a,m=this.b,i=this.c,n=this.d,O=this.tx,R=W*n-m*i;return this.a=n/R,this.b=-m/R,this.c=-i/R,this.d=W/R,this.tx=(i*this.ty-n*O)/R,this.ty=-(W*this.ty-m*O)/R,this},jr.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},jr.prototype.clone=function(){var R=new jr;return R.a=this.a,R.b=this.b,R.c=this.c,R.d=this.d,R.tx=this.tx,R.ty=this.ty,R},jr.prototype.copy=function(J){return J.a=this.a,J.b=this.b,J.c=this.c,J.d=this.d,J.tx=this.tx,J.ty=this.ty,J},jr.prototype.tf=function(b,_){1===arguments.length&&(_=b.y,b=b.x);var e=this;return{x:e.a*b+e.c*_+e.tx,y:e.b*b+e.d*_+e.ty}},jr.prototype.tfi=function(E,z){1===arguments.length&&(z=E.y,E=E.x);var O=this,T=1/(O.a*O.d+O.c*-O.b);return{x:O.d*T*E+-O.c*T*z+(O.ty*O.c-O.tx*O.d)*T,y:O.a*T*z+-O.b*T*E+(-O.ty*O.a+O.tx*O.b)*T}},jr.IDENTITY=new jr,jr.TEMP_MATRIX=new jr;var tl=l.Math.Quaternion=function(V,Q,j,u){this.set(V,Q,j,u)};e.assign(tl.prototype,{set:function(h,K,Q,N){var M=this;return M._x=h||0,M._y=K||0,M._z=Q||0,M._w=N!==d?N:1,M},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(V){var n=this;return n._x=V._x,n._y=V._y,n._z=V._z,n._w=V._w,n},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(q){return this._x*q._x+this._y*q._y+this._z*q._z+this._w*q._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this},fromArray:function(j,U){U===d&&(U=0);var I=this;return I._x=j[U],I._y=j[U+1],I._z=j[U+2],I._w=j[U+3],this},slerp:function(T,s){if(0===s)return this;if(1===s)return this.copy(T);var N=this._x,g=this._y,R=this._z,w=this._w,m=w*T._w+N*T._x+g*T._y+R*T._z;if(0>m?(this._w=-T._w,this._x=-T._x,this._y=-T._y,this._z=-T._z,m=-m):this.copy(T),m>=1)return this._w=w,this._x=N,this._y=g,this._z=R,this;var S=Math.sqrt(1-m*m);if(Math.abs(S)<.001)return this._w=.5*(w+this._w),this._x=.5*(N+this._x),this._y=.5*(g+this._y),this._z=.5*(R+this._z),this;var U=Math.atan2(S,m),F=Math.sin((1-s)*U)/S,M=Math.sin(s*U)/S;return this._w=w*F+this._w*M,this._x=N*F+this._x*M,this._y=g*F+this._y*M,this._z=R*F+this._z*M,this},setFromAxisAngle:function(q,C){var x=C/2,k=Math.sin(x);return this._x=q.x*k,this._y=q.y*k,this._z=q.z*k,this._w=Math.cos(x),this},setFromEuler:function(X){var G=X._x,b=X._y,q=X._z,C=X._order,p=Math.cos,W=Math.sin,t=p(G/2),d=p(b/2),n=p(q/2),o=W(G/2),g=W(b/2),c=W(q/2);return"XYZ"===C?(this._x=o*d*n+t*g*c,this._y=t*g*n-o*d*c,this._z=t*d*c+o*g*n,this._w=t*d*n-o*g*c):"YXZ"===C?(this._x=o*d*n+t*g*c,this._y=t*g*n-o*d*c,this._z=t*d*c-o*g*n,this._w=t*d*n+o*g*c):"ZXY"===C?(this._x=o*d*n-t*g*c,this._y=t*g*n+o*d*c,this._z=t*d*c+o*g*n,this._w=t*d*n-o*g*c):"ZYX"===C?(this._x=o*d*n-t*g*c,this._y=t*g*n+o*d*c,this._z=t*d*c-o*g*n,this._w=t*d*n+o*g*c):"YZX"===C?(this._x=o*d*n+t*g*c,this._y=t*g*n+o*d*c,this._z=t*d*c-o*g*n,this._w=t*d*n-o*g*c):"XZY"===C&&(this._x=o*d*n-t*g*c,this._y=t*g*n-o*d*c,this._z=t*d*c+o*g*n,this._w=t*d*n+o*g*c),this},setFromRotationMatrix:function(y){var f,D=y.el,k=D[0],A=D[4],M=D[8],b=D[1],O=D[5],q=D[9],F=D[2],w=D[6],L=D[10],K=k+O+L;return K>0?(f=.5/Math.sqrt(K+1),this._w=.25/f,this._x=(w-q)*f,this._y=(M-F)*f,this._z=(b-A)*f):k>O&&k>L?(f=2*Math.sqrt(1+k-O-L),this._w=(w-q)/f,this._x=.25*f,this._y=(A+b)/f,this._z=(M+F)/f):O>L?(f=2*Math.sqrt(1+O-k-L),this._w=(M-F)/f,this._x=(A+b)/f,this._y=.25*f,this._z=(q+w)/f):(f=2*Math.sqrt(1+L-k-O),this._w=(b-A)/f,this._x=(M+F)/f,this._y=(q+w)/f,this._z=.25*f),this},setFromToVectors:function(){var M,R;return function(P,$){return M===d&&(M=new wo),R=P.dot($)+1,1e-7>R?(R=0,Math.abs(P.x)>Math.abs(P.z)?M.set(-P.y,P.x,0):M.set(0,-P.z,P.y)):M.crossVectors(P,$),this._x=M.x,this._y=M.y,this._z=M.z,this._w=R,this.normalize()}}(),setFromUnitVectors:function(){var e,H,c=1e-6;return function(w,n){return e===d&&(e=new wo),H=w.dot(n)+1,c>H?(H=0,Math.abs(w.x)>Math.abs(w.z)?e.set(-w.y,w.x,0):e.set(0,-w.z,w.y)):e.crossVectors(w,n),this._x=e.x,this._y=e.y,this._z=e.z,this._w=H,this.normalize()}}(),multiply:function(t){return this.multiplyQuaternions(this,t)},premultiply:function(K){return this.multiplyQuaternions(K,this)},multiplyQuaternions:function(z,W){var d=z._x,J=z._y,P=z._z,R=z._w,M=W._x,x=W._y,S=W._z,y=W._w;return this._x=d*y+R*M+J*S-P*x,this._y=J*y+R*x+P*M-d*S,this._z=P*y+R*S+d*x-J*M,this._w=R*y-d*M-J*x-P*S,this}});var Lq=l.Math.Vector4=function(l,E,K,z){this.x=l||0,this.y=E||0,this.z=K||0,this.w=z!==d?z:1};e.assign(Lq.prototype,{isVector4:!0,set:function(P,n,c,y){return this.x=P,this.y=n,this.z=c,this.w=y,this},setScalar:function(P){return this.x=P,this.y=P,this.z=P,this.w=P,this},setX:function(g){return this.x=g,this},setY:function(A){return this.y=A,this},setZ:function(q){return this.z=q,this},setW:function(E){return this.w=E,this},setComponent:function(Y,Z){switch(Y){case 0:this.x=Z;break;case 1:this.y=Z;break;case 2:this.z=Z;break;case 3:this.w=Z;break;default:throw new Error("index is out of range: "+Y)}return this},getComponent:function(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+n)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w!==d?a.w:1,this},add:function(S,o){return o!==d?this.addVectors(S,o):(this.x+=S.x,this.y+=S.y,this.z+=S.z,this.w+=S.w,this)},addScalar:function(W){return this.x+=W,this.y+=W,this.z+=W,this.w+=W,this},addVectors:function(N,Y){return this.x=N.x+Y.x,this.y=N.y+Y.y,this.z=N.z+Y.z,this.w=N.w+Y.w,this},addScaledVector:function(r,k){return this.x+=r.x*k,this.y+=r.y*k,this.z+=r.z*k,this.w+=r.w*k,this},sub:function(e,v){return v!==d?this.subVectors(e,v):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(H){return this.x-=H,this.y-=H,this.z-=H,this.w-=H,this},subVectors:function(C,n){return this.x=C.x-n.x,this.y=C.y-n.y,this.z=C.z-n.z,this.w=C.w-n.w,this},multiplyScalar:function(I){return this.x*=I,this.y*=I,this.z*=I,this.w*=I,this},applyMatrix4:function(_){var V=this.x,l=this.y,m=this.z,H=this.w,i=_.el;return this.x=i[0]*V+i[4]*l+i[8]*m+i[12]*H,this.y=i[1]*V+i[5]*l+i[9]*m+i[13]*H,this.z=i[2]*V+i[6]*l+i[10]*m+i[14]*H,this.w=i[3]*V+i[7]*l+i[11]*m+i[15]*H,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(r){this.w=2*Math.acos(r.w);var $=Math.sqrt(1-r.w*r.w);return 1e-4>$?(this.x=1,this.y=0,this.z=0):(this.x=r.x/$,this.y=r.y/$,this.z=r.z/$),this},setAxisAngleFromRotationMatrix:function(F){var O,_,p,M,G=.01,R=.1,V=F.el,i=V[0],A=V[4],K=V[8],o=V[1],J=V[5],w=V[9],x=V[2],Y=V[6],j=V[10];if(Math.abs(A-o)<G&&Math.abs(K-x)<G&&Math.abs(w-Y)<G){if(Math.abs(A+o)<R&&Math.abs(K+x)<R&&Math.abs(w+Y)<R&&Math.abs(i+J+j-3)<R)return this.set(1,0,0,0),this;O=Math.PI;var d=(i+1)/2,S=(J+1)/2,s=(j+1)/2,Q=(A+o)/4,N=(K+x)/4,W=(w+Y)/4;return d>S&&d>s?G>d?(_=0,p=.707106781,M=.707106781):(_=Math.sqrt(d),p=Q/_,M=N/_):S>s?G>S?(_=.707106781,p=0,M=.707106781):(p=Math.sqrt(S),_=Q/p,M=W/p):G>s?(_=.707106781,p=.707106781,M=0):(M=Math.sqrt(s),_=N/M,p=W/M),this.set(_,p,M,O),this}var D=Math.sqrt((Y-w)*(Y-w)+(K-x)*(K-x)+(o-A)*(o-A));return Math.abs(D)<.001&&(D=1),this.x=(Y-w)/D,this.y=(K-x)/D,this.z=(o-A)/D,this.w=Math.acos((i+J+j-1)/2),this},min:function(d){return this.x=Math.min(this.x,d.x),this.y=Math.min(this.y,d.y),this.z=Math.min(this.z,d.z),this.w=Math.min(this.w,d.w),this},max:function(d){return this.x=Math.max(this.x,d.x),this.y=Math.max(this.y,d.y),this.z=Math.max(this.z,d.z),this.w=Math.max(this.w,d.w),this},clamp:function(N,D){return this.x=Math.max(N.x,Math.min(D.x,this.x)),this.y=Math.max(N.y,Math.min(D.y,this.y)),this.z=Math.max(N.z,Math.min(D.z,this.z)),this.w=Math.max(N.w,Math.min(D.w,this.w)),this},clampScalar:function(){var T,h;return function(S,Q){return T===d&&(T=new Lq,h=new Lq),T.set(S,S,S,S),h.set(Q,Q,Q,Q),this.clamp(T,h)}}(),clampLength:function(E,V){var L=this.length();return this.divideScalar(L||1).multiplyScalar(Math.max(E,Math.min(V,L)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(h){return this.x*h.x+this.y*h.y+this.z*h.z+this.w*h.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(n){return this.normalize().multiplyScalar(n)},lerp:function(r,Z){return this.x+=(r.x-this.x)*Z,this.y+=(r.y-this.y)*Z,this.z+=(r.z-this.z)*Z,this.w+=(r.w-this.w)*Z,this},lerpVectors:function(e,y,W){return this.subVectors(y,e).multiplyScalar(W).add(e)},equals:function(Z){return Z.x===this.x&&Z.y===this.y&&Z.z===this.z&&Z.w===this.w},fromArray:function(k,R){return R===d&&(R=0),this.x=k[R],this.y=k[R+1],this.z=k[R+2],this.w=k[R+3],this},toArray:function(G,m){return G===d&&(G=[]),m===d&&(m=0),G[m]=this.x,G[m+1]=this.y,G[m+2]=this.z,G[m+3]=this.w,G},fromBufferAttribute:function(C,B){return this.x=C.getX(B),this.y=C.getY(B),this.z=C.getZ(B),this.w=C.getW(B),this}});var wo=l.Math.Vector3=function(N,C,f){N===d?(this.x=0,this.y=0,this.z=0):"object"==typeof N?this.copy(N):this.set(N,C==d?N:C,f==d?N:f)};e.assign(wo.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(s,F,h){return this.x=s,this.y=F,this.z=h,this},equals:function(F){return F&&this.x===F.x&&this.y===F.y&&this.z===F.z},setScalar:function(q){return this.x=q,this.y=q,this.z=q,this},setX:function(l){return this.x=l,this},setY:function(s){return this.y=s,this},setZ:function(r){return this.z=r,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(x){return x.x===d?(this.x=x[0],this.y=x[1],this.z=x[2]):(this.x=x.x,this.y=x.y,this.z=x.z||0),this},add:function(K){return this.x+=K.x,this.y+=K.y,this.z+=K.z,this},addScalar:function(q){return this.x+=q,this.y+=q,this.z+=q,this},addVectors:function(L,W){return this.x=L.x+W.x,this.y=L.y+W.y,this.z=L.z+W.z,this},addScaledVector:function(W,E){return this.x+=W.x*E,this.y+=W.y*E,this.z+=W.z*E,this},sub:function(p){return this.x-=p.x,this.y-=p.y,this.z-=p.z,this},subScalar:function(Z){return this.x-=Z,this.y-=Z,this.z-=Z,this},subVectors:function(O,M){return this.x=O.x-M.x,this.y=O.y-M.y,this.z=O.z-M.z,this},divide:function(B){return this.x/=B.x,this.y/=B.y,this.z/=B.z,this},multiply:function(A){return this.x*=A.x,this.y*=A.y,this.z*=A.z,this},multiplyScalar:function(P){return this.x*=P,this.y*=P,this.z*=P,this},distanceTo:function(K){return Math.sqrt(this.distanceToSquared(K))},distanceToSquared:function(Q){var X=this.x-Q.x,y=this.y-Q.y,c=this.z-Q.z;return X*X+y*y+c*c},distanceToSquared2:function(q){var A=this.x-q[0],G=this.y-q[1],u=this.z-q[2];return A*A+G*G+u*u},divideVectors:function(J,p){return this.x=J.x/p.x,this.y=J.y/p.y,this.z=J.z/p.z,this},multiplyVectors:function(J,e){return this.x=J.x*e.x,this.y=J.y*e.y,this.z=J.z*e.z,this},transformDirection:function(t){var M=this.x,N=this.y,W=this.z,k=t.el;return this.x=k[0]*M+k[4]*N+k[8]*W,this.y=k[1]*M+k[5]*N+k[9]*W,this.z=k[2]*M+k[6]*N+k[10]*W,this.normalize()},applyAxisAngle:function(){var L=new tl;return function(e,s){return this.applyQuaternion(L.setFromAxisAngle(e,s))}}(),applyEuler:function(){var j=new tl;return function(U){return this.applyQuaternion(j.setFromEuler(U))}}(),applyQuaternion:function(w){var I=this.x,B=this.y,a=this.z,N=w._x,S=w._y,K=w._z,z=w._w,C=z*I+S*a-K*B,l=z*B+K*I-N*a,p=z*a+N*B-S*I,g=-N*I-S*B-K*a;return this.x=C*z+g*-N+l*-K-p*-S,this.y=l*z+g*-S+p*-N-C*-K,this.z=p*z+g*-K+C*-S-l*-N,this},applyMatrix4:function(X){var Z=this.x,b=this.y,Q=this.z,e=X.el,L=1/(e[3]*Z+e[7]*b+e[11]*Q+e[15]);return this.x=(e[0]*Z+e[4]*b+e[8]*Q+e[12])*L,this.y=(e[1]*Z+e[5]*b+e[9]*Q+e[13])*L,this.z=(e[2]*Z+e[6]*b+e[10]*Q+e[14])*L,this},applyMatrix3:function(P){var W=this.x,Z=this.y,R=this.z,I=P.el;return this.x=I[0]*W+I[3]*Z+I[6]*R,this.y=I[1]*W+I[4]*Z+I[7]*R,this.z=I[2]*W+I[5]*Z+I[8]*R,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var z=new wo;return function(t){return this.sub(z.copy(t).multiplyScalar(2*this.dot(t)))}}(),dot:function(O){return this.x*O.x+this.y*O.y+this.z*O.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var I=this.length();return I?this.multiplyScalar(1/I):this},setLength:function(b){return this.normalize().multiplyScalar(b)},fromArray:function(m,z){return z===d&&(z=0),this.x=m[z],this.y=m[z+1],this.z=m[z+2],this},toArray:function(P,f){return P===d&&(P=[0,0,0]),f===d&&(f=0),P[f]=this.x,P[f+1]=this.y,P[f+2]=this.z,P},cross:function(I){return this.crossVectors(this,I)
},angleTo:function(h){var u=this.dot(h)/Math.sqrt(this.lengthSq()*h.lengthSq());return u>1||-1>u?0:Math.acos(u)},lerp:function(q,R){return this.x+=(q.x-this.x)*R,this.y+=(q.y-this.y)*R,this.z+=(q.z-this.z)*R,this},lerpVectors:function(a,j,B){return this.subVectors(j,a).multiplyScalar(B).add(a)},crossVectors:function(f,P){var G=f.x,F=f.y,e=f.z,l=P.x,o=P.y,B=P.z;return this.x=F*B-e*o,this.y=e*l-G*B,this.z=G*o-F*l,this},min:function(O){return this.x=Math.min(this.x,O.x),this.y=Math.min(this.y,O.y),this.z=Math.min(this.z,O.z),this},max:function(m){return this.x=Math.max(this.x,m.x),this.y=Math.max(this.y,m.y),this.z=Math.max(this.z,m.z),this},setFromMatrixPosition:function(b){return this.setFromMatrixColumn(b,3)},setFromMatrixScale:function(f){var q=this.setFromMatrixColumn(f,0).length(),T=this.setFromMatrixColumn(f,1).length(),s=this.setFromMatrixColumn(f,2).length();return this.x=q,this.y=T,this.z=s,this},setFromMatrixColumn:function(m,e){return this.fromArray(m.el,4*e)}});var Kk=l.Math.Vector2=function(R,L,x){"object"==typeof R&&(R.x!=d?(L=R.y,R=R.x,x=R.e):(x=R[2],L=R[1],R=R[0])),this.set(R||0,L||0,x)};Kk.prototype={},Kk.prototype.constructor=Kk,e.defineProperties(Kk.prototype,{width:{get:function(){return this.x},set:function(v){this.x=v}},height:{get:function(){return this.y},set:function(b){this.y=b}}}),Kk.prototype.clone=function(){return new Kk(this.x,this.y,this.e)},Kk.prototype.copy=function(F){return this.set(F.x,F.y,F.e),this},Kk.prototype.equals=function(C){return C.x===this.x&&C.y===this.y},Kk.prototype.set=function(v,R,Z){return this.x=v||0,this.y=R||(0!==R?this.x:0),Z!=d&&(this.e=Z),this},Kk.prototype.setScalar=function(M){return this.x=M,this.y=M,this},Kk.prototype.setX=function(K){return this.x=K||0,this},Kk.prototype.setY=function(c){return this.y=c||0,this},Kk.prototype.add=function(o){return this.x+=o.x,this.y+=o.y,this},Kk.prototype.addVectors=function(m,e){return this.x=m.x+e.x,this.y=m.y+e.y,this},Kk.prototype.addScalar=function(I){return this.x+=I,this.y+=I,this},Kk.prototype.addScaledVector=function(L,i){return this.x+=L.x*i,this.y+=L.y*i,this},Kk.prototype.sub=function(K){return this.x-=K.x,this.y-=K.y,this},Kk.prototype.subScalar=function(F){return this.x-=F,this.y-=F,this},Kk.prototype.subVectors=function(C,P){return this.x=C.x-P.x,this.y=C.y-P.y,this},Kk.prototype.multiply=function(K){return this.x*=K.x,this.y*=K.y,this},Kk.prototype.multiplyScalar=function(Y){return this.x*=Y,this.y*=Y,this},Kk.prototype.divide=function(U){return this.x/=U.x,this.y/=U.y,this},Kk.prototype.divideScalar=function(o){return this.multiplyScalar(1/o)},Kk.prototype.min=function(g){return this.x=Math.min(this.x,g.x),this.y=Math.min(this.y,g.y),this},Kk.prototype.max=function(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this},Kk.prototype.fromArray=function(R,$){return $===d&&($=0),this.x=R[$],this.y=R[$+1],this},Kk.prototype.clamp=function(E,F){return this.x=Math.max(E.x,Math.min(F.x,this.x)),this.y=Math.max(E.y,Math.min(F.y,this.y)),this},Kk.prototype.clampScalar=function(){var e,M;return function(w,q){return e===d&&(e=new Kk,M=new Kk),e.set(w,w),M.set(q,q),this.clamp(e,M)}}(),Kk.prototype.clampLength=function(w,M){var H=this.length();return this.multiplyScalar(Math.max(w,Math.min(M,H))/H)},Kk.prototype.dot=function(y){return this.x*y.x+this.y*y.y},Kk.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Kk.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Kk.prototype.normalize=function(){return this.divideScalar(this.length())},Kk.prototype.angle=function(){var z=Math.atan2(this.y,this.x);return 0>z&&(z+=2*Math.PI),z},Kk.prototype.distanceTo=function(o){return Math.sqrt(this.distanceToSquared(o))},Kk.prototype.distanceToSquared=function(R){var P=this.x-R.x,x=this.y-R.y;return P*P+x*x},Kk.prototype.isNearEnough=function(L){return this.distanceToSquared(L)<1e-8},Kk.prototype.setLength=function(M){var v=this.length();return v?this.multiplyScalar(M/v):this},Kk.prototype.lerp=function(Y,$){return this.x+=(Y.x-this.x)*$,this.y+=(Y.y-this.y)*$,this},Kk.prototype.lerpVectors=function(G,p,v){return this.subVectors(p,G).multiplyScalar(v).add(G)},Kk.prototype.rotateAround=function($,o){var f=$?$.x:0,G=$?$.y:0,E=Math.cos(o),m=Math.sin(o),i=this.x-f,R=this.y-G;return this.x=i*E-R*m+f,this.y=i*m+R*E+G,this},e.assign(z.prototype,{isMatrix3:!0,set:function(g,i,l,e,X,k,d,P,s){var y=this.el;return y[0]=g,y[1]=e,y[2]=d,y[3]=i,y[4]=X,y[5]=P,y[6]=l,y[7]=k,y[8]=s,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(m){var W=this.el,M=m.el;return W[0]=M[0],W[1]=M[1],W[2]=M[2],W[3]=M[3],W[4]=M[4],W[5]=M[5],W[6]=M[6],W[7]=M[7],W[8]=M[8],this},setFromMatrix4:function(a){var t=a.el;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var l=new wo;return function(P){for(var $=0,q=P.count;q>$;$++)l.x=P.getX($),l.y=P.getY($),l.z=P.getZ($),l.applyMatrix3(this),P.setXYZ($,l.x,l.y,l.z);return P}}(),multiply:function(m){return this.multiplyMatrices(this,m)},premultiply:function(f){return this.multiplyMatrices(f,this)},multiplyMatrices:function(N,b){var r=N.el,J=b.el,$=this.el,Z=r[0],u=r[3],v=r[6],n=r[1],S=r[4],k=r[7],g=r[2],c=r[5],F=r[8],L=J[0],y=J[3],e=J[6],m=J[1],U=J[4],K=J[7],z=J[2],E=J[5],s=J[8];return $[0]=Z*L+u*m+v*z,$[3]=Z*y+u*U+v*E,$[6]=Z*e+u*K+v*s,$[1]=n*L+S*m+k*z,$[4]=n*y+S*U+k*E,$[7]=n*e+S*K+k*s,$[2]=g*L+c*m+F*z,$[5]=g*y+c*U+F*E,$[8]=g*e+c*K+F*s,this},multiplyScalar:function(X){var A=this.el;return A[0]*=X,A[3]*=X,A[6]*=X,A[1]*=X,A[4]*=X,A[7]*=X,A[2]*=X,A[5]*=X,A[8]*=X,this},determinant:function(){var c=this.el,F=c[0],G=c[1],D=c[2],q=c[3],k=c[4],u=c[5],z=c[6],X=c[7],_=c[8];return F*k*_-F*u*X-G*q*_+G*u*z+D*q*X-D*k*z},getInverse:function(h){var k=h.el,Q=this.el,D=k[0],y=k[1],Z=k[2],i=k[3],H=k[4],d=k[5],G=k[6],P=k[7],I=k[8],a=I*H-d*P,R=d*G-I*i,p=P*i-H*G,W=D*a+y*R+Z*p;if(0===W)return this.identity();var o=1/W;return Q[0]=a*o,Q[1]=(Z*P-I*y)*o,Q[2]=(d*y-Z*H)*o,Q[3]=R*o,Q[4]=(I*D-Z*G)*o,Q[5]=(Z*i-d*D)*o,Q[6]=p*o,Q[7]=(y*G-P*D)*o,Q[8]=(H*D-y*i)*o,this},transpose:function(){var k,H=this.el;return k=H[1],H[1]=H[3],H[3]=k,k=H[2],H[2]=H[6],H[6]=k,k=H[5],H[5]=H[7],H[7]=k,this},getNormalMatrix:function(q){return this.setFromMatrix4(q).getInverse(this).transpose()},transposeIntoArray:function(Y){var A=this.el;return Y[0]=A[0],Y[1]=A[3],Y[2]=A[6],Y[3]=A[1],Y[4]=A[4],Y[5]=A[7],Y[6]=A[2],Y[7]=A[5],Y[8]=A[8],this},setUvTransform:function(d,J,S,o,a,D,r){var X=Math.cos(a),x=Math.sin(a);this.set(S*X,S*x,-S*(X*D+x*r)+D+d,-o*x,o*X,-o*(-x*D+X*r)+r+J,0,0,1)},scale:function(c,r){var K=this.el;return K[0]*=c,K[3]*=c,K[6]*=c,K[1]*=r,K[4]*=r,K[7]*=r,this},rotate:function(I){var E=Math.cos(I),$=Math.sin(I),r=this.el,v=r[0],L=r[3],l=r[6],g=r[1],e=r[4],Q=r[7];return r[0]=E*v+$*g,r[3]=E*L+$*e,r[6]=E*l+$*Q,r[1]=-$*v+E*g,r[4]=-$*L+E*e,r[7]=-$*l+E*Q,this},translate:function(f,D){var B=this.el;return B[0]+=f*B[2],B[3]+=f*B[5],B[6]+=f*B[8],B[1]+=D*B[2],B[4]+=D*B[5],B[7]+=D*B[8],this},equals:function(s){for(var y=this.el,H=s.el,u=0;9>u;u++)if(y[u]!==H[u])return!1;return!0},fromArray:function(Q,n){n===d&&(n=0);for(var x=0;9>x;x++)this.el[x]=Q[x+n];return this},toArray:function(J,N){J===d&&(J=[]),N===d&&(N=0);var R=this.el;return J[N]=R[0],J[N+1]=R[1],J[N+2]=R[2],J[N+3]=R[3],J[N+4]=R[4],J[N+5]=R[5],J[N+6]=R[6],J[N+7]=R[7],J[N+8]=R[8],J}});var ob=l.Math.Plane=function(V,_){this.normal=V!==d?V:new wo(1,0,0),this.constant=_!==d?_:0};e.assign(ob.prototype,{set:function(m,s){return this.normal.copy(m),this.constant=s,this},setComponents:function(V,e,U,v){return this.normal.set(V,e,U),this.constant=v,this},setFromNormalAndCoplanarPoint:function(b,z){return this.normal.copy(b),this.constant=-z.dot(this.normal),this},setFromCoplanarPoints:function(){var A=new wo,N=new wo;return function(C,q,k){var u=A.subVectors(k,q).cross(N.subVectors(C,q)).normalize();return this.setFromNormalAndCoplanarPoint(u,C),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(r){return this.normal.copy(r.normal),this.constant=r.constant,this},normalize:function(){var h=1/this.normal.length();return this.normal.multiplyScalar(h),this.constant*=h,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(g){return this.normal.dot(g)+this.constant},distanceToSphere:function(z){return this.distanceToPoint(z.center)-z.radius},projectPoint:function(V,Q){return Q===d&&(Q=new wo),Q.copy(this.normal).multiplyScalar(-this.distanceToPoint(V)).add(V)},intersectLine:function(){var L=new wo;return function(A,x){x===d&&(x=new wo);var K=A.delta(L),z=this.normal.dot(K);if(0===z)return 0===this.distanceToPoint(A.start)?x.copy(A.start):d;var W=-(A.start.dot(this.normal)+this.constant)/z;return 0>W||W>1?d:x.copy(K).multiplyScalar(W).add(A.start)}}(),intersectsLine:function(A){var u=this.distanceToPoint(A.start),W=this.distanceToPoint(A.end);return 0>u&&W>0||0>W&&u>0},intersectsBox:function(A){return A.intersectsPlane(this)},intersectsSphere:function(o){return o.intersectsPlane(this)},coplanarPoint:function(K){return K===d&&(K=new wo),K.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var g=new wo,R=new z;return function($,T){var O=T||R.getNormalMatrix($),c=this.coplanarPoint(g).applyMatrix4($),V=this.normal.applyMatrix3(O).normalize();return this.constant=-c.dot(V),this}}(),translate:function(c){return this.constant-=c.dot(this.normal),this},equals:function(T){return T.normal.equals(this.normal)&&T.constant===this.constant}});var Sp=l.Math.Ray=function(V,s){this.origin=V!==d?V.clone():new wo,this.direction=s!==d?s.clone():new wo};e.assign(Sp.prototype,{set:function(E,T){return this.origin.copy(E),this.direction.copy(T),this},clone:function(){return(new this.constructor).copy(this)},copy:function(L){return this.origin.copy(L.origin),this.direction.copy(L.direction),this.maxHitLen=L.maxHitLen,this},at:function(h,U){var H=U||new wo;return H.copy(this.direction).multiplyScalar(h).add(this.origin)},setMaxHitLength:function(_){this.maxHitLen=_},lookAt:function(w){return this.direction.copy(w).sub(this.origin).normalize(),this},applyMatrix4:function(A){var y=this.maxHitLen;if(y){var I=this.direction.clone().multiplyScalar(y).add(this.origin);I.applyMatrix4(A)}return this.origin.applyMatrix4(A),this.direction.transformDirection(A),y&&(this.maxHitLen=this.origin.distanceTo(I)),this},intersectSphere:function(){var G=new wo;return function(N,Q){G.subVectors(N.center,this.origin);var L=G.dot(this.direction),_=G.dot(G)-L*L,w=N.radius*N.radius;if(_>w)return null;var o=Math.sqrt(w-_),R=L-o,K=L+o;return 0>R&&0>K?null:0>R?this.at(K,Q):this.at(R,Q)}}(),intersectEllipsoid:function(){var d=new wo,H=new wo;return function(X,h){d.subVectors(X.center,this.origin),d.divide(X.radius),H.divideVectors(this.direction,X.radius);var n=H.lengthSq(),E=d.dot(H),s=d.dot(d)*n-E*E;if(s>n)return null;var S=Math.sqrt(n-s),m=(E-S)/n,U=(E+S)/n;return 0>m&&0>U?null:0>m?this.at(U,h):this.at(m,h)}}(),intersectBox:function(d,A){var M,N,S,J,F,O,P=1/this.direction.x,j=1/this.direction.y,C=1/this.direction.z,W=this.origin;if(P>=0?(M=(d.min.x-W.x)*P,N=(d.max.x-W.x)*P):(M=(d.max.x-W.x)*P,N=(d.min.x-W.x)*P),j>=0?(S=(d.min.y-W.y)*j,J=(d.max.y-W.y)*j):(S=(d.max.y-W.y)*j,J=(d.min.y-W.y)*j),M>J||S>N)return null;if((S>M||M!==M)&&(M=S),(N>J||N!==N)&&(N=J),C>=0?(F=(d.min.z-W.z)*C,O=(d.max.z-W.z)*C):(F=(d.max.z-W.z)*C,O=(d.min.z-W.z)*C),M>O||F>N)return null;if((F>M||M!==M)&&(M=F),(N>O||N!==N)&&(N=O),0>N)return null;var g=M>=0?M:N,m=this.maxHitLen;return m&&g>m?null:this.at(g,A)},intersectTriangle:function(){var Y=new wo,Z=new wo,A=new wo,k=new wo;return function(X,G,L,m,h){Z.subVectors(G,X),A.subVectors(L,X),k.crossVectors(Z,A);var J,o=this.direction.dot(k);if(o>0){if(m)return null;J=1}else{if(!(0>o))return null;J=-1,o=-o}Y.subVectors(this.origin,X);var W=J*this.direction.dot(A.crossVectors(Y,A));if(0>W)return null;var P=J*this.direction.dot(Z.cross(Y));if(0>P||W+P>o)return null;var C=-J*Y.dot(k);if(0>C)return null;var j=C/o,s=this.maxHitLen;return s&&j>s?null:this.at(j,h)}}()});var Zo=l.Math.Box3=function(U,P){this.min=U!==d?U:new wo(1/0,1/0,1/0),this.max=P!==d?P:new wo(-1/0,-1/0,-1/0)};e.assign(Zo.prototype,{set:function(N,r){return this.min.copy(N),this.max.copy(r),this},setFromArray:function(c){for(var H=1/0,v=1/0,m=1/0,P=-1/0,p=-1/0,B=-1/0,l=0,X=c.length;X>l;l+=3){var o=c[l],S=c[l+1],j=c[l+2];H>o&&(H=o),v>S&&(v=S),m>j&&(m=j),o>P&&(P=o),S>p&&(p=S),j>B&&(B=j)}return this.min.set(H,v,m),this.max.set(P,p,B),this},setFromPoints:function(w){this.makeEmpty();for(var I=0,b=w.length;b>I;I++)this.expandByPoint(w[I]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(C){return C.max.x<this.min.x||C.min.x>this.max.x||C.max.y<this.min.y||C.min.y>this.max.y||C.max.z<this.min.z||C.min.z>this.max.z?!1:!0},copy:function(P){return this.min.copy(P.min),this.max.copy(P.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(A){return this.min.min(A),this.max.max(A),this},expandByBox:function(y){return this.min.min(y.min),this.max.max(y.max),this},applyMatrix4:function(){var p=[new wo,new wo,new wo,new wo,new wo,new wo,new wo,new wo];return function(d){return this.isEmpty()?this:(p[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(d),p[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(d),p[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(d),p[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(d),p[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(d),p[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(d),p[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(d),p[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(d),this.setFromPoints(p),this)}}()});var xj=l.Math.Sphere=function(w,k){this.center=w!==d?w:new wo,this.radius=k!==d?k:0};e.assign(xj.prototype,{set:function(U,Z){return this.center.copy(U),this.radius=Z,this},setFromPoints:function(){var W=new Zo;return function(k,v){var p=this.center;v!==d?p.copy(v):W.setFromPoints(k).getCenter(p);for(var Z=0,m=0,V=k.length;V>m;m++)Z=Math.max(Z,p.distanceToSquared(k[m]));return this.radius=Math.sqrt(Z),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(h){return this.center.copy(h.center),this.radius=h.radius,this},empty:function(){return this.radius<=0},containsPoint:function(X){return X.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(w){return w.distanceTo(this.center)-this.radius},intersectsSphere:function(c){var F=this.radius+c.radius;return c.center.distanceToSquared(this.center)<=F*F},intersectsBox:function(I){return I.intersectsSphere(this)},intersectsPlane:function(C){return Math.abs(C.distanceToPoint(this.center))<=this.radius},clampPoint:function(O,S){var r=this.center.distanceToSquared(O);return S===d&&(S=new wo),S.copy(O),r>this.radius*this.radius&&(S.sub(this.center).normalize(),S.multiplyScalar(this.radius).add(this.center)),S},getBoundingBox:function(q){return q===d&&(q=new Zo),q.set(this.center,this.center),q.expandByScalar(this.radius),q},applyMatrix4:function(T){return this.center.applyMatrix4(T),this.radius=this.radius*T.getMaxScaleOnAxis(),this},translate:function(g){return this.center.add(g),this},equals:function(U){return U.center.equals(this.center)&&U.radius===this.radius}});var ep=l.Math.Frustum=function(E,v,G,z,U,C){this.planes=[E!==d?E:new ob,v!==d?v:new ob,G!==d?G:new ob,z!==d?z:new ob,U!==d?U:new ob,C!==d?C:new ob]};e.assign(ep.prototype,{set:function(l,G,m,Y,i,T){var A=this.planes;return A[0].copy(l),A[1].copy(G),A[2].copy(m),A[3].copy(Y),A[4].copy(i),A[5].copy(T),this},clone:function(){return(new this.constructor).copy(this)},copy:function($){for(var _=this.planes,H=0;6>H;H++)_[H].copy($.planes[H]);return this},setFromMatrix:function($){var L=this.planes,a=$.el,W=a[0],D=a[1],K=a[2],F=a[3],q=a[4],X=a[5],d=a[6],w=a[7],I=a[8],M=a[9],t=a[10],z=a[11],y=a[12],J=a[13],N=a[14],U=a[15];return L[0].setComponents(F-W,w-q,z-I,U-y).normalize(),L[1].setComponents(F+W,w+q,z+I,U+y).normalize(),L[2].setComponents(F+D,w+X,z+M,U+J).normalize(),L[3].setComponents(F-D,w-X,z-M,U-J).normalize(),L[4].setComponents(F-K,w-d,z-t,U-N).normalize(),L[5].setComponents(F+K,w+d,z+t,U+N).normalize(),this},intersectsObject:function(){var Z=new xj;return function(I){var Y=I.geometry;return null===Y.boundingSphere&&Y.computeBoundingSphere(),Z.copy(Y.boundingSphere).applyMatrix4(I.matrixWorld),this.intersectsSphere(Z)}}(),intersectsSprite:function(){var v=new xj;return function(y){return v.center.set(0,0,0),v.radius=.7071067811865476,v.applyMatrix4(y.matrixWorld),this.intersectsSphere(v)}}(),intersectsSphere:function(h){for(var J=this.planes,Z=h.center,o=-h.radius,a=0;6>a;a++){var R=J[a].distanceToPoint(Z);if(o>R)return!1}return!0},intersectsBox:function(){var X=new wo;return function(i){for(var z=this.planes,S=0;6>S;S++){var Q=z[S];if(X.x=Q.normal.x>0?i.max.x:i.min.x,X.y=Q.normal.y>0?i.max.y:i.min.y,X.z=Q.normal.z>0?i.max.z:i.min.z,Q.distanceToPoint(X)<0)return!1}return!0}}(),containsPoint:function(v){for(var e=this.planes,r=0;6>r;r++)if(e[r].distanceToPoint(v)<0)return!1;return!0}});var pl=l.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};e.assign(pl.prototype,{set:function(h,v,r,V,d,U,k,I,H,y,Z,w,l,t,j,S){var M=this.el;return M[0]=h,M[4]=v,M[8]=r,M[12]=V,M[1]=d,M[5]=U,M[9]=k,M[13]=I,M[2]=H,M[6]=y,M[10]=Z,M[14]=w,M[3]=l,M[7]=t,M[11]=j,M[15]=S,this},clone:function(){return(new pl).fromArray(this.el)},fromArray:function(u,r){r===d&&(r=0);for(var L=this.el,l=0;16>l;l++)L[l]=u[l+r];return this},scale:function(Q){var Y=this.el,v=Q.x,S=Q.y,c=Q.z;return Y[0]*=v,Y[4]*=S,Y[8]*=c,Y[1]*=v,Y[5]*=S,Y[9]*=c,Y[2]*=v,Y[6]*=S,Y[10]*=c,Y[3]*=v,Y[7]*=S,Y[11]*=c,this},makeRotationFromEuler:function(U){var E=this.el,P=U._x,q=U._y,T=U._z,v=U._order,f=Math.cos(P),H=Math.sin(P),L=Math.cos(q),V=Math.sin(q),d=Math.cos(T),c=Math.sin(T);if("XYZ"===v){var N=f*d,F=f*c,g=H*d,W=H*c;E[0]=L*d,E[4]=-L*c,E[8]=V,E[1]=F+g*V,E[5]=N-W*V,E[9]=-H*L,E[2]=W-N*V,E[6]=g+F*V,E[10]=f*L}else if("YXZ"===v){var A=L*d,b=L*c,o=V*d,u=V*c;E[0]=A+u*H,E[4]=o*H-b,E[8]=f*V,E[1]=f*c,E[5]=f*d,E[9]=-H,E[2]=b*H-o,E[6]=u+A*H,E[10]=f*L}else if("ZXY"===v){var A=L*d,b=L*c,o=V*d,u=V*c;E[0]=A-u*H,E[4]=-f*c,E[8]=o+b*H,E[1]=b+o*H,E[5]=f*d,E[9]=u-A*H,E[2]=-f*V,E[6]=H,E[10]=f*L}else if("ZYX"===v){var N=f*d,F=f*c,g=H*d,W=H*c;E[0]=L*d,E[4]=g*V-F,E[8]=N*V+W,E[1]=L*c,E[5]=W*V+N,E[9]=F*V-g,E[2]=-V,E[6]=H*L,E[10]=f*L}else if("YZX"===v){var x=f*L,w=f*V,I=H*L,j=H*V;E[0]=L*d,E[4]=j-x*c,E[8]=I*c+w,E[1]=c,E[5]=f*d,E[9]=-H*d,E[2]=-V*d,E[6]=w*c+I,E[10]=x-j*c}else if("XZY"===v){var x=f*L,w=f*V,I=H*L,j=H*V;E[0]=L*d,E[4]=-c,E[8]=V*d,E[1]=x*c+j,E[5]=f*d,E[9]=w*c-I,E[2]=I*c-w,E[6]=H*d,E[10]=j*c+x}return E[3]=0,E[7]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,this},makeRotationFromQuaternion:function(n){var D=this.el,s=n._x,j=n._y,V=n._z,g=n._w,e=s+s,J=j+j,v=V+V,X=s*e,t=s*J,q=s*v,Q=j*J,P=j*v,T=V*v,Y=g*e,O=g*J,y=g*v;return D[0]=1-(Q+T),D[4]=t-y,D[8]=q+O,D[1]=t+y,D[5]=1-(X+T),D[9]=P-Y,D[2]=q-O,D[6]=P+Y,D[10]=1-(X+Q),D[3]=0,D[7]=0,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(M){var x=this.el,h=M.el,O=h[0],c=h[1],i=h[2],K=h[3],z=h[4],Z=h[5],C=h[6],f=h[7],v=h[8],$=h[9],r=h[10],q=h[11],S=h[12],g=h[13],s=h[14],X=h[15],o=$*s*f-g*r*f+g*C*q-Z*s*q-$*C*X+Z*r*X,F=S*r*f-v*s*f-S*C*q+z*s*q+v*C*X-z*r*X,b=v*g*f-S*$*f+S*Z*q-z*g*q-v*Z*X+z*$*X,W=S*$*C-v*g*C-S*Z*r+z*g*r+v*Z*s-z*$*s,T=O*o+c*F+i*b+K*W;if(0===T)return this.identity();var l=1/T;return x[0]=o*l,x[1]=(g*r*K-$*s*K-g*i*q+c*s*q+$*i*X-c*r*X)*l,x[2]=(Z*s*K-g*C*K+g*i*f-c*s*f-Z*i*X+c*C*X)*l,x[3]=($*C*K-Z*r*K-$*i*f+c*r*f+Z*i*q-c*C*q)*l,x[4]=F*l,x[5]=(v*s*K-S*r*K+S*i*q-O*s*q-v*i*X+O*r*X)*l,x[6]=(S*C*K-z*s*K-S*i*f+O*s*f+z*i*X-O*C*X)*l,x[7]=(z*r*K-v*C*K+v*i*f-O*r*f-z*i*q+O*C*q)*l,x[8]=b*l,x[9]=(S*$*K-v*g*K-S*c*q+O*g*q+v*c*X-O*$*X)*l,x[10]=(z*g*K-S*Z*K+S*c*f-O*g*f-z*c*X+O*Z*X)*l,x[11]=(v*Z*K-z*$*K-v*c*f+O*$*f+z*c*q-O*Z*q)*l,x[12]=W*l,x[13]=(v*g*i-S*$*i+S*c*r-O*g*r-v*c*s+O*$*s)*l,x[14]=(S*Z*i-z*g*i-S*c*C+O*g*C+z*c*s-O*Z*s)*l,x[15]=(z*$*i-v*Z*i+v*c*C-O*$*C-z*c*r+O*Z*r)*l,this},makeRotationAxis:function(S,A){var K=Math.cos(A),M=Math.sin(A),e=1-K,W=S.x,y=S.y,Q=S.z,T=e*W,D=e*y;return this.set(T*W+K,T*y-M*Q,T*Q+M*y,0,T*y+M*Q,D*y+K,D*Q-M*W,0,T*Q-M*y,D*Q+M*W,e*Q*Q+K,0,0,0,0,1),this},multiply:function(o){return this.multiplyMatrices(this,o)},premultiply:function(W){return this.multiplyMatrices(W,this)},multiplyMatrices:function(w,o){var g=w.el,u=o.el,v=this.el,Y=g[0],x=g[4],f=g[8],E=g[12],O=g[1],Q=g[5],n=g[9],_=g[13],L=g[2],p=g[6],R=g[10],U=g[14],P=g[3],X=g[7],h=g[11],b=g[15],I=u[0],C=u[4],j=u[8],D=u[12],z=u[1],H=u[5],c=u[9],Z=u[13],r=u[2],F=u[6],q=u[10],t=u[14],k=u[3],V=u[7],B=u[11],A=u[15];return v[0]=Y*I+x*z+f*r+E*k,v[4]=Y*C+x*H+f*F+E*V,v[8]=Y*j+x*c+f*q+E*B,v[12]=Y*D+x*Z+f*t+E*A,v[1]=O*I+Q*z+n*r+_*k,v[5]=O*C+Q*H+n*F+_*V,v[9]=O*j+Q*c+n*q+_*B,v[13]=O*D+Q*Z+n*t+_*A,v[2]=L*I+p*z+R*r+U*k,v[6]=L*C+p*H+R*F+U*V,v[10]=L*j+p*c+R*q+U*B,v[14]=L*D+p*Z+R*t+U*A,v[3]=P*I+X*z+h*r+b*k,v[7]=P*C+X*H+h*F+b*V,v[11]=P*j+X*c+h*q+b*B,v[15]=P*D+X*Z+h*t+b*A,this},lookAt:function(){var V=new wo,w=new wo,y=new wo;return function(T,x,G){var X=this.el;return y.subVectors(T,x),0===y.lengthSq()&&(y.z=1),y.normalize(),V.crossVectors(G,y),0===V.lengthSq()&&(1===Math.abs(G.z)?y.x+=1e-4:y.z+=1e-4,y.normalize(),V.crossVectors(G,y)),V.normalize(),w.crossVectors(y,V),X[0]=V.x,X[4]=w.x,X[8]=y.x,X[1]=V.y,X[5]=w.y,X[9]=y.y,X[2]=V.z,X[6]=w.z,X[10]=y.z,this}}(),extractScale:function(){var b;return function(c){b===d&&(b=new wo),c===d&&(c=new wo);var R=b.setFromMatrixColumn(this,0).length(),M=b.setFromMatrixColumn(this,1).length(),o=b.setFromMatrixColumn(this,2).length();return c.set(R,M,o),c}}(),extractRotation:function(){var Y;return function(s){Y===d&&(Y=new wo),s===d&&(s=new pl);var f=this.el,E=s.el,X=1/Y.setFromMatrixColumn(s,0).length(),a=1/Y.setFromMatrixColumn(s,1).length(),F=1/Y.setFromMatrixColumn(s,2).length();return f[0]=E[0]*X,f[1]=E[1]*X,f[2]=E[2]*X,f[4]=E[4]*a,f[5]=E[5]*a,f[6]=E[6]*a,f[8]=E[8]*F,f[9]=E[9]*F,f[10]=E[10]*F,this}}(),multiplyScalar:function(U){var i=this.el;return i[0]*=U,i[4]*=U,i[8]*=U,i[12]*=U,i[1]*=U,i[5]*=U,i[9]*=U,i[13]*=U,i[2]*=U,i[6]*=U,i[10]*=U,i[14]*=U,i[3]*=U,i[7]*=U,i[11]*=U,i[15]*=U,this},getPosition:function(S){return S===d&&(S=new wo),S.setFromMatrixColumn(this,3)},setPosition:function(u){var V=this.el;return V[12]=u.x,V[13]=u.y,V[14]=u.z,this},toArray:function(C,g){C===d&&(C=[]),g===d&&(g=0);var W=this.el;return C[g]=W[0],C[g+1]=W[1],C[g+2]=W[2],C[g+3]=W[3],C[g+4]=W[4],C[g+5]=W[5],C[g+6]=W[6],C[g+7]=W[7],C[g+8]=W[8],C[g+9]=W[9],C[g+10]=W[10],C[g+11]=W[11],C[g+12]=W[12],C[g+13]=W[13],C[g+14]=W[14],C[g+15]=W[15],C},determinant:function(){var W=this.el,U=W[0],P=W[4],q=W[8],T=W[12],Q=W[1],l=W[5],E=W[9],I=W[13],a=W[2],X=W[6],w=W[10],c=W[14],F=W[3],N=W[7],e=W[11],S=W[15];return F*(+T*E*X-q*I*X-T*l*w+P*I*w+q*l*c-P*E*c)+N*(+U*E*c-U*I*w+T*Q*w-q*Q*c+q*I*a-T*E*a)+e*(+U*I*X-U*l*c-T*Q*X+P*Q*c+T*l*a-P*I*a)+S*(-q*l*a-U*E*X+U*l*w+q*Q*X-P*Q*w+P*E*a)},copy:function(w){var h=this.el,$=w.el;return h[0]=$[0],h[1]=$[1],h[2]=$[2],h[3]=$[3],h[4]=$[4],h[5]=$[5],h[6]=$[6],h[7]=$[7],h[8]=$[8],h[9]=$[9],h[10]=$[10],h[11]=$[11],h[12]=$[12],h[13]=$[13],h[14]=$[14],h[15]=$[15],this},compose:function(J,z,C){var N=this.el,h=z._x,F=z._y,p=z._z,O=z._w,s=h+h,c=F+F,j=p+p,A=h*s,W=h*c,m=h*j,H=F*c,K=F*j,$=p*j,M=O*s,g=O*c,l=O*j,k=C.x,Y=C.y,E=C.z;return N[0]=(1-(H+$))*k,N[1]=(W+l)*k,N[2]=(m-g)*k,N[3]=0,N[4]=(W-l)*Y,N[5]=(1-(A+$))*Y,N[6]=(K+M)*Y,N[7]=0,N[8]=(m+g)*E,N[9]=(K-M)*E,N[10]=(1-(A+H))*E,N[11]=0,N[12]=J.x,N[13]=J.y,N[14]=J.z,N[15]=1,this},decompose:function(){var P=new wo,t=new pl;return function(Q,d,W){var g=this.el,I=P.set(g[0],g[1],g[2]).length(),C=P.set(g[4],g[5],g[6]).length(),V=P.set(g[8],g[9],g[10]).length(),B=this.determinant();0>B&&(I=-I),Q.x=g[12],Q.y=g[13],Q.z=g[14],t.copy(this);var m=1/I,O=1/C,N=1/V;return t.el[0]*=m,t.el[1]*=m,t.el[2]*=m,t.el[4]*=O,t.el[5]*=O,t.el[6]*=O,t.el[8]*=N,t.el[9]*=N,t.el[10]*=N,d.setFromRotationMatrix(t),W.x=I,W.y=C,W.z=V,this}}()});var Vi=l.Math.Triangle=function(Q,v,x){this.a=Q!==d?Q:new wo,this.b=v!==d?v:new wo,this.c=x!==d?x:new wo};e.assign(Vi,{barycoordFromPoint:function(){var n=new wo,u=new wo,d=new wo;return function(v,T,q,g,C){n.subVectors(g,T),u.subVectors(q,T),d.subVectors(v,T);var l=n.dot(n),h=n.dot(u),s=n.dot(d),Q=u.dot(u),P=u.dot(d),$=l*Q-h*h,e=C||new wo;if(0===$)return e.set(-2,-1,-1);var V=1/$,z=(Q*s-h*P)*V,I=(l*P-h*s)*V;return e.set(1-z-I,I,z)}}()});var sr=l.Math.Euler=function($,V,E,p,e){this.set($,V,E,p,e)};sr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],sr.DefaultOrder="XYZ",sr.ReverseOrder=function(S){return S=S[2]+S[1]+S[0],S.toUpperCase()},e.defineProperties(sr.prototype,{x:{get:function(){return this._x},set:function(S){this._x=S,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(m){this._y=m,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(y){this._z=y,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(u){this._order=u,this.onChangeCallback()}}}),e.assign(sr.prototype,{set:function(I,T,y,Q,u){return Cq(I)&&(u=y,Q=T,y=I[2],T=I[1],I=I[0]),Q?u&&(Q=sr.ReverseOrder(Q)):Q="ZYX",this._x=I||0,this._y=T||0,this._z=y||0,this._order=Q||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(l){return this._x=l._x,this._y=l._y,this._z=l._z,this._order=l._order,this.onChangeCallback(),this},setFromRotationMatrix:function(o,X,t){var I=l.Math.clamp,F=o.el||o,B=F[0],V=F[4],O=F[8],n=F[1],b=F[5],Y=F[9],e=F[2],p=F[6],N=F[10];return X=X||this._order,"XYZ"===X?(this._y=Math.asin(I(O,-1,1)),Math.abs(O)<.99999?(this._x=Math.atan2(-Y,N),this._z=Math.atan2(-V,B)):(this._x=Math.atan2(p,b),this._z=0)):"YXZ"===X?(this._x=Math.asin(-I(Y,-1,1)),Math.abs(Y)<.99999?(this._y=Math.atan2(O,N),this._z=Math.atan2(n,b)):(this._y=Math.atan2(-e,B),this._z=0)):"ZXY"===X?(this._x=Math.asin(I(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-e,N),this._z=Math.atan2(-V,b)):(this._y=0,this._z=Math.atan2(n,B))):"ZYX"===X?(this._y=Math.asin(-I(e,-1,1)),Math.abs(e)<.99999?(this._x=Math.atan2(p,N),this._z=Math.atan2(n,B)):(this._x=0,this._z=Math.atan2(-V,b))):"YZX"===X?(this._z=Math.asin(I(n,-1,1)),Math.abs(n)<.99999?(this._x=Math.atan2(-Y,b),this._y=Math.atan2(-e,B)):(this._x=0,this._y=Math.atan2(O,N))):"XZY"===X?(this._z=Math.asin(-I(V,-1,1)),Math.abs(V)<.99999?(this._x=Math.atan2(p,b),this._y=Math.atan2(O,B)):(this._x=Math.atan2(-Y,N),this._y=0)):console.warn("unsupported order: "+X),this._order=X,t!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var W=new pl;return function(c,R,X){return W.makeRotationFromQuaternion(c),this.setFromRotationMatrix(W,R,X)}}(),setFromVector3:function(Q,e){return this.set(Q.x,Q.y,Q.z,e||this._order)},reorder:function(){var X=new tl;return function(q){return X.setFromEuler(this),this.setFromQuaternion(X,q)}}(),equals:function(k){return k._x===this._x&&k._y===this._y&&k._z===this._z&&k._order===this._order},fromArray:function($){return this._x=$[0],this._y=$[1],this._z=$[2],$[3]!==d&&(this._order=$[3]),this.onChangeCallback(),this},toArray:function(g,C){return g===d&&(g=[]),C===d&&(C=0),g[C]=this._x,g[C+1]=this._y,g[C+2]=this._z,g[C+3]=this._order,g},toVector3:function(C){return C?C.set(this._x,this._y,this._z):new wo(this._x,this._y,this._z)},onChange:function(L){return this.onChangeCallback=L,this},onChangeCallback:function(){}});var lr={ms_ac:function(q,J){for(var u=J.ms_ac,m=0;m<u.length;m++)Pi(q,u[m])},ms_listener:function(U){U.addListeners=function(){for(var U=this,x=0;x<qf.length;x++){var r=qf[x];"wheel"===r&&!U.handle_wheel&&U.handle_mousewheel&&(U.handle_wheel=function(Y){nr(U,Y)}),U["handle_"+r]&&Je(r,U.getView(),U)}},U.removeListeners=function(){for(var r=this,Q=0;Q<qf.length;Q++)r["handle_"+qf[Q]]&&Bh(qf[Q],r.getView(),r)}},ms_fire:function(f){f.mp=function(o,t,v){this.addPropertyChangeListener(o,t,v)},f.ump=function(q,w){this.removePropertyChangeListener(q,w)},f.fp=function(P,v,z,J,o){return this.firePropertyChange(P,v,z,J,o)},f.addPropertyChangeListener=function(t,$,z){var N=this;N._62I||(N._62I=new lh),N._62I.add(t,$,z)},f.removePropertyChangeListener=function(Q,g){this._62I&&this._62I.remove(Q,g)},f.firePropertyChange=function(C,f,b,t,I){if(t){if(t(f,b))return!1}else if(f===b)return!1;var J=this,K=I||{};return K.property=C,K.oldValue=f,K.newValue=b,K.source=J,K.data=J,J._62I&&J._62I.fire(K),J.onPropertyChanged&&J.onPropertyChanged(K),!0}},ms_attr:function(a){a.a=function(k,n){var I=this;if(2===arguments.length)I.setAttr(k,n);else{if(!qr(k))return I.getAttr(k);for(var X in k)I.setAttr(X,k[X])}return I},a.getAttr=function(H,r){if(r===d&&(r=1),this._attrObject&&H in this._attrObject)return this._attrObject[H];if(this.getImage){var L=this.getImage();if(Or(L)&&(L=jl[L]),qr(L)&&"dataBindings"in L)for(var j=L.dataBindings,E=j.length-1;E>=0;E--){var Z=j[E];if(Z.attr===H){if("defaultValue"in Z)return Z.defaultValue;break}}}return r?V[H]:d},a.setAttr=function(U,L){var J=this;J._attrObject||(J._attrObject={});var A=J._attrObject[U];L===d?delete J._attrObject[U]:J._attrObject[U]=L,J.fp&&J.fp("a:"+U,A,L)&&J.onAttrChanged&&J.onAttrChanged(U,A,L)},a.getSerializableAttrs=function(){var B,S={};for(B in this._attrObject)S[B]=1;return S}},ms_bnb:function(N){N.getBodyColor=function(o){return o.s("body.color")},N.getBorderColor=function(K){return K.s("border.color")}},_51o:function(V){V.mi=function(o,U,s){this.addInteractorListener(o,U,s)},V.umi=function(d,V){this.removeInteractorListener(d,V)},V.fi=function(a){this.fireInteractorEvent(a)},V.addInteractorListener=function(b,d,Z){var B=this;B._63I||(B._63I=new lh),B._63I.add(b,d,Z)},V.removeInteractorListener=function(b,k){this._63I&&this._63I.remove(b,k)},V.fireInteractorEvent=function(h){this._63I&&this._63I.fire(h)},V.setInteractors=function(R){var X=this,a=X._interactors;a&&a.each(function(j){j.tearDown()}),Cq(R)&&(R=new bm(R)),X._interactors=R,R&&R.each(function(c){c.setUp()}),X.fp("interactors",a,R),X.invalidateSelection()},V.getInteractors=function(){return this._interactors}},_49o:function(E){E._44O=s,E._45O=s,E.getTopPainters=function(){return this._44O},E.getBottomPainters=function(){return this._45O},E.addTopPainter=function(w){var m=this;m._44O||(m._44O=new bm),m._44O.contains(w)||(m._44O.add(w),m.redraw&&m.redraw())},E.removeTopPainter=function(G){var C=this;C._44O&&(C._44O.remove(G),C.redraw&&C.redraw())},E.addBottomPainter=function(U){var z=this;z._45O||(z._45O=new bm),z._45O.contains(U)||(z._45O.add(U),z.redraw&&z.redraw())},E.removeBottomPainter=function(V){var K=this;K._45O&&(K._45O.remove(V),K.redraw&&K.redraw())},E._93db=function(S,z){var M=this;M._45O&&M._45O.each(function(b){b.draw?b.draw(S,z):b.call(M,S,z)})},E._92db=function(B,M){var $=this;$._44O&&$._44O.each(function(R){R.draw?R.draw(B,M):R.call($,B,M)})}},ms_sm:function(v){v.sm=function(){return this.getSelectionModel()},v.setSelectableFunc=function(w){this.sm().setFilterFunc(w)},v.getSelectableFunc=function(){return this.sm().getFilterFunc()},v.getSelectionModel=function(){var k=this;return k._selectionModel?k._selectionModel:k.dm().sm()},v.isSelectionModelShared=function(){return!this._selectionModel},v.setSelectionModelShared=function(C){var K=this,g=!K._selectionModel,A=K.handleSelectionChange,I=K.dm();g!==C&&(K.invalidateSelection&&K.invalidateSelection(),C?(I.sm().ms(A,K),K._selectionModel.ums(A,K),K._selectionModel.dispose(),K._selectionModel=s):(I.sm().ums(A,K),K._selectionModel=new pd(I),K._selectionModel.ms(A,K)),K.onSelectionModelSharedChanged(),K.fp("selectionModelShared",g,C))},v.onSelectionModelSharedChanged=function(){var t=this;t.redraw(),t.invalidateSelection&&t.invalidateSelection()
},v.removeSelection=function(){var A=this.dm();A.beginTransaction(),this.sm().toSelection().each(A.remove,A),A.endTransaction()},v.selectAll=function(){var F=this;F.sm().ss(F.dm().toDatas(function(i){return F.isVisible(i)&&F.isSelectable(i)}))},v.isSelected=function(j){return this.sm().co(j)},v.isSelectedById=function(b){var Z=this.dm().getDataById(b);return Z?this.isSelected(Z):!1},v.isSelectable=function(G){return this.sm().isSelectable(G)}},ms_tx:function(l){l._64I=0,l._65O=0,l.isScrollable=function(){return this.getWidth()<this._64I},l._40o=function(){return this.isScrollable()},l.getLogicalPoint=function(G){return Pp(G,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},l.tx=function(O){return O===d?this.getTranslateX():(this.setTranslateX(O),void 0)},l.getTranslateX=function(){return this._65O},l.setTranslateX=function(A){var Z=this,h=Z.getWidth()-Z._64I;h>A&&(A=h),A>0&&(A=0),A=t(A);var z=Z._65O;Z._65O=A,Z.fp(Mi,z,A)}},ms_ty:function(h){h._23Q=0,h._66O=0,h._41o=function(){return this.getHeight()<this._23Q},h.getLogicalPoint=function(Y){return Pp(Y,this._canvas||this._view,this.tx?this.tx():0,this.ty())},h.ty=function(W){return W===d?this.getTranslateY():(this.setTranslateY(W),void 0)},h.getTranslateY=function(){return this._66O},h.setTranslateY=function(e){var r=this,Z=r.getHeight()-r._23Q;Z>e&&(e=Z),e>0&&(e=0),e=t(e);var Y=r._66O;r._66O=e,r.fp(qc,Y,e)}},ms_txy:function(g){g._65O=0,g._66O=0,g.tx=function(R){return R===d?this.getTranslateX():(this.setTranslateX(R),void 0)},g.ty=function(F){return F===d?this.getTranslateY():(this.setTranslateY(F),void 0)},g.onTranslateEnded=function(){},g.setTranslate=function(M,a,P){var i=this;if(P=jb(P)){i._65I&&i._65I.stop(!0);var C=i.tx(),f=i.ty();P.action=function(n){i.setTranslate(C+(M-C)*n,f+(a-f)*n)},P._37o=function(){delete i._66I,delete i._65I,i.onTranslateEnded()},i._66I=1,i._65I=gp(P)}else i.tx(M),i.ty(a)},g.getTranslateX=function(){return this._65O},g.setTranslateX=function(Z){var w=this;Z=w.adjustTranslateX(Z);var Y=w._65O;w._65O=Z,w.fp(Mi,Y,Z)},g.getTranslateY=function(){return this._66O},g.setTranslateY=function(R){var F=this;R=F.adjustTranslateY(R);var K=F._66O;F._66O=R,F.fp(qc,K,R)},g.adjustTranslateX=function(y){return t(y)},g.adjustTranslateY=function(q){return t(q)},g.translate=function(y,V,Q){this.setTranslate(this.tx()+y,this.ty()+V,Q)},g.getLogicalPoint=function(D){var H=this;return Pp(D,this._canvas||H._view,H.tx(),H.ty())}},ms_dm:function(L){L.dm=function(k){return k?(this.setDataModel(k),void 0):this.getDataModel()},L.getDataModel=function(){return this._dataModel}},ms_lp:function(t){t.lp=function(v){return this.getLogicalPoint(v)}},ms_v:function(I){I._disabled=!1,I.setDisabled=function(j,u){var D=this,H=D._disabled;H!==j&&(H&&(Zb(D._63O),delete D._63O),j&&(Dj(D._view,D._63O=nb(u)),D.iv()),D._disabled=j,D.fp("disabled",H,j))},I.isDisabled=function(){return this._disabled},I.getDisabledDiv=function(){return this._63O},I.getView=function(){return this._view},I.addToDOM=function(Y){var I=this,M=I.getView(),w=M.style;Y=Y||m.body,Y.appendChild(M),w.left="0",w.right="0",w.top="0",w.bottom="0",K(g,"resize",function(){I.iv()}),I.iv()},I.getWidth=function(){return this._view.clientWidth},I.getHeight=function(){return this._view.clientHeight},I.setWidth=function(B){var z=this;z._view.style.width=B+Se,z.iv(),z.fp&&z.fp(vs,s,B)},I.setHeight=function(i){var J=this;J._view.style.height=i+Se,J.iv(),J.fp&&J.fp(Vk,s,i)},I.setFocus=function(P){var g=this,K=g._currentEditor;return P&&K&&(K.getView&&(K=K.getView()),K.contains(P.target))?!1:(Ep(g._view),g.endEditing&&g.endEditing(),g.fireViewEvent("focus"),!0)},I.iv=function(y){this.invalidate(y)},I.invalidate=function(W){var K=this;K._68I||(K._68I=1,Ag(K.validate,K,s,W),K.onInvalidated&&K.onInvalidated(),K.fireViewEvent("invalidate"))},I.validate=function(){var N=this,Q=N._view;if(N._68I&&(delete N._68I,Q.parentNode))if(0===Q.offsetWidth&&0===Q.offsetHeight&&N._67I!==s)N._67I===d&&(N._67I=k.reinvalidateCount),N._67I>0?N._67I--:N._67I=s,N.iv();else{N.fireViewEvent("beginValidate"),N.validateImpl(),N.onValidated&&N.onValidated(),N.fireViewEvent("validate");var W=N._63O;W&&(Q.lastChild!==W&&(Zb(W),Dj(Q,W)),ci(W,0,0,N.getWidth(),N.getHeight())),jc(N),Em(N),Td(N)}},I.layout=function(T,n,q,I){1===arguments.length?ci(this,T):ci(this,T,n,q,I)},I.addViewListener=function(H,j,q){var i=this;i._67O||(i._67O=new lh),i._67O.add(H,j,q)},I.removeViewListener=function(v,f){this._67O.remove(v,f)},I.fireViewEvent=function(D){var i=this;i._67O&&(Or(D)&&(D={kind:D}),i._67O.fire(D)),k.viewListener&&k.viewListener(i,D)}},ms_tip:function(Q){Q.setToolTipEnabled=function(X){var Z=this;X?mo||Z._13o||(Z.enableToolTip(),Z.fp("toolTipEnabled",!1,!0)):Z._13o&&(Z.disableToolTip(),Z.fp("toolTipEnabled",!0,!1))},Q.isToolTipEnabled=function(){return!!this._13o},Q.enableToolTip=function(){var n=this;if(!mo&&!n._13o){n._13o=function(Y){var x=n.getToolTip(Y);x!=s?k.toolTipContinual&&k.isToolTipShowing()?Hj(Y,x):(en(),Kf={timeout:j(Ve,sg),e:Y,info:x}):en()};var u=n.getView();K(u,$g,n._13o),K(u,"mouseleave",k.hideToolTip)}},Q.disableToolTip=function(){var G=this;if(G._13o){var W=G.getView();f(W,$g,G._13o),f(W,"mouseleave",k.hideToolTip),delete G._13o}},Q.getToolTip=function(W){var M=this;if(M.getDataAt){var C=M.getDataAt(W);return C?C.getToolTip():s}return M.getValue?M.getValue():void 0}},_52o:function(p){p._zoom=1,p._29I=sc,p.zoomIn=function(K,v){this.setZoom(this._zoom*be,K,v)},p.zoomOut=function(o,G){this.setZoom(this._zoom/be,o,G)},p.zoomReset=function(A,U){this.setZoom(1,A,U)},p.scrollZoomIn=function(S){this.setZoom(this._zoom*Lr,s,S)},p.scrollZoomOut=function(o){this.setZoom(this._zoom/Lr,s,o)},p.pinchZoomIn=function(T){this.setZoom(this._zoom*fr,s,T)},p.pinchZoomOut=function(f){this.setZoom(this._zoom/fr,s,f)},p.adjustZoom=function(Q){return Ad>Q?Ad:Q>qq?qq:Q},p.getZoom=function(){return this._zoom},p.setZoom=function(P,q,A){var K=this;if(q=jb(q)){K._14o&&K._14o.stop(!0);var T=K._zoom;q.action=function(W){K._96O(T+(P-T)*W,A)},q._37o=function(){delete K._zooming,delete K._14o,K.onZoomEnded()},K._zooming=1,K._14o=gp(q)}else K._96O(P,A)},p._96O=function(w,S){var X=this;if(w=X.adjustZoom(w),w!==X._zoom){X.validate();var e=X._29I,d=X._zoom;0!==e.width&&0!==e.height&&(S=S?S:{x:e.x+e.width/2,y:e.y+e.height/2},X.tx((S.x-e.x)*d-S.x*w),X.ty((S.y-e.y)*d-S.y*w)),X._zoom=w,X.fp("zoom",d,w)}}},ms_edge:function(v){v._2I=function(V){var k=this;k._44I||(k._44I=new bm),k._42I||(k._42I=new bm),k._44I.add(V),k._42I.add(V),k._20I()},v._4I=function(a){var p=this;p._44I||(p._44I=new bm),p._43I||(p._43I=new bm),p._44I.add(a),p._43I.add(a),p._20I()},v._16I=function(i){var W=this;W._44I.remove(i),W._42I.remove(i),W._44I.isEmpty()&&delete W._44I,W._42I.isEmpty()&&delete W._42I,W._20I()},v._18I=function(K){var x=this;x._44I.remove(K),x._43I.remove(K),x._44I.isEmpty()&&delete x._44I,x._43I.isEmpty()&&delete x._43I,x._20I()},v._20I=function(){var j=this;if(delete j._45I,!j._44I||j._44I.isEmpty())return delete j._70O,void 0;var o;j._44I.each(function(c){c.isLooped()&&(o||(o={}),o[c._id]||(j._45I||(j._45I=new bm),j._45I.add(c),o[c._id]=c))}),o?(j._70O=new bm,j._44I.each(function(W){o[W._id]?"A"===o[W._id]||(o[W._id]="A",j._70O.add(W)):j._70O.add(W)})):j._70O=j._44I},v.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},v.getSourceAgentEdges=function(){return this._46I},v.getTargetAgentEdges=function(){return this._47I},v._1I=function(w){var j=this;j._46I||(j._46I=new bm),j._48I||(j._48I=new bm),j._46I.add(w),j._48I.add(w),j._19I()},v._3I=function(x){var Y=this;Y._47I||(Y._47I=new bm),Y._48I||(Y._48I=new bm),Y._47I.add(x),Y._48I.add(x),Y._19I()},v._15I=function(G){var d=this;d._46I.remove(G),d._48I.remove(G),d._46I.isEmpty()&&delete d._46I,d._48I.isEmpty()&&delete d._48I,d._19I()},v._17I=function(j){var G=this;G._47I.remove(j),G._48I.remove(j),G._47I.isEmpty()&&delete G._47I,G._48I.isEmpty()&&delete G._48I,G._19I()},v._19I=function(){var g=this;delete g._49I;var n=g._48I;if(n&&!n.isEmpty()){var C={};n.each(function(u){C[u._id]?g._49I||(g._49I=new bm):C[u._id]=u}),g._49I?n.each(function(d){C[d._id]&&(g._49I.add(d),delete C[d._id])}):g._49I=n}},v.getLoopedEdges=function(){return this._45I},v.getEdges=function(){return this._70O},v.getAgentEdges=function(){return this._49I},v.getSourceEdges=function(){return this._42I},v.getTargetEdges=function(){return this._43I},v._8I=function(){this._70O&&this._70O.each(function(P){P._7I()})}}};ag(k,{numberDigits:5,crossOrigin:"",baseZIndex:d,isTouchable:mo,devicePixelRatio:g.devicePixelRatio?g.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:P.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return uj},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:mo?20:1,animDuration:200,animEasing:function(R){return R*R},labelColor:Jp,labelSelectColor:Ej,labelFont:(mo?"15":"12")+"px arial, sans-serif",widgetIndent:mo?30:20,widgetRowHeight:mo?30:20,widgetHeaderHeight:mo?32:22,widgetTitleHeight:mo?34:24,scrollBarColor:eq,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:mo?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:fk,intersectionLineLine:Br,isEnter:Cr,isEsc:ti,isDelete:hj,isSpace:Af,isLeft:lb,isUp:Gj,isRight:si,isDown:ub,getTarget:bh,isString:Or,isNumber:hk,isBoolean:Zl,isArray:Cq,isSelectAll:mg,isFunction:Lo,isObject:qr,getPropertyValue:Wi,setPropertyValue:Bn,addMethod:ag,getVersion:function(){return"7.0.6"},isMobile:function(){var j;return function(){return j!==d?j:(j=!1,function(k){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(k)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(k.substr(0,4)))&&(j=!0)}(navigator.userAgent||navigator.vendor||g.opera),j)}}(),createGradient:function(i,e,N,f,F,B,p,P){var u=Ni[e];return u(i,N,f,F,B,p,P)},appendToScreen:function(A){A=A.getView?A.getView():A,(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement||m.body).appendChild(A)},encodeString:function(a){return l.Math.encodeBase64(a,k.encodeStringKey)},decodeString:function(t){return l.Math.decodeBase64(t,k.encodeStringKey)},findView:function(Q){var v=function(W,z){var y=z._ht;y&&W.push(y);var h=z.children,H=h.length;if(H)for(var g=0;H>g;g++)v(W,h[g])},U=[];v(U,m.body);var H=function(g,p){for(var C="2d"===p?Lk.GraphView:gd.Graph3dView,R=0,K=g.length;K>R;R++)if(g[R]instanceof C)return U[R];return null};return"all"===Q?U:"2d"===Q?H(U,"2d"):"3d"===Q?H(U,"3d"):H(U,"3d")||H(U,"2d")},toggleFullscreen:function(U){var I=U.getView();if(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement)m.exitFullscreen?m.exitFullscreen():m.msExitFullscreen?m.msExitFullscreen():m.mozCancelFullScreen?m.mozCancelFullScreen():m.webkitExitFullscreen&&m.webkitExitFullscreen();else{var d=!0;if(U.isSelfViewEvent){var s=U.getX(),f=U.getY(),v=U.getWidth(),N=U.getHeight(),L=I.style.background,J=I.style.backgroundColor;L||J||(I.style.backgroundColor="white"),I.requestFullscreen?I.requestFullscreen():I.msRequestFullscreen?I.msRequestFullscreen():I.mozRequestFullScreen?I.mozRequestFullScreen():I.webkitRequestFullscreen&&I.webkitRequestFullscreen();var q=setInterval(function(){if(I!==(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement))clearInterval(q),U.setX(s),U.setY(f),U.setWidth(v),U.setHeight(N),U._fullscreen=!1,I.style.oldBackgroundColor=J,U.iv();else{var W=l.Default.getWindowInfo();(d||W.width!==U.getWidth()||W.height!==U.getHeight())&&(U.setX(W.left),U.setY(W.top),U.setWidth(W.width),U.setHeight(W.height),U._fullscreen=!0,U.iv(),d=!1)}},500)}else{var y=I.style.left,_=I.style.top,v=I.style.width,N=I.style.height,L=I.style.background,J=I.style.backgroundColor;L||J||(I.style.backgroundColor="white"),I.requestFullscreen?I.requestFullscreen():I.msRequestFullscreen?I.msRequestFullscreen():I.mozRequestFullScreen?I.mozRequestFullScreen():I.webkitRequestFullscreen&&I.webkitRequestFullscreen();var q=setInterval(function(){if(I!==(m.fullscreenElement||m.mozFullScreenElement||m.webkitFullscreenElement||m.msFullscreenElement))clearInterval(q),I.style.left=y,I.style.top=_,I.style.width=v,I.style.height=N,I.style.oldBackgroundColor=J,U.iv();else{var Q=l.Default.getWindowInfo();(d||Q.width!==U.getWidth()||Q.height!==U.getHeight())&&(ci(U),d=!1)}},500)}}},appendTimeStamp:function(z){return z},setCompType:function(x,a){Lo(a)||qr(a)?sh[x]=a:Xm(x)},getCompType:function(r){var N=sh[r];return N===d&&Ub.test(r)&&Xm(r),N},getCompTypeMap:function(){return sh},drawCompType:function(I,O,N,S,o,k){I(O,N,S,o,k)},numberListener:function(){var y={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(F){var L=F.keyCode;y[L]||65===L&&k.isCtrlDown(F)||86===L&&k.isCtrlDown(F)||67===L&&k.isCtrlDown(F)||88===L&&k.isCtrlDown(F)||L>=35&&40>=L||(F.shiftKey||48>L||L>57)&&(96>L||L>105)&&F.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(c){var I=c.target.tagName;("DIV"===I||"CANVAS"===I)&&!(k.ignoreKeyCodes.indexOf(c.keyCode)>=0)&&("keydown"!==c.type||lb(c)||si(c)||Gj(c)||ub(c)||hj(c)||65===c.keyCode&&(c.metaKey||c.ctrlKey))&&(c.preventDefault(),c.preventManipulation&&c.preventManipulation())},getWindowInfo:function(){var k=m.documentElement,Z=k&&(k.scrollLeft||k.scrollTop)?k:m.body;return{target:Z,left:Z.scrollLeft,top:Z.scrollTop,width:g.innerWidth||Z.clientWidth,height:g.innerHeight||Z.clientHeight}},isDragging:function(){return!!uj},isLeftButton:function(G){return mo?!0:0===G.button},isMiddleButton:function(J){return mo?!1:J&&(1===J.button||4&(J.buttons||0))},isRightButton:function(S){return mo?!1:S&&(2===S.button||2&(S.buttons||0))},isInput:function(w){if(!w)return!1;var c=w.tagName;return"INPUT"===c||"TEXTAREA"===c||"SELECT"===c},getTouchCount:function(i){return mo?i.touches.length:1},isDoubleClick:function(){function m(o){o.details=0,o.timeout=null,o.lastPoint=null}var U={};return Co=new $,jd=Co.getTime(),function(I){if(I.touches&&I.touches.length>1)return!1;var E=I.button==s?"":I.button,o=I.type+E,v=o+"_isDoubleClick",A=U[o];if(A||(A=U[o]={details:0,timeout:null,lastPoint:null}),I[v]===d){I[v]=!0;var P=xl(I);A.timeout&&(n(A.timeout),A.timeout=null),A.lastPoint&&Qd(A.lastPoint,P)>k.doubleClickRange&&m(A),A.lastPoint=P,A.details++,A.timeout=j(function(){m(this)}.bind(A),500)}return 2===A.details}}(),isShiftDown:function(q){return q?q.shiftKey:Ob["16"]},isCtrlDown:function(J){return J?kd?J.metaKey:J.ctrlKey:kd?Ob["91"]:Ob["17"]},getClientPoint:function(h){return mo&&(h=Zg(h)),{x:h.clientX,y:h.clientY}},isMouseEvent:function(m){return m instanceof MouseEvent||0===m.type.indexOf("mouse")},getTargetElement:function(B){if(k.isMouseEvent(B)||!m.elementFromPoint)return B.target;var W=Jg(B);return m.elementFromPoint(W.x,W.y)},getPagePoint:function(n){return mo&&(n=Zg(n)),{x:n.pageX,y:n.pageY}},createObject:function(Y,C){var F=new Y;for(var f in C){var Q=C[f];if(Lo(Q))F[f]=Q;else if(0===f.indexOf("s:"))F.s(f.substr(2),C[f]);else if(0===f.indexOf("a:"))F.a(f.substr(2),C[f]);else{var N=Wg(f),Q=C[f];F[N]?(F[N](Q),"setToolTip"===N&&F.enableToolTip&&F.enableToolTip()):F[f]=Q}}return F},setImage:function(q,Q,E,C){var $=arguments.length;4===$?vo(q,C,Q,E):2===$?Or(Q)?vo(q,Q):yn(q,Q):1===$&&vo(q,q)},getImage:function(c,j,S){var X;if(c==s)return s;if(qr(c)?X=c:(X=jl[c],c&&X===d&&(wk&&wk[c]||vo(c,c))),j&&X&&X.tagName){var Z;Z="override"===S?"colors_override":"override_rgb"===S?"colors_override_rgb":"override_a"===S?"colors_override_a":"colors",X[Z]||(X[Z]={__count__:0});var l=X[Z][j];return l||(X[Z].__count__>k.imageCacheThreshold&&(X[Z]={__count__:0}),l=Sf(X,id(j),X.width,X.height,S),X[Z][j]=l,X[Z].__count__++),l}return X},isImageComplete:function(r,A,f){var w=Qf(r);if(!w)return!1;if(w.tagName)return w.complete;for(var o,r,n,y=w.comps,_=!0,R=0,h=y.length;h>R;R++)if(o=y[R],n=o.type,"image"===o.type){r=o.name,r&&r.func&&(r=Ud(r,A));var O=kq(r,A,f);if(!O){_=!1;break}}else if(Ub.test(n)&&k.getCompType(n)===d){_=!1,Xm(n);break}return _},getId:function(){var B=1;return function(){return++B}}(),callLater:function(O,U,$,k){var F=function(){O.apply(U,$)};return k?j(F,k):g.requestAnimationFrame(F)},cancelLater:function(T,H){H?n(T):g.cancelAnimationFrame(T)},clone:function(m){if(null==m||"object"!=typeof m)return m;if(m instanceof Date){var O=new Date;return O.setTime(m.getTime()),O}if(m instanceof Array){for(var O=[],M=0,z=m.length;z>M;M++)O[M]=Tm(m[M]);return O}if(m instanceof bm){for(var O=new bm,M=0,z=m.length;z>M;M++)O.set(M,Tm(m.get(M)));return O}if(m instanceof ih)return m;if(m instanceof e){var O={};for(var C in m)m.hasOwnProperty(C)&&(O[C]=Tm(m[C]));return O}return m},callWhenLoaded:function(n,G){G=G||100;var s=Xj(n,G);Ck||(Ck={}),Ck[s]={tick:s,cb:n,delay:G}},beforeLoadURL:function(y){if(Ck){var f={};for(var g in Ck){var h=Ck[g];n(h.tick);var $=Xj(h.cb,h.delay);f[$]={tick:$,delay:h.delay,cb:h.cb}}Ck=f}return k.convertURL?k.convertURL(y):y},convertURL:function(T){return T},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return k.getImage("default_blank")},resizeImagePOT:function(m,r){if(!m||!m.tagName)return m;var U=m.width,Y=m.height;if(!U||!Y)return m;if(bq.isPOT(U)&&bq.isPOT(Y)&&(!r||U===Y))return m;var I,o;r?o=I=bq.nearestPOT(Math.min(U,Y)):(I=bq.nearestPOT(U),o=bq.nearestPOT(Y));var v=sb(),N=v.getContext("2d");return Cd(v,I,o,1),N.drawImage(m,0,0,U,Y,0,0,I,o),v},sortFunc:function(w,l){if(w===l)return 0;if(w==s&&l!=s)return 1;if(w!=s&&l==s)return-1;if(w==s&&l==s)return 0;var T,e=typeof w,P=typeof l;return e===Ol&&P===Ol?T=w.localeCompare(l):e===br&&P===br&&(T=w-l),T===d&&(T=(""+w).localeCompare(""+l)),T>0?1:0>T?-1:0},getClassMap:function(){return um},getClass:function(O){if(Or(O)){var l,f=um[O];if(!f){l=O.split("."),f=g;for(var e=0;e<l.length;e++)f=f[l[e]];um[O]=f}return f}return O},def:function(d,e,u){var R,v,Q,H=function(){};if(H.prototype=e.prototype,R=new H,Or(d)){if(um[d])throw"'"+d+"' already defined";Q=iq(d),R.getClassName=function(){return d}}else Q=d;if(R.constructor=Q,R.getClass=function(){return Q},R.getSuperClass=function(){return e},u)for(v in u)lr[v]&&lr.hasOwnProperty(v)?lr[v](R,u):yp(R,u,v);Q.prototype=R,Q.superClass=e.prototype},startAnim:function(){var b=function(N){N.duration&&(N.startTime=Xl()),N.timeId=Ag(N.tick,s,s,N.interval)};return function(O){return O=Tm(O),O.easing=O.easing||k.animEasing,O.duration||O.frames||(O.duration=k.animDuration),O.t=0,O.duration?O.interval=0:(O.frame=0,O.interval=O.interval||10),O.tick=function(){if(O.duration){var l=(Xl()-O.startTime)/O.duration;if(l>1&&(l=1),O.t=l,O.action(O.easing(l),l),!O.isRunning())return;1===l?O.stop():O._isPaused||(O.timeId=Ag(O.tick))}else{if(O.frame++,l=O.t=O.frame/O.frames,O.action(O.easing(l),l),!O.isRunning())return;O.frame<O.frames?O._isPaused||(O.timeId=Ag(O.tick,s,s,O.interval)):O.stop()}},O.resume=function(){O._isPaused&&(delete O._isPaused,O.duration?O.t<1&&(O.startTime=Xl()-O.duration*O.t,O.timeId=Ag(O.tick)):O.frame<O.frames&&(O.timeId=Ag(O.tick,s,s,O.interval)))},O.pause=function(){An(O.timeId,!O.duration),O._isPaused=!0},O.isPaused=function(){return this._isPaused},O.stop=function(E){O.isRunning()&&(An(O.timeId,!O.duration),delete O.timeId,O.duration?O.t<1&&E&&(O.t=1,O.action(O.easing(1),1)):O.frame<O.frames&&E&&(O.frame=O.frames,O.action(O.easing(1),1)),O._37o&&O._37o(),O.finishFunc&&O.finishFunc())},O.isRunning=function(){return O.timeId!=s},O.delay?Ag(b,s,[O],O.delay):b(O),O}}(),getTextSize:function(){var u={},H=m?sb().getContext("2d"):s;return function(N,f){H.font=N?N:Uj;var l=u[H.font];return l||(l=2*H.measureText("e").width+4,u[H.font]=l),{width:H.measureText(f).width+4,height:l}}}(),drawText:function(K,h,I,f,Z,O,k,$,P,T){if(h!=s){var c=bk(I,h),M={};M.y=T&&T!==Ef?T===rg?O+c.height/2:O+$-c.height/2:O+$/2,M.x=P&&P!==xb?P===cr?Z+k-c.width/2:Z+k/2:Z+c.width/2,Eo(K,h,M,I,f)}},getDistance:function(L,O){var U=L.length;return O?3===U?r(C(L[0]-O[0])+C(L[1]-O[1])+C(L[2]-O[2])):2===U?r(C(L[0]-O[0])+C(L[1]-O[1])):L.z===d?r(C(O.x-L.x)+C(O.y-L.y)):r(C(O.x-L.x)+C(O.y-L.y)+C(O.z-L.z)):3===U?r(C(L[0])+C(L[1])+C(L[2])):2===U?r(C(L[0])+C(L[1])):void 0},brighter:function(_,e){return 0>e&&(e=-e),dr(_,e?e:40)},darker:function(z,w){return w>0&&(w=-w),dr(z,w?w:-40)},unionPoint:function(i,R){if(!i)return s;if(2===arguments.length)return i&&R?{x:B(i.x,R.x),y:B(i.y,R.y),width:J(i.x-R.x),height:J(i.y-R.y)}:s;var y=i;if(y._as&&(y=y._as),y.length===d)return s;var C=y.length;if(0>=C)return s;for(var l=1,k=y[0],p={x:k.x,y:k.y,width:0,height:0};C>l;l++){k=y[l];var w=B(p.x,k.x),Z=I(p.x+p.width,k.x),M=B(p.y,k.y),x=I(p.y+p.height,k.y);p.x=w,p.y=M,p.width=Z-w,p.height=x-M}return p},unionRect:function(K,O){if(K&&!O)return Tm(K);if(!K&&O)return Tm(O);if(K&&O){var u={x:B(K.x,O.x),y:B(K.y,O.y)};return u.width=I(K.x+K.width,O.x+O.width)-u.x,u.height=I(K.y+K.height,O.y+O.height)-u.y,u}return s},containsPoint:function(S,l,o,Y){if(Y!=s&&1!==Y){var B=S.x+S.width/2,C=S.y+S.height/2;S={x:B-S.width/2*Y,y:C-S.height/2*Y,width:S.width*Y,height:S.height*Y}}if(o){var z=S.width/2,G=S.height/2,J=L(-o),g=O(-o),w=l.x-S.x-z,N=l.y-S.y-G;return l={x:g*w-J*N,y:J*w+g*N},Sn({x:-z,y:-G,width:S.width,height:S.height},l)}return!(!S||l.x<S.x||l.y<S.y||l.x>S.x+S.width||l.y>S.y+S.height)},containsRect:function(P,y){if(!P||!y)return!1;var K=y.x,$=y.y,O=y.width,i=y.height,Z=P.width,L=P.height;if(0>(Z|L|O|i))return!1;var V=P.x,X=P.y;if(V>K||X>$)return!1;if(Z+=V,O+=K,K>=O){if(Z>=V||O>Z)return!1}else if(Z>=V&&O>Z)return!1;if(L+=X,i+=$,$>=i){if(L>=X||i>L)return!1}else if(L>=X&&i>L)return!1;return!0},intersectsRect:function(M,m){if(!M||!m)return!1;var u=m.width,p=m.height,s=M.width,t=M.height;if(0>=s||0>=t||0>=u||0>=p)return!1;var i=m.x,b=m.y,W=M.x,G=M.y;return s+=W,t+=G,u+=i,p+=b,s>i&&t>b&&u>W&&p>G},intersection:function(C,N){if(!C||!N)return s;var l=N.x,g=N.y,y=C.x,x=C.y,z=l,O=g,B=y,L=x;return z+=N.width,O+=N.height,B+=C.width,L+=C.height,y>l&&(l=y),x>g&&(g=x),z>B&&(z=B),O>L&&(O=L),z-=l,O-=g,0>=z||0>=O?s:{x:l,y:g,width:z,height:O}},grow:function(E,t,k){k===d&&(k=t),E.x-=t,E.y-=k,E.width=E.width+2*t,E.height=E.height+2*k},getScreenPoint:function(P,c,T,e,i,b,H){var K=T.getBoundingClientRect(),$=P*(b||1)-T.scrollLeft+(e||0),Z=c*(H||1)-T.scrollTop+(i||0),U=hn(T,!1);if(U){var E=new wo($,Z,0);return E.applyMatrix4(U),console.log(E),{x:E.x,y:E.y}}return{x:$+K.left,y:Z+K.top}},getLogicalPoint:function(B,Q,f,z,T,b){var r,$,V=Q.getBoundingClientRect();B.target?(oo(B)?kd?Ob["91"]=!0:Ob["17"]=!0:kd?Ob["91"]=!1:Ob["17"]=!1,Ob["16"]=km(B)?!0:!1,B=mo?Zg(B):B,r=B.clientX,$=B.clientY):(r=B.x,$=B.y);var C=hn(Q,!0);if(C){var I=new wo(r,$,0);I.applyMatrix4(C);do{if(Math.abs(I.z)<=1e-6)break;var u=new wo(r,$,1);if(u.applyMatrix4(matrix),Math.abs(u.z)<=1e-6){I=u;break}if(u.sub(I),Math.abs(u.z)<=1e-6)break;I.addScaledVector(u,-I.z/u.z)}while(!1);return{x:(I.x+Q.scrollLeft-(f||0))/(T||1),y:(I.y+Q.scrollTop-(z||0))/(b||1)}}return{x:(r-V.left+Q.scrollLeft-(f||0))/(T||1),y:($-V.top+Q.scrollTop-(z||0))/(b||1)}},removeHTML:function(){var Q;return function(T){return T&&T.getView&&(T=T.getView()),T&&T.parentNode?Q===T?!0:(Q=T,T.parentNode.removeChild(T),Q=s,!0):!1}}(),getToolTipDiv:function(){if(!Jm){Jm=Lp(),fo=Lp();var b=Jm.style;k.baseZIndex!=s&&(b.zIndex=H(k.baseZIndex)+3+""),b.whiteSpace="nowrap",b.color=k.toolTipLabelColor,b.background=k.toolTipBackground,b.font=k.toolTipLabelFont,b.padding="5px",b.boxShadow="0px 0px 3px "+k.toolTipShadowColor}return Jm},isToolTipShowing:function(){return Jm&&Jm.parentNode?!0:fo&&fo.parentNode?!0:!1},hideToolTip:function(){Zb(Jm),Zb(fo),np()},showToolTip:function(J,p){if(!J||p==s)return en(),void 0;k.getToolTipDiv();var R,u;if(p.html?(p=p.html,R=fo,Zb(Jm)):(R=Jm,Zb(fo)),u=R.style,R.innerHTML=p,R.parentNode||l.Default.appendToScreen(R),J.target){J=Jg(J);var X=sl(),h=J.x,D=J.y,L=mo?60:12;if(mo){var e=R.getBoundingClientRect();u.left=h-e.width/2+Se,u.top=D-e.height-L<X.top?D+L+Se:D-e.height-L+Se}else{u.left=h+L+Se,u.top=D+L+Se;var e=R.getBoundingClientRect();e.left+e.width>X.width&&(u.left=h-L-e.width+Se),e.top+e.height>X.height&&(u.top=D-L-e.height+Se),e.left<0&&(u.left=h+L+Se),e.top<0&&(u.top=D+L+Se)}}else u.left=J.x+Se,u.top=J.y+Se;np()},startDragging:function(f,p,C){C==d&&(C=!0),f!==uj&&(uj?C&&(mo?uj.handleWindowTouchEnd(p):uj.handleWindowMouseUp(p)):mo?(K(g,Bi,Qr),K(g,pq,mh)):(K(g,$g,el),K(g,Un,rs)),uj=f)},getImageMap:function(){return jl},toBoundaries:function(N,I,O,U){var i=[];return Si(N,I,O,U).forEach(function(F){var X=[];F.forEach(function(n){X.push(n.x,n.y)}),i.push(X)}),i},getCurrentKeyCodeMap:function(){return Ob},drawCenterImage:function(W,Q,I,d,C,_,a,l){!C&&_&&_.isSelfViewEvent&&(C=_);var j=Tb(Q,C,_),y=hd(Q,C,_);Jq(W,Q,t(I-j/2),t(d-y/2),j,y,C,_,a,l)},drawStretchImage:function(A,d,O,l,Y,I,W,w,L,J,i,E){!w&&L&&L.isSelfViewEvent&&(w=L);var e,q=Tb(d,w,L,I),K=hd(d,w,L,W);"uniform"===O?(e=B(I/q,W/K),q*=e,K*=e,l+=t((I-q)/2),Y+=t((W-K)/2),I=q,W=K):"centerUniform"===O&&((q>I||K>W)&&(e=B(I/q,W/K),q*=e,K*=e),l+=t((I-q)/2),Y+=t((W-K)/2),I=q,W=K);var P=A.interactiveInfo;if(P){var T;if(T="center"===O?{x:l+I/2-q/2,y:Y+W/2-K/2,width:q,height:K}:{x:l,y:Y,width:I,height:W},P.rect){var F=P.compInfos,M=F.length;M&&(F[M-1].rect.image=d)}else P.rect=T}if("center"===O){var D=i!==!1&&(q>I||K>W);D&&(A.save(),A.beginPath(),A.rect(l,Y,I,W),A.clip()),Jq(A,d,l+I/2-q/2,Y+W/2-K/2,q,K,w,L,J,E),D&&A.restore()}else Jq(A,d,l,Y,I,W,w,L,J,E)},toCanvas:function(U,a,t,z,g,c,D,A,O){U=Qf(U,D),a=a||Tb(U,g),t=t||hd(U,g);var i=sb(),I=wi(i);return A?(Cd(i,a,t,A),I.scale(A,A)):Cd(i,a,t,1),Iq(I,U,z,0,0,a,t,g,c,D,O),U&&U.clampToEdge&&(i.clampToEdge=U.clampToEdge),I.restore(),i},toGrayColor:function(Y){if(!Y)return Y;var v=$h(Y),B=t(.299*v[0]+.587*v[1]+.114*v[2]);return"rgba("+B+","+B+","+B+","+v[3]/255+")"},createGradientImage:function(X,w,O,j){for(var M=["L",0,0,X,0,1,0,0,1,0,0],o=0,T=Math.min(w.length,O.length);T>o;o++)M.push(O[o],w[o]);var u=l.Default.toCanvas({width:X,height:X,clampToEdge:!0,comps:[{type:"shape",rotation:j||0,points:[0,0,X,0,X,X,0,X],background:"#ffffff",gradientPack:M}]});return u},createElement:function(v,$,w,e){var a=m.createElement(v);return Jr(a,$||P.widgetBorder,2),a.style.font=w?w:Uj,e!=s&&(a.value=e),k.onElementCreated&&k.onElementCreated(a),a},containedInView:function(J,k){var U=Zd(k).getBoundingClientRect();return Sn({x:U.left,y:U.top,width:U.width,height:U.height},xl(J))},isIsolating:function(){return ie>0},setIsolating:function(Q){Q?ie++:ie--},getMSMap:function(){return lr},stringify:function(e,F,f){var $=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var o=JSON.stringify(e,function(Q,t){return"function"==typeof t?"__ht__"+(t.__ht__||t.toString()):hk(t)?tp(t):t instanceof l.List?"__ht__list"+(t.__ht__list||k.stringify(t._as)):t},F==s?2:F);return Date.prototype.toJSON=$,f&&(o="__ht__encode"+k.encodeString(o)),o},parse:function(F){return Or(F)?"__ht__encode"!=F.substr(0,12)||(F=k.decodeString(F.substr(12)),Or(F))?JSON.parse(F,function(T,i){if(Or(i))if("__ht__function"==i.substr(0,14)){var A=i.indexOf("{")+1,a=i.lastIndexOf("}"),u=i.indexOf("(")+1,J=i.indexOf(")");if(A&&a&&u&&J){var R=new Function(i.substring(u,J),i.substring(A,a));return R.__ht__=i.substr(6),R}}else{if("__ht__date"==i.substr(0,10))return new Date(H(i.substr(10)));if("__ht__list"===i.substr(0,10))return new bm(k.parse(i.substr(10)))}return i}):F:F},loadJS:function(r,N){N&&r.push(N);var n=r.shift();if(Cq(n))r=n.contact(r),k.loadJS(r);else if(Lo(n))n(),k.loadJS(r);else if(Or(n)){var g=m.createElement("script");g.onload=function(){k.loadJS(r)},g.setAttribute("src",n),m.getElementsByTagName("head")[0].appendChild(g)}else r.length&&k.loadJS(r)},toRoundedCorner:function(){function b(s,H,r){s.x=H.x,s.y=H.e||r,s.z=H.y}var w=new wo,c=new wo,k=new wo,t=new wo;return function(i,n){var X,q=0;i.getPoints&&(q=i.getElevation(),i=i.getPoints()),X=i instanceof bm?i:new bm(i);var y=X.size();if(0>=n)return{points:X};var O=new bm,_=new bm,u=X.get(0);b(w,u,q),O.add(u),_.add(1);for(var N=1;y>N;N++)if(y>N+1){var B=X.get(N),C=X.get(N+1);b(c,B,q),b(k,C,q),t.subVectors(w,c).setLength(Math.min(.99*t.length(),n)).add(c),B.e!==d||u.e!==d?O.add({x:t.x,y:t.z,e:t.y}):O.add({x:t.x,y:t.z}),O.add(B),t.subVectors(k,c).setLength(Math.min(.99*t.length(),n)).add(c),B.e!==d||C.e!==d?O.add(u={x:t.x,y:t.z,e:t.y}):O.add(u={x:t.x,y:t.z}),w.copy(t),_.addAll([2,3])}else O.add(X.get(N)),_.add(2);return{points:O,segments:_}}}(),toColorData:$h,setCanvas:Cd,createDiv:Lp,createDisabledDiv:nb,createView:Eq,createCanvas:sb,appendChild:Dj,initContext:wi,checkLoadingImage:jc,translateAndScale:gh,layout:ci,getPosition:Ih,drawPoints:hh,drawRoundRect:Dg,drawBorder:Gr,setFocus:Ep,getter:zl,setter:Wg,isEmptyObject:ol,cameraPriority:function(){var K={skybox:0,main:1e4,top:1e7};return e.seal(e.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return K.skybox},set:function(r){if(r>=K.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");K.skybox=Number(r)}},main:{configurable:!1,enumerable:!1,get:function(){return K.main},set:function(y){if(y<=K.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(y>=K.top)throw new RangeError("Main camera must have lower priority than the top camera.");K.main=Number(y)}},top:{configurable:!1,enumerable:!1,get:function(){return K.top},set:function(C){if(C<=K.main)throw new RangeError("Top camera must have higher priority than the main camera.");K.top=Number(C)}}}))}()},!0),ag(R,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Aj=k.disabledOpacity,sg=k.toolTipDelay,He=k.devicePixelRatio,Pr=k.autoMakeVisible,nl=k.autoHideScrollBar,wp=k.imageGradient,Hj=k.showToolTip,en=k.hideToolTip,Tr=k.dashPattern,Dq=k.lineCap,yd=k.lineJoin,Vj=k.labelColor,we=k.labelSelectColor,Uj=k.labelFont,Wo=k.widgetIndent,pp=k.widgetRowHeight,Yf=k.widgetHeaderHeight,Kn=k.widgetTitleHeight,zo=k.scrollBarColor,Ah=k.scrollBarSize,uk=k.scrollBarTimeout,Hb=k.scrollBarMinLength,ji=k.scrollBarInteractiveSize,be=k.zoomIncrement,Lr=k.scrollZoomIncrement,fr=k.pinchZoomIncrement,qq=k.zoomMax,Ad=k.zoomMin,In=k.createObject,yc=k.preventDefault,$m=k.setImage,Qf=k.getImage,kq=k.isImageComplete,Yr=k.drawCenterImage,Iq=k.drawStretchImage,Dd=k.getId,Ag=k.callLater,An=k.cancelLater,Pn=k.sortFunc,Tm=k.clone,iq=k.getClass,gp=k.startAnim,Dc=k.brighter,Gh=k.darker,xg=k.drawText,bk=k.getTextSize,ee=k.isLeftButton,im=k.isMiddleButton,dq=k.isRightButton,on=k.getTouchCount,Ec=k.isDoubleClick,km=k.isShiftDown,oo=k.isCtrlDown,xl=k.getClientPoint,Jg=k.getPagePoint,Qd=k.getDistance,Bc=k.unionPoint,$r=k.unionRect,Sn=k.containsPoint,Zi=k.containsRect,Ed=k.intersectsRect,Xg=k.intersection,sl=k.getWindowInfo,ho=k.grow,Pp=k.getLogicalPoint,vp=k.getScreenPoint,Fh=k.startDragging,Zb=k.removeHTML,Xn=k.createElement,ls=k.segmentResolution,qh=k.shapeResolution,cc=k.shapeSide,an=k.def,tf=function(w,v,R){an(A+"."+w,v,R)
},Cc=function(V,b){V.childNodes.forEach(function(F){b(F),Cc(F,b)})};ag(k,{toolTipLabelColor:Vj,toolTipLabelFont:Uj,toolTipBackground:P.toolTipBackground,toolTipShadowColor:eq,drawBreakableText:Jk,setDevicePixelRatio:function(h){He=k.devicePixelRatio="number"==typeof h?h:g.devicePixelRatio,Cc(m.body,function(j){var F=j._ht;F&&F._canvas&&(Cd(F._canvas,F.getWidth(),F.getHeight()),F.redraw?F.redraw():F.iv())})}},!0);var no=1e-6,Rj="undefined"!=typeof Uint16Array?Uint16Array:Array,vi="undefined"!=typeof Float32Array?Float32Array:Array,ke=function(b,a,v){var e=[b[0]-a[0],b[1]-a[1],b[2]-a[2]];if(v){var l=Qd(e);l>0&&(e[0]/=l,e[1]/=l,e[2]/=l)}return e},dg=function(){var y="charCodeAt",i=2*(2*Pe.length+1);for(var M in g)if(M===A+xb[0]+(Se.length+2)){var J=g[M];if(!J)break;for(var m=J.length,V=0;m>V;V++)if(J[V][y](0)===i&&J[V+1]!=s&&J[V+1]===Se[0]&&J[V+2]!=s&&J[V+2][y](0)===i){for(var a=V+3;m>a;a++)if(J[a][y](0)===i){if(0==J[a+1])for(var L,Z=a+2;m>Z;Z++){if(J[Z][y](0)===i){0==J[Z-1]&&L&&(Rr=L.substr(0,L.length-1));break}L==s?L=J[Z]:L+=J[Z]}break}break}break}return function(E){return[-E[0],-E[1],-E[2]]}}(),Eb=function(D,T){return 3===D.length?D[0]*T[0]+D[1]*T[1]+D[2]*T[2]:D[0]*T[0]+D[1]*T[1]},Il=function(){var E=new vi(16);return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},Zr=Il(),ri=function(K){var o=new vi(16);return o[0]=K[0],o[1]=K[1],o[2]=K[2],o[3]=K[3],o[4]=K[4],o[5]=K[5],o[6]=K[6],o[7]=K[7],o[8]=K[8],o[9]=K[9],o[10]=K[10],o[11]=K[11],o[12]=K[12],o[13]=K[13],o[14]=K[14],o[15]=K[15],o},Ug=function(k,D){return k[0]=D[0],k[1]=D[1],k[2]=D[2],k[3]=D[3],k[4]=D[4],k[5]=D[5],k[6]=D[6],k[7]=D[7],k[8]=D[8],k[9]=D[9],k[10]=D[10],k[11]=D[11],k[12]=D[12],k[13]=D[13],k[14]=D[14],k[15]=D[15],k},xq=function(Z){return Z[0]=1,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,Z[5]=1,Z[6]=0,Z[7]=0,Z[8]=0,Z[9]=0,Z[10]=1,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,Z},hs=function(B,x){var t=B[0],l=B[1],S=B[2];return B[0]=x[0]*t+x[4]*l+x[8]*S+x[12],B[1]=x[1]*t+x[5]*l+x[9]*S+x[13],B[2]=x[2]*t+x[6]*l+x[10]*S+x[14],B},$o=function(u,d){var P=u[0],o=u[1],f=u[2],C=u[3];return u[0]=d[0]*P+d[4]*o+d[8]*f+d[12]*C,u[1]=d[1]*P+d[5]*o+d[9]*f+d[13]*C,u[2]=d[2]*P+d[6]*o+d[10]*f+d[14]*C,u[3]=d[3]*P+d[7]*o+d[11]*f+d[15]*C,u},Nf=function(){var L,S,D,W,T=Hf(Rp[1]+Rp[7]),Q=Hf(Rp[0]+Rp[3]-Rp[10]),U=Hf(Rp[8]+2),o=function(){return S=D.charAt(L),L+=1,S},f=function(){var j="";if(S===U)for(;o();){if(S===U)return o(),j;j+=S}else o()},m=function(){for(;S&&" ">=S;)o()},x=function(){var x,R={};if(S===T){if(o(),m(),S===Q)return o(),R;for(;S;){if(x=f(),m(),o(),R[x]=W(),m(),S===Q)return o(),R;o(),m()}}};return W=function(){switch(m(),S){case T:return x();default:return f()}},function(C){if(h={},C){var A;if(D=C,L=0,S=" ",A=W(),m(),!S)return A}}}(),Uc=function($,e){if(e){var P=L(e),w=O(e),X=$[4],J=$[5],j=$[6],s=$[7],p=$[8],N=$[9],B=$[10],i=$[11];$[4]=X*w+p*P,$[5]=J*w+N*P,$[6]=j*w+B*P,$[7]=s*w+i*P,$[8]=p*w-X*P,$[9]=N*w-J*P,$[10]=B*w-j*P,$[11]=i*w-s*P}},ze=function(J,R){if(R){var p=L(R),G=O(R),s=J[0],l=J[1],Q=J[2],y=J[3],w=J[8],x=J[9],z=J[10],u=J[11];J[0]=s*G-w*p,J[1]=l*G-x*p,J[2]=Q*G-z*p,J[3]=y*G-u*p,J[8]=s*p+w*G,J[9]=l*p+x*G,J[10]=Q*p+z*G,J[11]=y*p+u*G}},rc=function(Y,m){if(m){var $=L(m),B=O(m),N=Y[0],n=Y[1],k=Y[2],j=Y[3],A=Y[4],f=Y[5],c=Y[6],h=Y[7];Y[0]=N*B+A*$,Y[1]=n*B+f*$,Y[2]=k*B+c*$,Y[3]=j*B+h*$,Y[4]=A*B-N*$,Y[5]=f*B-n*$,Y[6]=c*B-k*$,Y[7]=h*B-j*$}},No=function(E,o,C){return Sr(s,C===!1?s:E.getFinalScale3d(),E.getFinalRotation3d(),E.getRotationMode(),E.p3(),s,o)},Sr=function(b,X,j,Q,C,m,I){return m||(m=Il()),C&&Vf(m,C),kk(m,j,Q),I&&so(m,m,I),X&&ig(m,X),b&&so(m,m,b),m},Tg=function(b,Z,l){Z=H(Z),l=H(l);var z=this;z.g=b,z._84O=Z,z._85O=l,z._70I=!0,z.F=0,z._83O=Z+l,z.pen={x:0,y:0}},Wc="lineDashOffset",De="setLineDash",gn=function(q){for(var E in q)1===E.length&&(Wc=q[E]);return E?1:0},dl=function(k,_,V){return lp(_)?k:k[De]?(k[De](_),V&&(k.lineDashOffset=V),k):new Tg(k,_[0],_.length>1?_[1]:_[0])},Zh=function(R,k){!lp(k)&&R[De]&&(R[De](gj),R.lineDashOffset=0)};if(an(Tg,e,{_69I:6,moveTo:function(k,q){var H=this,d=H.pen;d.x=k,d.y=q,H.g.moveTo(k,q),H.start||(H.start={x:k,y:q})},lineTo:function(Y,k){var Q=this,S=Q.pen,b=Y-S.x,p=k-S.y,F=c(p,b),l=O(F),M=L(F),z=Q._23O(S.x,S.y,Y,k),o=Q._85O,$=Q._84O,n=Q._83O;if(Q.F){if(Q.F>z)return Q._70I?Q._72I(Y,k):Q.moveTo(Y,k),Q.F-=z,void 0;if(Q._70I?Q._72I(S.x+l*Q.F,S.y+M*Q.F):Q.moveTo(S.x+l*Q.F,S.y+M*Q.F),z-=Q.F,Q.F=0,Q._70I=!Q._70I,!z)return}var _=G(z/n);if(_){for(var D=l*$,I=M*$,X=l*o,P=M*o,w=0;_>w;w++)Q._70I?(Q._72I(S.x+D,S.y+I),Q.moveTo(S.x+X,S.y+P)):(Q.moveTo(S.x+X,S.y+P),Q._72I(S.x+D,S.y+I));z-=n*_}Q._70I?z>$?(Q._72I(S.x+l*$,S.y+M*$),Q.moveTo(Y,k),Q.F=o-(z-$),Q._70I=!1):(Q._72I(Y,k),z===$?(Q.F=0,Q._70I=!Q._70I):(Q.F=$-z,Q.moveTo(Y,k))):z>o?(Q.moveTo(S.x+l*o,S.y+M*o),Q._72I(Y,k),Q.F=$-(z-o),Q._70I=!0):(Q.moveTo(Y,k),z===o?(Q.F=0,Q._70I=!Q._70I):Q.F=o-z)},quadraticCurveTo:function(t,S,f,P){var A,L=this,I=L.pen,v=I.x,p=I.y,j=L._22O(v,p,t,S,f,P),Y=0,C=0,y=L._85O,x=L._84O;if(L.F){if(L.F>j)return L._70I?L._71I(t,S,f,P):L.moveTo(f,P),L.F-=j,void 0;if(Y=L.F/j,A=L._20O(v,p,t,S,f,P,Y),L._70I?L._71I(A[2],A[3],A[4],A[5]):L.moveTo(A[4],A[5]),L.F=0,L._70I=!L._70I,!j)return}var d=j-j*Y,u=G(d/L._83O),O=x/j,r=y/j;if(u)for(var a=0;u>a;a++)L._70I?(C=Y+O,A=L._21O(v,p,t,S,f,P,Y,C),L._71I(A[2],A[3],A[4],A[5]),Y=C,C=Y+r,A=L._21O(v,p,t,S,f,P,Y,C),L.moveTo(A[4],A[5])):(C=Y+r,A=L._21O(v,p,t,S,f,P,Y,C),L.moveTo(A[4],A[5]),Y=C,C=Y+O,A=L._21O(v,p,t,S,f,P,Y,C),L._71I(A[2],A[3],A[4],A[5])),Y=C;d=j-j*Y,L._70I?d>x?(C=Y+O,A=L._21O(v,p,t,S,f,P,Y,C),L._71I(A[2],A[3],A[4],A[5]),L.moveTo(f,P),L.F=y-(d-x),L._70I=!1):(A=L._19O(v,p,t,S,f,P,Y),L._71I(A[2],A[3],A[4],A[5]),j===x?(L.F=0,L._70I=!L._70I):(L.F=x-d,L.moveTo(f,P))):d>y?(C=Y+r,A=L._21O(v,p,t,S,f,P,Y,C),L.moveTo(A[4],A[5]),A=L._19O(v,p,t,S,f,P,C),L._71I(A[2],A[3],A[4],A[5]),L.F=x-(d-y),L._70I=!0):(L.moveTo(f,P),d===y?(L.F=0,L._70I=!L._70I):L.F=y-d)},bezierCurveTo:function(){var _=arguments;this.pen={x:_[4],y:_[5]},this.g.bezierCurveTo(_[0],_[1],_[2],_[3],_[4],_[5])},arc:function(D,X,Y,d,R,h){h||(d=-d,R=-R),Vr(this,D,X,d,R-d,Y,Y,!1)},rect:function(x,K,w,I){var f=this;f.pen={x:x,y:K},f.moveTo(x,K),f.lineTo(x,K+I),f.lineTo(x+w,K+I),f.lineTo(x+w,K),f.lineTo(x,K)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(t,N,S,u){var G=S-t,h=u-N;return r(G*G+h*h)},_22O:function(S,Y,y,t,v,R,L){for(var p,f,o,Q,l,P,$,K=0,A=S,e=Y,r=L>0?L:this._69I,F=1;r>=F;F++)o=F/r,Q=1-o,l=Q*Q,P=2*o*Q,$=o*o,p=l*S+P*y+$*v,f=l*Y+P*t+$*R,K+=this._23O(A,e,p,f),A=p,e=f;return K},_21O:function(X,B,h,g,M,Z,c,q){var e=this;if(0===c)return e._20O(X,B,h,g,M,Z,q);if(1===q)return e._19O(X,B,h,g,M,Z,c);var L=e._20O(X,B,h,g,M,Z,q);return L.push(c/q),e._19O.apply(e,L)},_20O:function(h,K,S,f,z,g,y){if(1!==y){var _=S+(z-S)*y,A=f+(g-f)*y;S=h+(S-h)*y,f=K+(f-K)*y,z=S+(_-S)*y,g=f+(A-f)*y}return[h,K,S,f,z,g]},_19O:function(T,H,N,Z,G,K,t){if(1!==t){var u=T+(N-T)*t,z=H+(Z-H)*t;N+=(G-N)*t,Z+=(K-Z)*t,T=u+(N-u)*t,H=z+(Z-z)*t}return[T,H,N,Z,G,K]},_72I:function(O,G){var X=this.pen;(O!==X.x||G!==X.y)&&(X.x=O,X.y=G,this.g.lineTo(O,G))},_71I:function(I,n,i,v){var u=this.pen;(I!==i||n!==v||i!==u.x||v!==u.y)&&(u.x=i,u.y=v,this.g.quadraticCurveTo(I,n,i,v))}}),U&&a){var zj=a.toString();Z=zj.indexOf(_n.substr(0,2))>0&&zj.indexOf(rg+rg.substr(1,1))>1||zj.indexOf(ts.substr(0,2)+_n.substr(2,2)+xb[0]+_n[4])>1?!0:!1}var Cl=s,ed=s,Em=function(g){Cl&&!g._72O&&(ed||(ed={}),ed[g._72O=Dd()]=g)},Xm=function(G,f){if(f||(f=G),f&&(Cl||(Cl={}),!Cl[G])){var Y=new Yp;if(Cl[f]={request:Y,url:f},f=k.beforeLoadURL(f),f.data){var O=k.parse(f.data);Gb(G,O),k.handleCompTypeLoaded(G,O)}else{Y.onload=function(){if(200===this.status||0===this.status){var T=k.parse(Y.getResponseText());Gb(G,T),k.handleCompTypeLoaded(G,T)}else Gb(G,s)},Y.onerror=function(){Gb(G,s)};var j={};j.url=encodeURI(f),j.sync=!1,Y.send(j)}}},Gb=function(L,W){if(sh[L]=W,delete Cl[L],ol(Cl)&&(Cl=s,ed)){for(var r in ed){var q=ed[r];q.invalidateAll&&q.invalidateAll(d,"compTypeLoaded",L),q.redraw&&q.redraw(),q.iv(),delete q._72O}ed=s}if(W&&ed)for(var r in ed){var q=ed[r];q.invalidateAll&&q.invalidateAll(d,"compTypeLoading",L),q.redraw&&q.redraw(),q.iv()}},or=P.chart,hc="",Bo=!0,Jj=k.compStack=[],ak=/^style@/,vb=/^attr@/,rq=/^field@/,Mn={x:.5,y:.5},oq=function(){Bo=!0},dd=function(){return Bo},Tb=function(l,r,T,p){if(!l)return 0;if(Ud(l.fitSize,r,T)&&p)return p;var u=Ud(l.width,r,T);return null==u?20:u},hd=function(q,V,p,s){if(!q)return 0;if(Ud(q.fitSize,V,p)&&s)return s;var d=Ud(q.height,V,p);return null==d?20:d},Ud=function(v,o,O){if(!v||!v.func)return v;var r,Y=v.func,u=v.value;return r=Lo(Y)?O&&O.vectorDataBindingDisabled&&!v.isSafeFunc?u:Y(o,O):o instanceof ih||(l.ui?o instanceof l.ui.View:0)?vb.test(Y)?o.a(hc+Y.slice(5)):ak.test(Y)?o.s(hc+Y.slice(6)):rq.test(Y)?o[Y.slice(6)]:o[Y]?o[Y](O):u:u,u!==d&&r==s?u:r},Jq=k.drawImage=function(){var c,w,x,C,G,Z,o=function($,g){$.getValue&&$.getValue.compType===g||($.getValue=function(P){var X=u($,P);if(X===d&&g.properties){var H=g.properties[P];H&&(X=H.defaultValue)}return X},$.getColor=function(Y){return E($.getValue(Y))},$.getValue.compType=g)},u=function(R,s,m){var z,E=!1;if(R.prefix&&w instanceof ih){var K=w.a(hc+s);K!==d&&(E=!0,z=K)}return z===d&&(z=R[s]),z&&z.func&&(E=!0,z=Ud(z,w,x)),m&&(z=m(z),E||(R[s]=z)),z},E=function(m,j){var p;if(p=j?u(m,j):m,c&&c.compGray&&p)return k.toGrayColor(p);if(G&&p){if("override"===Z)return G;if("override_rgb"===Z){var w=id(G);return p=$h(p),"rgba("+t(255*w[0])+","+t(255*w[1])+","+t(255*w[2])+","+p[3]/255+")"}if("override_a"===Z){var w=id(G);return p=$h(p),"rgba("+p[0]+","+p[1]+","+p[2]+","+w[3]+")"}var w=id(G);return p=$h(p),"rgba("+t(p[0]*w[0])+","+t(p[1]*w[1])+","+t(p[2]*w[2])+","+p[3]/255*w[3]+")"}return p},i=function(U){if(Cq(U)){for(var F=new bm,t=U.length,g=0;t>g;g+=2)F.add({x:U[g],y:U[g+1]});U=F}return U},b=function(k){var n=u(k,"anchorX"),y=u(k,"anchorY");if(n!==d||y!==d)return{x:n===d?Mn.x:n,y:y===d?Mn.y:y};var i=u(k,"type"),A=u(k,"name");if("image"!==i||!A)return Mn;var x=Qf(A);return x&&x.anchorX!==d&&x.anchorY!==d?{x:x.anchorX,y:x.anchorY}:Mn},e=function(e,q){var o=u(e,Vc),c=b(e);if(Cq(o)){var w=o.length,S=u(e,"relative"),y=q.width,H=q.height;if(4===w)o={x:o[0],y:o[1],width:o[2],height:o[3]},S&&(o.x*=y,o.y*=H,o.width*=y,o.height*=H);else if(3===w){var E=o[0];o={width:o[1],height:o[2]},S&&(o.width*=y,o.height*=H),"object"==typeof E?E.length&&(E={x:E[0],y:E[1]}):E=Ih(E,q,o),o.x=E.x-o.width*c.x,o.y=E.y-o.height*c.y}o.x+=u(e,"offsetX")||0,o.y+=u(e,"offsetY")||0,!S&&q.fitSize&&(o=A(e,o,q))}return o},A=function(v,R,H){if(R){var l,c,Z,Q={x:R.x,y:R.y,width:R.width,height:R.height},g=b(v),X=u(v,"layoutH"),f=u(v,"layoutV"),K=1,A=1,G=0,L=0,e=1,i=1;switch(X){case"left":break;case"right":Q.x+=H.width-H.rw;break;case"center":Q.x+=.5*(H.width-H.rw);break;case"scale":case"leftright":default:l=u(v,cf)||0,l&&(G=Math.abs(L=Math.sin(l)),e=Math.abs(i=Math.cos(l))),"leftright"!==X?(K+=e*(H.widthScale-1),A+=G*(H.widthScale-1)):(K+=Q.width?e*(H.width-H.rw)/Q.width:0,A+=Q.height?G*(H.width-H.rw)/Q.height:0,c=-Math.min(-g.x*i+g.y*L,-g.x*i-(1-g.y)*L,(1-g.x)*i+g.y*L,(1-g.x)*i-(1-g.y)*L))}switch(f){case"top":break;case"bottom":Q.y+=H.height-H.rh;break;case"center":Q.y+=.5*(H.height-H.rh);break;case"scale":case"topbottom":default:l==s&&(l=u(v,cf),l&&(G=Math.abs(L=Math.sin(l)),e=Math.abs(i=Math.cos(l)))),"topbottom"!==f?(K+=G*(H.heightScale-1),A+=e*(H.heightScale-1)):(K+=Q.width?G*(H.height-H.rh)/Q.width:0,A+=Q.height?e*(H.height-H.rh)/Q.height:0,Z=-Math.min(-g.x*L-g.y*i,-g.x*L+(1-g.y)*i,(1-g.x)*L-g.y*i,(1-g.x)*L+(1-g.y)*i))}return(1!==K||1!==A)&&("scale"!==X&&X?"leftright"===X&&(Q.x+=Q.width*(1-K)*g.x+c*(H.width-H.rw)):Q.x+=Q.x*(H.widthScale-1)+g.x*Q.width*(H.widthScale-K),"scale"!==f&&f?"topbottom"===f&&(Q.y+=Q.height*(1-A)*g.y+Z*(H.height-H.rh)):Q.y+=Q.y*(H.heightScale-1)+g.y*Q.height*(H.heightScale-A),Q.width*=K,Q.height*=A),Q.width<0&&(Q.width=0),Q.height<0&&(Q.height=0),Q}},D=function(c){return Cq(c)?new bm(c):c},a=function(z,A,s,R,n,O,_){var S=c.interactiveInfo,D=z.transform;if(D)return c.save(),c.setTransform(D.a,D.b,D.c,D.d,D.tx,D.ty),S&&S.compInfos.push({comp:z,rect:A,matrix:D.clone(),prefix:hc}),!0;n===d&&(n=1),O===d&&(O=1);var K=u(z,"clipPercentage"),I=Ai(s,A);if(I&&!R&&1===n&&1===O&&!(1>K))return S&&S.compInfos.push({comp:z,rect:A,matrix:S.matrix.clone(),prefix:hc}),!1;_=_||Mn;var g=A.x+A.width*_.x,t=A.y+A.height*_.y,Q=s.x+s.width*_.x,H=s.y+s.height*_.y,G=s.width?n*(A.width/s.width):1,N=s.height?O*(A.height/s.height):1;if(c.save(),S&&(S.matrix.appendTranslate(g,t).appendRotate(R).appendScale(G,N).appendTranslate(-Q,-H),S.compInfos.push({comp:z,rect:A,matrix:S.matrix.clone()})),bs(c,g,t),Dn(c,R||0),Nj(c,G,N),bs(c,-Q,-H),1>K){0>K&&(K=0);var i=Mb(s,u(z,"clipDirection"),K);c.beginPath(),c.rect(i.x,i.y,i.width,i.height),c.clip()}return!0},P=function(){c.restore()},f=function(t,J,x){var h=u(t,"path"),y=u(t,cf),W=u(t,"scaleX"),e=u(t,"scaleY"),m=b(t),g=s,z=xn(null,h);if(x||(x=t.unionRect,x||(x=Bc(z),t.path.func||(t.unionRect=x)),g=x),x){g||(g=t.unionRect,g||(g=Bc(z),t.path.func||(t.unionRect=g)));var Q=a(t,x,g,y,W,e,m),r=u(t,"borderPattern"),O=dl(c,r),I=E(t,"background"),N=E(t,"borderColor"),i=u(t,"borderWidth"),q=u(t,"gradient"),G=E(t,"gradientColor"),L=u(t,"border3d"),S=E(t,"border3dColor"),k=u(t,"border3dAccuracy"),w=c.lineJoin,V=c.lineCap;c.lineJoin=u(t,"borderJoin")||yd,c.lineCap=u(t,"borderCap")||Dq,I?(Wb(c,I,q,G,g),xn(c,h),c.fill(),O!==c&&xn(c,h)):xn(c,h);var l=u(t,"borderWidthAbsolute");if(l&&(c.save(),c.setTransform(1,0,0,1,0,0)),i&&N&&(c.lineWidth=i,c.strokeStyle=N,c.stroke(),L&&ec(c,N,S,i,C,k)),Zh(c,r),u(t,"dash")){var Z=u(t,"dashWidth")||i;if(Z>0){r=u(t,"dashPattern")||Tr;var O=dl(c,r,u(t,"dashOffset")),T=E(t,"dashColor")||E(uh);O!==c&&xn(c,h),c.strokeStyle=T,c.lineWidth=Z,c.stroke(),u(t,"dash3d")&&ec(c,T,E(t,"dash3dColor"),Z,C,u(t,"dash3dAccuracy")),Zh(c,r)}}J===Vc&&wd(c,I,u(t,"depth"),g),l&&c.restore(),c.lineJoin=w,c.lineCap=V,Q&&P()}},J=function(g,k,q,o){var Y=u(g,Xh,i),J=u(g,cf),L=b(g);if(Y&&o.fitSize){var d=new bm,R=Bc(Y),$=A(g,R,o),v=R.x+L.x*R.width,K=R.y+L.y*R.height,h=$.x+L.x*$.width,B=$.y+L.y*$.height,T=R.width?$.width/R.width:1,S=R.height?$.height/R.height:1;Y.each(function(I){d.add({x:h+(I.x-v)*T,y:B+(I.y-K)*S})}),Y=d,g.unionRect=null}var z=u(g,"scaleX"),l=u(g,"scaleY"),n=k===mj,I=s;if(!q&&n&&(q=g.unionRect,q||(q=Bc(Y),g.points.func||(g.unionRect=q)),I=q),q){n?I||(I=g.unionRect,I||(I=Bc(Y),g.points.func||(g.unionRect=I))):I=q;var _,j,Q,W,p=a(g,q,I,J,z,l,L),N=u(g,"borderPattern"),U=dl(c,N),y=E(g,"background"),m=Qf(u(g,"repeatImage"),G,Z),O=u(g,"gradientPack"),r=E(g,"borderColor"),H=u(g,"borderWidth"),M=u(g,"segments",D),f=u(g,"gradient"),V=E(g,"gradientColor"),X=u(g,"border3d"),F=E(g,"border3dColor"),t=u(g,"border3dAccuracy"),e=u(g,"closePath"),Rg=u(g,"fillRule")||"nonzero",Br=c.lineJoin,dc=c.lineCap;if(c.lineJoin=u(g,"borderJoin")||yd,c.lineCap=u(g,"borderCap")||Dq,n)if(y||m||O){var Gb=u(g,"fillClipPercentage");if(1>Gb){0>Gb&&(Gb=0);var $n=Mb(I,u(g,"fillClipDirection"),Gb);c.save(),c.beginPath(),c.rect($n.x,$n.y,$n.width,$n.height),c.clip()}hh(c,Y,M,e),O?ug(c,O):m?Rf(c,m,G,Z,w,x):Wb(c,y,f,V,I),c.fill(Rg),1>Gb&&c.restore(),O&&c.restore(),U!==c&&hh(U,Y,M,e)}else hh(U,Y,M,e);else if("roundRect"===k?_=u(g,"cornerRadius"):"polygon"===k?_=u(g,"polygonSide"):"arc"===k&&(_=u(g,"arcFrom"),j=u(g,"arcTo"),Q=u(g,"arcClose"),W=u(g,"arcOval")),y||m||O){var Gb=u(g,"fillClipPercentage");if(1>Gb){0>Gb&&(Gb=0);var $n=Mb(I,u(g,"fillClipDirection"),Gb);c.save(),c.beginPath(),c.rect($n.x,$n.y,$n.width,$n.height),c.clip()}Md(c,k,I,_,j,Q,W),O?ug(c,O):m?Rf(c,m,G,Z,w,x):Wb(c,y,f,V,I),c.fill(Rg),1>Gb&&c.restore(),O&&c.restore(),c!==U&&Md(U,k,I,_,j,Q,W)}else Md(U,k,I,_,j,Q,W);var fs=u(g,"borderWidthAbsolute");if(fs&&(c.save(),c.setTransform(1,0,0,1,0,0)),H&&r&&(c.lineWidth=H,c.strokeStyle=r,c.stroke(),X&&ec(c,r,F,H,C,t)),Zh(c,N),u(g,"dash")){var wk=u(g,"dashWidth")||H;if(wk>0){N=u(g,"dashPattern")||Tr;var U=dl(c,N,u(g,"dashOffset")),gk=E(g,"dashColor")||E(uh);U!==c&&(n?hh(U,Y,M,e):Md(U,k,I,_,j,Q,W)),c.strokeStyle=gk,c.lineWidth=wk,c.stroke(),u(g,"dash3d")&&ec(c,gk,E(g,"dash3dColor"),wk,C,u(g,"dash3dAccuracy")),Zh(c,N)}}k===Vc&&wd(c,y,u(g,"depth"),I),fs&&c.restore(),c.lineJoin=Br,c.lineCap=dc,p&&P()}},q=function(E,H){var r=G||u(E,Ld),A=Z||u(E,"blendMode"),R=u(E,"name"),b=Qf(R,r,A);b?Iq(c,b,u(E,"stretch"),H.x,H.y,H.width,H.height,w,x,r,null,A):Bo=!1},h=function(U,G){var P=u(U,"text");P!=s&&xg(c,P,u(U,"font"),E(U,Ld),G.x,G.y,G.width,G.height,u(U,"align"),u(U,"vAlign"))},v=function(A,w){Gr(c,E(A,Ld),w.x,w.y,w.width,w.height,u(A,"width"))},S=function($,N){var r=u($,ce),Q=0;if(r&&(r.forEach(function(l){Q+=l}),Q>0)){for(var f=u($,"colors")||or,z=u($,"startAngle")||0,i=u($,"hollow"),M=u($,sk),U=u($,Bf),Y=u($,_b),V=M?new bm:s,S=N.x,y=N.y,h=N.width,n=N.height,Z=S+h/2,v=y+n/2,E=B(h,n)/2,g=0,e=0;e<r.length;e++){var G=r[e],t=p*G/Q,R=z+t;if(c.fillStyle=f[g++],g===f.length&&(g=0),c.beginPath(),i){var J=Z+O(z)*E/2,K=v+L(z)*E/2,P=Z+O(R)*E,C=v+L(R)*E;c.moveTo(J,K),c.arc(Z,v,E/2,z,R,!1),c.lineTo(P,C),c.arc(Z,v,E,R,z,!0)}else c.moveTo(Z,v),c.arc(Z,v,E,R,z,!0);V&&(t=(z+R)/2,V.add({text:Lo(M)?M(G,e,Q,w):G,x:Z+.75*O(t)*E,y:v+.75*L(t)*E})),c.closePath(),c.fill(),z=R}V&&V.each(function(z){xg(c,z.text,U,Y,z.x,z.y,0,0,zc)})}},R=function(K,k){var M=u(K,Wn);if(M&&M.length>0){var t=M.length,v=u(K,sk),Y=u(K,Bf),j=u(K,_b),n=v?new bm:s,i=u(K,"minValue")||0,q=u(K,"maxValue");if(q==s&&(q=0,M.forEach(function(l){u(l,ce).forEach(function(S){q=I(q,S)})})),i===q)return;for(var B=k.height/(q-i),X=k.y+q*B,R=u(M[0],ce).length,E=k.width/(3*R+1),H=2*E/t,V=0,r=0;t>r;r++)for(var $=M[r],b=u($,Ld),g=u($,"colors"),x=u($,ce),U=0;R>U;U++){g?c.fillStyle=g[U]:b?c.fillStyle=b:(c.fillStyle=or[V++],V===or.length&&(V=0));var m=x[U],d=m*B,Q=k.x+(1+3*U)*E+r*H;if(Gn(c,Q,X-d,H,d),n){var O=Lo(v)?v(m,U,$,w):m,W=bk(Y,O).height;n.add({x:Q,y:X-d-W,width:H,height:W,text:O})}}n&&n.each(function(z){xg(c,z.text,Y,j,z.x,z.y,z.width,z.height,zc)})}},r=function(k,v){var H=u(k,Wn);if(H&&H.length>0){var z=H.length,d=u(H[0],ce).length,G=v.width/(3*d+1),_=0,R=u(k,"maxValue"),A=u(k,sk),X=u(k,Bf),N=u(k,_b),T=A?new bm:s;if(R==s){R=0;for(var g=0;d>g;g++){for(var O=0,r=0;z>r;r++)O+=u(H[r],ce)[g];R=I(R,O)}}if(R>0){for(var g=0;d>g;g++)for(var j=v.y+v.height,r=0;z>r;r++){var m=H[r],l=u(m,Ld),J=u(m,ce)[g],F=J/R*v.height;l?c.fillStyle=l:(c.fillStyle=or[_++],_===or.length&&(_=0)),j-=F;var i={x:v.x+(1+3*g)*G,y:j,width:2*G,height:F};Gn(c,i.x,i.y,i.width,i.height),T&&(i.text=Lo(A)?A(J,g,m,w):J,T.add(i))}T&&T.each(function(u){xg(c,u.text,X,N,u.x,u.y,u.width,u.height,zc)})}}},n=function(j,d){var r=u(j,Wn);if(r&&r.length>0){for(var F=r.length,b=u(r[0],ce).length,_=d.width/(3*b+1),O=0,v=u(j,sk),L=u(j,Bf),M=u(j,_b),Y=v?new bm:s,K=0;b>K;K++){for(var N=0,Q=0;F>Q;Q++)N+=u(r[Q],ce)[K];if(N>0){var n=d.y+d.height;for(Q=0;F>Q;Q++){var $=r[Q],S=u($,Ld),x=u($,ce)[K],P=x/N*d.height;S?c.fillStyle=S:(c.fillStyle=or[O++],O===or.length&&(O=0)),n-=P;var e={x:d.x+(1+3*K)*_,y:n,width:2*_,height:P};Gn(c,e.x,e.y,e.width,e.height),Y&&(e.text=Lo(v)?v(x,K,$,w):x,Y.add(e))}}}Y&&Y.each(function(J){xg(c,J.text,L,M,J.x,J.y,J.width,J.height,zc)})}},m=function(T,X){var O=u(T,Wn);if(O&&O.length>0){var j=O.length,S=u(T,"minValue")||0,$=u(T,"maxValue");if($==s&&($=0,O.forEach(function(i){u(i,ce).forEach(function(p){$=I($,p)})})),S===$)return;for(var _=X.height/($-S),K=X.y+$*_,r=u(O[0],ce).length,k=X.width/(3*r+1),a=0,J=u(T,"lineWidth")||2,m=u(T,"line3d"),A=u(T,"linePoint"),v=u(T,sk),V=u(T,Bf),f=u(T,_b),W=0;j>W;W++){var G=O[W],H=u(G,Ld),M=u(G,ce);H?c.strokeStyle=H:(H=c.strokeStyle=or[a++],a===or.length&&(a=0)),c.beginPath();for(var l=0;r>l;l++){var t=X.x+(2+3*l)*k,q=K-M[l]*_;0===l?c.moveTo(t,q):c.lineTo(t,q)}if(c.lineWidth=J,c.stroke(),m&&ec(c,H,s,J,C),A||v){var D,n=J/2+2;for(l=0;r>l;l++){var x=M[l];if(t=X.x+(2+3*l)*k,q=K-x*_,Lo(A)?A(c,t,q,H,l,G,w):A&&(c.fillStyle=H,c.beginPath(),c.arc(t,q,n,0,p,!0),c.fill()),Lo(v)?D=v(x,l,G,w):v&&(D=x),D){var y=bk(V,D).height,Q=c.shadowBlur;if(Q){var d=c.shadowOffsetX,b=c.shadowOffsetY,Z=c.shadowColor;c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=0,c.shadowColor=s}xg(c,D,V,f,t,q-y-n+2,0,y,zc),Q&&(c.shadowOffsetX=d,c.shadowOffsetY=b,c.shadowBlur=Q,c.shadowColor=Z)}}}}}},M=function(h){c=h[0],w=h[1],x=h[2],C=h[3],G=h[4],Z=h[5]},T=function(){return[c,w,x,C,G,Z]},U=function(L,s){var G;x&&x.getState?G=x.getState(w):(G=w instanceof ih?w.s(rp):null,(G===d||null===G)&&(G=u(L,rp)));var p=u(s,rp);return p!==d&&null!==p&&p!==G?!1:u(s,Wm)},z={border:v,image:q,text:h,pieChart:S,columnChart:R,stackedColumnChart:r,percentageColumnChart:n,lineChart:m};return function(h,K,X,q,l,r,v,R,p,S){if(K&&l&&r){var O=T();c=h,w=v,x=R,!w&&x&&x.isSelfViewEvent&&(w=x),C=x?x._zoom?x._zoom:1:1,G=p,Z=S;var Q=l,Y=r;if(ql()){var m,$,A;0===c[Ze]?ql[0]&&(m=!0):m=!0,c.texureImage2D?ql[1]&&($=!0):$=!0,c.texureImage3D?ql[2]&&(A=!0):A=!0,m&&$&&A&&(Q=X,Y=q)}if(K.tagName)return Or(Rr)&&!g[Rr]||c.drawImage(K,Q,Y,l,r),M(O),void 0;if(u(K,"visible")===!1)return M(O),void 0;G||(G=Ud(K.color,w,x)),S||(Z=Ud(K.blendMode,w,x)),Or(Rr)&&!g[Rr]&&(l=Q,r=Y);var I=Tb(K,w,x,l),L=hd(K,w,x,r),n={x:0,y:0,width:I,height:L,fitSize:u(K,"fitSize")},V=u(K,"clip"),y=u(K,"opacity");if(n.fitSize){var F=n.rw=Ud(K.width,w,x)||20;n.widthScale=I/F;var H=n.rh=Ud(K.height,w,x)||20;n.heightScale=L/H}if(c.save(),c.interactiveInfo){var B=c.interactiveInfo.matrix,t=B.clone();B.appendTranslate(Q,Y).appendScale(l/I,r/L)}bs(c,Q,Y),(I!==l||L!==r)&&c.scale(l/I,r/L),V&&(Lo(V)?V(c,I,L,w,x,K):(c.beginPath(),c.rect(0,0,I,L),c.clip())),y!=s&&(c.globalAlpha*=y),u(K,"comps").forEach(function(j){if(j.prefix){var O=hc,h=Ud(j.prefix,w,x);h&&(hc=hc+h+".")}if(U(K,j)===!1)return j.prefix&&(hc=O),void 0;if(Jj.splice(0,0,j),c.interactiveInfo)var Q=c.interactiveInfo.matrix.clone();var S=u(j,"opacity"),L=u(j,"shadow"),q=u(j,"type"),t=e(j,n);if(S!=s){var l=c.globalAlpha;c.globalAlpha*=S}if(L){var H=c.shadowOffsetX,p=c.shadowOffsetY,B=c.shadowBlur,M=c.shadowColor,y=u(j,"shadowOffsetX"),F=u(j,"shadowOffsetY"),N=u(j,"shadowBlur"),r=E(j,"shadowColor");c.shadowOffsetX=(y==s?3:y)*C,c.shadowOffsetY=(F==s?3:F)*C,c.shadowBlur=(N==s?6:N)*C,c.shadowColor=r||E(xr)}if("save"===q)c.save();else if("endClip"===q||"restore"===q)c.restore();else if("clip"===q)c.save(),hh(c,u(j,"points",i),u(j,"segments",D),!0),c.clip();else if(Ni[q])t=t||{x:0,y:0,width:n.width,height:n.height},J(j,q,t,n);else if(q===mj)J(j,q,t,n);else if("SVGPath"===q)f(j,q,t);else{t=t||{x:0,y:0,width:n.width,height:n.height};var Z=u(j,cf),R=u(j,"scaleX"),W=u(j,"scaleY"),X=b(j),V=a(j,t,t,Z,R,W,X);if(Lo(q))o(j,q),k.drawCompType(q,c,t,j,w,x);else if(k.getCompType(q)){var v=k.getCompType(q),A=v.func||v;o(j,v),k.drawCompType(A,c,t,j,w,x)}else z[q]?z[q](j,t):k.getCompType(q)===d&&Ub.test(q)&&Xm(q);V&&P()}L&&(c.shadowOffsetX=H,c.shadowOffsetY=p,c.shadowBlur=B,c.shadowColor=M),S!=s&&(c.globalAlpha=l),c.interactiveInfo&&(c.interactiveInfo.matrix=Q),j.prefix&&(hc=O),Jj.splice(0,1)}),c.interactiveInfo&&(c.interactiveInfo.matrix=t),c.restore(),M(O)}}}();k.getCurrentComp=function(){return Jj[0]},k.getParentComp=function(){return Jj[1]},k.getInternal=function(){return{isEnter:Cr,isEsc:ti,isSpace:Af,isLeft:lb,isUp:Gj,isRight:si,isDown:ub,addMethod:ag,superCall:$d,toPointsArray:Si,translateAndScale:gh,appendArray:Hi,createWorldMatrix:Sr,vec3TransformMat4:hs,setCanvas:Cd,createDiv:Lp,createView:Eq,createCanvas:sb,createImage:Up,initContext:wi,layout:ci,fillRect:Gn,Mat:vk,drawBorder:Gr,isString:Or,setBorder:Jr,getPropertyValue:Wi,setPropertyValue:Bn,drawVerticalLine:Fp,draw3DRect:wd,getPinchDist:Oi,isSameRect:Ai,getPosition:Ih,intersectionLineRect:fk,getNodeRect:Ui,getEdgeAgentPosition:Ao,getEdgeHostPosition:rf,getImageWidth:Tb,getImageHeight:hd,initItemElement:Fo,drawPoints:hh,createG2:dl,closePopup:fi,isH:op,createAnim:jb,createNormalMatrix:gr,createNormals:Pk,toFloatArray:je,glMV:ll,batchShape:Gp,createNodeMatrix:No,getFaceInfo:Nd,transformAppend:os,drawFaceInfo:Kc,to3dPointsArray:xm,setGLDebugMode:function(R){Gc=R},cube:function(){return{vs:Ii,is:un,uv:ab}},ui:function(){return{DataUI:mi,NodeUI:co,EdgeUI:_o,GroupUI:fj,ShapeUI:th,GridUI:nn,Data3dUI:Cb,Node3dUI:xi,Shape3dUI:nk}},getInternalVersion:function(){return"U2FsdGVkX1+qoeLc8xKtxybynLbzRBGYkkdYhrSQy6M="},getDragger:function(){return uj},addMSMap:function(e){ag(lr,e)},k:F,addEventListener:K,removeEventListener:f}},function(D){function u(q,p){q!=s&&(p==s&&Ol!=typeof q?this._54O(q,256):this._54O(q,p))}function x(){return new u(s)}function Q(m,z,I,f,W,A){for(;--A>=0;){var j=z*this[m++]+I[f]+W;W=G(j/67108864),I[f++]=67108863&j}return W}function o(M,o,I,C,w,N){for(var u=32767&o,W=o>>15;--N>=0;){var y=32767&this[M],V=this[M++]>>15,T=W*y+V*u;y=u*y+((32767&T)<<15)+I[C]+(1073741823&w),w=(y>>>30)+(T>>>15)+W*V+(w>>>30),I[C++]=1073741823&y}return w}function m(R,N,b,v,l,K){for(var G=16383&N,$=N>>14;--K>=0;){var P=16383&this[R],U=this[R++]>>14,e=$*P+U*G;P=G*P+((16383&e)<<14)+b[v]+l,l=(P>>28)+(e>>14)+$*U,b[v++]=268435455&P}return l}function b(f){return Uo.charAt(f)}function V(v,t){var L=Ll[v.charCodeAt(t)];return L==s?-1:L}function d(g){for(var H=this.t-1;H>=0;--H)g[H]=this[H];g.t=this.t,g.s=this.s}function Z(q){this.t=1,this.s=0>q?-1:0,q>0?this[0]=q:-1>q?this[0]=q+this.DV:this.t=0}function W(t){var u=x();return u._58O(t),u}function Y(f,e){var z,v=this;if(16==e)z=4;else if(8==e)z=3;else if(256==e)z=8;else if(2==e)z=1;else if(32==e)z=5;else{if(4!=e)return v.fromRadix(f,e),void 0;z=2}v.t=0,v.s=0;for(var T=f.length,x=!1,w=0;--T>=0;){var k=8==z?255&f[T]:V(f,T);0>k?"-"==f.charAt(T)&&(x=!0):(x=!1,0==w?v[v.t++]=k:w+z>v.DB?(v[v.t-1]|=(k&(1<<v.DB-w)-1)<<w,v[v.t++]=k>>v.DB-w):v[v.t-1]|=k<<w,w+=z,w>=v.DB&&(w-=v.DB))}8==z&&0!=(128&f[0])&&(v.s=-1,w>0&&(v[v.t-1]|=(1<<v.DB-w)-1<<w)),v._57O(),x&&u.ZERO._78O(v,v)}function l(){for(var r=this,O=r.s&r.DM;r.t>0&&r[r.t-1]==O;)--r.t}function z(l){var L=this;if(L.s<0)return"-"+L._85O()[cn](l);var A;if(16==l)A=4;else if(8==l)A=3;else if(2==l)A=1;else if(32==l)A=5;else{if(4!=l)return L.toRadix(l);A=2}var I,u=(1<<A)-1,w=!1,Q="",o=L.t,k=L.DB-o*L.DB%A;if(o-->0)for(k<L.DB&&(I=L[o]>>k)>0&&(w=!0,Q=b(I));o>=0;)A>k?(I=(L[o]&(1<<k)-1)<<A-k,I|=L[--o]>>(k+=L.DB-A)):(I=L[o]>>(k-=A)&u,0>=k&&(k+=L.DB,--o)),I>0&&(w=!0),w&&(Q+=b(I));return w?Q:"0"}function g(){var A=x();return u.ZERO._78O(this,A),A}function a(){return this.s<0?this._85O():this}function j(E){var m=this,b=m.s-E.s;if(0!=b)return b;var h=m.t;if(b=h-E.t,0!=b)return m.s<0?-b:b;for(;--h>=0;)if(0!=(b=m[h]-E[h]))return b;return 0}function X($){var W,Q=1;return 0!=(W=$>>>16)&&($=W,Q+=16),0!=(W=$>>8)&&($=W,Q+=8),0!=(W=$>>4)&&($=W,Q+=4),0!=(W=$>>2)&&($=W,Q+=2),0!=(W=$>>1)&&($=W,Q+=1),Q}function h(){var D=this;return D.t<=0?0:D.DB*(D.t-1)+X(D[D.t-1]^D.s&D.DM)}function R(k,W){var L;for(L=this.t-1;L>=0;--L)W[L+k]=this[L];for(L=k-1;L>=0;--L)W[L]=0;W.t=this.t+k,W.s=this.s}function E(C,A){for(var S=C;S<this.t;++S)A[S-C]=this[S];A.t=I(this.t-C,0),A.s=this.s}function w(H,e){var M,z=this,j=H%z.DB,D=z.DB-j,i=(1<<D)-1,V=G(H/z.DB),m=z.s<<j&z.DM;for(M=z.t-1;M>=0;--M)e[M+V+1]=z[M]>>D|m,m=(z[M]&i)<<j;for(M=V-1;M>=0;--M)e[M]=0;e[V]=m,e.t=z.t+V+1,e.s=z.s,e._57O()}function c(Q,W){var m=this;W.s=m.s;var k=G(Q/m.DB);if(k>=m.t)return W.t=0,void 0;var L=Q%m.DB,F=m.DB-L,Z=(1<<L)-1;W[0]=m[k]>>L;for(var O=k+1;O<m.t;++O)W[O-k-1]|=(m[O]&Z)<<F,W[O-k]=m[O]>>L;L>0&&(W[m.t-k-1]|=(m.s&Z)<<F),W.t=m.t-k,W._57O()}function K(q,s){for(var f=this,u=0,z=0,C=B(q.t,f.t);C>u;)z+=f[u]-q[u],s[u++]=z&f.DM,z>>=f.DB;if(q.t<f.t){for(z-=q.s;u<f.t;)z+=f[u],s[u++]=z&f.DM,z>>=f.DB;z+=f.s}else{for(z+=f.s;u<q.t;)z-=q[u],s[u++]=z&f.DM,z>>=f.DB;z-=q.s}s.s=0>z?-1:0,-1>z?s[u++]=f.DV+z:z>0&&(s[u++]=z),s.t=u,s._57O()}function N(S,h){var w=this.abs(),s=S.abs(),r=w.t;for(h.t=r+s.t;--r>=0;)h[r]=0;for(r=0;r<s.t;++r)h[r+w.t]=w.am(0,s[r],h,r,0,w.t);h.s=0,h._57O(),this.s!=S.s&&u.ZERO._78O(h,h)}function J(Q){for(var R=this.abs(),$=Q.t=2*R.t;--$>=0;)Q[$]=0;for($=0;$<R.t-1;++$){var j=R.am($,R[$],Q,2*$,0,1);(Q[$+R.t]+=R.am($+1,2*R[$],Q,2*$+1,j,R.t-$-1))>=R.DV&&(Q[$+R.t]-=R.DV,Q[$+R.t+1]=1)}Q.t>0&&(Q[Q.t-1]+=R.am($,R[$],Q,2*$,0,1)),Q.s=0,Q._57O()}function $(J,Q,g){var I=J.abs(),O=this;if(!(I.t<=0)){var i=O.abs();if(i.t<I.t)return Q!=s&&Q._58O(0),g!=s&&O._77O(g),void 0;g==s&&(g=x());var M=x(),U=O.s,n=J.s,k=O.DB-X(I[I.t-1]);k>0?(I._44O(k,M),i._44O(k,g)):(I._77O(M),i._77O(g));var r=M.t,t=M[r-1];if(0!=t){var Z=t*(1<<O.F1)+(r>1?M[r-2]>>O.F2:0),y=O.FV/Z,P=(1<<O.F1)/Z,L=1<<O.F2,C=g.t,z=C-r,N=Q==s?x():Q;for(M._59O(z,N),g._52O(N)>=0&&(g[g.t++]=1,g._78O(N,g)),u.ONE._59O(r,N),N._78O(M,M);M.t<r;)M[M.t++]=0;for(;--z>=0;){var A=g[--C]==t?O.DM:G(g[C]*y+(g[C-1]+L)*P);if((g[C]+=M.am(0,A,g,z,0,r))<A)for(M._59O(z,N),g._78O(N,g);g[C]<--A;)g._78O(N,g)}Q!=s&&(g._45O(r,Q),U!=n&&u.ZERO._78O(Q,Q)),g.t=r,g._57O(),k>0&&g._46O(k,g),0>U&&u.ZERO._78O(g,g)}}}function f(B){var g=x();return this.abs()._49O(B,s,g),this.s<0&&g._52O(u.ZERO)>0&&B._78O(g,g),g}function U(X){this.m=X}function k(Q){return Q.s<0||Q._52O(this.m)>=0?Q.mod(this.m):Q}function q(Z){return Z}function i(C){C._49O(this.m,s,C)}function t(K,A,d){K._47O(A,d),this._74O(d)}function P(t,j){t._48O(j),this._74O(j)}function C(){if(this.t<1)return 0;var U=this[0];if(0==(1&U))return 0;var i=3&U;return i=15&i*(2-(15&U)*i),i=255&i*(2-(255&U)*i),i=65535&i*(2-(65535&(65535&U)*i)),i=i*(2-U*i%this.DV)%this.DV,i>0?this.DV-i:-i}function n(E){var _=this;_.m=E,_.mp=E._50O(),_.mpl=32767&_.mp,_.mph=_.mp>>15,_.um=(1<<E.DB-15)-1,_.mt2=2*E.t}function _(t){var h=x();return t.abs()._59O(this.m.t,h),h._49O(this.m,s,h),t.s<0&&h._52O(u.ZERO)>0&&this.m._78O(h,h),h}function e(J){var U=x();return J._77O(U),this._74O(U),U}function M(K){for(var D=this;K.t<=D.mt2;)K[K.t++]=0;for(var X=0;X<D.m.t;++X){var b=32767&K[X],O=b*D.mpl+((b*D.mph+(K[X]>>15)*D.mpl&D.um)<<15)&K.DM;for(b=X+D.m.t,K[b]+=D.m.am(0,O,K,X,0,D.m.t);K[b]>=K.DV;)K[b]-=K.DV,K[++b]++}K._57O(),K._45O(D.m.t,K),K._52O(D.m)>=0&&K._78O(D.m,K)}function De(t,e){t._48O(e),this._74O(e)}function Jj(G,L,E){G._47O(L,E),this._74O(E)}function ec(){return 0==(this.t>0?1&this[0]:this.s)}function Gd(Z,i){if(Z>4294967295||1>Z)return u.ONE;var d=x(),k=x(),y=i._73O(this),P=X(Z)-1;for(y._77O(d);--P>=0;)if(i._76O(d,k),(Z&1<<P)>0)i._75O(k,y,d);else{var I=d;d=k,k=I}return i.revert(d)}function Bo(D,r){var y;return y=256>D||r._51O()?new U(r):new n(r),this.exp(D,y)}function ns(){var x=this;if(x.s<0){if(1==x.t)return x[0]-x.DV;if(0==x.t)return-1}else{if(1==x.t)return x[0];if(0==x.t)return 0}return(x[1]&(1<<32-x.DB)-1)<<x.DB|x[0]}function fn(L,f){return new u(L,f)}function zp(){var I=this;I.n=s,I.e=0,I.d=s,I.p=s,I.q=s,I.dmp1=s,I.dmq1=s,I._10A=s}function hp(c){return c._53O(this.e,this.n)}function nr(m){var T,$,z,s="",P=0;for(T=0;T<m.length&&m.charAt(T)!=ic;++T)z=qs.indexOf(m.charAt(T)),0>z||(0==P?(s+=b(z>>2),$=3&z,P=1):1==P?(s+=b($<<2|z>>4),$=15&z,P=2):2==P?(s+=b($),s+=b(z>>2),$=3&z,P=3):(s+=b($<<2|z>>4),s+=b(15&z),P=0));return 1==P&&(s+=b($<<2)),s}function Xd(V){var w=V.split(""),y=nr(V);return w.forEach(function(E){var X=E.length;X>0&&y&&(bo+=H(E))}),y}function Dj(f,p){var J=ml._4O.Util._56O(f,"ss"),C={},Y=0;return C.v=J==p,C.t=1,C.s=0>Y?-1:0,dm=C.v,Y>0?C[0]=Y:-1>Y?C[0]=Y+C.DV:C.t=0,[J,C]}function zh(o){var k=38,s=o.substring(0,k);if(s&&30==s.indexOf("05000420")){var u=["ss",o.substring(k)];return u}return[]}function Qd(C,f){f=f.replace(Ff,""),f=f.replace(/[ \n]+/g,"");var P=fn(f,16);if(P._55O()>this.n._55O())return 0;var F=this._37O(P),x=F[cn](16).replace(/^1f+00/,""),i=zh(x);if(0==i.length)return!1;for(var V,W,l,Q=.5,A=cc,h=[0,.5,.75,.875,.9375],u=[],Z=[],N=[],t=p/A,E=i[1],z=Dj(C,E)[0],S=0,q=0;S<h.length;S++){var $=0===S%2?0:.5;for(V=0;A>=V;V++)W=(V+$)*t,l=1-h[S],u.push(O(W)*Q*l,-Q+2*h[S]*Q,-L(W)*Q*l),Z.push((V+$)/A,l)}for(S=0;S<h.length-1;S++){var Y=S*(A+1),_=(S+1)*(A+1);for(V=0;A>V;V++)N.push(Y+V,_+V+1,_+V,Y+V,Y+V+1,_+V+1)}return N.forEach(function(z){q+=z}),E==z&&q>10}var $b,Hl=0xdeadbeefcafe,yn=15715070==(16777215&Hl),cn="toString",Je="",ii="nat",Oo=function(){};v=D["D"+11182[cn](S(2,5))];var Zn=u.prototype;yh+=uf.substr(0,1);var qh=D.navigator?D.navigator.appName:"";yn&&"Microsoft Internet Explorer"==qh?(Zn.am=o,$b=30):yn&&"Netscape"!=qh?(Zn.am=Q,$b=26):(Zn.am=m,$b=28),Zn.DB=$b,Zn.DM=(1<<$b)-1,Zn.DV=1<<$b;
var Ir=52;Zn.FV=S(2,Ir),Zn.F1=Ir-$b,Zn.F2=2*$b-Ir;var fk,Xp,Uo="0123456789abcdefghijklmnopqrstuvwxyz",Ll=[],_k=function(z){return String.fromCharCode(z)};for(fk="0".charCodeAt(0),Xp=0;9>=Xp;++Xp)Ll[fk++]=Xp;for(fk="a".charCodeAt(0),Xp=10;36>Xp;++Xp)Ll[fk++]=Xp;for(fk="A".charCodeAt(0),Xp=10;36>Xp;++Xp)Ll[fk++]=Xp;var xn=U.prototype;xn._73O=k,xn.revert=q,xn._74O=i,xn._75O=t,xn._76O=P;var Xq=n.prototype;Xq._73O=_,Xq.revert=e,Xq._74O=M,Xq._75O=Jj,Xq._76O=De,Zn._77O=d,Zn._58O=Z,Zn._54O=Y,Zn._57O=l,Zn._59O=R,Zn._45O=E,Zn._44O=w,Zn._46O=c,Zn._78O=K,Zn._47O=N,Zn._48O=J,Zn._49O=$,Zn._50O=C,Zn._51O=ec,Zn.exp=Gd,Zn.toString=z,Zn._85O=g,Zn.abs=a,Zn._52O=j,Zn._55O=h,Zn.mod=f,Zn._53O=Bo,u.ZERO=W(0),u.ONE=W(1),Zn._86O=ns;var Ho=function(g,A){var D=this;D.isPublic=!0,typeof g!==Ol?(D.n=g,D.e=A):g!=s&&A!=s&&g.length>0&&A.length>0&&(D.n=fn(g,16),D.e=H(A,16))};On=function(){var Z,d,U=Xd(tr),q=U.substr(0,4),B=U.substr(4,2),i=U.substr(6,2),I=1,p=!I,Q=F,X=[],x=Sk.charAt(7);if(v&&(v[cn]().indexOf(ii)<0||v[yh][cn]().indexOf(ii)<0||!U?Z=s:(U=new v(q-0,B-I,i-0),d=U.setHours(9),v[yh]()>d?Z=xp[x]:p=!0)),U&&Z&&Z[0]&&Z[y(.5)]&&Q){var W=Nf(Z[0]),H=Nf(Z[1]);for(var _ in H)X.push(_);var C,E=0,m=W[X[E]],M=H[X[E++]],a=H[X[E++]],w=H[X[E++]],u=H[X[E++]],A=H[X[E++]],J=H[X[E++]],P=W[X[E]],t=H[X[E++]],L=qi._27O(Q);if(m===M&&L&&t){C=M+a+w+u+A+J;var T=!J||J===sp;if(!T&&J)for(var K,l=0,D=J.length;D>l;l++)J[l]===mb[E]?K===sp?T=!0:K[0]===Fi[5]&&sp&&sp.indexOf(K.substr(1))>=0?T=!0:K=s:(K==s?K=J[l]:K+=J[l],l===D-1&&(K===sp?T=!0:K[0]===Fi[5]&&sp&&sp.indexOf(K.substr(1))>=0&&(T=!0)));C&&L._31O(C,t)&&L._31O(m,P)&&T&&(!A||v[yh]()<A)&&(p=!0)}}return p||(Md=lp),x};var og=zp.prototype;og._37O=hp,og._38O=Ho;var qs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ic="=",Vq=25,Cp=10,tr="ICACJQ==",kj=kj||function(a,$){var f={},v=f._7A={},X=v._6A=function(){function u(){}return{_80O:function(N){u.prototype=this;var K=new u;return N&&K._5A(N),K.hasOwnProperty("_82O")||(K._82O=function(){K.$super._82O.apply(this,arguments)}),K._82O.prototype=K,K.$super=this,K},_3A:function(){var F=this._80O();return F._82O.apply(F,arguments),F},_82O:function(){},_5A:function(q){for(var P in q)q.hasOwnProperty(P)&&(this[P]=q[P]);q.hasOwnProperty(cn)&&(this.toString=q.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),A=v._39O=X._80O({_82O:function(D,K){D=this._84O=D||[],this._65O=K!=$?K:4*D.length},toString:function(y){return(y||M).stringify(this)},_89O:function(f){var L=this._84O,C=f._84O,T=this._65O,k=f._65O;if(this._57O(),T%4)for(var G=0;k>G;G++){var H=255&C[G>>>2]>>>24-8*(G%4);L[T+G>>>2]|=H<<24-8*((T+G)%4)}else if(C.length>65535)for(var G=0;k>G;G+=4)L[T+G>>>2]=C[G>>>2];else L.push.apply(L,C);return this._65O+=k,this},_57O:function(){var S=this._84O,$=this._65O;S[$>>>2]&=4294967295<<32-8*($%4),S.length=y($/4)},_88O:function(){var a=X._88O.call(this);return a._84O=this._84O.slice(0),a},_87O:function(b){for(var Q=[],M=0;b>M;M+=4)Q.push(0|4294967296*T);return new A._82O(Q,b)}}),V=f._2A={},M=V._69O={stringify:function(G){var d,c=G._84O,C=G._65O,J=[];for(d=0;C>d;d++){var g=255&c[d>>>2]>>>24-8*(d%4);J.push((g>>>4).toString(16)),J.push((15&g).toString(16))}return J.join("")},_68O:function(B){for(var I=B.length,O=[],P=0;I>P;P+=2)O[P>>>3]|=H(B.substr(P,2),16)<<24-4*(P%8);return new A._82O(O,I/2)}},o=V._8A={stringify:function(I){var V,U=I._84O,s=I._65O,X=[];for(V=0;s>V;V++){var x=255&U[V>>>2]>>>24-8*(V%4);X.push(_k(x))}return X.join("")},_68O:function($){var L,N=$.length,m=[];for(L=0;N>L;L++)m[L>>>2]|=(255&$.charCodeAt(L))<<24-8*(L%4);return new A._82O(m,N)}},E=V._9A={stringify:function(M){try{return decodeURIComponent(escape(o.stringify(M)))}catch(y){throw new Error("")}},_68O:function(N){return o._68O(unescape(encodeURIComponent(N)))}},Y=v._32O=X._80O({_1A:function(){this._83O=new A._82O,this._23O=0},_33O:function(p){typeof p==Ol&&(p=E._68O(p)),this._83O._89O(p),this._23O+=p._65O},_25O:function(O){var f=this._83O,X=f._84O,r=f._65O,N=this._79O,a=4*N,i=r/a;i=O?y(i):I((0|i)-this._22O,0);var T=i*N,L=B(4*T,r);if(T){for(var d=0;T>d;d+=N)this._20O(X,d);var t=X.splice(0,T);f._65O-=L}return new A._82O(t,L)},_88O:function(){var d=X._88O.call(this);return d._83O=this._83O._88O(),d},_22O:0});v._66O=Y._80O({cfg:X._80O(),_82O:function(F){this.cfg=this.cfg._80O(F),this._1A()},_1A:function(){Y._1A.call(this),this._34O()},_81O:function(l){return this._33O(l),this._25O(),this},_72O:function(V){V&&this._33O(V);var N=this._21O();return N},_79O:16,_26O:function(w){return function(i,B){return new w._82O(B)._72O(i)}},_19O:function(B){return function(P,D){return new _._71O._82O(B,D)._72O(P)}}});var _=f._67O={};return f}();!function(){var D=kj,J=D._7A,V=J._39O,E=J._66O,x=D._67O,L=[],P=[];!function(){function t(k){for(var I=r(k),X=2;I>=X;X++)if(!(k%X))return!1;return!0}function C(v){return 0|4294967296*(v-(0|v))}for(var Z=2,H=0;64>H;)t(Z)&&(8>H&&(L[H]=C(S(Z,.5))),P[H]=C(S(Z,1/3)),H++),Z++}();var T=[],Q=x._41O=E._80O({_34O:function(){this._64O=new V._82O(L.slice(0))},_20O:function(v,V){for(var I=this._64O._84O,t=I[0],Y=I[1],r=I[2],R=I[3],d=I[4],m=I[5],E=I[6],l=I[7],b=0;64>b;b++){if(16>b)T[b]=0|v[V+b];else{var g=T[b-15],u=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,N=T[b-2],F=(N<<15|N>>>17)^(N<<13|N>>>19)^N>>>10;T[b]=u+T[b-7]+F+T[b-16]}var c=d&m^~d&E,Z=t&Y^t&r^Y&r,D=(t<<30|t>>>2)^(t<<19|t>>>13)^(t<<10|t>>>22),L=(d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25),o=l+L+c+P[b]+T[b],p=D+Z;l=E,E=m,m=d,d=0|R+o,R=r,r=Y,Y=t,t=0|o+p}I[0]=0|I[0]+t,I[1]=0|I[1]+Y,I[2]=0|I[2]+r,I[3]=0|I[3]+R,I[4]=0|I[4]+d,I[5]=0|I[5]+m,I[6]=0|I[6]+E,I[7]=0|I[7]+l},_21O:function(){var P=this._83O,b=P._84O,k=8*this._23O,M=8*P._65O;return b[M>>>5]|=128<<24-M%32,b[(M+64>>>9<<4)+14]=G(k/4294967296),b[(M+64>>>9<<4)+15]=k,P._65O=4*b.length,this._25O(),this._64O},_88O:function(){var t=E._88O.call(this);return t._64O=this._64O._88O(),t}});D._41O=E._26O(Q),D._42O=E._19O(Q)}();var Ff=new RegExp("");Ff.compile("[^0-9a-f]","gi"),zp._28O=-1,zp._29O=-2,og._31O=Qd,og._63O=Qd,zp._43O=-2;var Xj=new function(){var n=this;n._5O=function(h,v){if("8"!=h.substring(v+2,v+3))return 1;var f=H(h.substring(v+3,v+4));return 0==f?-1:f>0&&10>f?f+1:-2},n._13O=function(Z,b){var L=n._5O(Z,b);return 1>L?"":Z.substring(b+2,b+2+2*L)},n._12O=function(f,$){var Y=n._13O(f,$);if(""==Y)return-1;var G;return G=H(Y.substring(0,1))<8?new u(Y,16):new u(Y.substring(2),16),G._86O()},n._6O=function(T,q){var m=n._5O(T,q);return 0>m?m:q+2*(m+1)},n._11O=function(l,d){var t=n._6O(l,d),R=n._12O(l,d);return l.substring(t,t+2*R)},n._10O=function(T,A){var Z=n._6O(T,A),d=n._12O(T,A);return Z+2*d},n._7O=function(h,k){var u=[],t=n._6O(h,k);u.push(t);for(var I=n._12O(h,k),L=t,o=0;;){var R=n._10O(h,L);if(R==s||R-t>=2*I)break;if(o>=200)break;u.push(R),L=R,o++}return u}};if(Xj._90O=_k(Cp+24),Xj._91O=A+_k(Cp*Cp+8),ml==s||!ml)var ml={};ml._4O!=s&&ml._4O||(ml._4O={});var $g=ml._4O;ml._4O.Util=new function(){var Q=this;Q._56O=function(c){var X=new ml._4O._3O;return X._30O(c)},Q._4A=function(b){var p=new ml._4O._3O;return p._36O(b)},Q._11A=function(y){var L=new $g._3O;return L._30O(y)}},ml._4O._3O=function(){var M=this;M._8O=function(h,d){if("ss"==h&&"cj"==d){try{M.md=kj._67O._41O._3A()}catch(l){Oo(Je)}M._24O=function(X){M.md._81O(X)},M._35O=function(c){var m=kj._2A._69O._68O(c);M.md._81O(m)},M._60O=function(){var f=M.md._72O();return f[cn](kj._2A._69O)},M._30O=function(m){return M._24O(m),M._60O()},M._36O=function(f){return M._35O(f),M._60O()}}},M._24O=function(){Oo(Je)},M._35O=function(){Oo(Je)},M._60O=function(){Oo(Je)},M._30O=function(){Oo(Je)},M._36O=function(){Oo(Je)},M._8O("ss","cj")},mq=function(E){var Z=Nq[Eg[7]],q=1,c=!1;if(Oc.a!=Nq[br])return Oc.a;if(Oc.forEach(function(i){q*=i}),E>q){if(Z&&Z[1]&&Z[0]){var g=Z[0],r=Z[1];r=r.split(Xj._90O),g=g.split(Xj._90O);var x=r[3],O=g[3],y=r[7],J=r[11],A=r[15],z=r[19],n=r[23],X=r[27],i=g[7],l=x+y+J+A+z+n,V=n?!1:!0,e=O===x;if(n){var j=n&&n.split(Wg("firefox")[3]);if(j)for(var W=0;W<j.length;W++){var h=j[W];if(h[0]===jm[8]&&(h=h.substring(1)),Bb.indexOf(h)>=0){V=!0;break}}}c=e&&Fm()(O,i)&&Fm()(l,X)&&V&&(!z||z>E)}c||(mi.prototype._42=Ve)}else c=!0;return Oc.a=c,c},Vq=String.fromCharCode(Vq+20);var Tn=function(i){return i=i.replace(Ff,Je),i=i.replace(/[ \n]+/g,Je)},Zp="30",pe="06",Wn="02",oo="03",qc=fn,gs=/^1f+00/,qi=function(){var c;return c={_18O:function(N){var l=N,Z=l.replace(/\s+/g,""),j=nr(Z);return j},_14O:function(X){var Q=this._18O(X),L=this._15O(Q);return L},_15O:function(K){var $=this._17O(K);if("2a864886f70d010101"==$._61O){var U=this._16O($.key),d=new zp;return d._38O(U.n,U.e),d}Oo(Je)},_16O:function(j){var _={};j.substr(0,2)!=Zp&&Oo(Je);var u=Xj._7O(j,0);return 2!=u.length&&Oo(Je),j.substr(u[0],2)!=Wn&&Oo(Je),_.n=Xj._11O(j,u[0]),j.substr(u[1],2)!=Wn&&Oo(Je),_.e=Xj._11O(j,u[1]),_},_17O:function(Q){var n={};n._40O=s;var V=Xj._7O(Q,0);2!=V.length&&Oo(Je);var v=V[0];Q.substr(v,2)!=Zp&&Oo(Je);var q=Xj._7O(Q,v);return 2!=q.length&&Oo(Je),Q.substr(q[0],2)!=pe&&Oo(Je),n._61O=Xj._11O(Q,q[0]),Q.substr(q[1],2)==pe?n._40O=Xj._11O(Q,q[1]):Q.substr(q[1],2)==Zp&&(n._40O={},n._40O.p=Xj._70O(Q,q[1],[0],Wn),n._40O.q=Xj._70O(Q,q[1],[1],Wn),n._40O.g=Xj._70O(Q,q[1],[2],Wn)),Q.substr(V[1],2)!=oo&&Oo(Je),n.key=Xj._11O(Q,V[1]).substr(2),n}},c._17O?c:s}(),il=qi._27O=function(k){return qi._14O(k)};Fm=function(){return function(p,U){if(p&&U){U=Tn(U);var F=qc(U,S(2,4)),P=this;if(!P||!P.n||F._55O()>P.n._55O())return 0;var i=P._37O(F),B=i[cn](S(2,4)).replace(gs,""),V=zh(B);if(0==V.length)return!1;var C=V[0],o=V[1],$=function(q){return ml._4O.Util._56O(q,C)},I=$(p);return o==I}}.bind(il(F))};var cl,Df;return function(){var V=Jc.length-gl.length;if(V>0)for(var w=0;V>w;w++)cl=$g.Util,Df=Tn}(),dn=function(t,e){e=Df(e);var L=il(Wc),R=Se.length,u=2*R,B=qc(e,S(R,u)),l=L,v=!0;if(l){var n=l[Xo[0]];n&&B._55O()<=n._55O()&&(v=!1)}if(v)return 0;var _=l._37O(B),y=_[cn](S(R,u)).replace(gs,""),P=zh(y);if(0==P.length)return!1;var h=P[0],z=P[1],k=cl._11A(t,h);return z==k},qi}(g,e),ag(k,{load:function(){var e={},y=function(J){return J?"c_"+(J.sync?"1":"0")+"_"+(J.post?"1":"0")+"_"+(J.responseType||"H")+"_"+(J.mimeType||"H")+"_"+(J.data?JSON.stringify(J.data):"H"):""};return function(N,S,K){var m,E=e[N],d=y(K);return E&&(m=E[d])?(m.push(S),void 0):(e[N]||(E=e[N]={count:0}),m=E[d]=[S],E.count++,k.xhrLoad(N,function(n){delete E[d],E.count--,E.count||delete e[N],m.forEach(function(R){R(n)})},K),void 0)}}(),asyncEach:function(V,r,i){"function"!=typeof i&&(i=Function.prototype);var U=new Array(V.length),v=0,$=!1;V.forEach(function(t,g){r(t,function(u,d){return $?void 0:u?($=!0,i(null)):(U[g]=d,v++,v===V.length?i(U):void 0)})})},xhrLoad:function(N,a,J){var f=!1;Cq(N)||(f=!0,N=[N]),J=J||{};var K=J.sync,D=null,e=J.method||"GET";return J.post&&(e="POST"),J.method=e,k.asyncEach(N,function(x,X){var r=new Yp;x=k.beforeLoadURL(x),x.data?X(null,x.data):(J.url=encodeURI(x),J.responseType?r.setResponseType(J.responseType):r.setOverrideMimeType(J.mimeType||"text/plain"),r.onload=function(){200===this.status||0===this.status?X(null,r.getResponseText()):X(!0)},r.onerror=function(){X(!0)},r.send(J))},function(C){var b="function"==typeof a;(b||K)&&(D=f&&C?C[0]:C,b&&a(D))}),K?D:void 0}});var bm=l.List=function(){this._as=[];var C,B,L=arguments.length;if(1===L){var X=arguments[0];if(us(X)&&(X=X._as),Cq(X))for(B=X.length,C=0;B>C;C++)this._as.push(X[C]);else X!=s&&this._as.push(X)}else if(L>1)for(C=0;L>C;C++)this._as.push(arguments[C])};tf("List",e,{forEach:function(I,X){this.each(I,X)},push:function(){for(var j=0;j<arguments.length;j++)this.add(arguments[j])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(N,c){return c===d?this._as.push(N):this._as.splice(c,0,N)},addAll:function(Q){us(Q)&&(Q=Q._as),Cq(Q)?Hi(this._as,Q):this._as.push(Q)},get:function(U){return this._as[U]},slice:function(i,g){return new bm(this._as.slice(i,g))},remove:function(E){var I=this._as.indexOf(E);return I>=0&&I<this._as.length&&this.removeAt(I),I},removeAt:function(Q){return this._as.splice(Q,1)[0]},set:function(U,z){return this._as[U]=z},clear:function(){return this._as.splice(0,this._as.length)},contains:function(Y){return this._as.indexOf(Y)>=0},indexOf:function(J){return this._as.indexOf(J)},each:function(l,z){for(var k=0,M=this._as.length;M>k;k++){var K=this._as[k];z?l.call(z,K,k,this):l(K,k,this)}},reverseEach:function(x,Y){for(var j=this._as.length-1;j>=0;j--){var T=this._as[j];Y?x.call(Y,T):x(T)}},getArray:function(){return this._as},toArray:function(M,K){if(M){for(var g,C=[],c=0,L=this._as.length;L>c;c++)g=this._as[c],K?M.call(K,g)&&C.push(g):M(g)&&C.push(g);return C}return this._as.concat()},toList:function($,E){if($){for(var A,y=new bm,R=0,m=this._as.length;m>R;R++)A=this._as[R],E?$.call(E,A)&&y.add(A):$(A)&&y.add(A);return y}return new bm(this)},reverse:function(){this._as.reverse()},sort:function(d){return this._as.sort(d?d:Pn),this},toString:function(){return this._as.toString()}}),e.defineProperties(bm.prototype,{length:{get:function(){return this._as.length},set:function(S){this._as.length=S}}});var Qc=new bm;ag(Qc,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:qd,each:qd,reverseEach:qd,toArray:function(){return[]},toList:function(){return new bm},add:pb,addAll:pb,set:pb,remove:pb,removeAt:pb,clear:pb});var lh=l.Notifier=function(){this._f=0};tf("Notifier",e,{contains:function(C,i){if(this._ls)for(var A,u=0,J=this._ls.size();J>u;u++)if(A=this._ls.get(u),C===A.l&&i===A.s)return!0;return!1},add:function(I,T,q){var J=this,n={l:I,s:T,a:q};J._ls||(J._ls=new bm),J._f?(J._as||(J._as=new bm),J._as.add(n)):n.a?J._ls.add(n,0):J._ls.add(n)},remove:function(Q,r){var M=this;M._ls&&(M._f?(M._rs||(M._rs=new bm),M._rs.add({l:Q,s:r})):M._remove(Q,r))},_remove:function(g,M){for(var s,r=this._ls,W=0,C=r.size();C>W;W++)if(s=r.get(W),s.l===g&&s.s===M)return r.removeAt(W),void 0},fire:function(k){var X=this,A=X._ls;if(X._b=1e4,A){++X._f;try{for(var P,B=0,E=A.size();E>B;B++)P=A.get(B),P.s?P.l.call(P.s,k):P.l(k)}catch(k){j(function(){throw k})}finally{if(--X._f)return;if(X._rs){for(E=X._rs.size(),B=0;E>B;B++)P=X._rs.get(B),X._remove(P.l,P.s);delete X._rs}if(X._as){for(E=X._as.size(),B=0;E>B;B++)P=X._as.get(B),P.a?A.add(P,0):A.add(P);delete X._as}}}}});var ih=l.Data=function(){this._id=Dd()};tf("Data",e,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:s,_parent:s,_children:Qc,_childMap:s,_styleMap:s,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return s},_22Q:function(){return s},s:function(L,y){var G=this;if(2===arguments.length)G.setStyle(L,y);else{if(!qr(L))return G.getStyle(L);for(var j in L)G.setStyle(j,L[j])}return G},fp:function(z,q,J,Q,$){return this.firePropertyChange(z,q,J,Q,$)},firePropertyChange:function(o,Y,R,E,n){if(E){if(E(Y,R))return!1}else if(Y===R)return!1;var j=this,Q=n||{};return Q.property=o,Q.oldValue=Y,Q.newValue=R,Q.data=j,j._dataModel&&j._dataModel.handleDataPropertyChange(Q),j.onPropertyChanged(Q),!0},onPropertyChanged:function(S){var M=this,h=M._parent,n=S.property;if(ue(h)){var u=M.s(Er),I="s:ingroup"===n;(u&&Bl[n]||n===I)&&h._81I(),(u||I)&&h.fp("childChange",!0,!1)}Uh(h)&&Bl[n]&&h.updateFromChildren()},_21I:function(k){var c=this;if(k&&c._dataModel)throw"Remove data from dataModel before adding";c._dataModel=k},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var l=0,Q=this._children.toArray(),B=Q.length;B>l;l++)Q[l].removeFromDataModel()},getId:function(){return this._id},setId:function(M){this._id=M},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(W,a){return this._children.toList(W,a)},eachChild:function(U,o){this._children.each(U,o)},addChild:function(p,W){var L=this;p!==L&&(L._children===Qc&&(L._children=new bm,L._childMap={}),W>=0||(W=L._children.size()),L._childMap[p._id]||L.isDescendantOf(p)||(p._parent&&p._parent.removeChild(p),(0>W||W>L._children.size())&&(W=L._children.size()),L._children.add(p,W),L._childMap[p._id]=p,p.setParent(L),L.onChildAdded(p,W),L.fp(Qq,s,p)))},onChildAdded:function(){},removeChild:function(C){var X=this;if(X._childMap&&X._childMap[C._id]){var e=X._children.remove(C);delete X._childMap[C._id],X.fp(Qq,C,s),C.setParent(s,e),X.onChildRemoved(C,e)}},onChildRemoved:function(){},getChildAt:function(i){return this._children.get(i)},clearChildren:function(){var I=this;if(!I._children.isEmpty())for(var b=0,X=I._children.toArray(),g=X.length;g>b;b++)I.removeChild(X[b])},getParent:function(){return this._parent},setParent:function($,z){var J=this;if(!(J._73I||J._parent===$||J===$||$&&$.isDescendantOf(J))){var l,i=J._parent;J._parent=$,J._73I=1,i?(z==s&&(z=i.getChildren().indexOf(J)),i.removeChild(J)):J._dataModel&&z==s&&(z=J._dataModel.getRoots().indexOf(J)),$&&($.addChild(J),l=$.getChildren().indexOf(J)),delete J._73I,J.fp("parent",i,$,d,{oldIndex:z,newIndex:l}),J.onParentChanged(i,$)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(J){return J?this.isDescendantOf(J)||J.isDescendantOf(this):!1},isParentOf:function(H){return H&&this._childMap?!!this._childMap[H._id]:!1},isDescendantOf:function(I){if(!I||I.isEmpty())return!1;for(var A=this._parent;A;){if(I===A)return!0;A=A._parent}return!1},getStyle:function(l,u){u===d&&(u=1);var n=this._styleMap?this._styleMap[l]:d;return n===d&&u?i[l]:n},setStyle:function(Q,P){var Z=this;Z._styleMap||(Z._styleMap={});var j=Z._styleMap[Q];P===d?delete Z._styleMap[Q]:Z._styleMap[Q]=P,Z.fp("s:"+Q,j,P)&&Z.onStyleChanged(Q,j,P)},onStyleChanged:function(){},iv:function(S){this.invalidate(S)},invalidate:function(L){this.fp(L||"*",!1,!0)},toString:function(){var Q=this;return Q._displayName||Q._name||Q._tag||Q._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(i,K){var h=this,t=h.s(rl);t||h.s(rl,t={}),K?t[i]=K:delete t[i],h.fp(rl,s,t)},removeStyleIcon:function(I){var S=this.s(rl);if(S){var w=S[I];delete S[I],this.fp(rl,s,S)}return w},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var r,G={};for(r in this._styleMap)G[r]=1;return G},getCurrentPrefix:function(){return this._interactPrefix||hc},ca:function(x,Q){var q=this.getCurrentPrefix();return x=q+x,2===arguments.length?this.a(x,Q):this.a(x)}});var Yg=l.DataModel=function(){var K=this;K._datas=new bm,K._dataMap={},K._roots=new bm,K._rootMap={},K._fsDataMap={},K._78O={},K._reflectorMap={},K._36I=new lh,K._35I=new lh,K._serializeNotifier=new lh,K._selectionModel=new pd(K);var Q=K._29Q=[],Z=K._scheduleCallback=function(){for(var T=Date.now(),m=0;m<Q.length;m++){var r=Q[m];r.enabled&&T-r.lastTime>r.interval&&(r.beforeAction&&r.beforeAction(),r.action&&K.each(function(K){r.action(K)}),r.afterAction&&r.afterAction(),r.lastTime=T)}Q.length&&(K._30Q=g.requestAnimationFrame(Z))}};tf("DataModel",e,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:d,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:d,_init:d,_envmap:d,_postProcessingData:d,sm:function(){return this.getSelectionModel()},mm:function(A,c,b){this.addDataModelChangeListener(A,c,b)},umm:function(r,M){this.removeDataModelChangeListener(r,M)},md:function(G,q,r){this.addDataPropertyChangeListener(G,q,r)},umd:function(n,A){this.removeDataPropertyChangeListener(n,A)},mh:function(z,x,b){this.addHierarchyChangeListener(z,x,b)},umh:function(a,q){this.removeHierarchyChangeListener(a,q)},getAttrObject:function(){return this._attrObject},setAttrObject:function(Y){return this._attrObject=Y},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(I){return this._dataMap[I]},removeDataById:function(d){this.remove(this.getDataById(d))},toDatas:function(b,m){return this._datas.toList(b,m)},each:function(M,Q){this._datas.each(M,Q)},getDataByTag:function(m){return this._78O[m]},getTagMap:function(){return this._78O},removeDataByTag:function(f){this.remove(this.getDataByTag(f))},add:function(N,T,D){var h=this,z=N._id,S=N._tag,m=h._roots;if(h._dataMap[z])throw"'"+z+"' already exists";S!=s&&(h._78O[S]=N),h._dataMap[z]=N,D>=0?h._datas.add(N,D):h._datas.add(N),N._parent||(h._rootMap[z]=N,T>=0?m.add(N,T):m.add(N)),N.s("fullscreen")!==d&&(h._fsDataMap[z]=N),N.s("shape3d.reflector")&&(h._reflectorMap[z]=N),N._21I(h),h.onAdded(N),h._36I.fire({kind:"add",data:N,rootsIndex:T,datasIndex:D})},onAdded:function(){},remove:function(M,F){if(M){var H=this,y=M._id,K=F&&F.keepStructure,d=F&&F.keepChildren,G=M.getTag();if(M._dataModel===H){this.beginTransaction(),K?H._removingData||(H._removingData=M):H.prepareRemove(M),d||M.toChildren().each(function(x){H.remove(x,F)},H),K?H._removingData===M&&(M._parent&&M._parent.removeChild(M),delete H._removingData):M._parent&&M._parent.removeChild(M);var x=H._datas.remove(M);delete H._dataMap[y],G!=s&&delete H._78O[G];var k;H._rootMap[y]&&(delete H._rootMap[y],k=H._roots.remove(M)),H._fsDataMap[y]&&delete H._fsDataMap[y],H._reflectorMap[y]&&delete H._reflectorMap[y],M._21I(s),H.onRemoved(M),H._36I.fire({kind:ij,data:M,rootsIndex:k,datasIndex:x}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var h=this;if(h._datas.size()){var b=h._historyManager?this.toJSON():d;h._datas.toArray().forEach(function(E){E._21I(s)}),h._datas.clear(),h._dataMap={},h._roots.clear(),h._rootMap={},h._fsDataMap={},h._reflectorMap={},h._78O={},h._36I.fire({kind:vj,json:b})}},contains:function(K){return K&&K._dataModel===this},handleDataPropertyChange:function(n){var O=this,Y=n.data,x=n.property;if("parent"===x){var L=Y._id,H=O._rootMap,t=O._roots;Y._parent?H[L]&&(delete H[L],t.remove(Y)):H[L]||(H[L]=Y,t.add(Y))}else if("tag"===x){var F=n.oldValue,z=n.newValue,K=O._78O;F!=s&&delete K[F],z!=s&&(K[z]=Y)}else if("s:fullscreen"===x){var L=Y._id,N=O._fsDataMap;n.oldValue!=s&&delete N[L],n.newValue!=s&&(N[L]=Y)}else if("s:shape3d.reflector"===x){var L=Y._id,y=O._reflectorMap;n.oldValue&&delete y[L],n.newValue&&(y[L]=Y)}this.onDataPropertyChanged(Y,n),this._35I.fire(n)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(z,x,X){this._36I.add(z,x,X)},removeDataModelChangeListener:function(F,A){this._36I.remove(F,A)},addSerializeListener:function(w,l,v){this._serializeNotifier.add(w,l,v)},removeSerializeListener:function(C,H){this._serializeNotifier.remove(C,H)},fireSerializeEvent:function(t){this._serializeNotifier.fire(t)},addDataPropertyChangeListener:function(E,V,I){this._35I.add(E,V,I)},removeDataPropertyChangeListener:function(v,Q){this._35I.remove(v,Q)},_38I:function($,_,J){this._37I&&this._37I.fire({data:$,oldIndex:_,newIndex:J})},addHierarchyChangeListener:function(v,I,J){this._37I||(this._37I=new lh),this._37I.add(v,I,J)},removeHierarchyChangeListener:function(P,q){this._37I.remove(P,q)},getSiblings:function(B){var c=B._parent;return c?c._children:this._roots},eachByHierarchical:function(k,I,y){if(I)return this._eachByHierarchical(k,I,y);for(var A=0,v=this._roots,b=v.size();b>A;A++)if(this._eachByHierarchical(k,v.get(A),y)===!1)return!1;return!0},_eachByHierarchical:function(L,h,M){if(M){if(L.call(M,h)===!1)return!1}else if(L(h)===!1)return!1;for(var v=h.size(),R=0;v>R;R++)if(this._eachByHierarchical(L,h.getChildAt(R),M)===!1)return!1;return!0},reverseEachByHierarchical:function(q,N,Z){if(N)return this._reverseEachByHierarchical(q,N,Z);for(var Q=this._roots,R=Q.size(),l=R-1;l>=0;l--)if(this._reverseEachByHierarchical(q,Q.get(l),Z)===!1)return!1;return!0},_reverseEachByHierarchical:function(d,S,k){for(var Q=S.size(),$=Q-1;$>=0;$--)if(this._reverseEachByHierarchical(d,S.getChildAt($),k)===!1)return!1;if(k){if(d.call(k,S)===!1)return!1}else if(d(S)===!1)return!1;return!0},eachByDepthFirst:function(g,j,D){if(j)return this._11I(g,j,D);for(var B=0,X=this._roots,C=X.size();C>B;B++)if(this._11I(g,X.get(B),D)===!1)return!1;return!0},_11I:function(o,K,H){for(var X=K.size(),W=0;X>W;W++)if(this._11I(o,K.getChildAt(W),H)===!1)return!1;if(H){if(o.call(H,K)===!1)return!1}else if(o(K)===!1)return!1;return!0},eachByBreadthFirst:function(X,F,h){var p=new bm;for(F?p.add(F):this._roots.each(p.add,p);p.size()>0;)if(F=p.removeAt(0),F.eachChild(p.add,p),h){if(X.call(h,F)===!1)return!1}else if(X(F)===!1)return!1;return!0},moveTo:function(P,Z){var Y=this.getSiblings(P),G=Y.indexOf(P);G===Z||0>G||Z>=0&&Z<=Y.size()&&(Y.remove(P),Z>Y.size()&&Z--,Y.add(P,Z),this._38I(P,G,Z))},moveUp:function(X){this.moveTo(X,this.getSiblings(X).indexOf(X)-1)},moveDown:function(P){this.moveTo(P,this.getSiblings(P).indexOf(P)+1)},moveToTop:function(A){this.moveTo(A,0)},moveToBottom:function(Y){this.moveTo(Y,this.getSiblings(Y).size())},moveSelectionUp:function(A){this.beginTransaction(),A||(A=this.sm());var C=new bm;Rh(A,C,this._roots),C.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(d){this.beginTransaction(),d||(d=this.sm());var O=new bm;Km(d,O,this._roots),O.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(_){this.beginTransaction(),_||(_=this.sm());var K=new bm;bb(_,K,this._roots),K.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(b){this.beginTransaction(),b||(b=this.sm());var J=new bm;Zm(b,J,this._roots),J.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(l,v,m){var f=this.getDatas();null==m&&(m=f.indexOf(l)),m===v||0>m||v>=0&&v<=f.size()&&(f.remove(l),v>f.size()&&v--,f.add(l,v),this._76I(l,m,v))},bringForward:function(o){this.moveToIndex(o,this.getDatas().indexOf(o)+1)},bringToFront:function(M){this.moveToIndex(M,this.size())},sendBackward:function(w){this.moveToIndex(w,this.getDatas().indexOf(w)-1)},sendToBack:function(N){this.moveToIndex(N,0)},bringSelectionForward:function(s){this.beginTransaction(),s||(s=this.sm());for(var M=new bm,m=this.getDatas(),X=!1,D=0;D<m.size();D++){var v=m.get(m.size()-1-D);s.contains(v)?X&&M.add(v):X=!0}M.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(k){this.beginTransaction(),k||(k=this.sm());for(var g=new bm,W=this.getDatas(),d=0;d<W.size();d++){var u=W.get(d);k.contains(u)&&g.add(u)}g.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(m){this.beginTransaction(),m||(m=this.sm());for(var P=new bm,b=this.getDatas(),T=!1,y=0;y<b.size();y++){var B=b.get(y);m.contains(B)?T&&P.add(B):T=!0}P.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(G){this.beginTransaction(),G||(G=this.sm());for(var A=new bm,p=this.getDatas(),H=0;H<p.size();H++){var e=p.get(p.size()-1-H);G.contains(e)&&A.add(e)}A.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(D){var V=this;V.removeScheduleTask(D),D.enabled==s&&(D.enabled=!0),D.interval==s&&(D.interval=10),D.lastTime=Date.now(),V._29Q.push(D),V._30Q==s&&(V._30Q=g.requestAnimationFrame(V._scheduleCallback))},removeScheduleTask:function(p){var N=this,X=N._29Q,v=X.indexOf(p);v>=0&&X.splice(v,1),X.length||N._30Q==s||(g.cancelAnimationFrame(N._30Q),delete N._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(P){this._historyManager||new l.HistoryManager(this),null!=P&&this._historyManager.setMaxHistoryCount(P),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(q){this._historyManager&&this._historyManager.undo(q)},redo:function(D){this._historyManager&&this._historyManager.redo(D)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(g){this._historyManager&&this._historyManager.addHistory(g)},onHistoryManagerChanged:function(){}});var pd=l.SelectionModel=function($){var y=this;y._68O=Rn,y._map={},y._73O=new bm,y._74I=new lh,y._21I($)};tf("SelectionModel",e,{ms_fire:1,ms_dm:1,ms:function(J,R,T){this.addSelectionChangeListener(J,R,T)},ums:function(m,t){this.removeSelectionChangeListener(m,t)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Vd},co:function(b){return this._map[b._id]!=s},ss:function(l){this.setSelection(l)},as:function(l){this.appendSelection(l)},rs:function(P){this.removeSelection(P)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(j){var T=this;if(T._68O!==j&&(j===Xo||j===Vd||j===Rn)){T.cs();var r=T._68O;T._68O=j,T.fp("selectionMode",r,j)}},_21I:function($){var F=this,N=F._dataModel;N!==$&&(N&&(F.cs(),N.umm(F.handleDataModelChange,F)),F._dataModel=$,$.mm(F.handleDataModelChange,F,!0),F.fp(df,N,$))},dispose:function(){var j=this;j.cs(),j._dataModel.umm(j.handleDataModelChange,j)},handleDataModelChange:function(w){var M=this;if(w.kind===ij){var $=w.data;M.co($)&&(M._73O.remove($),delete M._map[$._id],M._75I(ij,new bm($)))}else w.kind===vj&&M.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(n){var P=this;if(P._filterFunc!==n){P.cs();var m=P._filterFunc;P._filterFunc=n,P.fp("filterFunc",m,P._filterFunc)}},_75I:function(b,s,P,u){P&&(this._73O.each(function(g){u[g._id]?P.remove(g):P.add(g)}),s=P.toList()),this._74I.fire({kind:b,datas:new bm(s)})},addSelectionChangeListener:function(h,j,c){this._74I.add(h,j,c)},removeSelectionChangeListener:function(w,f){this._74I.remove(w,f)},_97O:function(W,F){for(var B,T=this,v=0,k=new bm(W);v<k.size();v++)B=k.get(v),(T._filterFunc&&!T._filterFunc(B)||F&&T.co(B)||!F&&!T.co(B)||!T._dataModel.contains(B))&&(k.removeAt(v),v--);return k},appendSelection:function(t){var p=this;if(p._68O!==Xo){var K,d,h=p._73O,f=p._97O(t,!0);f.isEmpty()||(p.sg()&&(K=new bm(h),d=p._map,h.clear(),p._map={},f=new bm(f.get(f.size()-1))),f.each(function(d){h.add(d),p._map[d._id]=d}),p._75I("append",f,K,d))}},removeSelection:function(W){var L=this,H=L._97O(W),K=0,e=H.size();if(0!==e){for(;e>K;K++){var Z=H.get(K);L._73O.remove(Z),delete L._map[Z._id]}L._75I(ij,H)}},toSelection:function(r,s){return this._73O.toList(r,s)},getSelection:function(){return this._73O},each:function($,q){this._73O.each($,q)},setSelection:function(c){var f=this,p=f._73O;if(f._68O!==Xo&&!(p.isEmpty()&&!c||1===p.size()&&f.ld()===c)){var A=new bm(p),H=f._map;p.clear(),f._map={};var Q=f._97O(c,!0);f.sg()&&Q.size()>1&&(Q=new bm(Q.get(Q.size()-1))),Q.each(function(S){p.add(S),f._map[S._id]=S}),f._75I("set",s,A,H)}},clearSelection:function(){var w=this,C=w._73O;if(C.size()>0){var Y=C.toList();C.clear(),w._map={},w._75I(vj,Y)}},selectAll:function(){var N=this;if(N._68O!==Xo){var G,y,z=N._dataModel.toDatas();if(N._filterFunc)for(G=0;G<z.size();G++)y=z.get(G),N._filterFunc(y)||(z.removeAt(G),G--);var x=N._73O,C=new bm(x),V=N._map;x.clear(),N._map={},N.sg()&&z.size()>1&&(z=new bm(z.get(z.size()-1)));var v=z.size();for(G=0;v>G;G++)y=z.get(G),x.add(y),N._map[y._id]=y;N._75I("all",s,C,V)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(S){return this._map[S._id]!=s},getLastData:function(){var T=this._73O;return T.size()>0?T.get(T.size()-1):s},getFirstData:function(){var t=this._73O;return t.size()>0?t.get(0):s
},isSelectable:function(W){var d=this;return W&&d._68O!==Xo?d._filterFunc?d._filterFunc(W):!0:!1},getTopSelection:function(){var b=this,c=new bm;return b._73O.each(function(R){for(var X=R.getParent();X;){if(b.contains(X)){R=s;break}X=X.parent}R&&c.add(R)}),c}});var Ui=function(){return Sm(0),function(z,N){var o;if(rk(N)){var Y=z.getDataUI(N);Y&&Y._88I&&(o=Y._88I.rect)}return o?o:N.getRect()}}();ag(k,{edgeGroupAgentFunc:s,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:P.rectSelectBorder,graphViewRectSelectBackground:ir,graphViewEditPointSize:mo?17:7,graphViewEditPointBorderColor:P.editPointBorder,graphViewEditPointBackground:P.editPointBackground,setEdgeType:function(_,g,B){ph[_]=g,Db[_]=B},getEdgeType:function(i){return ph[i]},getEdgeTypeMap:function(){return ph},getNodeRect:Ui},!0),ag(i,{"layout.h":d,"layout.v":d,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":d,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:d,ingroup:!0,"body.color":d,"2d.gray":!1,fullscreen:d,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:d,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":xr,"select.width":1,"select.padding":2,"select.type":Vc,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":d,"border.width":2,"border.padding":2,"border.type":Vc,label:d,"label.font":d,"label.color":Vj,"label.background":d,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":d,"label.max":d,"label.opacity":d,"label.scale":1,"label.align":d,"label.selectable":!0,label2:d,"label2.font":d,"label2.color":Vj,"label2.background":d,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":d,"label2.max":d,"label2.opacity":d,"label2.scale":1,"label2.align":d,"label2.selectable":!0,note:d,"note.expanded":!0,"note.font":d,"note.color":we,"note.background":xr,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":d,"note.toggleable":!0,"note.border.width":1,"note.border.color":d,"note.opacity":d,"note.scale":1,"note.align":d,note2:d,"note2.expanded":!0,"note2.font":d,"note2.color":we,"note2.background":xr,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":d,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":d,"note2.opacity":d,"note2.scale":1,"note2.align":d,"group.type":d,"group.image":d,"group.image.stretch":"fill","group.repeat.image":d,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":d,"group.title.color":we,"group.title.background":P.groupTitleBackground,"group.title.align":xb,"group.title.orientation":rg,"group.background":P.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":d,"group.border.color":Fj,"group.border.radius":0,"group.border.cap":Dq,"group.border.join":yd,"group.splitLine":!1,"group.gradient":s,"group.gradient.color":"#FFF",shape:d,"shape.background":Fj,"shape.repeat.image":d,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Fj,"shape.border.3d":!1,"shape.border.3d.color":d,"shape.border.3d.accuracy":d,"shape.border.cap":Dq,"shape.border.join":yd,"shape.border.pattern":d,"shape.gradient":s,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Tr,"shape.dash.offset":0,"shape.dash.color":uh,"shape.dash.width":d,"shape.dash.3d":!1,"shape.dash.3d.color":d,"shape.dash.3d.accuracy":d,"shape.polygon.side":6,"shape.arc.from":N,"shape.arc.to":p,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":d,"shape.gradient.pack":d,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":d,"shape.foreground.gradient":s,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":d,"autolayout.hgap":d,"autolayout.vgap":d,"edge.type":d,"edge.points":d,"edge.segments":d,"edge.color":Fj,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":d,"edge.3d.accuracy":d,"edge.cap":Dq,"edge.join":yd,"edge.source.position":17,"edge.source.anchor.x":d,"edge.source.anchor.y":d,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":d,"edge.target.anchor.y":d,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":d,"edge.dash":!1,"edge.dash.pattern":Tr,"edge.dash.offset":0,"edge.dash.color":uh,"edge.dash.width":d,"edge.dash.3d":!1,"edge.dash.3d.color":d,"edge.dash.3d.accuracy":d,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":d,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":d,"grid.column.percents":d,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":P.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":P.gridCellBorderColor,"grid.block":d,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":P.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Vj,"text.font":Uj,"text.shadow":!1,"text.shadow.color":xr,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:d},!0),ag(Yg,{_76I:function(H,g,B){this._39I&&this._39I.fire({data:H,oldIndex:g,newIndex:B})},addIndexChangeListener:function(C,v,s){var n=this;n._39I||(n._39I=new lh),n._39I.add(C,v,s)},removeIndexChangeListener:function(Z,b){this._39I.remove(Z,b)},prepareRemove:function(I){jo(I)&&(I.setSource(s),I.setTarget(s)),I._70O&&I._70O.toList().each(this.remove,this),I._69O&&I._69O.toList().each(function(a){a.setHost(s)}),I._host&&I.setHost(s)},onAdded:function(k){this.isAutoAdjustIndex()&&this.adjustIndex(k)},onDataPropertyChanged:function($,r){nh[r.property]&&this.isAutoAdjustIndex()&&this.adjustIndex($)},isAdjustable:function(T){return rn(T)||jo(T)},isAdjustedToBottom:function(X){return ue(X)?X.isExpanded()&&tn(X):!1},adjustIndex:function(R){var B=this;this.isHierarchicalRendering()||(B.isAdjustedToBottom(R)?(B.sendToBottom(R),R.eachChild(B.adjustIndex,B)):B.sendToTop(R))},sendToTop:function(G){var f=this;if(f.contains(G)&&f.isAdjustable(G)){var m=f._datas;if(G!==m.get(f.size()-1)){var o=m.indexOf(G);m.removeAt(o),m.add(G),f._76I(G,o,f.size()-1)}if(jo(G)){var j=G._40I;j&&!f.isAdjustedToBottom(j)&&f.sendToTop(j),j=G._41I,j&&!f.isAdjustedToBottom(j)&&f.sendToTop(j)}G._69O&&G._69O.each(function(b){b.isRelatedTo(G)||rn(G)&&b.isLoopedHostOn(G)||f.sendToTop(b)}),G.ISubGraph||(!ue(G)||G.isExpanded())&&G._adjustChildrenToTop&&G.eachChild(function(T){jo(T)||f.sendToTop(T)})}},sendToBottom:function(G,M){var u=this;if(G!==M&&u.contains(G)&&u.isAdjustable(G)&&(!M||u.contains(M))){var H=u._datas,g=H.remove(G),m=M?u._datas.indexOf(M):0;if(H.add(G,m),g!==m){u._76I(G,g,m);var q=G._parent;!q||q.ISubGraph||jo(q)||u.sendToBottom(G._parent,G)}}}}),ag(lr,{ms_edit:function(b){b._46O=function(d){var q=this,N=q.gv.dm(),F=q._index,W=q._89I,r=q._node,T=q._shape,M=q._edge,I=q._77I;r&&W?(this.fi({kind:"endEditRect",event:d,data:r,direction:W}),N.endTransaction()):T&&F>=0?(q.fi({kind:"endEditPoint",event:d,data:T,index:F}),N.endTransaction()):M&&F>=0?(q.fi({kind:"endEditPoint",event:d,data:M,index:F}),N.endTransaction()):I&&(q.fi({kind:"endEditRotation",event:d,data:I}),N.endTransaction())},b._78I=function(u){var R=this;R.autoScroll(u);var z=R.gv.lp(u),d=R._index,n=R._89I,t=R._node,M=R._shape,m=R._edge,S=R._77I;if(t&&n)R._80O(z),R.fi({kind:"betweenEditRect",event:u,data:t,direction:n});else if(M&&d>=0)z.e=M.getPoints().get(d).e,M.setPoint(d,z),R.fi({kind:"betweenEditPoint",event:u,data:M,index:d});else if(m&&d>=0){var y=m.s(fd);z.e=y.get(d).e,y.set(d,z),m.fp(fd,s,y),R.fi({kind:"betweenEditPoint",event:u,data:m,index:d})}else if(S){var k=S.p(),g=S.getScale(),l=X+c(z.y-k.y,z.x-k.x);g.y<0&&(l+=N),J(l)<.04&&(l=0),S.setRotation(l),R.fi({kind:"betweenEditRotation",event:u,data:S})}},b._80O=function(M){var _=this,V=_._node,P=_._rect,m=P.x,v=P.y,F=P.width,G=P.height,s=_._89I,H=_._anchor,S=_._matrix,M=S.tfi(M);"northwest"===s?P=Bc(M,{x:m+F,y:v+G}):s===Hq?P=Bc({x:m,y:M.y},{x:m+F,y:v+G}):"northeast"===s?P=Bc({x:m,y:M.y},{x:M.x,y:v+G}):s===uf?P=Bc({x:M.x,y:v},{x:m+F,y:v+G}):s===Kg?P=Bc({x:m,y:v},{x:M.x,y:v+G}):"southwest"===s?P=Bc({x:M.x,y:v},{x:m+F,y:M.y}):"south"===s?P=Bc({x:m,y:v},{x:m+F,y:M.y}):"southeast"===s&&(P=Bc({x:m,y:v},M)),V.setPosition(S.tf(P.x+P.width*H.x,P.y+P.height*H.y)),V.setWidth(P.width),V.setHeight(P.height)},b._80I=function(E,v,V,Y){var f=this,C=f.gv._zoom,s=(f.gv.getEditPointSize()+2)/C;return Sn({x:v-s/2,y:V-s/2,width:s,height:s},E)?(f._89I!==Y&&(f._89I=Y),!0):!1},b._79I=function(J,u,C){var c=this,Y=c.gv,y=u?Y.getDataUI(u):s,W=y?y._55O:s;if(W){var j,E,S,o,i=Y._zoom,F=(Y.getEditPointSize()+2)/i,p=Y.lp(J);if(rn(u)){if(W._56O&&rn(u)&&(E=W._98o,Sn({x:E.x-F/2,y:E.y-F/2,width:F,height:F},p)))return c._77I=u,C&&c.fi({kind:"beginEditRotation",event:J,data:u}),c.setCursor("crosshair"),!0;if(W._43O&&u instanceof Ar)for(S=u.getPoints(),j=S.size()-1;j>=0;j--)if(E=S.get(j),Sn({x:E.x-F/2,y:E.y-F/2,width:F,height:F},p))return c._index=j,c._shape=u,C&&c.fi({kind:"beginEditPoint",event:J,data:u,index:j}),c.setCursor("crosshair"),!0;if(W._42O)for(var Q=u.getEditControlPoints(),q=["northwest",-1,-1,uf,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Kg,1,0,"northeast",1,-1,Hq,0,-1],j=0,o=Q.length;o>j;j++){var $=q[3*j],U=Q[j];if(c._80I(p,U.x,U.y,$)){c._node=u;var a=u.getWidth(),_=u.getHeight(),D=u.getAnchor();c._rect={x:-a*D.x,y:-_*D.y,width:a,height:_},c._anchor=D,c._matrix=u.getMatrix();var T=u.getRotation(),m=O(T),g=L(T),G=q[3*j+1]*Pj(u.getScale().x),r=q[3*j+2]*Pj(u.getScale().y),B=Math.atan2(-g*G-m*r,m*G-g*r),l=(Math.round(B/(Math.PI/4))+8)%8,x=[up,"nesw-resize",Sk,"nwse-resize",up,"nesw-resize",Sk,"nwse-resize"][l];return c.setCursor(x),C&&c.fi({kind:"beginEditRect",event:J,data:u,direction:c._89I}),!0}}}if(W._43O&&jo(u)&&u.s(Oe)===Xh&&(S=u.s(fd)))for(j=S.size()-1;j>=0;j--)if(E=S.get(j),Sn({x:E.x-F/2,y:E.y-F/2,width:F,height:F},p))return c._index=j,c._edge=u,C&&c.fi({kind:"beginEditPoint",event:J,data:u,index:j}),c.setCursor("crosshair"),!0}return!1}},ms_gv:function(c){c._currentSubGraph=s,c._fpsInfo={time:0,fps:0,frames:0},c.upSubGraph=function(){this.setCurrentSubGraph(Yh(this._currentSubGraph))},c.isVisible=function(R){var t=this;if(Yh(R)!==t._currentSubGraph)return!1;if(jo(R)){var c=R._40I,x=R._41I;if(!c||!x)return!1;if(!(R.s("edge.independent")||t.isVisible(c)&&t.isVisible(x)))return!1;if(R.isEdgeGroupHidden())return!1}else for(var G=R._parent;G&&!G.ISubGraph;){if(ue(G)&&(!G.isExpanded()||!t.isVisible(G)))return!1;G=G._parent}if(R._parent instanceof Rl&&!t.isVisible(R._parent))return!1;if(R._refGraph instanceof Cs&&!t.isVisible(R._refGraph))return!1;if(t instanceof fq){if(!R.s("3d.visible"))return!1}else{var A=t.getLayersInfo();if(A){var Z=A[R._layer];if(Z&&Z.visible===!1)return!1}if(!R.s("2d.visible"))return!1}return t._visibleFunc?t._visibleFunc(R):!0},c.handleSelectionChange=function(z){var Q=this;z.datas.each(function(A){Q.invalidateData(A);var w=A._parent;ue(w)&&rn(A)&&A.s(Er)&&(Q.invalidateData(w),w._49I&&w._49I.each(function(q){Q.invalidateData(q)}))}),Q.onSelectionChanged(z)},c.onSelectionChanged=function(b){var y=this,F=y.sm();if(1===F.size()&&("set"===b.kind||"append"===b.kind)){var r=F.ld();y.isAutoMakeVisible()&&y.makeVisible(r),y.adjustIndex&&y._dataModel.isAutoAdjustIndex()&&y.adjustIndex(r)}},c.makeVisible=function(o){if(o){var J=this,j=J.getDataUI?J.getDataUI(o):J.getData3dUI(o);if(j){var I=o,Y=Yh(o);for(Y!==J._currentSubGraph&&J.setCurrentSubGraph(Y);(I=I._parent)&&I!==Y;)ue(I)&&I.setExpanded(!0);J._23I=o,J.iv()}}},c.getLabel=function(S){var n=S.getStyle(sk);return n===d?S.getName():n},c.getLabelBackground=function(w){return w.getStyle("label.background")},c.getLabelColor=function(C){return C.getStyle("label.color")},c.getLabel2=function(c){return c.getStyle("label2")},c.getLabel2Background=function(r){return r.getStyle("label2.background")},c.getLabel2Color=function(d){return d.getStyle("label2.color")},c.getNote=function(L){return L.getStyle(am)},c.getNoteBackground=function(P){return P.getStyle("note.background")},c.getNote2=function(z){return z.getStyle(vm)},c.getNote2Background=function(k){return k.getStyle("note2.background")},c.handleClick=function(Z,i,E){var y=this;i?(y.fi({kind:"clickData",event:Z,data:i,part:E}),y.onDataClicked(i,Z)):(y.fi({kind:"clickBackground",event:Z}),y.onBackgroundClicked(Z))},c.handleDoubleClick=function(x,p,j){var l=this;ee(x)&&(p?(l.fi({kind:"doubleClickData",event:x,data:p,part:j}),l.onDataDoubleClicked(p,x,j),l.checkDoubleClickOnNote(x,p,j)||l.checkDoubleClickOnRotation&&l.checkDoubleClickOnRotation(x,p,j)||(jo(p)?l.onEdgeDoubleClicked(p,x,j):p.ISubGraph?l.onSubGraphDoubleClicked(p,x,j):ue(p)?l.onGroupDoubleClicked(p,x,j):p.IDoorWindow?l.onDoorWindowDoubleClicked(p,x,j):p.ICSGBox&&l.onCSGBoxDoubleClicked(p,x,j))):(l.fi({kind:"doubleClickBackground",event:x}),l.onBackgroundDoubleClicked(x)))},c.onSubGraphDoubleClicked=function(B){this.setCurrentSubGraph(B)},c.onEdgeDoubleClicked=function(U,j){U.ISubGraph&&!oo(j)?this.setCurrentSubGraph(U):U.s("edge.toggleable")&&U.toggle()},c._39Q=function(a){return this.isInteractive(a)?this.preventDefaultWhenInteractive(a):!1},c.preventDefaultWhenInteractive=function(k){return k.s("preventDefaultWhenInteractive")},c.onGroupDoubleClicked=function(n){n.s("group.toggleable")&&n.toggle()},c.onDoorWindowDoubleClicked=function(s){s.s("dw.toggleable")&&s.toggle(!0)},c.onCSGBoxDoubleClicked=function(t,d){var $=this;if($ instanceof fq){var o=$.getHitFaceInfo(d);o&&o.face&&t.s(o.face+".toggleable")&&t.toggleFace(o.face,!0)}},c.onBackgroundClicked=function(){},c.onBackgroundDoubleClicked=function(){this.upSubGraph()},c.onDataClicked=function(){},c.onDataDoubleClicked=function(){},c.onAutoLayoutEnded=function(){},c.onMoveEnded=function(){},c.onPanEnded=function(){},c.onPinchEnded=function(){},c.onRectSelectEnded=function(){},c.onZoomEnded=function(){},c.serialize=function(I){return this.dm().serialize(I)},c.toJSON=function(){return this.dm().toJSON()},c.deserialize=function(K,t){var r=this;t=t instanceof ih?{rootParent:t}:Zl(t)?{setId:t}:Lo(t)?{finishFunc:t}:t||{},t.view=r;var F=r.dm(),w=t.finishFunc;return t.finishFunc=function(){w&&w.apply(t,arguments),Zl(F.a("zoomable"))&&r.setZoomable&&r.setZoomable(F.a("zoomable")),Zl(F.a("pannable"))&&r.setPannable&&r.setPannable(F.a("pannable")),Zl(F.a("rectSelectable"))&&r.setRectSelectable&&r.setRectSelectable(F.a("rectSelectable")),F.a("fitContent")===!0&&r.fitContent&&r.fitContent(!0,0)},F.deserialize(K,t.rootParent,t)},c.showDebugTip=function(){var t=this,y=t._debugDiv;if(!y){y=t._debugDiv=m.createElement("div"),y.style.position="absolute",y.style.overflow="hidden",y.style.backgroundColor="white",y.style.color="black";var J=t.getView();t._79O?J.insertBefore(y,t._79O):J.appendChild(y);var r=function(){t.redraw();var b=t._canvas,A="FPS : "+t._fpsInfo.fps+"<br/>"+"Datas : "+t.dm().getDatas().length+(b?"<br/>Size : "+b.width+" * "+b.height:""),l=t.getDebugTip();l&&(A+="<br/>------<br/>"+l),y.innerHTML=A,t._isDebugging&&requestAnimationFrame(r)};requestAnimationFrame(r),t._isDebugging=!0}},c.hideDebugTip=function(){var W=this,i=W._debugDiv;i&&(delete W._debugDiv,W.getView().removeChild(i),W._isDebugging=!1)},c.updateDOMAppendMatrix=function(){var q=this.getView();q&&(q.updateAppendMatrix=!0)},c.countFrame=function(){if(this._isDebugging){var k=Date.now(),A=this._fpsInfo;k-A.time>1e3?(A.fps=Math.round(1e5*(A.frames+1)/(k-A.time))/100,A.time=k,A.frames=0):A.frames++}}},ms_icons:function(b){b.getRotation=function(e){return e==s?0:e},b._15O=function(){var U=this,k=U.s(rl);if(k){var P=U,Y=U.data||U._data,M=U._38o={icons:k,rects:{}};for(var p in k){var L=k[p],Q=Ud(L.shape3d,Y,P);if(!(Ud(L.visible,Y,P)===!1||Ud(L.for3d,Y,P)&&!U.I3d||Q&&!U.I3d)){var C=Q?[Q]:Ud(L.names,Y,P),E=C?C.length:0,e=Ud(L.position,Y,P)||3,D=Ud(L.offsetX,Y,P)||0,K=Ud(L.offsetY,Y,P)||0,z=Ud(L.direction,Y,P)||Kg,h=Ud(L.gap,Y,P),r=h!=s?h:1,y=Ud(L.rotation,Y,P),v=Ud(L.keepOrien,Y,P),Z=Ud(L.rotationFixed,Y,P)?y:U.getRotation(y,v,e),w=s,m=M.rects[p]=new Array(E);m.rotation=Z;for(var t=0;E>t;t++){var B,x,b,j,S=C[t];if(Q)b=0,j=0;else{var H=Qf(S);b=Ud(L.width,Y,P),j=Ud(L.height,Y,P),b==s&&(b=Tb(H,Y)),j==s&&(j=hd(H,Y))}if(w?z===Kg?D+=b/2:z===uf?D-=b/2:z===Hq?K-=j/2:K+=j/2:w={width:b,height:j},U.I3d){var f=-b/2,X=-j/2;x={width:b,height:j,mat:U._16O(Ud(L.autorotate,Y,P),e,w,Ud(L.face,Y,P)||Oh,Ud(L.t3,Y,P),Ud(L.r3,Y,P),Ud(L.rotationMode,Y,P),D,K),vs:new vi([f,-X,0,f,-X-j,0,f+b,-X-j,0,f+b,-X,0])}}else B=U.getPosition(e,D,K,w,Ud(L.positionFixed,Y,P)),x={x:B.x-b/2,y:B.y-j/2,width:b,height:j},U._68o(x,Z);m[t]=x,z===Kg?D+=b/2+r:z===uf?D-=b/2+r:z===Hq?K-=j/2+r:K+=j/2+r}}}}}}});var Qk={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},ng={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},vg={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},nh={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Bl={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Fc={"edge.type":1,"edge.group":1},Qm={rotation:1,rotationX:1,rotationZ:1},Lb={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},hq={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Nn={shape:1,thickness:1,position:1,anchor:1,scale:1},Yh=function(z){if(!z)return s;if(jo(z)){var W=z._40I,v=z._41I;if(!W||!v)return s;var G=Yh(W),M=Yh(v);return G===M?G:s}for(var B=z._parent;jo(B)&&!B.ISubGraph;)B=B._parent;return B?B.ISubGraph?B:Yh(B):s},Jh=function(d,c,y,l){var q=c.getStyle(y)*l;q&&ho(d,q),q=c.getStyle(y+".left")*l,q&&(d.x-=q,d.width+=q),q=c.getStyle(y+".right")*l,q&&(d.width+=q),q=c.getStyle(y+".top")*l,q&&(d.y-=q,d.height+=q),q=c.getStyle(y+".bottom")*l,q&&(d.height+=q),d.width<0&&(d.width=-d.width,d.x-=d.width),d.height<0&&(d.height=-d.height,d.y-=d.height)},tn=function(i){for(var w,y=0,e=i.size();e>y;y++)if(w=i.getChildAt(y),rn(w)&&tn(w))return!0;return i.hasAgentEdges()},Dp=function(Q){if(!Q)return s;for(var A=Q._parent;ue(A);){if(!ue(A._parent))return A.isExpanded()?Q:A;A.isExpanded()||(Q=A),A=A._parent}return Q},kn=function(c,a){if(!c||!a)return s;var p,S,v,G=Yh(c),U=Yh(a);if(G!==U){for(;U&&G!==U;)U=Yh(U);if(G===U)return c;p=new bm,p.add(c,0);for(var Z=c._parent;rn(Z)&&!a.isDescendantOf(Z);)p.add(Z,0),Z=Z._parent;for(v=p.size(),S=0;v>S;S++){var D=p.get(S);if(ue(D)&&!D.isExpanded())return D;if(D.ISubGraph)return D}return c}return c},kf=function(J){if(J.isLooped())return J._source;var Q=Dp(J._source),P=Dp(J._target);return Q===P?J._source:kn(Q,P)},ck=function(r){if(r.isLooped())return r._target;var l=Dp(r._source),_=Dp(r._target);return l===_?r._target:kn(_,l)},rf=function(K,X,S){"target"!==S&&(S="source");var U="target"===S?X.getTargetAgent():X.getSourceAgent(),V="edge."+S+".";if(jo(U)){var $=K.getDataUI(U);$._79o();var D=X.s(V+"index");if(D!==d){var q=Wj($);return q[Math.max(0,Math.min(D,q.length-1))]}var t=X.s(V+"percent")||0;t=Math.max(0,Math.min(t,1));var n=Gi($);return Ln(n,100*t)}return Ao(K,U,X.s(V+"position"),X.s(V+"offset.x"),X.s(V+"offset.y"),X.s(V+"anchor.x"),X.s(V+"anchor.y"))},Ao=function(P,g,F,B,N,h,e){if(!g)return s;var D,Y=g.getRotation?g.getRotation():0;if(h!==d||e!==d){h=h===d?.5:h,e=e===d?.5:e;var $=g.getScale();if(Y&&!rk(g,P)||$.x<0||$.y<0){var q=g.getPosition(),C=g.getWidth(),M=g.getHeight(),J=g.getAnchor(),E=new vk(Y,q.x,q.y,$.x,$.y);F=E.tf((h-J.x)*C,(e-J.y)*M)}else D=Ui(P,g),F={x:D.x+h*D.width,y:D.y+e*D.height}}else F=Ih(F,Ui(P,g));if(Y){var I=O(Y),G=L(Y),z=B*I-N*G;N=B*G+N*I,B=z}return F.x+=B,F.y+=N,F},ns=function(m,$){if(!m||!$)return s;var l,R,h,e,v,g;if(m===$){if(e=m.getLoopedEdges(),!e)return s;e=new bm(e)}else{if(v=m.getAgentEdges(),g=$.getAgentEdges(),!v||!g)return s;for(R=v.size(),l=0;R>l;l++)h=v.get(l),g.contains(h)&&(e||(e=new bm),e.add(h))}if(e)for(l=0;l<e.size();l++)h=e.get(l),h.getStyle(Oe)===Xh&&(h._22I(s),e.removeAt(l),l--);return e},jp=function(H,C){var M=ns(H,C);if(M&&!M.isEmpty()){if(1===M.size())return M.get(0)._22I(s),void 0;var X=new bm,m=new bm;M.each(function(o){var h=o.s("edge.group");X.contains(h)||X.add(h)}),X.sort(),X.each(function(S){m.add(new l.EdgeGroup(M.toList(function(h){return S===h.s("edge.group")}),m))}),m.each(function(J){J.each(function(G){G._22I(J)})})}},Ge=function(J,T,m){var t=J._canvas;J._zoom;var I=Pp(T,t),l=Pp(m,t);return{x:I.x-l.x,y:I.y-l.y}},wf=function(u,B){if(B){var A=B.rect,w=B.color,x=B.rotation,p=B.labelWidth,N=B.background,G=B.opacity,h=B.scale,i=h!=s&&1!==h;if(G!=s){var E=u.globalAlpha;u.globalAlpha*=G}if(x||i){u.save();var _=A.x+A.width/2,d=A.y+A.height/2;bs(u,_,d),x&&Dn(u,x),i&&u.scale(h,h),bs(u,-_,-d)}if(N&&Gn(u,A.x,A.y,A.width,A.height,N),p){var z=A.width,r=u.createLinearGradient(A.x,A.y,A.x+z,A.y);r.addColorStop(0,w),r.addColorStop(.9,w),r.addColorStop(1,sf),w=r,A.width=p}Jk(u,B.ss,A,B.font,w,B.align),p&&(A.width=z),(x||i)&&u.restore(),G!=s&&(u.globalAlpha=E)}},Xq=function(G,k){if(k){var K=k.rect,D=K.x,w=K.y,u=K.width,V=K.height,n=k.background,M=k.backgroundImage,A=k.borderWidth,W=k.borderColor,y=k.labelWidth,h=k.opacity,x=k.scale,q=x!=s&&1!==x;if(h!=s){var F=G.globalAlpha;G.globalAlpha*=h}if(q){G.save();var c=K.x+K.width/2,v=K.y+K.height/2;bs(G,c,v),G.scale(x,x),bs(G,-c,-v)}if(k.expanded){var L=B(8,u/4),l=w+V-8;if(G.fillStyle=n,G.beginPath(),G.moveTo(D,w),G.lineTo(D,l),G.lineTo(D+u/2,l),G.lineTo(D+u/2,w+V),G.lineTo(D+u/2+L,l),G.lineTo(D+u,l),G.lineTo(D+u,w),G.closePath(),G.fill(),A&&(G.lineWidth=A,G.lineJoin="round",G.lineCap="round",W?(G.strokeStyle=W,G.stroke()):(G.strokeStyle=Gh(n),G.beginPath(),G.moveTo(D+u,w),G.lineTo(D+u,l),G.lineTo(D+u/2+L,l),G.lineTo(D+u/2,w+V),G.stroke(),G.strokeStyle=Dc(n),G.beginPath(),G.moveTo(D+u,w),G.lineTo(D,w),G.lineTo(D,l),G.lineTo(D+u/2,l),G.lineTo(D+u/2,w+V),G.stroke())),M)Iq(G,Qf(M),Gl,K.x,K.y,K.width,K.height-8,k.data,k.view);else{if(K.height-=8,n=k.color,y){var O=u,Z=G.createLinearGradient(D,w,D+O,w);Z.addColorStop(0,n),Z.addColorStop(.9,n),Z.addColorStop(1,sf),n=Z,K.width=y}Jk(G,k.ss,K,k.font,n,k.align),y&&(K.width=O),K.height+=8}}else if(k.icon)Jq(G,Qf(k.icon),D,w,u,V,k.data,k.view);else{var Y=u/2;A&&(G.lineWidth=A,G.lineJoin="round",G.lineCap="round",G.strokeStyle=W?W:Gh(n),G.beginPath(),G.arc(D+Y,w+Y,Y,X,1.6*N,!0),G.moveTo(D+Y,w+V),G.lineTo(D+u-Y/5,w+Y),G.stroke(),G.strokeStyle=W?W:Dc(n),G.beginPath(),G.arc(D+Y,w+Y,Y,1.6*N,X,!0),G.moveTo(D+Y,w+V),G.lineTo(D+Y/5,w+Y),G.stroke()),G.fillStyle=n,G.beginPath(),G.arc(D+Y,w+Y,Y,0,p,!0),G.moveTo(D+Y,w+V),G.lineTo(D+u-Y/5,w+Y),G.lineTo(D+Y/5,w+Y),G.closePath(),G.fill(),G.fillStyle=k.color,G.beginPath(),G.arc(D+Y,w+Y,Y/3,0,p,!0),G.fill()}q&&G.restore(),h!=s&&(G.globalAlpha=F)}},mf=function(m,A){return A>2*m?m:A/2},Rm=function(b,B,o,s){if(!b||!B)return 0;var I=c(B.y-b.y,B.x-b.x);return o||(I=B.x<b.x?I+N:I),I+s},wl=function(y,V,Q,u,D,l,S){S&&(y.x>V.x||y.x===V.x&&y.y>V.y)&&(Q=Bk[Q],D=-D);var v=Ih(Q,{x:0,y:0,width:Qd(y,V),height:0},l);return v.x+=u,v.y+=D,v=new vk(c(V.y-y.y,V.x-y.x)).tf(v),v.x+=y.x,v.y+=y.y,v},Aq=function(Z,s,A,m,E){if(Z._19Q=!0,!A.getEdgeGroup())return m?A.s("edge.gap"):0;if(jo(A.getSourceAgent())||jo(A.getTargetAgent()))return 0;var J,R=0,y=0,X=0;if(A.getEdgeGroup().getSiblings().each(function(K){K.each(function(Q){if(s.isVisible(Q)&&Q.s(Oe)==E){var b=Q.s("edge.gap");J?(y+=X/2+b/2,X=b):(J=Q,X=b),Q===A&&(R=y)}})}),m)return y-R+X;var d=R-y/2;return J&&A._40I!==J._40I&&(Z._19Q=!1),d},Uq=function(){var C=function(H){var C=[];return H.forEach(function(R){C.push({x:R.x,y:R.y}),C.push({x:R.x+R.width,y:R.y+R.height}),C.push({x:R.x+R.width,y:R.y}),C.push({x:R.x,y:R.y+R.height})}),C};return function(y,L,z){if("oval"===y){var G=0,F=z.height/z.width,V=F*F,f=z.x+z.width/2,b=z.y+z.height/2,O=C(L);O.forEach(function(J){var O=J.x-f,Z=J.y-b,A=O*O+Z*Z/V;A>G&&(G=A)}),G=r(G);var I=F*G;return{x:f-G,y:b-I,width:2*G,height:2*I}}if("circle"===y){var n=0,f=z.x+z.width/2,b=z.y+z.height/2,O=C(L);return O.forEach(function(X){var o=X.x-f,q=X.y-b,U=o*o+q*q;U>n&&(n=U)}),n=r(n),{x:f-n,y:b-n,width:2*n,height:2*n}}return"roundRect"===y?(ho(z,B(z.width,z.height)/16),z):z}}(),Lk=l.graph={},Wp=function(j,M,h){an(A+".graph."+j,M,h)};l.layout={};var Xk={},zs=function($,O,b,C,N,T,H,R){var m=[O.uuid,Math.round(C),Math.round(N),b].join("_");O.cacheRule&&(m+=Ud(O.cacheRule,T,H));var P=H._zoom;P!==H._cacheZoom&&(H._cacheZoom=P,H._cacheImage={}),P*=He;var u=H._cacheImage[m];return u||(oq(),u=l.Default.toCanvas(O,Math.ceil(C*P),Math.ceil(N*P),b,T,H,R),dd()&&(H._cacheImage[m]=u)),u};ag(k,{setImageCacheRule:function(C,T){var B;B=T||"object"!=typeof C?{_image:T}:C;for(var U in B){var l=B[U];Or(U)?(an=Qf(U),an?an.cacheRule=l:Xk[U]=l):U.cacheRule=l}}});var cm={comps:[{type:mj,points:[85,50,70,115,100,71,86,107,88,49,56,70,99,108,122,53,87,104,50,83,65,80,108,116,88,121,112,90,90,121,98,102,115,85,99,89,53,82,89,122,65,105,52,61],borderWidth:1,borderColor:s}]};if(cm[vs]=cm[Vk]=160,g.Image){var Nc=new g.Image;Nc.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",$m("default_blank",Nc)}$m("node_image",Up(30,30,[{type:Vc,rect:[4,5,22,16],gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[2,3,26,20],borderWidth:1,borderColor:Fj},{type:Vc,rect:[11,23,8,4],background:Fj},{type:Vc,rect:[6,27,18,2],background:Fj}])),$m("node_icon",Up(16,16,[{type:Vc,rect:[2,2,12,10],gradient:wp,gradientColor:oj,background:Fj},{type:kp,rect:[2,2,12,10],width:1,color:Fj},{type:Vc,rect:[6,12,4,2],background:Fj},{type:Vc,rect:[4,14,8,1],background:Fj}])),$m("block_icon",Up(16,16,[{type:kp,rect:[1,1,14,14],width:1,color:Fj}])),$m("group_image",Up(66,39,[{type:Vc,rect:[44.3,18,18.1,12.8],gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[3.3,17.8,18.1,12.8],gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Fj,gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[26.2,29.4,12.8,4.2],background:Fj},{type:Vc,rect:[21.3,33.5,22.5,2.3],background:Fj},{type:Vc,rect:[5.3,32.7,14.1,2.1],background:Fj},{type:Vc,rect:[9,30.4,6.7,2.4],background:Fj},{type:Vc,rect:[50,30.7,6.7,2.4],background:Fj},{type:Vc,rect:[46.3,33,14.1,2.1],background:Fj}])),$m("group_icon",Up(16,16,[{type:Vc,rect:[4,12,4,2],background:Fj},{type:Vc,rect:[2,13,8,1],background:Fj},{type:Vc,rect:[12,12,2,1],background:Fj},{type:Vc,rect:[11,13,4,1],background:Fj},{type:Vc,rect:[10,7,6,5],gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[1,2,10,10],gradient:wp,gradientColor:oj,background:Fj},{type:kp,rect:[1,2,10,10],width:1,color:Fj}])),$m("refGraph_icon",Up(16,16,[{type:"shape",borderWidth:1,borderColor:Fj,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Fj,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),$m("edge_icon",Up(16,16,[{type:Vc,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[10.8,1,4,4],background:Fj},{type:Vc,rect:[1,11,4,4],background:Fj}])),$m("subGraph_image",Up(72,45,[{type:mj,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[29.6,30.7,3.6,1.8],background:Fj},{type:Vc,rect:[28.4,32.3,6,1.2],background:Fj},{type:Vc,rect:[37.3,32,10.8,1.8],background:Fj},{type:Vc,rect:[39.1,29.9,7.2,2.3],background:Fj},{type:Vc,rect:[26.6,23.7,9.6,7.2],gradient:wp,gradientColor:oj,background:Fj},{type:Vc,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Fj,gradient:wp,gradientColor:oj,background:Fj}])),$m("subGraph_icon",Up(17,17,[{type:mj,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:wp,gradientColor:oj,background:Fj}])),$m("shape_icon",Up(16,16,[{type:mj,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Fj}])),$m("polyline_icon",Up(16,16,[{type:mj,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Fj},sn(7.5,.4),sn(7.5,6.3),sn(13.6,6.3),sn(13.6,14),sn(.7,13.9),sn(.7,.3)])),$m("grid_icon",Up(16,16,[{type:Vc,rect:[1,1,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[6,1,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[11,1,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[11,6,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[6,6,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[1,6,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[11,11,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[6,11,4,4],background:Fj,gradient:wp,gradientColor:oj},{type:Vc,rect:[1,11,4,4],background:Fj,gradient:wp,gradientColor:oj}])),$m("light_icon",Up(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Fj},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Fj,gradient:wp,gradientColor:oj,background:{func:function(N){var g=N?N.s(wj):s;return Cq(g)?"rgb("+H(255*g[0])+","+H(255*g[1])+","+H(255*g[2])+")":g||Fj}}}])),$m("text_icon",Up(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Fj}])),$m("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),$m("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),$m("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),$m("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});
var $n=function(r,w,h,l,P,j){var F,b,y,M,S,q,V,e,E,Y,p,U=[];if(Math.abs(l)>2*Math.PI&&(l=2*Math.PI),S=Math.ceil(Math.abs(l)/(Math.PI/4)),F=l/S,b=-F,y=-h,S>0){q=r+Math.cos(h)*P,V=w+Math.sin(-h)*j,U.push({x:q,y:V});for(var z=0;S>z;z++)y+=b,M=y-b/2,e=r+Math.cos(y)*P,E=w+Math.sin(y)*j,Y=r+Math.cos(M)*(P/Math.cos(b/2)),p=w+Math.sin(M)*(j/Math.cos(b/2)),U.push({x:Y,y:p}),U.push({x:e,y:E})}return U},Qg=function(a){if(a){var A=a._data;if(A instanceof l.Shape)return{points:A.getPoints(),segments:A.getSegments()};var I;if(A instanceof l.Edge&&(I=a._78o)){var M,$,R=I.type,U=I.points,P=I.segments,t=I.edgeTypeInfo;if(!R||U){var B=I.sourcePoint,E=B.x,b=B.y,O=I.targetPoint,F=O.x,V=O.y;if(R)P?(M=new bm({x:E,y:b}),M.addAll(U),M.add({x:F,y:V}),$=new bm(P._as)):(M=new bm({x:E,y:b}),U.each(function(n){M.add(n)}),M.add({x:F,y:V}));else if(I.looped){M=new bm($n(E,b,0,2*Math.PI,I.radius,I.radius)),$=new bm([1]);for(var S=0;S<(M.size()-1)/2;S++)$.add(3)}else M=new bm,I.center?(M.add({x:I.c1.x,y:I.c1.y}),M.add({x:E,y:b}),M.add({x:F,y:V}),M.add({x:I.c2.x,y:I.c2.y})):(M.add({x:E,y:b}),M.add({x:F,y:V}))}else t&&(M=new bm(t.points._as),t.segments&&($=new bm(t.segments._as)));return{points:M,segments:$}}}},Gi=function(M,A,V){if(null==A){var D=Qg(M);if(!D)return;A=D.points,V=D.segments}if(A){if(Array.isArray(A)&&(A=new bm(A)),"number"==typeof A.get(0)){for(var w=new l.List,n=0;n<A.size();n+=2)w.add({x:A.get(n),y:A.get(n+1)});A=w}if(!V){V=[1];for(var H=A.length-1;H>0;H--)V.push(2)}Array.isArray(V)&&(V=new bm(V));for(var U=Si(A._as,V._as,50),F=U.length,v=[],n=0;F>n;n++){var Q=U[n];Q.length>1&&v.push(Q)}return v}},Gd=function(g){for(var U=0,x=g.length-1,e=0;x>e;e++){var K=g[e],R=g[e+1],a=R.x-K.x,H=R.y-K.y;U+=Math.sqrt(a*a+H*H)}return U},re=function(i,I){for(var c=0,X=I.length,w=0;X>w;w++){var M=I[w];if(c+=M,c>i)return w}return Math.min(w,X-1)},zq=function(u,e){for(var C=0,$=0,D=0,X=u.length-1,W=0;X>W;W++){var t=u[W],P=u[W+1],g=P.x-t.x,y=P.y-t.y;if(D=Math.sqrt(g*g+y*y),C+=D,C>e){C-=D,$=W;break}}var B=u[$],T=u[$+1],O=Math.atan2(T.y-B.y,T.x-B.x),z=e-C,y=Math.sin(O)*z,g=Math.cos(O)*z;return{x:B.x+g,y:B.y+y}},Ln=function(U,c){if(U){var j;if(0===c)j=U[0][0];else if(100===c)U=U[U.length-1],j=U[U.length-1];else{for(var e=0,D=[],b=U.length,m=0;b>m;m++){var R=U[m],r=Gd(R);e+=r,D.push(r)}for(var S=e*c/100,x=re(S,D),i=0,L=0;x>L;L++)i+=D[L];S-=i,j=zq(U[x],S)}return j}},Wj=function(e){var W,b,S,H,N=Qg(e),q=[],v=N.points,B=N.segments,T=-1;for(b=0,S=B?B.length:v.length;S>b;b++){if(W=B?B.get(b):1,3===W)H=2;else if(4===W)H=3;else{if(5===W)continue;H=1}T+=H,q.push(v.get(T))}return q},Mj=function(f,b,T,A){function y(T){if(T>=0&&1>=T){r=b(T);var u=(f.x-r.x)*(f.x-r.x)+(f.y-r.y)*(f.y-r.y);return m>u?(m=u,C=T,!0):!1}}T=T||100,A=A||1e-5;for(var m=1/0,C=0,r=new Kk,i=0;T>i;++i)y(i/T);for(var x=1/(2*T);x>A;)y(C-x)||y(C+x)||(x/=2);return C};ag(k,{_edgeProtectMethod:{getStraightLinePoints:Gi,calculateLineLength:Gd,calcSegmentIndexByDistance:re,calculatePointAlongLine:zq,getPercentPosition:Ln,getRealPointsFromDataUI:Wj}});var Ik=function(f,W){for(var Q=f.vertices,V=0;V<Q.length;V++){var G=Q[V],i=G.y;G.y=G.z,G.z=-i,W&&(G.y+=W)}},bd=function(t){for(var l,A,C,f,x,D,p=[],M=[],J=[],c=t.faces,W=0,w=0,R=0,B=c.length;B>W;W++,w+=6,R+=9){var Q=c[W];1===Q.i?(l||(l=[],A=[],C=[]),Fd(Q,W,w,R,t,l,C,A)):2===Q.i?(f||(f=[],x=[],D=[]),Fd(Q,W,w,R,t,f,D,x)):Fd(Q,W,w,R,t,p,J,M)}return{vs:p,uv:M,ns:J,top_vs:l,top_uv:A,top_ns:C,bottom_vs:f,bottom_uv:x,bottom_ns:D}},Fd=function(d,J,v,K,e,x,$,C){var h=e.vertices,l=e.faceVertexUvs,I=h[d.a],t=h[d.b],Z=h[d.c];x[K]=I.x,x[K+1]=I.y,x[K+2]=I.z,x[K+3]=t.x,x[K+4]=t.y,x[K+5]=t.z,x[K+6]=Z.x,x[K+7]=Z.y,x[K+8]=Z.z;var b=d.vertexNormals;if(3===b.length){var F=b[0],c=b[1],G=b[2];$[K]=F.x,$[K+1]=F.y,$[K+2]=F.z,$[K+3]=c.x,$[K+4]=c.y,$[K+5]=c.z,$[K+6]=G.x,$[K+7]=G.y,$[K+8]=G.z}else{var B=d.normal;$[K]=B.x,$[K+1]=B.y,$[K+2]=B.z,$[K+3]=B.x,$[K+4]=B.y,$[K+5]=B.z,$[K+6]=B.x,$[K+7]=B.y,$[K+8]=B.z}var n=l[0][J][0],q=l[0][J][1],r=l[0][J][2];C[v]=n.x,C[v+1]=n.y,C[v+2]=q.x,C[v+3]=q.y,C[v+4]=r.x,C[v+5]=r.y},yg=function(){function P(h,s){return h.dot(s)>0}function V(K,I,s,H,a,Q,h){for(var M,_,U=[I,s,H],A=[a,Q,h],o=[],v=U.length,N=!0;v--&&N;){for(var T=U[v],C=A.length,n=!1;C--;)if(T.equals(A[C])){A.splice(C,1),o.push(T),n=!0;break}if(!n){if(M){N=!1;break}M=T}}return N&&2===o.length&&(_=A[0],y.subVectors(M,o[0]),B.subVectors(_,o[0]),i.subVectors(M,o[1]),y.x*i.y*B.z+i.x*B.y*y.z+B.x*y.y*i.z-B.x*i.y*y.z-B.y*i.z*y.x-B.z*i.x*y.y<1e-6&&(Z.subVectors(_,o[1]),t.subVectors(o[1],o[0]),P(t,y)&&P(t,B)&&(t.negate(),P(t,i)&&P(t,Z))))?(K.push(o[1].x,o[1].y,o[1].z),K.push(M.x,M.y,M.z),K.push(M.x,M.y,M.z),K.push(o[0].x,o[0].y,o[0].z),K.push(o[0].x,o[0].y,o[0].z),K.push(_.x,_.y,_.z),K.push(_.x,_.y,_.z),K.push(o[1].x,o[1].y,o[1].z),2):(K.push(I.x,I.y,I.z),K.push(s.x,s.y,s.z),K.push(s.x,s.y,s.z),K.push(H.x,H.y,H.z),K.push(H.x,H.y,H.z),K.push(I.x,I.y,I.z),1)}function S(){this._vertexMap={},this._lineMap={},this._lineList=[]}function j(l,D,q,j,B,W,s){var z=[q,B];l[0]===j&&z.reverse();var i=[z[0]._key,z[1]._key].join("|"),$=l._triangles[i];$||(l._triangles[i]=$={});var Q=[W._key,s._key].join("|");$[Q]||($[Q]=[W,s])}function M(j,M,c){var q=j._planes[c._key];if(!q)for(var Q in j._planes){var T=j._planes[Q];if(T._normal.angleTo(c)<.001){q=T;break}}return q?(q._vertices.indexOf(M)<0&&q._vertices.push(M),void 0):(j._planes[c.key]={_normal:c,_vertices:[M]},void 0)}function X(T){var v=T._ctlineModel;if(v||(T._ctlineModel=v=[]),v[0])return v[0];var Q;Q=Cq(T)?T:[T];var t,B,c,q,F,G,h,S,N,Z,H,W,r,w,f,J,D,l,I,g=["","top_","bottom_"];for(v=[],t=0,B=Q.length;B>t;t++)if(Z=Q[t])for(td(Z),c=0,q=g.length;q>c;c++)if(N=Z[g[c]+"lvs"])for(D=v.length,l=N.length,v.length=D+l,I=0;l>I;++I,++D)v[D]=N[I];else if(h=Z[g[c]+"vs"]){S=Z[g[c]+"is"],G=S?S.length:h.length/3;for(var F=0;G-1>F;)S?(H=S[F],W=S[F+1],r=S[F+2],w=S[F+3],f=S[F+4],J=S[F+5]):(H=F,W=F+1,r=F+2,w=F+3,f=F+4,J=F+5),E.fromArray(h,3*H),m.fromArray(h,3*W),u.fromArray(h,3*r),_.fromArray(h,3*w),O.fromArray(h,3*f),p.fromArray(h,3*J),F+=3*V(v,E,m,u,_,O,p);G>F&&(S?(H=S[F],W=S[F+1],r=S[F+2]):(H=F,W=F+1,r=F+2),E.fromArray(h,3*H),m.fromArray(h,3*W),u.fromArray(h,3*r),v.push(E.x,E.y,E.z),v.push(m.x,m.y,m.z),v.push(m.x,m.y,m.z),v.push(u.x,u.y,u.z),v.push(u.x,u.y,u.z),v.push(E.x,E.y,E.z))}return T._ctlineModel[0]=v,v}function s(U){var y=U._ctlineModel;if(y||(U._ctlineModel=y=[]),y[1])return y[1];var M;M=Cq(U)?U:[U];var A,P,p,X,T,j,x,u,F,t,c,Q,k=["","top_","bottom_"],f=new S;for(y=[],A=0,P=M.length;P>A;A++)if(F=M[A])for(td(F),p=0,X=k.length;X>p;p++)if(x=F[k[p]+"vs"]){u=F[k[p]+"is"],j=u?u.length:x.length/3;for(var T=0,T=0;j>T;T+=3)u?(t=u[T],c=u[T+1],Q=u[T+2]):(t=T,c=T+1,Q=T+2),f._addTriangle(x,d,t,c,Q)}return f._toLineVS(y),U._ctlineModel[1]=y,y}function q(w){var O=w._ctlineModel;if(O||(w._ctlineModel=O=[]),O[2])return O[2];var f;f=Cq(w)?w:[w];var D,$,I,F,Y,y,L,u,T,l,c,z,g,K=["","top_","bottom_"],v=new S;for(O=[],D=0,$=f.length;$>D;D++)if(l=f[D])for(td(l),I=0,F=K.length;F>I;I++)if(L=l[K[I]+"vs"]){u=l[K[I]+"is"],T=l[K[I]+"ns"],y=u?u.length:L.length/3;for(var Y=0,Y=0;y>Y;Y+=3)u?(c=u[Y],z=u[Y+1],g=u[Y+2]):(c=Y,z=Y+1,g=Y+2),v._addTriangle(L,T,c,z,g)}return v._toLineVS(O),w._ctlineModel[2]=O,O}var E=new wo,m=new wo,u=new wo,_=new wo,O=new wo,p=new wo,y=new wo,i=new wo,B=new wo,Z=new wo,t=new wo,A=new wo;S.prototype._findVertex=function(M,B){A.fromArray(M,3*B);var u=[A.x,A.y,A.z].join(","),s=this._vertexMap[u];if(!s){var D=A.clone();D._key=u,this._vertexMap[u]=s=D}return s},S.prototype._findLine=function(Y,y){var $=[Y,y];Y._key>y._key&&$.reverse(),$._key=[$[0]._key,$[1]._key].join("|");var E=this._lineMap[$._key];return E||(this._lineMap[$._key]=E=$,$._triangles={},$._planes={},this._lineList.push($)),E};var c=new wo,T=new wo;return S.prototype._addTriangle=function(O,L,G,x,K){var A,q,l,$=this._findVertex(O,G),k=this._findVertex(O,x),Z=this._findVertex(O,K),d=this._findLine($,k),e=this._findLine(k,Z),S=this._findLine(Z,$);L?(A=(new wo).fromArray(L,3*G),A._key=[A.x,A.y,A.z].join("|"),q=(new wo).fromArray(L,3*x),q._key=[q.x,q.y,q.z].join("|"),l=(new wo).fromArray(L,3*K),l._key=[l.x,l.y,l.z].join("|"),j(d,$,A,k,q,Z,l),j(e,k,q,Z,l,$,A),j(S,Z,l,$,A,k,q)):(T.subVectors(Z,k),c.subVectors(k,$),A=(new wo).crossVectors(c,T),A._key=[A.x,A.y,A.z].join("|"),M(d,Z,A),M(e,$,A),M(S,k,A))},S.prototype._toLineVS=function(L){for(var b=this._lineList,k=0,N=b.length;N>k;++k){var B=b[k],K=!1;for(var J in B._triangles)if(1==e.keys(B._triangles[J]).length){L.push(B[0].x,B[0].y,B[0].z,B[1].x,B[1].y,B[1].z),K=!0;break}if(!K)for(var R in B._planes)if(1==B._planes[R]._vertices.length){L.push(B[0].x,B[0].y,B[0].z,B[1].x,B[1].y,B[1].z),K=!0;break}}},[X,s,q]}(),er=function(c){var q=c._lineModel;if(q)return q;var R;R=Cq(c)?c:[c];var W,Y,I,K,T,U,d,u,o,t,r,M,$=["","top_","bottom_"];for(q=[],W=0,Y=R.length;Y>W;W++)if(o=R[W])for(I=0,K=$.length;K>I;I++)if(d=o[$[I]+"vs"]){u=o[$[I]+"is"],U=u?u.length:d.length/3;for(var T=0;U>T;T+=3)u?(t=u[T],r=u[T+1],M=u[T+2]):(t=T,r=T+1,M=T+2),t*=3,r*=3,M*=3,q.push(d[t],d[t+1],d[t+2],d[r],d[r+1],d[r+2],d[r],d[r+1],d[r+2],d[M],d[M+1],d[M+2],d[M],d[M+1],d[M+2],d[t],d[t+1],d[t+2])}return c._lineModel=q,q},Gq=function(u,c,X,p,H,Z,M,_,W){X==s&&(X=!0),p==s&&(p=!0),M==s&&(M=1),_==s&&(_=0);var n=new vn;return hh(n,u,c,W),n=n.toShapes(),bd(new Kb(n,{top:X,bottom:p,curveSegments:H,amount:M,repeatUVLength:Z},-M/2+_))},Zj=function(m,O){this.x=m||0,this.y=O||0};Zj.prototype={constructor:Zj,add:function(n){return this.x+=n.x,this.y+=n.y,this},sub:function(r){return this.x-=r.x,this.y-=r.y,this},equals:function(R){return R.x===this.x&&R.y===this.y},multiplyScalar:function(X){return this.x*=X,this.y*=X,this},distanceTo:function(P){return r(this.distanceToSquared(P))},distanceToSquared:function(g){var o=this.x-g.x,f=this.y-g.y;return o*o+f*f},clone:function(){return new Zj(this.x,this.y)}};var kj=function(K,r,y){this.x=K||0,this.y=r||0,this.z=y||0};kj.prototype={constructor:kj,set:function(k,Q,B){return this.x=k,this.y=Q,this.z=B,this},setY:function(n){return this.y=n,this},copy:function(F){return this.x=F.x,this.y=F.y,this.z=F.z,this},add:function(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this},addVectors:function(n,y){return this.x=n.x+y.x,this.y=n.y+y.y,this.z=n.z+y.z,this},sub:function(A){return this.x-=A.x,this.y-=A.y,this.z-=A.z,this},subVectors:function(C,p){return this.x=C.x-p.x,this.y=C.y-p.y,this.z=C.z-p.z,this},multiplyScalar:function(u){return this.x*=u,this.y*=u,this.z*=u,this},applyMatrix4:function(i){var v=this.x,x=this.y,N=this.z,g=i.elements;return this.x=g[0]*v+g[4]*x+g[8]*N+g[12],this.y=g[1]*v+g[5]*x+g[9]*N+g[13],this.z=g[2]*v+g[6]*x+g[10]*N+g[14],this},divideScalar:function(F){if(0!==F){var C=1/F;this.x*=C,this.y*=C,this.z*=C}else this.x=0,this.y=0,this.z=0;return this},dot:function(w){return this.x*w.x+this.y*w.y+this.z*w.z},length:function(){return r(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(P){var t=this.x,i=this.y,X=this.z;return this.x=i*P.z-X*P.y,this.y=X*P.x-t*P.z,this.z=t*P.y-i*P.x,this},crossVectors:function(z,e){var M=z.x,P=z.y,m=z.z,b=e.x,n=e.y,k=e.z;return this.x=P*k-m*n,this.y=m*b-M*k,this.z=M*n-P*b,this},distanceTo:function(p){return r(this.distanceToSquared(p))},distanceToSquared:function(h){var H=this.x-h.x,u=this.y-h.y,I=this.z-h.z;return H*H+u*u+I*I},clone:function(){return new kj(this.x,this.y,this.z)}};var Xc=function(){this.elements=new Float32Array(16)};Xc.prototype={constructor:Xc,set:function(s,e,d,A,B,i,H,x,K,q,m,l,n,W,S,F){var p=this.elements;return p[0]=s,p[4]=e,p[8]=d,p[12]=A,p[1]=B,p[5]=i,p[9]=H,p[13]=x,p[2]=K,p[6]=q,p[10]=m,p[14]=l,p[3]=n,p[7]=W,p[11]=S,p[15]=F,this},makeRotationAxis:function(H,b){var Q=O(b),s=L(b),e=1-Q,o=H.x,p=H.y,J=H.z,E=e*o,w=e*p;return this.set(E*o+Q,E*p-s*J,E*J+s*p,0,E*p+s*J,w*p+Q,w*J-s*o,0,E*J-s*p,w*J+s*o,e*J*J+Q,0,0,0,0,1),this}};var wr=function(Z){this.repeatUVLength=Z};wr.prototype={generateTopUV:function(E,J,U,I,H,X,_){var N,m,w,r,W=E.vertices,g=W[I].x,s=W[I].y,f=W[H].x,b=W[H].y,L=W[X].x,C=W[X].y,o=this.repeatUVLength;if(o)N=0,m=0,w=o,r=o;else{this._bb||(this._bb=J.getBoundingBox());var u=this._bb;N=u.minX,m=u.minY,w=u.maxX-N,r=u.maxY-m}return _?[new Zj((g-N)/w,(s-m)/r),new Zj((f-N)/w,(b-m)/r),new Zj((L-N)/w,(C-m)/r)]:[new Zj((g-N)/w,1-(s-m)/r),new Zj((f-N)/w,1-(b-m)/r),new Zj((L-N)/w,1-(C-m)/r)]},generateBottomUV:function(Z,S,_,z,$,Q){return this.generateTopUV(Z,S,_,z,$,Q,!0)},generateSideWallUV:function(F,m,S,c,K,l,G,W,N,C,M,D){if(!this._cl){for(var X,Z,I=[],y=0,J=S.length,x=0;J>x;x++){X=S[x],Z=S[(x+1)%J];var d=X.x-Z.x,h=X.y-Z.y,z=r(d*d+h*h);I.push(y),y+=z}for(var x=0;J>x;x++)I[x]/=y;this._cl=I}var I=this._cl,V=1-N/C,Y=1-(N+1)/C,u=I[M],g=I[D];return g>u&&(u+=1),[new Zj(u,V),new Zj(g,V),new Zj(g,Y),new Zj(u,Y)]}};var gc=function(q,w,$,E,s,T){this.a=q,this.b=w,this.c=$,this.i=T,this.normal=E instanceof kj?E:new kj,this.vertexNormals=E instanceof Array?E:[]};gc.prototype={constructor:gc};var Dl=[-8,13,1,8,0,12,5,10,-1],ql=function(){if(ql[kh]!=s)return ql[kh];for(var E=em[kh],S=Dl,X=ih.prototype.getClassName(),N='"',v=0,c="",h=!1,W=+new(g[X.substr(3,3)+up[v]]),x=v;x<S.length;x++){var w=S.length-x;c+=x%2===v?S[x]+w+"":S[x]-w+""}for(var x=v;4>x;x++)c+=v;if(c=c*c.length/c.length,W>c){if(E&&E[v]&&E[4/Vc.length]){for(var A,j,e,Q,P,Z,y,D,H=E[0],T=E[1],z="",r=0,x=0;x<T.length;x++)T[x]===N?D?(D=!1,0!==r%2&&(A==s?A=z:j==s?j=z:e==s?e=z:Q==s?Q=z:P==s?P=z:Z==s?Z=z:y==s&&(y=z)),r++,z=""):D=!0:D&&(z+=T[x]);for(var q,F,Y,b="",G=0,x=0;x<H.length;x++)H[x]===N?q?(q=!1,0!==G%2&&(F==s?F=b:Y==s&&(Y=b)),G++,b=""):q=!0:q&&(b+=H[x]);var l=A+j+e+Q+P+Z,M=!Z||Z===sp;if(!M&&Z)for(var K,x=0,f=Z.length;f>x;x++)Z[x]===Ch[4]?K===sp?M=es:K[0]===se[7]&&sp&&sp.indexOf(K.substr(1))>=0?M=pm:K=s:(K==s?K=Z[x]:K+=Z[x],x===f-1&&(K===sp?M=es:K[0]===se[7]&&sp&&sp.indexOf(K.substr(1))>=0&&(M=pm)));(h=dn(l,y)&&dn(F,Y)&&F===A&&M&&(!P||P>W))&&e.indexOf(Qh[0])>=0&&(ql[Qh[0]]=1),h&&e.indexOf(1)>=0&&(ql[1]=1),h&&e.indexOf(2)>=0&&(ql[2]=1)}}else h=!0,ql[Qh[0]]=ql[1]=ql[2]=1;return ql[kh]=h,h},Yi=function(){},Oj=Yi.prototype;Oj.getPointAt=function(Q){var z=this.getUtoTmapping(Q);return this.getPoint(z)},Oj.getPoints=function(U){U||(U=5);var y,q=[];for(y=0;U>=y;y++)q.push(this.getPoint(y/U));return q},Oj.getSpacedPoints=function(y){y||(y=5);var r,M=[];for(r=0;y>=r;r++)M.push(this.getPointAt(r/y));return M},Oj.getLength=function(){var q=this.getLengths();return q[q.length-1]},Oj.getLengths=function(_){if(_||(_=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==_+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var s,v,Y=[],J=this.getPoint(0),m=0;for(Y.push(0),v=1;_>=v;v++)s=this.getPoint(v/_),m+=s.distanceTo(J),Y.push(m),J=s;return this.cacheArcLengths=Y,Y},Oj.getUtoTmapping=function(N,p){var z,x=this.getLengths(),y=0,E=x.length;z=p?p:N*x[E-1];for(var T,I=0,O=E-1;O>=I;)if(y=G(I+(O-I)/2),T=x[y]-z,0>T)I=y+1;else{if(!(T>0)){O=y;break}O=y-1}if(y=O,x[y]==z){var W=y/(E-1);return W}var o=x[y],c=x[y+1],q=c-o,t=(z-o)/q,W=(y+t)/(E-1);return W},Oj.getTangent=function(D){var z=1e-4,B=D-z,v=D+z;0>B&&(B=0),v>1&&(v=1);var n=this.getPoint(B),h=this.getPoint(v),f=h.clone().sub(n);return f.normalize()},Oj.getTangentAt=function(T){var D=this.getUtoTmapping(T);return this.getTangent(D)},Yi.create=function(y,S){return y.prototype=pf(Yi.prototype),y.prototype.getPoint=S,y};var pc=function(){this.curves=[],this.autoClose=!1},Mc=pc.prototype=pf(Oj);Mc.add=function(X){this.curves.push(X)},Mc.closePath=function(){var H=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);H.equals(n)||this.curves.push(new Zq(n,H))},Mc.getPoint=function(M){for(var W,f,c=M*this.getLength(),R=this.getCurveLengths(),Q=0;Q<R.length;){if(R[Q]>=c){W=R[Q]-c,f=this.curves[Q];var D=1-W/f.getLength();return f.getPointAt(D)}Q++}return null},Mc.getLength=function(){var M=this.getCurveLengths();return M[M.length-1]},Mc.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var $,e=[],y=0,k=this.curves.length;for($=0;k>$;$++)y+=this.curves[$].getLength(),e.push(y);return this.cacheLengths=e,e},Mc.getTransformedPoints=function(u){return this.getPoints(u)},Mc.getBoundingBox=function(){var j,p,Q,o,k,K,y=this.getPoints();j=p=Number.NEGATIVE_INFINITY,o=k=Number.POSITIVE_INFINITY;var x,M,V,B,U=y[0]instanceof kj;for(B=U?new kj:new Zj,M=0,V=y.length;V>M;M++)x=y[M],x.x>j&&(j=x.x),x.x<o&&(o=x.x),x.y>p&&(p=x.y),x.y<k&&(k=x.y),U&&(x.z>Q&&(Q=x.z),x.z<K&&(K=x.z)),B.add(x);var S={minX:o,minY:k,maxX:j,maxY:p};return U&&(S.maxZ=Q,S.minZ=K),S};var gf=function(S){pc.call(this),this.actions=[],S&&this.fromPoints(S)},gb=gf.prototype=pf(pc.prototype),Ae="moveTo",Hn="lineTo",jq="quadraticCurveTo",jh="bezierCurveTo",Mk="arc",Nk="ellipse";gb.fromPoints=function(l){this.moveTo(l[0].x,l[0].y);for(var n=1,Y=l.length;Y>n;n++)this.lineTo(l[n].x,l[n].y)},gb.moveTo=function(){var F=Array.prototype.slice.call(arguments);this.actions.push({action:Ae,args:F})},gb.lineTo=function(z,p){var S=Array.prototype.slice.call(arguments),Q=this.actions[this.actions.length-1].args,P=Q[Q.length-2],u=Q[Q.length-1],U=new Zq(new Zj(P,u),new Zj(z,p));this.curves.push(U),this.actions.push({action:Hn,args:S})},gb.quadraticCurveTo=function(x,S,f,v){var d=Array.prototype.slice.call(arguments),Q=this.actions[this.actions.length-1].args,U=Q[Q.length-2],p=Q[Q.length-1],K=new Ho(new Zj(U,p),new Zj(x,S),new Zj(f,v));this.curves.push(K),this.actions.push({action:jq,args:d})},gb.bezierCurveTo=function(u,D,Q,K,t,z){var w=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,m=c[c.length-2],X=c[c.length-1],d=new wh(new Zj(m,X),new Zj(u,D),new Zj(Q,K),new Zj(t,z));this.curves.push(d),this.actions.push({action:jh,args:w})},gb.arc=function(Q,y,m,p,v,c){var o=this.actions[this.actions.length-1].args,j=o[o.length-2],A=o[o.length-1];this.absarc(Q+j,y+A,m,p,v,c)},gb.absarc=function(l,q,_,b,L,S){this.absellipse(l,q,_,_,b,L,S)},gb.ellipse=function(W,d,c,R,z,P,V){var g=this.actions[this.actions.length-1].args,Y=g[g.length-2],p=g[g.length-1];this.absellipse(W+Y,d+p,c,R,z,P,V)},gb.absellipse=function(v,i,z,g,t,U,J){var p=Array.prototype.slice.call(arguments),Y=new rj(v,i,z,g,t,U,J);this.curves.push(Y);var M=Y.getPoint(1);p.push(M.x),p.push(M.y),this.actions.push({action:Nk,args:p})},gb.getSpacedPoints=function(X){X||(X=40);for(var V=[],W=0;X>W;W++)V.push(this.getPoint(W/X));return V},gb.getPoints=function(f,z){f=f||12;var T,b,U,r,Z,H,e,Y,n,l,y,p,k,c,D,o,V,F,q=[];for(T=0,b=this.actions.length;b>T;T++)switch(U=this.actions[T],r=U.action,Z=U.args,r){case Ae:q.push(new Zj(Z[0],Z[1]));break;case Hn:q.push(new Zj(Z[0],Z[1]));break;case jq:for(H=Z[2],e=Z[3],l=Z[0],y=Z[1],q.length>0?(c=q[q.length-1],p=c.x,k=c.y):(c=this.actions[T-1].args,p=c[c.length-2],k=c[c.length-1]),D=1;f>=D;D++)o=D/f,V=eo.b2(o,p,l,H),F=eo.b2(o,k,y,e),q.push(new Zj(V,F));break;case jh:for(H=Z[4],e=Z[5],l=Z[0],y=Z[1],Y=Z[2],n=Z[3],q.length>0?(c=q[q.length-1],p=c.x,k=c.y):(c=this.actions[T-1].args,p=c[c.length-2],k=c[c.length-1]),D=1;f>=D;D++)o=D/f,V=eo.b3(o,p,l,Y,H),F=eo.b3(o,k,y,n,e),q.push(new Zj(V,F));break;case Mk:var A,W=Z[0],h=Z[1],I=Z[2],S=Z[3],t=Z[4],g=!!Z[5],B=t-S,P=2*f;for(D=1;P>=D;D++)o=D/P,g||(o=1-o),A=S+o*B,V=W+I*O(A),F=h+I*L(A),q.push(new Zj(V,F));break;case Nk:var A,W=Z[0],h=Z[1],G=Z[2],C=Z[3],S=Z[4],t=Z[5],g=!!Z[6],B=t-S,P=2*f;for(D=1;P>=D;D++)o=D/P,g||(o=1-o),A=S+o*B,V=W+G*O(A),F=h+C*L(A),q.push(new Zj(V,F))}var R,d,s=i["shape3d.point.epsilon"],N=!1;for(b=q.length,T=0,b=q.length;b>T;T++)R=q[T],d=T===b-1?q[0]:q[T+1],R&&d&&J(R.x-d.x)<s&&J(R.y-d.y)<s&&(N=!0,q[T]=null);if(N){var E=[];for(T=0;b>T;T++)q[T]&&E.push(q[T]);q=E}return z&&q.push(q[0]),q},gb.toShapes=function(l,Z){function n(D){var b,E,k,t,O,n=[],J=new gf;for(b=0,E=D.length;E>b;b++)k=D[b],O=k.args,t=k.action,t==Ae&&0!=J.actions.length&&(n.push(J),J=new gf),J[t].apply(J,O);return 0!=J.actions.length&&n.push(J),n}function E(t){for(var O=[],M=0,r=t.length;r>M;M++){var d=t[M],H=new vn;H.actions=d.actions,H.curves=d.curves,O.push(H)}return O}function D(s,y){for(var X=1e-10,I=y.length,i=!1,K=I-1,L=0;I>L;K=L++){var g=y[K],M=y[L],R=M.x-g.x,z=M.y-g.y;if(J(z)>X){if(0>z&&(g=y[L],R=-R,M=y[K],z=-z),s.y<g.y||s.y>M.y)continue;if(s.y==g.y){if(s.x==g.x)return!0}else{var O=z*(s.x-g.x)-R*(s.y-g.y);if(0==O)return!0;if(0>O)continue;i=!i}}else{if(s.y!=g.y)continue;if(M.x<=s.x&&s.x<=g.x||g.x<=s.x&&s.x<=M.x)return!0}}return i}var k=n(this.actions);if(0==k.length)return[];if(Z===!0)return E(k);var w,L,q,X=[];if(1==k.length)return L=k[0],q=new vn,q.actions=L.actions,q.curves=L.curves,X.push(q),X;var j=!eo.isClockWise(k[0].getPoints());j=l?!j:j;var V,r=[],F=[],U=[],T=0;F[T]=d,U[T]=[];var y,g;for(y=0,g=k.length;g>y;y++)L=k[y],V=L.getPoints(),w=eo.isClockWise(V),w=l?!w:w,w?(!j&&F[T]&&T++,F[T]={s:new vn,p:V},F[T].s.actions=L.actions,F[T].s.curves=L.curves,j&&T++,U[T]=[]):U[T].push({h:L,p:V[0]});if(!F[0])return E(k);if(F.length>1){for(var z=!1,u=[],M=0,B=F.length;B>M;M++)r[M]=[];for(var M=0,B=F.length;B>M;M++){F[M];for(var W=U[M],e=0;e<W.length;e++){for(var f=W[e],p=!0,i=0;i<F.length;i++)D(f.p,F[i].p)&&(M!=i&&u.push({froms:M,tos:i,hole:e}),p?(p=!1,r[i].push(f)):z=!0);p&&r[M].push(f)}}u.length>0&&(z||(U=r))}var A,b,I;for(y=0,g=F.length;g>y;y++)for(q=F[y].s,X.push(q),A=U[y],b=0,I=A.length;I>b;b++)q.holes.push(A[b].h);return X};var vn=function(){gf.apply(this,arguments),this.holes=[]},qm=vn.prototype=pf(gb);qm.getPointsHoles=function(b){var R,q=this.holes.length,f=[];for(R=0;q>R;R++)f[R]=this.holes[R].getTransformedPoints(b);return f},qm.extractAllPoints=function(R){return{shape:this.getTransformedPoints(R),holes:this.getPointsHoles(R)}},qm.extractPoints=function(p){return this.extractAllPoints(p)};var eo={triangulateShape:function($,L){function E(b,Q,w){return b.x!=Q.x?b.x<Q.x?b.x<=w.x&&w.x<=Q.x:Q.x<=w.x&&w.x<=b.x:b.y<Q.y?b.y<=w.y&&w.y<=Q.y:Q.y<=w.y&&w.y<=b.y}function t(B,I,Y,Z,x){var $=1e-10,y=I.x-B.x,N=I.y-B.y,t=Z.x-Y.x,h=Z.y-Y.y,A=B.x-Y.x,F=B.y-Y.y,X=N*t-y*h,q=N*A-y*F;if(J(X)>$){var M;if(X>0){if(0>q||q>X)return[];if(M=h*A-t*F,0>M||M>X)return[]}else{if(q>0||X>q)return[];if(M=h*A-t*F,M>0||X>M)return[]}if(0==M)return!x||0!=q&&q!=X?[B]:[];if(M==X)return!x||0!=q&&q!=X?[I]:[];if(0==q)return[Y];if(q==X)return[Z];var K=M/X;return[{x:B.x+K*y,y:B.y+K*N}]}if(0!=q||h*A!=t*F)return[];var m=0==y&&0==N,l=0==t&&0==h;if(m&&l)return B.x!=Y.x||B.y!=Y.y?[]:[B];if(m)return E(Y,Z,B)?[B]:[];if(l)return E(B,I,Y)?[Y]:[];var z,v,k,S,L,D,W,u;return 0!=y?(B.x<I.x?(z=B,k=B.x,v=I,S=I.x):(z=I,k=I.x,v=B,S=B.x),Y.x<Z.x?(L=Y,W=Y.x,D=Z,u=Z.x):(L=Z,W=Z.x,D=Y,u=Y.x)):(B.y<I.y?(z=B,k=B.y,v=I,S=I.y):(z=I,k=I.y,v=B,S=B.y),Y.y<Z.y?(L=Y,W=Y.y,D=Z,u=Z.y):(L=Z,W=Z.y,D=Y,u=Y.y)),W>=k?W>S?[]:S==W?x?[]:[L]:u>=S?[L,v]:[L,D]:k>u?[]:k==u?x?[]:[z]:u>=S?[z,v]:[z,D]}function n(U,k,A,u){var G=1e-10,D=k.x-U.x,E=k.y-U.y,p=A.x-U.x,F=A.y-U.y,L=u.x-U.x,I=u.y-U.y,C=D*F-E*p,j=D*I-E*L;if(J(C)>G){var Z=L*F-I*p;return C>0?j>=0&&Z>=0:j>=0||Z>=0}return j>0}function F(I,F){function L(h,U){var x=Z.length-1,m=h-1;0>m&&(m=x);var b=h+1;b>x&&(b=0);var B=n(Z[h],Z[m],Z[b],Y[U]);if(!B)return!1;var j=Y.length-1,p=U-1;0>p&&(p=j);var e=U+1;return e>j&&(e=0),B=n(Y[U],Y[p],Y[e],Z[h]),B?!0:!1}function K(B,l){var P,o,h;for(P=0;P<Z.length;P++)if(o=P+1,o%=Z.length,h=t(B,l,Z[P],Z[o],!0),h.length>0)return!0;return!1}function H(m,V){var _,P,w,D,R;for(_=0;_<z.length;_++)for(P=F[z[_]],w=0;w<P.length;w++)if(D=w+1,D%=P.length,R=t(m,V,P[w],P[D],!0),R.length>0)return!0;return!1}for(var Y,l,j,g,W,w,h,k,b,$,c,Z=I.concat(),z=[],p=[],q=0,s=F.length;s>q;q++)z.push(q);for(var S=0,X=2*z.length;z.length>0&&(X--,!(0>X));)for(j=S;j<Z.length;j++){g=Z[j],l=-1;for(var q=0;q<z.length;q++)if(w=z[q],h=g.x+":"+g.y+":"+w,p[h]===d){Y=F[w];for(var T=0;T<Y.length;T++)if(W=Y[T],L(j,T)&&!K(g,W)&&!H(g,W)){l=T,z.splice(q,1),k=Z.slice(0,j+1),b=Z.slice(j),$=Y.slice(l),c=Y.slice(0,l+1),Z=k.concat($).concat(c).concat(b),S=j;break}if(l>=0)break;p[h]=!0}if(l>=0)break}return Z}for(var M,m,a,q,b,s,S={},P=$.concat(),e=0,T=L.length;T>e;e++)Array.prototype.push.apply(P,L[e]);for(M=0,m=P.length;m>M;M++)b=P[M].x+":"+P[M].y,S[b]!==d,S[b]=M;var c=F($,L),U=Tq.Triangulate(c,!1);for(M=0,m=U.length;m>M;M++)for(q=U[M],a=0;3>a;a++)b=q[a].x+":"+q[a].y,s=S[b],s!==d&&(q[a]=s);return U.concat()},isClockWise:function(l){return Tq.Triangulate.area(l)<0},b2p0:function(k,o){var B=1-k;return B*B*o},b2p1:function(O,R){return 2*(1-O)*O*R},b2p2:function(w,S){return w*w*S},b2:function(V,W,i,A){return this.b2p0(V,W)+this.b2p1(V,i)+this.b2p2(V,A)},b3p0:function(r,z){var Z=1-r;return Z*Z*Z*z},b3p1:function(P,V){var s=1-P;return 3*s*s*P*V},b3p2:function(R,T){var k=1-R;return 3*k*R*R*T},b3p3:function(q,j){return q*q*q*j},b3:function(x,R,L,r,e){return this.b3p0(x,R)+this.b3p1(x,L)+this.b3p2(x,r)+this.b3p3(x,e)}},Tq={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var o=e.keys(this.faces);return o.length?o[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(R){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(Z){var l=Z.familyName.toLowerCase(),b=this;return b.faces[l]=b.faces[l]||{},b.faces[l][Z.cssFontWeight]=b.faces[l][Z.cssFontWeight]||{},b.faces[l][Z.cssFontWeight][Z.cssFontStyle]=Z,Z},drawText:function(F){var s,X=this.getFace(),A=this.size/X.resolution,h=0,K=String(F).split(""),t=K.length,W=[];for(s=0;t>s;s++){var P=new gf,o=this.extractGlyphPoints(K[s],X,A,h,P);o&&(h+=o.offset*this.spacing,W.push(o.path))}var x=h/2;return{paths:W,offset:x}},extractGlyphPoints:function(m,$,x,O,V){var e,p,f,b,u,w,y,F,i,v,M,z,N,h,E,Y,H,D,c,B=[],G=$.glyphs[m]||$.glyphs["?"];if(G){if(G.o)for(b=G._cachedOutline||(G._cachedOutline=G.o.split(" ")),w=b.length,y=x,F=x,e=0;w>e;)switch(u=b[e++]){case"m":i=b[e++]*y+O,v=b[e++]*F,V.moveTo(i,v);break;case"l":i=b[e++]*y+O,v=b[e++]*F,V.lineTo(i,v);break;case"q":if(M=b[e++]*y+O,z=b[e++]*F,E=b[e++]*y+O,Y=b[e++]*F,V.quadraticCurveTo(E,Y,M,z),c=B[B.length-1])for(N=c.x,h=c.y,p=1,f=this.divisions;f>=p;p++){var j=p/f;eo.b2(j,N,E,M),eo.b2(j,h,Y,z)}break;case"b":if(M=b[e++]*y+O,z=b[e++]*F,E=b[e++]*y+O,Y=b[e++]*F,H=b[e++]*y+O,D=b[e++]*F,V.bezierCurveTo(E,Y,H,D,M,z),c=B[B.length-1])for(N=c.x,h=c.y,p=1,f=this.divisions;f>=p;p++){var j=p/f;eo.b3(j,N,E,H,M),eo.b3(j,h,Y,D,z)}}return{offset:G.ha*x,path:V}}}};Tq.generateShapes=function(j,v){v=v||{};var L=v.font;if(L===d&&(L=Tq.getDefaultFont(),!L))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var s=v.size!==d?v.size:1,U=v.curveSegments!==d?v.curveSegments:4,p=v.spacing!==d?v.spacing:1,V=v.weight!==d?v.weight:"normal",Q=v.style!==d?v.style:"normal";Tq.size=s,Tq.divisions=U,Tq.face=L,Tq.weight=V,Tq.style=Q,Tq.spacing=p;for(var l=Tq.drawText(j),J=l.paths,N=[],n=0,A=J.length;A>n;n++)Array.prototype.push.apply(N,J[n].toShapes());return N},function(V){var C=1e-10,J=function(U,e){var V=U.length;if(3>V)return null;var i,q,w,J=[],Z=[],p=[];if(F(U)>0)for(q=0;V>q;q++)Z[q]=q;else for(q=0;V>q;q++)Z[q]=V-1-q;var G=V,n=2*G;for(q=G-1;G>2;){if(n--<=0)return e?p:J;if(i=q,i>=G&&(i=0),q=i+1,q>=G&&(q=0),w=q+1,w>=G&&(w=0),P(U,i,q,w,G,Z)){var z,y,o,v,s;for(z=Z[i],y=Z[q],o=Z[w],J.push([U[z],U[y],U[o]]),p.push([Z[i],Z[q],Z[w]]),v=q,s=q+1;G>s;v++,s++)Z[v]=Z[s];G--,n=2*G}}return e?p:J},F=function(Z){for(var f=Z.length,W=0,u=f-1,J=0;f>J;u=J++)W+=Z[u].x*Z[J].y-Z[J].x*Z[u].y;return.5*W},P=function(R,m,k,V,p,U){var A,$,Z,_,L,E,I,S,u;if($=R[U[m]].x,Z=R[U[m]].y,_=R[U[k]].x,L=R[U[k]].y,E=R[U[V]].x,I=R[U[V]].y,C>(_-$)*(I-Z)-(L-Z)*(E-$))return!1;var i,M,r,P,X,K,T,j,J,D,B,z,t,w,h;for(i=E-_,M=I-L,r=$-E,P=Z-I,X=_-$,K=L-Z,A=0;p>A;A++)if(S=R[U[A]].x,u=R[U[A]].y,!(S===$&&u===Z||S===_&&u===L||S===E&&u===I)&&(T=S-$,j=u-Z,J=S-_,D=u-L,B=S-E,z=u-I,h=i*D-M*J,t=X*j-K*T,w=r*z-P*B,h>=-C&&w>=-C&&t>=-C))return!1;return!0};return V.Triangulate=J,V.Triangulate.area=F,V}(Tq),g._typeface_js={faces:Tq.faces,loadFace:Tq.loadFace};var fp=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Jb=fp.prototype={constructor:fp,computeFaceNormals:function(){for(var $=new kj,h=new kj,u=0,C=this.faces.length;C>u;u++){var L=this.faces[u],U=this.vertices[L.a],G=this.vertices[L.b],t=this.vertices[L.c];$.subVectors(t,G),h.subVectors(U,G),$.cross(h),$.normalize(),L.normal.copy($)}},computeVertexNormals:function(b){var j,X,y,x,Y,W;for(W=new Array(this.vertices.length),j=0,X=this.vertices.length;X>j;j++)W[j]=new kj;if(b){var V,T,r,N=new kj,F=new kj;for(y=0,x=this.faces.length;x>y;y++)Y=this.faces[y],V=this.vertices[Y.a],T=this.vertices[Y.b],r=this.vertices[Y.c],N.subVectors(r,T),F.subVectors(V,T),N.cross(F),W[Y.a].add(N),W[Y.b].add(N),W[Y.c].add(N)}else for(y=0,x=this.faces.length;x>y;y++)Y=this.faces[y],W[Y.a].add(Y.normal),W[Y.b].add(Y.normal),W[Y.c].add(Y.normal);for(j=0,X=this.vertices.length;X>j;j++)W[j].normalize();for(y=0,x=this.faces.length;x>y;y++)Y=this.faces[y],Y.vertexNormals[0]=W[Y.a].clone(),Y.vertexNormals[1]=W[Y.b].clone(),Y.vertexNormals[2]=W[Y.c].clone()},mergeVertices:function(){var M,n,Z,F,l,J,z,m,k={},O=[],$=[],U=4,q=S(10,U);for(Z=0,F=this.vertices.length;F>Z;Z++)M=this.vertices[Z],n=t(M.x*q)+"_"+t(M.y*q)+"_"+t(M.z*q),k[n]===d?(k[n]=Z,O.push(this.vertices[Z]),$[Z]=O.length-1):$[Z]=$[k[n]];var g=[];for(Z=0,F=this.faces.length;F>Z;Z++){l=this.faces[Z],l.a=$[l.a],l.b=$[l.b],l.c=$[l.c],J=[l.a,l.b,l.c];for(var A=0;3>A;A++)if(J[A]==J[(A+1)%3]){g.push(Z);break}}for(Z=g.length-1;Z>=0;Z--){var _=g[Z];for(this.faces.splice(_,1),z=0,m=this.faceVertexUvs.length;m>z;z++)this.faceVertexUvs[z].splice(_,1)}var L=this.vertices.length-O.length;return this.vertices=O,L}},rj=function(s,e,i,P,G,v,W){this.aX=s,this.aY=e,this.xRadius=i,this.yRadius=P,this.aStartAngle=G,this.aEndAngle=v,this.aClockwise=W};rj.prototype=pf(Oj),rj.prototype.getPoint=function(H){var D,R=this.aEndAngle-this.aStartAngle;0>R&&(R+=p),R>p&&(R-=p),D=this.aClockwise===!0?this.aEndAngle+(1-H)*(p-R):this.aStartAngle+H*R;var M=this.aX+this.xRadius*O(D),m=this.aY+this.yRadius*L(D);return new Zj(M,m)};var Zq=function(Y,a){this.v1=Y,this.v2=a},Yo=Zq.prototype=pf(Oj);Yo.getPoint=function(N){var Z=this.v2.clone().sub(this.v1);return Z.multiplyScalar(N).add(this.v1),Z},Yo.getPointAt=function(S){return this.getPoint(S)},Yo.getTangent=function(){var m=this.v2.clone().sub(this.v1);return m.normalize()};var Ho=function(f,H,r){this.v0=f,this.v1=H,this.v2=r};Ho.prototype=pf(Oj),Ho.prototype.getPoint=function(b){var s,h;return s=eo.b2(b,this.v0.x,this.v1.x,this.v2.x),h=eo.b2(b,this.v0.y,this.v1.y,this.v2.y),new Zj(s,h)};var wh=function(o,q,v,y){this.v0=o,this.v1=q,this.v2=v,this.v3=y};wh.prototype=pf(Oj),wh.prototype.getPoint=function(H){var i,A;return i=eo.b3(H,this.v0.x,this.v1.x,this.v2.x,this.v3.x),A=eo.b3(H,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Zj(i,A)},Yi.create(function(j,w){this.v1=j,this.v2=w},function(C){var q=new kj;return q.subVectors(this.v2,this.v1),q.multiplyScalar(C),q.add(this.v1),q});var kc=Yi.create(function(Y,L,C){this.v0=Y,this.v1=L,this.v2=C},function(P){var u,V,a;return u=eo.b2(P,this.v0.x,this.v1.x,this.v2.x),V=eo.b2(P,this.v0.y,this.v1.y,this.v2.y),a=eo.b2(P,this.v0.z,this.v1.z,this.v2.z),new kj(u,V,a)}),Ko=Yi.create(function(m,d,C,T){this.v0=m,this.v1=d,this.v2=C,this.v3=T},function(J){var e,I,s;return e=eo.b3(J,this.v0.x,this.v1.x,this.v2.x,this.v3.x),I=eo.b3(J,this.v0.y,this.v1.y,this.v2.y,this.v3.y),s=eo.b3(J,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new kj(e,I,s)}),yo=function(Q,K,A,F,W,J,i,l){fp.call(this),F=F!==d?F:.5,W=W!==d?W:.5,l=l!==d?l:1,Q=Q||8,J=J||0,i=i||p;var q,E,B=1,Z=l/2,P=[],h=[],H=this.vertices,c=this.faces,$=this.faceVertexUvs;for(E=0;B>=E;E++){var T=[],m=[],C=E/B,M=C*(W-F)+F;for(q=0;Q>=q;q++){var t=q/Q,G=new kj,o=-(t*i+J);G.z=M*L(o),G.y=-C*l+Z,G.x=M*O(o),H.push(G),T.push(H.length-1),m.push(new Zj(t,C))}P.push(T),h.push(m)}var U,g,Y=(W-F)/l;for(q=0;Q>q;q++)for(0!==F?(U=H[P[0][q]].clone(),g=H[P[0][q+1]].clone()):(U=H[P[1][q]].clone(),g=H[P[1][q+1]].clone()),U.setY(r(U.x*U.x+U.z*U.z)*Y).normalize(),g.setY(r(g.x*g.x+g.z*g.z)*Y).normalize(),E=0;B>E;E++){var S=P[E][q],I=P[E+1][q],V=P[E+1][q+1],f=P[E][q+1],s=U.clone(),_=U.clone(),y=g.clone(),v=g.clone(),n=h[E][q].clone(),u=h[E+1][q].clone(),x=h[E+1][q+1].clone(),R=h[E][q+1].clone();
c.push(new gc(S,I,f,[s,_,v])),$[0].push([n,u,R]),c.push(new gc(I,V,f,[_.clone(),y,v.clone()])),$[0].push([u.clone(),x,R.clone()])}if(K&&F>0)for(this.vertices.push(new kj(0,Z,0)),q=0;Q>q;q++){var S=P[0][q],I=P[0][q+1],V=this.vertices.length-1,s=new kj(0,1,0),_=new kj(0,1,0),y=new kj(0,1,0),n=h[0][q].clone(),u=h[0][q+1].clone(),x=new Zj(u.x,0);c.push(new gc(S,I,V,[s,_,y],null,1));var k=q/Q*p,b=O(k),w=L(k),a=(q+1)/Q*p,D=O(a),z=L(a);$[0].push([new Zj(.5+.5*b,.5+.5*w),new Zj(.5+.5*D,.5+.5*z),new Zj(.5,.5)])}if(A&&W>0)for(this.vertices.push(new kj(0,-Z,0)),q=0;Q>q;q++){var S=P[E][q+1],I=P[E][q],V=H.length-1,s=new kj(0,-1,0),_=new kj(0,-1,0),y=new kj(0,-1,0),n=h[E][q+1].clone(),u=h[E][q].clone();c.push(new gc(S,I,V,[s,_,y],null,2));var k=q/Q*p,b=O(k),w=L(k),a=(q+1)/Q*p,D=O(a),z=L(a);$[0].push([new Zj(.5+.5*D,.5-.5*z),new Zj(.5+.5*b,.5-.5*w),new Zj(.5,.5)])}};yo.prototype=pf(Jb);var Fq=function(B,s,D,X,v,h,k){fp.call(this),k=k||.5,B=B||16,s=s||16,D=(D!==d?D:0)-N,X=X!==d?X:p,v=v!==d?v:0,h=h!==d?h:N;var m,c,E=[],R=[],U=this.vertices,b=this.faces,r=this.faceVertexUvs;for(c=0;s>=c;c++){var Z=[],T=[];for(m=0;B>=m;m++){var z=m/B,A=c/s,o=new kj;o.x=-k*O(D+z*X)*L(v+A*h),o.y=k*O(v+A*h),o.z=k*L(D+z*X)*L(v+A*h),U.push(o),Z.push(U.length-1),T.push(new Zj(z,A))}E.push(Z),R.push(T)}for(c=0;s>c;c++)for(m=0;B>m;m++){var Y=E[c][m+1],C=E[c][m],t=E[c+1][m],Q=E[c+1][m+1],F=U[Y].clone().normalize(),n=U[C].clone().normalize(),e=U[t].clone().normalize(),H=U[Q].clone().normalize(),_=R[c][m+1].clone(),M=R[c][m].clone(),I=R[c+1][m].clone(),u=R[c+1][m+1].clone();J(U[Y].y)===k?(_.x=(_.x+M.x)/2,b.push(new gc(Y,t,Q,[F,e,H])),r[0].push([_,I,u])):J(U[t].y)===k?(I.x=(I.x+u.x)/2,b.push(new gc(Y,C,t,[F,n,e])),r[0].push([_,M,I])):(b.push(new gc(Y,C,Q,[F,n,H])),r[0].push([_,M,u]),b.push(new gc(C,t,Q,[n.clone(),e,H.clone()])),r[0].push([M.clone(),I,u.clone()]))}};Fq.prototype=pf(Jb);var jk=function(H,J,X,k,z,s){fp.call(this),H=H||.33,J=J||.17,k=k||8,X=X||6,z=z||0,s=s||p;for(var l=new kj,i=[],T=[],I=0;k>=I;I++)for(var h=I/k*p+N,r=0;X>=r;r++){var m=r/X*s+z;l.x=H*O(m),l.z=-H*L(m);var g=new kj,y=H+J*O(h);g.x=y*O(m),g.z=-y*L(m),g.y=J*L(h),this.vertices.push(g),i.push(new Zj(r/X,1-I/k)),T.push(g.clone().sub(l).normalize())}for(var I=1;k>=I;I++)for(var r=1;X>=r;r++){var K=(X+1)*I+r-1,b=(X+1)*(I-1)+r-1,e=(X+1)*(I-1)+r,c=(X+1)*I+r,D=new gc(K,b,c,[T[K].clone(),T[b].clone(),T[c].clone()]);this.faces.push(D),this.faceVertexUvs[0].push([i[K].clone(),i[b].clone(),i[c].clone()]),D=new gc(b,e,c,[T[b].clone(),T[e].clone(),T[c].clone()]),this.faces.push(D),this.faceVertexUvs[0].push([i[b].clone(),i[e].clone(),i[c].clone()])}this.computeFaceNormals()};jk.prototype=pf(Jb);var Kb=function(H,X,G){return H?(fp.call(this),H=H instanceof Array?H:[H],this.addShapeList(H,X),X.convertYZ!==!1&&Ik(this,G),this.computeFaceNormals(),void 0):(H=[],void 0)},Hg=Kb.prototype=pf(fp.prototype);Hg.addShapeList=function(q,A){for(var e=q.length,K=0;e>K;K++){var i=q[K];this.addShape(i,A)}},Hg.addShape=function(e,T){function B(){if(T.bottom)for(var k=0;V>k;k++)R=L[k],S(R[2],R[1],R[0],!0);if(T.top)for(k=0;V>k;k++)R=L[k],S(R[0]+j*g,R[1]+j*g,R[2]+j*g,!1)}function u(){var E=0;for(K(U,E),E+=U.length,y=0,P=a.length;P>y;y++)I=a[y],K(I,E),E+=I.length}function K(b,C){for(var H,v,n=b.length;--n>=0;){H=n,v=n-1,0>v&&(v=b.length-1);var T=0,O=g;for(T=0;O>T;T++){var F=j*T,e=j*(T+1),l=C+H+F,x=C+v+F,N=C+v+e,t=C+H+e;Q(l,x,N,t,b,T,O,H,v)}}}function X(w,H,p){N.vertices.push(new kj(w,H,p))}function S(P,K,y,E){P+=h,K+=h,y+=h,N.faces.push(new gc(P,K,y,null,null,E?2:1));var V=E?O.generateBottomUV(N,e,T,P,K,y):O.generateTopUV(N,e,T,P,K,y);N.faceVertexUvs[0].push(V)}function Q(d,R,x,l,P,K,M,Q,Z){d+=h,R+=h,x+=h,l+=h,N.faces.push(new gc(d,R,l)),N.faces.push(new gc(R,x,l));var y=O.generateSideWallUV(N,e,P,T,d,R,x,l,K,M,Q,Z);N.faceVertexUvs[0].push([y[0],y[1],y[3]]),N.faceVertexUvs[0].push([y[1],y[2],y[3]])}var D,m,E,J,$,l=T.amount,w=T.curveSegments||qh,g=T.steps||1,c=T.extrudePath,Z=!1,O=new wr(T.repeatUVLength);c&&(D=c.getSpacedPoints(g),Z=!0,m=T.frames!==d?T.frames:new Yc.FrenetFrames(c,g,!1),E=new kj,J=new kj,$=new kj);var I,y,P,N=this,h=this.vertices.length,z=e.extractPoints(w),k=z.shape,a=z.holes,q=!eo.isClockWise(k);if(q){for(k=k.reverse(),y=0,P=a.length;P>y;y++)I=a[y],eo.isClockWise(I)&&(a[y]=I.reverse());q=!1}var L=eo.triangulateShape(k,a),U=k;for(y=0,P=a.length;P>y;y++)I=a[y],k=k.concat(I);for(var W,R,j=k.length,V=L.length,r=0;j>r;r++)W=k[r],Z?(J.copy(m.normals[0]).multiplyScalar(W.x),E.copy(m.binormals[0]).multiplyScalar(W.y),$.copy(D[0]).add(J).add(E),X($.x,$.y,$.z)):X(W.x,W.y,0);var v;for(v=1;g>=v;v++)for(r=0;j>r;r++)W=k[r],Z?(J.copy(m.normals[v]).multiplyScalar(W.x),E.copy(m.binormals[v]).multiplyScalar(W.y),$.copy(D[v]).add(J).add(E),X($.x,$.y,$.z)):X(W.x,W.y,l/g*v);B(),u()};var Yc=function(P,Y,A,e,U){function i(d,o,$){return C.vertices.push(new kj(d,o,$))-1}fp.call(this),Y=Y||64,A=A||1,e=e||8,U=U||!1;var S,t,Q,G,k,Z,X,N,z,f,W,j,H,b,E,l,q,h,I,y,n=[],C=this,w=Y+1,c=new kj,x=new Yc.FrenetFrames(P,Y,U),u=x.tangents,o=x.normals,B=x.binormals;for(this.tangents=u,this.normals=o,this.binormals=B,z=0;w>z;z++)for(n[z]=[],G=z/(w-1),N=P.getPointAt(G),S=u[z],t=o[z],Q=B[z],f=0;e>f;f++)k=f/e*p,Z=-A*O(k),X=A*L(k),c.copy(N),c.x+=Z*t.x+X*Q.x,c.y+=Z*t.y+X*Q.y,c.z+=Z*t.z+X*Q.z,n[z][f]=i(c.x,c.y,c.z);for(z=0;Y>z;z++)for(f=0;e>f;f++)W=U?(z+1)%Y:z+1,j=(f+1)%e,H=n[z][f],b=n[W][f],E=n[W][j],l=n[z][j],q=new Zj(z/Y,f/e),h=new Zj((z+1)/Y,f/e),I=new Zj((z+1)/Y,(f+1)/e),y=new Zj(z/Y,(f+1)/e),this.faces.push(new gc(H,b,l)),this.faceVertexUvs[0].push([q,h,y]),this.faces.push(new gc(b,E,l)),this.faceVertexUvs[0].push([h.clone(),I,y.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Yc.prototype=pf(Jb),Yc.FrenetFrames=function(H,B,P){function z(){x[0]=new kj,I[0]=new kj,N=Number.MAX_VALUE,l=J(h[0].x),T=J(h[0].y),W=J(h[0].z),N>=l&&(N=l,f.set(1,0,0)),N>=T&&(N=T,f.set(0,1,0)),N>=W&&f.set(0,0,1),d.crossVectors(h[0],f).normalize(),x[0].crossVectors(h[0],d),I[0].crossVectors(h[0],x[0])}var U,N,l,T,W,L,g,f=new kj,h=[],x=[],I=[],d=new kj,$=new Xc,D=B+1,q=1e-4;for(this.tangents=h,this.normals=x,this.binormals=I,L=0;D>L;L++)g=L/(D-1),h[L]=H.getTangentAt(g),h[L].normalize();for(z(),L=1;D>L;L++)x[L]=x[L-1].clone(),I[L]=I[L-1].clone(),d.crossVectors(h[L-1],h[L]),d.length()>q&&(d.normalize(),U=M(vc(h[L-1].dot(h[L]),-1,1)),x[L].applyMatrix4($.makeRotationAxis(d,U))),I[L].crossVectors(h[L],x[L]);if(P)for(U=M(vc(x[0].dot(x[D-1]),-1,1)),U/=D-1,h[0].dot(d.crossVectors(x[0],x[D-1]))>0&&(U=-U),L=1;D>L;L++)x[L].applyMatrix4($.makeRotationAxis(h[L],U*L)),I[L].crossVectors(h[L],x[L])};var Uk=function(u,l,i,D){fp.call(this),l=l||18,i=i||0,D=D==s?p:D;for(var U=1/(u.length-1),J=1/l,G=0,N=l;N>=G;G++)for(var m=i+G*J*D,n=O(m),g=L(m),$=0,v=u.length;v>$;$++){var c=u[$],j=new kj;j.x=n*c.x-g*c.y,j.y=g*c.x+n*c.y,j.z=c.z,this.vertices.push(j)}for(var r=u.length,G=0,N=l;N>G;G++)for(var $=0,v=u.length-1;v>$;$++){var x=$+r*G,V=x,W=x+r,n=x+1+r,d=x+1,Z=G*J,o=$*U,P=Z+J,b=o+U;this.faces.push(new gc(V,d,W)),this.faceVertexUvs[0].push([new Zj(Z,o),new Zj(Z,b),new Zj(P,o)]),this.faces.push(new gc(W,d,n)),this.faceVertexUvs[0].push([new Zj(P,o),new Zj(Z,b),new Zj(P,b)])}this.mergeVertices(),Ik(this),this.computeFaceNormals(),this.computeVertexNormals()};Uk.prototype=pf(Jb);var mp=function(m,L){L=L||{};var h=Tq.generateShapes(m,L);L.amount=L.amount!==d?L.amount:.5,L.convertYZ=!1,L.fill!==!1&&(L.bottom=!0,L.top=!0),Kb.call(this,h,L)};mp.prototype=pf(Hg);var Hr=l.Node=function(){$d(Hr,this)},pe={X:Uc,Y:ze,Z:rc},ac={X:0,Y:1,Z:2},Ng={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Mm="xzy",kk=function(D,j,S){if(j){var N=j[0],k=j[1],o=j[2];"xzy"===S?(ze(D,k),rc(D,o),Uc(D,N)):"xyz"===S?(rc(D,o),ze(D,k),Uc(D,N)):"yxz"===S?(rc(D,o),Uc(D,N),ze(D,k)):"yzx"===S?(Uc(D,N),rc(D,o),ze(D,k)):"zxy"===S?(ze(D,k),Uc(D,N),rc(D,o)):"zyx"===S?(Uc(D,N),ze(D,k),rc(D,o)):(ze(D,k),rc(D,o),Uc(D,N))}};tf("Node",ih,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Mm,_64O:0,_rotationX:0,_53O:0,_host:s,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return co},_22Q:function(){return xi},getX:function(){return this.p().x},setX:function(I){this.p(I,this.p().y)},getY:function(){return this.p().y},setY:function(X){this.p(this.p().x,X)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(G){this.setAnchor(G,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(F){this.setAnchor(this.getAnchor().x,F)},getScaleX:function(){return this.getScale().x},setScaleX:function(V){this.setScale(V,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(f){this.setScale(this.getScale().x,f)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(R,q){hs(R,Sr(s,s,this.r3(),this.getRotationMode())),this.translate3d(R[0]*q,R[1]*q,R[2]*q)},translateFront:function(y){this.translate3dBy([0,0,1],y)},translateBack:function(b){this.translate3dBy([0,0,-1],b)},translateLeft:function(b){this.translate3dBy([-1,0,0],b)},translateRight:function(W){this.translate3dBy([1,0,0],W)},translateTop:function(s){this.translate3dBy([0,1,0],s)},translateBottom:function(Z){this.translate3dBy([0,-1,0],Z)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(x,S,o){1===arguments.length&&(S=x[1],o=x[2],x=x[0]),this.p(x,o),this.setElevation(S)},translate3d:function(S,N,s){1===arguments.length&&(N=S[1],s=S[2],S=S[0]),this.translate(S,s),this.setElevation(this._54O+N)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(c,v,t){1===arguments.length&&(v=c[1],t=c[2],c=c[0]),this.setSize(c,t),this.setTall(v)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(T,i,l){1===arguments.length&&(i=T[1],l=T[2],T=T[0]),this.setRotationX(T),this.setRotation(-i),this.setRotationZ(l)},setRotationY:function(t){this.setRotation(-t)},getRotationY:function(){return-this._64O},lookAtDirection:function(n,i){i=i||Oh;var e=this,m=Qd(n);i===Oh?(e.r3([-W(n[1]/m),-c(n[2],n[0])+X,0]),e.setRotationMode("xzy")):i===cr?(e.r3(0,-c(n[2],n[0]),W(n[1]/m)),e.setRotationMode("zyx")):i===xb?(e.r3(0,-c(n[2],n[0])+N,-W(n[1]/m)),e.setRotationMode("zyx")):i===rg?(e.r3([-W(n[1]/m)+X,-c(n[2],n[0])+X,0]),e.setRotationMode("xzy")):i===Rc&&(e.r3([-W(n[1]/m)-X,-c(n[2],n[0])+X,0]),e.setRotationMode("xzy")),i===ss&&(e.r3([-W(n[1]/m)+N,-c(n[2],n[0])+X,N]),e.setRotationMode("zxy"))},lookAt:function(c,r){return this.lookAtDirection(ke(c,this.p3()),r)},lookAtX:function(){var Z=new wo,F=new wo,H=new wo,w=new pl,m=new pl,g=new sr;return function(a,J){var h=No(this);if(w.fromArray(h),H.copy(this.p3()),Z.copy(a).sub(H),!(Z.lengthSq()<1e-6)){Z.normalize(),J===Oh?F.set(0,0,1):J===ss?F.set(0,0,-1):J===xb?F.set(-1,0,0):J===cr?F.set(1,0,0):J===rg?F.set(0,1,0):J===Rc&&F.set(0,-1,0),F.applyMatrix4(w).sub(H).normalize();var p=Math.acos(Z.dot(F));if(p){var R=Z.clone().cross(F);R.lengthSq()<1e-6&&(J===rg||J===Rc?R.set(0,0,1).applyMatrix4(w).sub(H):R.set(0,1,0).applyMatrix4(w).sub(H)),R.normalize(),g.set(this.r3(),this.getRotationMode(),!0),w.makeRotationFromEuler(g),m.makeRotationAxis(R,-p),g.setFromRotationMatrix(m.multiply(w)),this.r3([g.x,g.y,g.z])}}}}(),getHost:function(){return this._host},setHost:function(W){var M=this;if(M!==W&&M._host!==W){var K=M._host;K&&K._removeAttach(M),M._host=W,M._host&&M._host._addAttach(M),M.fp("host",K,W),M.onHostChanged(K,W)}},getAttaches:function(){return this._69O},_addAttach:function(T){var n=this;n._69O||(n._69O=new bm),n._69O.add(T),n.fp("attaches",s,T)},_removeAttach:function(B){var y=this;y._69O.remove(B),y._69O.isEmpty()&&delete y._69O,y.fp("attaches",B,s)},getImage:function(){if(this._pendingCheckImageJSON){var c=k.getImage(this._image);c&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Cs&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(b){var h=this,P=h._image,Z=h.getWidth(),y=h.getHeight();h._image=b,h.fp("image",P,b)&&(null!=b&&(qr(b)||Or(b)&&/\.json$/i.test(b))&&(this._pendingCheckImageJSON=!0),h.fp(vs,Z,h.getWidth()),h.fp(Vk,y,h.getHeight()))},getElevation:function(){return this._54O},setElevation:function(l){var f=this;if(!f._50O){f._50O=1;var C=f._54O;f._54O=l,f.fp(Tp,C,l),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(Z){var J=this;if(!J._49O){J._49O=1;var c=J._64O;J._64O=Z,J.fp(cf,c,Z),delete J._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(K){var o=this;if(!o._51O){o._51O=1;var W=o._rotationX;o._rotationX=K,o.fp("rotationX",W,K),delete o._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(M){var _=this;if(!_._52O){_._52O=1;var U=_._53O;_._53O=M,_.fp("rotationZ",U,M),delete _._52O}},getPosition:function(){return this._position},setPosition:function(i,$){var S=this;if(!S._50I){S._50I=1;var k;if(k=2===arguments.length?{x:i,y:$}:i,k.x!==S._position.x||k.y!==S._position.y){var t=S._position;S._position=k,S.fp(go,t,k)}delete S._50I}},translate:function(X,C){var H=this._position;this.p(H.x+X,H.y+C)},getWidth:function(){var B=this;if(B._width>=0)return B._width;var c=B.getStyle("shape3d");if(c){var i=ym(c);if(i&&i.rawS3)return i.rawS3[0];if("billboard"===c||"plane"===c){var g=Qf(B.getStyle("shape3d.image"));return g?Tb(g,B):20}}var g=Qf(B._image);return g?Tb(g,B):20},setWidth:function(F){var G=this,Q=G._width;G._width=F,G.fp(vs,Q,F)},getHeight:function(){var A=this;if(A._height>=0)return A._height;var I=A.getStyle("shape3d");if(I){var y=ym(I);if(y&&y.rawS3)return y.rawS3[2];if("plane"===I){var g=Qf(A.getStyle("shape3d.image"));return g?hd(g,A):20}if("billboard"===I)return 2}var g=Qf(A._image);return g?hd(g,A):20},setHeight:function(Z){var k=this,b=k._height;k._height=Z,k.fp(Vk,b,Z)},getTall:function(){var D=this;if(D._tall>=0)return D._tall;var R=D.getStyle("shape3d");if(R){var M=ym(R);if(M&&M.rawS3)return M.rawS3[1];if("billboard"===R){var x=Qf(D.getStyle("shape3d.image"));return x?hd(x,D):20}if("plane"===R)return 2}return 20},setTall:function(K){var N=this,S=N._tall;N._tall=K,N.fp("tall",S,K)},setSize:function(E,W){var d=this;2===arguments.length?(d.setWidth(E),d.setHeight(W)):(d.setWidth(E.width),d.setHeight(E.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(P,O,K,S,F){var j=this,n=j.getAnchor(),s=j.getScale();arguments.length<=2&&(F=O,O=P.y,K=P.width,S=P.height,P=P.x);var $=F&&s.x<0?1-n.x:n.x,Z=F&&s.y<0?1-n.y:n.y;j.p(P+K*$,O+S*Z),F&&(K/=Math.abs(s.x),S/=Math.abs(s.y)),j.setWidth(K),j.setHeight(S)},getMatrix:function(){var s=this,z=s._64O,E=s._position,l=s.getScale();return new vk(z,E.x,E.y,l.x,l.y)},getAnchorRect:function(){var g=this,T=g.getWidth(),O=g.getHeight(),W=g.getAnchor();return{x:-T*W.x,y:-O*W.y,width:T,height:O}},toLocal:function(v){return this.getMatrix().tfi(v)},toGlobal:function(u){return this.getMatrix().tf(u)},getAttachPosition:function(){var A=new vk;return function(K,z,Z,U){Z=Z||0,U=U||0;var O=this,I=O.getAnchor(),V=O._64O,k=O._position,M=O.getScale();return A.setFromTransform(V,k.x,k.y).tf({x:Z+M.x*O.getWidth()*(K-I.x),y:U+M.y*O.getHeight()*(z-I.y)})}}(),isInRect:function(K){K=this.toLocal(K);var r=this.getWidth(),x=this.getHeight();return K.x+=r*this.getAnchorX(),K.y+=x*this.getAnchorY(),!(K.x<0||K.y<0||K.x>r||K.y>x)},getRect:function(){var k=this,P=k.getWidth(),c=k.getHeight(),S=k.getAnchor(),L={x:-P*S.x,y:-c*S.y,width:P,height:c},p=k.getMatrix();return L=Bc([p.tf(L.x,L.y),p.tf(L.x+L.width,L.y),p.tf(L.x+L.width,L.y+L.height),p.tf(L.x,L.y+L.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var q=this,E=q.getAnchor(),T=q._anchorElevation;return{x:E.x,y:T,z:E.y}},setAnchorElevation:function(A){var p=this,y=p._anchorElevation;return y!==A?(p._anchorElevation=A,p.fp("anchorElevation",y,A),!0):!1},setAnchor3d:function(p,y,t,h){var B,L=this;"number"==typeof p?B={x:p,y:y,z:t}:(B=p.length?{x:p[0],y:p[1],z:p[2]}:p,h=y);var X=L.getDataModel();X&&X.beginTransaction();var F=L.getAnchor3d(),P=L.setAnchor(B.x,B.z);if(L.setAnchorElevation(B.y)&&(P=!0),P&&h&&!ie){L.getAnchor3d();var T=No(L),N=hs([B.x-F.x,B.y-F.y,B.z-F.z],T);L.p3(N)}return X&&X.endTransaction(),P},getAnchor:function(){var i=this;if(i.hasOwnProperty("_anchor"))return i._anchor;var R=Qf(i._image);return R&&R.anchorX!==d?{x:R.anchorX,y:R.anchorY}:i._anchor},setAnchor:function(H,n,a){var $,_=this;"number"==typeof H?$={x:H,y:n}:($=H.length?{x:H[0],y:H[1]}:H,a=n);var U=_.getAnchor();if(U.x!==$.x||U.y!==$.y){var g=_.getDataModel();if(g&&g.beginTransaction(),_._anchor=$,_.fp("anchor",U,$),a&&!ie){var u=_.getPosition(),Y=_.getSize(),l=_.getRotation(),h=_.getScale(),Q=-Y.width*(U.x-$.x)*h.x,X=-Y.height*(U.y-$.y)*h.y,f=L(l),w=O(l);_.setPosition(u.x+w*Q-f*X,u.y+f*Q+w*X)}return g&&g.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(W,s){var X,V=this;X=2===arguments.length?{x:W,y:s}:W;var y=V.getScale();(y.x!==X.x||y.y!==X.y)&&(V._scale=X,V.fp("scale",y,X))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var L=this,M=L._scaleTall,Q=L.getScale();return[Q.x,M,Q.y]},getFinalScale3d:function(){var X=this,z=X.s3(),E=X._dynamicScale3d,d=X.getScale3d();return z&&(d[0]*=z[0],d[1]*=z[1],d[2]*=z[2]),E&&(d[0]*=E[0],d[1]*=E[1],d[2]*=E[2]),d},getFinalRotation3d:function(){var s=this;return s._dynamicRotation||s.r3()},setScaleTall:function(k){var s=this,B=s._scaleTall;B!==k&&(s._scaleTall=k,s.fp("scaleTall",B,k))},setScale3d:function(d,j,Z){var D,s=this;D="number"==typeof d?{x:d,y:j,z:Z}:d.length?{x:d[0],y:d[1],z:d[2]}:d,s.setScaleTall(D.y),s.setScale(D.x,D.z)},getCorners:function(M,C){M==s&&(M=0),C==s&&(C=M);var v=this,m=v.getAnchor(),p=v.getWidth(),c=v.getHeight(),o=-p*m.x-M,H=-c*m.y-C,j=p+2*M,A=c+2*C,Q=v.getMatrix();return[Q.tf(o,H),Q.tf(o,H+A),Q.tf(o+j,H+A),Q.tf(o+j,H)]},getEditControlPoints:function(p,Y,N){Y==s&&(Y=0),N==s&&(N=Y);var S=this,U=S.getAnchor(),i=S.getWidth(),B=S.getHeight(),W=-i*U.x-Y,k=-B*U.y-N,Z=i+2*Y,h=B+2*N;if(p)return[{x:W,y:k},{x:W,y:0},{x:W,y:k+h},{x:0,y:k+h},{x:W+Z,y:k+h},{x:W+Z,y:0},{x:W+Z,y:k},{x:0,y:k}];var u=S.getMatrix();return[u.tf(W,k),u.tf(W,0),u.tf(W,k+h),u.tf(0,k+h),u.tf(W+Z,k+h),u.tf(W+Z,0),u.tf(W+Z,k),u.tf(0,k)]},rotateAt:function(g,n,W){var j=this,I=j._position,R=j._64O,l=new vk(R,I.x,I.y).tf(g,n),Z=r(g*g+n*n),p=c(I.y-l.y,I.x-l.x)+W;j.setRotation(R+W),j.p(l.x+Z*O(p),l.y+Z*L(p))},onParentChanged:function(){Hr.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var F={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(c){F[c]=!0}),function(r){var m=this;Hr.superClass.onPropertyChanged.call(m,r),F[r.property]&&!m._layoutUpdating&&m.updateLayoutParameters(null,r.property),m._69O&&m._69O.each(function(X){X.handleHostPropertyChange(r)}),m._49I&&m._49I.each(function(Z){Z.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(d){this.updateAttach(d)},onStyleChanged:function(O){Hr.superClass.onStyleChanged.apply(this,arguments),hq[O]&&this.updateAttach()},updateAttach:function(P){var j=this;return ie?(j.updateLayoutParameters(),void 0):(j._51I||(j._51I=1,j._71O(P),delete j._51I),void 0)},_71O:function(p){var o,J,t,R,q,f,r=this,W=r._host,C=p?p.property:s,B=p?p.oldValue:s,L=p?p.newValue:s;if(W instanceof l.Grid){if(C===Tp)r.setElevation(r._54O+L-B);else if(!p||Lb[C]){if(o=r.s("attach.row.index"),J=r.s("attach.column.index"),t=W.getCellRect(o,J),!t)return;R=r.s("attach.row.span"),q=r.s("attach.column.span"),(1!==R||1!==q)&&(t=$r(t,W.getCellRect(o+R-1,J+q-1))),Jh(t,r,"attach.padding",1),r.setRect(t)}}else if(W instanceof Ar&&(f=r.s("attach.index"))>=0&&(!p||Nn[C])){var y=r.s("attach.thickness");y!=s&&r.setHeight(W.getThickness()*y);var M=r.s("attach.offset"),O=W.getPoints(),z=O.size();if(z>f){var P=O.get(f),b=z===f+1?O.get(0):O.get(f+1),V=[b.x-P.x,b.y-P.y],E=Qd(V);if(E){r.s("attach.offset.relative")&&(M*=E),r.s("attach.offset.opposite")&&(M=E-M);var n={x:P.x+V[0]/E*M,y:P.y+V[1]/E*M},U=r.s("attach.gap");U&&(r.s("attach.gap.relative")&&(U*=W.getThickness()),n=zi(s,n,b,U)),r.p(n),r.setRotation(c(V[1],V[0]))}}}else p&&(C===go?r.translate(L.x-B.x,L.y-B.y):C===Tp?r.setElevation(r._54O+L-B):Qm[C]?r._11Q(W,C,L-B):("anchor"===C||"width"===C||"height"===C||"scale"===C)&&r.layout(W))},_11Q:function(){var j=new l.Math.Euler,h=l.Math.Euler.ReverseOrder,s=new l.Math.Vector2,z=new l.Math.Vector2;return function(M,Q,N){var y=this,Y=M.p3(),e=M.r3(),g=y.p3(),C=y.r3();if(Q===cf&&(Q="rotationY",N=-N),(Q===cf||"rotationY"===Q)&&0===C[0]&&0===C[2]&&0===e[0]&&0===e[2]&&0===g[1]&&0===Y[1])return y.setRotation(-C[1]-N),s.set(g[0],g[2]).rotateAround(z.set(Y[0],Y[2]),-N),y.p(s.x,s.y),void 0;var m=Ng[M.getRotationMode()],k=m[0],R=m[1],w=m[2],E=pe[k],P=pe[R],U=pe[w],t=Il();Q===cf+k?(U(t,e[ac[w]]),P(t,e[ac[R]]),E(t,N),P(t,-e[ac[R]]),U(t,-e[ac[w]])):Q===cf+R?(U(t,e[ac[w]]),P(t,N),U(t,-e[ac[w]])):Q===cf+w&&U(t,N);var X=ke(g,Y);hs(X,t),y.p3(Y[0]+X[0],Y[1]+X[1],Y[2]+X[2]);var u=y.getRotationMode();kk(t,y.r3(),u),j.setFromRotationMatrix(t,h(u)),y.r3([j.x,j.y,j.z])}}(),isHostOn:function(A){var r=this;if(r._host&&A&&A._69O)for(var F={},d=r._host;d&&d!==r&&!F[d._id];){if(d===A)return!0;F[d._id]=d,d=d._host}return!1},isLoopedHostOn:function(U){return this.isHostOn(U)&&U.isHostOn(this)},getScaledSize:function(){var S=this.getSize(),d=this.getScale();return S.width*=Math.abs(d.x),S.height*=Math.abs(d.y),S},layout:function(v){if(v=v||this.getHost()){var s=this,E=s.s("layout.h")||"center",n=s.s("layout.v")||"center";if("center"!==E||"center"!==n){var O=new l.Math.Vector2,T=v.getPosition(),t=v.getAnchor(),S=v.getScaledSize();s.getPosition();var R,M,D,_,X,z=1,A=1;switch(s._layoutUpdating=!0,E){case"left":O.setX(s._layoutHValue-t.x*S.width);break;case"right":O.setX((1-t.x)*S.width-s._layoutHValue);break;case"leftright":R=S.width-s._layoutHValue[2],D=s.getRotation()-v.getRotation(),_=Math.abs(Math.sin(D)),X=Math.abs(Math.cos(D)),z+=X*R/s._layoutHValue[3],A+=_*R/s._layoutHValue[4],O.setX(s._layoutHValue[1]+(s._layoutHValue[5]-t.x)*S.width);break;case"center":O.setX((.5-t.x)*S.width-s._layoutHValue);break;case"scale":D=s.getRotation()-v.getRotation(),_=Math.abs(Math.sin(D)),X=Math.abs(Math.cos(D)),O.setX((.5-t.x)*S.width-s._layoutHValue[1]*S.width/s._layoutHValue[0]),M=S.width/s._layoutHValue[2]-1,z+=X*M,A+=_*M}switch(n){case"top":O.setY(s._layoutVValue-t.y*S.height);break;case"bottom":O.setY((1-t.y)*S.height-s._layoutVValue);break;case"topbottom":D||(D=s.getRotation()-v.getRotation(),_=Math.abs(Math.sin(D)),X=Math.abs(Math.cos(D))),R=S.height-s._layoutVValue[2],z+=_*R/s._layoutVValue[3],A+=X*R/s._layoutVValue[4],O.setY(s._layoutVValue[1]+(s._layoutVValue[5]-t.y)*S.height);break;case"center":O.setY((.5-t.y)*S.height-s._layoutVValue);break;case"scale":D||(D=s.getRotation()-v.getRotation(),_=Math.abs(Math.sin(D)),X=Math.abs(Math.cos(D))),O.setY((.5-t.y)*S.height-s._layoutVValue[1]*S.height/s._layoutVValue[0]),M=S.height/s._layoutVValue[2]-1,z+=_*M,A+=X*M}if("leftright"===E||"scale"===E||"topbottom"===n||"scale"===n){var G=this.getScale(),r=Math.abs(G.x),k=Math.abs(G.y);"leftright"===E||"scale"===E?s.setSize(s._layoutHValue[3]*z/r,s._layoutHValue[4]*A/k):s.setSize(s._layoutVValue[3]*z/r,s._layoutVValue[4]*A/k)}O.rotateAround(null,v.getRotation()),this.setPosition(O.x+T.x,O.y+T.y),s._layoutUpdating=d}}},updateLayoutParameters:function(T,a){if(T=T||this.getHost()){var V=this,h=V.s("layout.h"),S=V.s("layout.v");if(h||S){var p,F,M,o,A,x,$=new l.Math.Vector2,C=T.getPosition(),B=T.getAnchor(),c=T.getScaledSize(),k=V.getPosition(),D=V.getScaledSize();switch($.set(k.x-C.x,k.y-C.y),$.rotateAround(null,-T.getRotation()),h){case"left":V._layoutHValue=$.x+B.x*c.width;break;case"right":V._layoutHValue=-$.x+(1-B.x)*c.width;break;case"center":V._layoutHValue=-$.x+(.5-B.x)*c.width;break;case"leftright":case"scale":"scale"===h?p=-$.x+(.5-B.x)*c.width:(F=V.getAnchor(),M=V.getRotation()-T.getRotation(),o=Math.cos(M),A=Math.sin(M),x=-Math.min(-F.x*o+F.y*A,-F.x*o-(1-F.y)*A,(1-F.x)*o+F.y*A,(1-F.x)*o-(1-F.y)*A),p=$.x-(x-B.x)*c.width),"position"===a&&"object"==typeof V._layoutHValue?(V._layoutHValue[0]=c.width,V._layoutHValue[1]=p):V._layoutHValue=[c.width,p,c.width,D.width,D.height,x]}switch(S){case"top":V._layoutVValue=$.y+B.y*c.height;break;case"bottom":V._layoutVValue=-$.y+(1-B.y)*c.height;break;case"center":V._layoutVValue=-$.y+(.5-B.y)*c.height;break;case"topbottom":case"scale":"scale"===S?p=-$.y+(.5-B.y)*c.height:(M||(F=V.getAnchor(),M=V.getRotation()-T.getRotation(),o=Math.cos(M),A=Math.sin(M)),x=-Math.min(-F.x*A-F.y*o,-F.x*A+(1-F.y)*o,(1-F.x)*A-F.y*o,(1-F.x)*A+(1-F.y)*o),p=$.y-(x-B.y)*c.height),"position"===a&&"object"==typeof V._layoutVValue?(V._layoutVValue[0]=c.height,V._layoutVValue[1]=p):V._layoutVValue=[c.height,p,c.height,D.width,D.height,x]}}}},getSerializableProperties:function(){var Y=Hr.superClass.getSerializableProperties.call(this);return ag(Y,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),Y}});var ml=l.Edge=function(x,o){var i=this;$d(ml,i),i.setSource(x),i.setTarget(o)};tf("Edge",ih,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return _o},_22Q:function(){return Ji},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(s){if(s===this)return!1;if(rn(s))return!0;for(var w,P,F,C,R,v=[this],$=-1,T=0;T>$;)if($++,w=v[$],P=w._44I)for(P=P.getArray(),C=0,R=P.length;R>C;C++)if(F=P[C],jo(F)&&!(v.indexOf(F)>=0)){if(F===s)return!1;v.push(F),T++}return!0},setSource:function(l){var r=this;if(r._source!==l&&r.canSetSourceTarget(l)){var X=r._source;r._source=l,X&&X._16I(r),l&&l._2I(r),r._7I(),r.fp("source",X,l)}},setTarget:function(b){var N=this;if(N._target!==b&&N.canSetSourceTarget(b)){var B=N._target;N._target=b,B&&B._18I(N),b&&b._4I(N),N._7I(),N.fp("target",B,b)}},isLooped:function(){var S=this;return S._source===S._target&&rn(S._source)&&rn(S._target)},onPropertyChanged:function(){var X=this;X._49I&&X._49I.each(function(t){t.fp("agentChange",!0,!1)})},_7I:function(){var L,M=this,i=kf(M);M._40I!==i&&(L=this._40I,L&&L._15I(M),M._40I=i,i&&i._1I(M),M.fp("sourceAgent",L,i),jp(L,M._41I),jp(i,M._41I));var T=ck(M);M._41I!==T&&(L=M._41I,L&&L._17I(M),M._41I=T,T&&T._3I(M),M.fp("targetAgent",L,T),jp(L,M._40I),jp(T,M._40I))},_22I:function(d){this._52I=d,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var q=this;return q._52I&&q._52I.get(0)!==q&&!q.getStyle(oh)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var Z=this,N=Z._52I;return N&&!Z.getStyle(oh)&&N.size()>1&&Z===N.get(0)},toggle:function(){var k=this._52I,p=!this.s(oh);k&&k.size()>1&&(k.each(function(Z){Z.s(oh,p)}),k.getSiblings().each(function(P){P!==k&&P.each(function(G){G.fp("edgeGroup",s,P)})}))},setStyle:function(d,U){(d===fd||"edge.segments"===d)&&(U=Vn(U)),ml.superClass.setStyle.call(this,d,U)},onStyleChanged:function(b){ml.superClass.onStyleChanged.apply(this,arguments),Fc[b]&&jp(this._41I,this._40I)},getSerializableProperties:function(){var E=ml.superClass.getSerializableProperties.call(this);return ag(E,{source:1,target:1}),E}});var ao=l.Group=function(){$d(ao,this)};tf("Group",Hr,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return fj},onChildAdded:function(){ao.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){ao.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var X=this;if(!X._54I&&!ie){var y=X.getChildrenRect();y&&(X._53I=1,X.p(Ih(X.s("group.position"),y,X.getSize())),delete X._53I)}},getChildrenRect:function(){var Q,f=this;return f.eachChild(function(h){rn(h)&&(Q=$r(Q,f.getChildRect(h)))}),Q},getChildRect:function(D){var A;return rn(D)&&D.s(Er)&&(ue(D)&&D.isExpanded()&&D.eachChild(function(v){A=$r(A,D.getChildRect(v))}),!A&&D.getRect&&(A=D.getRect())),A},setPosition:function(A,U){var u=this;if(!u._54I){var j;j=2===arguments.length?{x:A,y:U}:A,ie||u._53I||(u._54I=1,Fe(u._children,j.x-u._position.x,j.y-u._position.y),delete u._54I),ao.superClass.setPosition.call(this,j)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(w){var U=this;if(U._57O!==w){var N=U._57O;U._57O=w,U.fp("expanded",N,U._57O),U._fireInvalidateDeep(),U._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(b){ue(b)?b._fireInvalidateDeep():b.iv()})},_8I:function(){ao.superClass._8I.call(this),this.eachChild(function(_){rn(_)&&_._8I()})},onStyleChanged:function(V){ao.superClass.onStyleChanged.apply(this,arguments),"group.position"===V&&this._81I()},getSerializableProperties:function(){var i=ao.superClass.getSerializableProperties.call(this);return i.expanded=1,i}});var Rl=l.Block=function(){$d(Rl,this)};tf("Block",Hr,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Vp},onChildAdded:function(){Rl.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Rl.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var T=this;if(!ie&&!T._updatingToChildren&&T._syncSize&&!T._freezeSyncFromChildren){var u,G,R,S,j,y=[],F=T.getRotation();if(T.eachChild(function(v){rn(v)&&y.push.apply(y,v.getCorners())}),y.length){T._updatingFromChildren=1;var N=O(-F),l=L(-F),e=1/0,r=-1/0,A=1/0,M=-1/0;for(S=0,j=y.length;j>S;S++)R=y[S],u=R.x,G=R.y,R.x=N*u-l*G,R.y=l*u+N*G,e=B(e,R.x),r=I(r,R.x),A=B(A,R.y),M=I(M,R.y);var p=T.getScale();T.setSize(J((r-e)/p.x),J((M-A)/p.y));var c;p.x<0&&(c=e,e=r,r=c),p.y<0&&(c=A,A=M,M=c),N=O(F),l=L(F);var h=T.getAnchor();u=e+(r-e)*h.x,G=A+(M-A)*h.y,T.setPosition(N*u-l*G,l*u+N*G),delete T._updatingFromChildren}}},setPosition:function(g,p){var K=this;if(!K._updatingToChildren){var _;_=2===arguments.length?{x:g,y:p}:g,ie||K._updatingFromChildren||(K._updatingToChildren=1,Fe(K._children,_.x-K._position.x,_.y-K._position.y),delete K._updatingToChildren),Rl.superClass.setPosition.call(this,_)}},setWidth:function(L){return this.setSize(L,this.getHeight())},setHeight:function(q){return this.setSize(this.getWidth(),q)},setSize:function($,j){1>$&&($=1),1>j&&(j=1);var V=this;if(!V._updatingToChildren){2!==arguments.length&&(j=$.height,$=$.width);var f=V.getWidth(),U=V.getHeight();if($!==f&&Rl.superClass.setWidth.call(V,$),j!==U&&Rl.superClass.setHeight.call(V,j),!ie&&!V._updatingFromChildren){V._updatingToChildren=1;var M=$/f,h=j/U;V._adjustChildScaleOrSize(M,h,"size"),delete V._updatingToChildren,V.updateFromChildren()}}},_adjustChildScaleOrSize:function(H,R,z){var U=this;if(U._syncSize){var b=U.getPosition(),$=U.getRotation();U.getScale(),U.eachChild(function(E){if(rn(E)){var Q=E.getPosition(),G=E.getRotation(),y=E.getWidth(),u=E.getHeight(),h=E.getScale(),j=h.x*y,K=h.y*u,s=new vk(G,Q.x,Q.y,j,K);s.translate(-b.x,-b.y),s.rotate(-$),G=c(s.b*Math.sign(j),s.a*Math.sign(j)),s.scale(H,R);var t,I,m,J=O(G);if(Math.abs(J)<.001?(t=L(G),I=s.b/t,m=-s.c/t):(I=s.a/J,m=s.d/J),"scale"===z)E.setScale(I/y,m/u);
else if("size"===z){var B=I/h.x,d=m/h.y;E.setScale(Pj(I)*Math.abs(h.x),Pj(m)*Math.abs(h.y)),E instanceof l.Shape?(E.setWidthForce(Math.max(Math.abs(B),1e-5)),E.setHeightForce(Math.max(Math.abs(d),1e-5))):E.setSize(Math.max(.01,Math.abs(B)),Math.max(.01,Math.abs(d)))}s.rotate($),s.translate(b.x,b.y),E.setPosition(s.tx,s.ty)}})}},_calcChangeFactor:function(X,r,U,v){var l,K,z,W;return l=J(X),K=J(U),z=l>K?l/K:K/l,l=J(r),K=J(v),W=l>K?l/K:K/l,I(z,W)},setAnchor:function(){var I=this;if(!I._updatingToChildren){var z=I.getAnchor();if(Rl.superClass.setAnchor.apply(I,arguments),!ie&&!I._updatingFromChildren&&I._syncSize){I._updatingToChildren=1;var w=I.getAnchor();I.getPosition();var P=I.getSize(),r=I.getScale(),N=I.getRotation(),S=-P.width*r.x*(z.x-w.x),a=-P.height*r.y*(z.y-w.y),U=L(N),p=O(N),E=p*S-U*a,$=U*S+p*a;I.eachChild(function(q){if(rn(q)){var z=q.getPosition();q.setPosition(z.x-E,z.y-$)}}),delete I._updatingToChildren}}},setRotation:function(K){var Y=this;if(!Y._updatingToChildren){var f=Y.getRotation();if(Rl.superClass.setRotation.apply(Y,arguments),!ie&&!Y._updatingFromChildren){Y._updatingToChildren=1;var e=Y.getPosition(),r=K-f;Y.eachChild(function(Q){if(rn(Q)){var f=Q.getMatrix();f.translate(-e.x,-e.y),f.rotate(r),f.translate(e.x,e.y);var B=Math.sign(Q.getScale().x);Q.setRotation(c(f.b*B,f.a*B)),Q.setPosition(f.tx,f.ty)}}),delete Y._updatingToChildren}}},setScale:function(L,F){var E=this;if(!E._updatingToChildren){null==F&&(F=L.y,L=L.x);var j=E.getScale();if(J(L)<.01&&(L=.01*(Pj(L)||Pj(j.x))),J(F)<.01&&(F=.01*(Pj(F)||Pj(j.y))),Rl.superClass.setScale.call(E,L,F),!ie&&!E._updatingFromChildren){E._updatingToChildren=1;var s=L/j.x,D=F/j.y;E._adjustChildScaleOrSize(s,D,"size"),delete E._updatingToChildren,E.updateFromChildren()}}},getSerializableProperties:function(){var $=Rl.superClass.getSerializableProperties.call(this);return $.clickThroughEnabled=1,$.syncSize=1,$}});var lf=l.Grid=function(){$d(l.Grid,this)};tf("Grid",Hr,{IRotatable:!1,_icon:"grid_icon",_image:s,getUIClass:function(){return nn},setRotation:function(){},getCellRect:function(d,y){var x=this,U=x.s("grid.row.count"),g=x.s("grid.column.count");if(0>=U||0>=g||0>d||d>=U||0>y||y>=g)return s;var n,w,b,M=x.getRect(),q=x.s("grid.row.percents"),e=x.s("grid.column.percents");if(Jh(M,x,"grid.border",-1),q&&q._as&&(q=q._as),e&&e._as&&(e=e._as),q&&q.length===U){for(b=0,n=0;d>n;n++)b+=M.height*q[n];M.y+=b,M.height=M.height*q[d]}else M.height=M.height/U,M.y+=M.height*d;if(e&&e.length===g){for(w=0,n=0;y>n;n++)w+=M.width*e[n];M.x+=w,M.width=M.width*e[y]}else M.width=M.width/g,M.x+=M.width*y;return ho(M,-x.s("grid.gap")),M}});var fc=l.Text=function(){$d(fc,this),this.setSize(100,50),this.s("text","TEXT")};tf("Text",Hr,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ff},setWidth:function(K){K||(K=.001),fc.superClass.setWidth.call(this,K)},setHeight:function(H){H||(H=.001),fc.superClass.setHeight.call(this,H)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),$m("__text__",{width:{value:100,isSafeFunc:!0,func:function(p){return p._width}},height:{value:50,isSafeFunc:!0,func:function(l){return l._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Ar=l.Shape=function(){$d(Ar,this),this._59O=new bm};Ar.__de__=cm,tf("Shape",Hr,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return th},_22Q:function(){return nk},getLength:function(C){return nm(Si(this._59O,this._58O,C,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var V=this._58O;return V?new bm(V._as.slice(0)):V},setSegments:function(J){var f=this._58O;J=J?Cq(J)?new bm(J.slice(0)):new bm(J._as.slice(0)):null,(f&&J&&f._as.join(",")!==J._as.join(",")||f!==J)&&(this._58O=J,this.fp("segments",f,J))},getPoints:function(){return this._59O},toPoints:function(){var J=this._59O;return new bm(J._as.slice(0))},setPoints:function(x,E){var o=this,v=o._59O;x=x?Cq(x)?new bm(x.slice(0)):new bm(x._as.slice(0)):new bm;var r,y,i,a,n,_;E&&(r=o.getPosition(),_=new vk(o.getRotation(),0,0,o.getScale().x,o.getScale().y)),(v&&x&&v._as.join(",")!==x._as.join(",")||v!==x)&&(o._59O=x,o.fs(),o.fp("points",v,x)),E&&(y=o.getPosition(),i=y.x-r.x,a=y.y-r.y,n=_.tf(i,a),o.setPosition(y.x-i+n.x,y.y-a+n.y))},addPoint:function(o,E,c){var P=this.toPoints();P.add(o,E),this.setPoints(P,c)},setPoint:function(D,Y,V){var P=this.toPoints();P.set(D,Y),this.setPoints(P,V)},removePointAt:function(y){var _=this.toPoints();_.removeAt(y),this.setPoints(_)},setWidthForce:function(s){var w=this;if(!w._55I&&!ie&&w.getWidth()){w._55I=1;var X=w._position.x,v=s/w.getWidth(),G=w.toPoints(),W=new bm;1!==v&&(G.each(function(o){W.add({x:(o.x-X)*v+X,y:o.y,e:o.e})}),w.setPoints(W),xp(w,[v,0,0,1,X*(1-v),0]),w.fs()),delete w._55I}Ar.superClass.setWidth.call(w,s)},setWidth:function(M){return this.setWidthForce(1>M?1:M)},setHeightForce:function(Q){var l=this;if(!l._55I&&!ie&&l.getHeight()){l._55I=1;var q=l._position.y,m=Q/l.getHeight(),P=l.toPoints(),d=new bm;1!==m&&(P.each(function(Y){d.add({x:Y.x,y:(Y.y-q)*m+q,e:Y.e})}),l.setPoints(d),xp(l,[1,0,0,m,0,q*(1-m)]),l.fs()),delete l._55I}Ar.superClass.setHeight.call(l,Q)},setHeight:function(O){return this.setHeightForce(1>O?1:O)},setAnchorElevation:function(D){var V=this;V._55I=!0;var U=V._updatingAnchor3d,q=!ie&&!U;if(q){var g,d=D,i=V.getAnchorElevation(),C=V.getTall();g=C*(i-d),0!==g&&V.shiftPointsElevation(g)}var O=Ar.superClass.setAnchorElevation.apply(V,arguments);return U||delete V._55I,O},getShapeElevation:function(){var N=this,s=N._54O;return s-(N.getTall()||0)*(N._anchorElevation-.5)},setAnchor3d:function(d,K,y,j){var O,E=this;"number"==typeof d?O={x:d,y:K,z:y}:(O=d.length?{x:d[0],y:d[1],z:d[2]}:d,j=K),E._55I=!0,E._updatingAnchor3d=!0;var F=E.getDataModel();if(F&&F.beginTransaction(),!ie){var v=E.getAnchor3d(),P=E.getSize(),n=E.getTall(),A=P.width*(v.x-O.x),f=P.height*(v.z-O.z),m=n*(v.y-O.y);j||E.shiftPoints(A,f,m);var I=E.p3()}var C=Ar.superClass.setAnchor3d.apply(E,arguments);if(!ie&&j){var e=E.p3();E.shiftPoints(e[0]-I[0]+A,e[2]-I[2]+f,e[1]-I[1]+m)}return F&&F.endTransaction(),delete E._updatingAnchor3d,delete E._55I,C},setAnchor:function(h,X,d){var f=this;f._55I=!0;var $=f._updatingAnchor3d,w=!ie&&!$;if(w){var y,L,z;"number"==typeof h?z={x:h,y:X}:(z=h.length?{x:h[0],y:h[1]}:h,d=X);var e=f.getAnchor(),S=f.getSize();y=S.width*(e.x-z.x),L=S.height*(e.y-z.y),d||f.shiftPoints(y,L);var D=f.getPosition()}var P=Ar.superClass.setAnchor.apply(f,arguments);if(w){var M=f.getPosition();d&&f.shiftPoints(M.x-D.x+y,M.y-D.y+L)}return $||delete f._55I,P},shiftPoints:function(_,q,Y){if(_||q||Y){var n=this,F=n.getElevation()||0,E=n.toPoints(),W=new bm;E.each(function(i){var Q=i.e;Y&&(Q=(Q==s?F:Q)+Y),W.add({x:i.x+_,y:i.y+q,e:Q})}),n.setPoints(W),n.fs()}},shiftPointsElevation:function(n){return this.shiftPoints(0,0,n)},setPosition:function(A,i){var C,B=this;if(!B._28Q){if(B._28Q=1,!B._55I&&!ie){C=2===arguments.length?{x:A,y:i}:A;var j=C.x-B._position.x,P=C.y-B._position.y;if(0===j&&0===P)return delete B._28Q,void 0;B._55I=1,B.shiftPoints(j,P),xp(B,[1,0,0,1,j,P]),delete B._55I}Ar.superClass.setPosition.apply(B,arguments),delete B._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var x=this;if(2!==x._59O.size())return!1;var Z=x._58O;return Z?2===Z.size()&&1===Z.get(0)&&2===Z.get(1)?!0:!1:!0},fireShapeChange:function(){var u=this;if(!u._55I&&!ie){var z=Bc(u._59O);z&&(u._55I=1,u.setRect(z),delete u._55I)}u.fp(mj,!1,!0)},getSerializableProperties:function(){var t=Ar.superClass.getSerializableProperties.call(this);return t.segments=1,t.points=1,t.thickness=1,t.closePath=1,t}});var ud=l.Polyline=function(){$d(ud,this),this.s({"shape.background":null,"shape.border.width":2})};tf("Polyline",Ar,{_icon:"polyline_icon",_22Q:function(){return Zk},getUIClass:function(){return _m},setClosePath:function(){},setTall:function(C){var W=this,y=W.getDataModel();if(y&&y.beginTransaction(),!W._55I&&!W._24Q&&!ie&&W.getTall()){W._24Q=1;var U=W._54O,k=C/W.getTall();if(1!==k){var p=W.toPoints(),x=new bm;p.each(function(X){x.add({x:X.x,y:X.y,e:X.e==s?X.e:(X.e-U)*k+U})}),W.setPoints(x),W.fs()}delete W._24Q}ud.superClass.setTall.call(W,C),y&&y.endTransaction()},setElevation:function(W){var z=this,n=z.getDataModel();if(n&&n.beginTransaction(),!z._55I&&!z._24Q&&!ie){z._24Q=1;var h=W-z._54O;0!==h&&z.shiftPointsElevation(h),delete z._24Q}ud.superClass.setElevation.apply(z,arguments),n&&n.endTransaction()},fireShapeChange:function(){var t=this,b=t._59O;if(!t._55I&&!t._24Q&&!ie){var a=b.size();if(a){var k=1,R=b.get(0),n=t._54O;R.e==s&&(R.e=n);for(var v=R.e,V=0;a>k;k++){R=b.get(k),R.e==s&&(R.e=n);var T=B(v,R.e),J=I(v+V,R.e);v=T,V=J-T}t._24Q=1,t.setTall(V),t.setElevation(v+V*t._anchorElevation),delete t._24Q}}ud.superClass.fireShapeChange.apply(t,arguments)}});var yb=l.SubGraph=function(){$d(yb,this)};tf("SubGraph",Hr,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){yb.superClass._8I.call(this),this.eachChild(function(b){rn(b)&&b._8I()})}}),k.loadingRefGraph=0;var Cs=l.RefGraph=function(){$d(Cs,this)};tf("RefGraph",Rl,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(E){var M=this._ref;this._ref=E,this.fp("ref",M,E),this.updateRef()},_21I:function(){Cs.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var f=this;if(k.loadingRefGraph++,f.clearChildrenFromDataModel(),k.loadingRefGraph--,f._ref&&f._dataModel){f._xhrLoadHandler&&(f._xhrLoadHandler.cancel=!0);var t=ie,e=f._xhrLoadHandler=function(U){if(U&&f._dataModel){k.loadingRefGraph++;var R=f._pendingUpdateInfo={needToRestore:t};t&&(R.position=f.p(),R.width=f.getWidth(),R.height=f.getHeight(),R.rotation=f.getRotation(),R.anchor=f.getAnchor(),R.scale=f.getScale()),f.p(0,0),f.setAnchor(.5,.5),f.setRotation(0),f.setScale(1,1);var W=k.parse(U),M=f._dataModel.deserialize(W,f,{justDatas:!0});M.each(function(K){K._refGraph=f}),f.checkPendingUpdateInfo(),k.loadingRefGraph--,k.handleRefGraphLoaded(f,M,W)}};e.xhrLoadCalled=!1,k.load(f._ref,function(O){e.cancel||(e.xhrLoadCalled?e(O):Ag(function(){e(O)}))}),e.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var T=this,y=T._pendingUpdateInfo;if(!y)return T.onPendingUpdated&&(k.loadingRefGraph++,T.onPendingUpdated(),k.loadingRefGraph--),void 0;var $=!0;this.eachChild(function(L){(L._pendingCheckImageJSON||L._pendingUpdateInfo)&&($=!1)}),$&&(k.loadingRefGraph++,T._pendingUpdateInfo=null,T.updateFromChildren(),y.needToRestore&&(T.setSize(y.width,y.height),T.setAnchor(y.anchor),T.setRotation(y.rotation),T.setScale(y.scale),T.p(y.position)),this.getParent()instanceof Cs&&this.getParent().checkPendingUpdateInfo(),T.onPendingUpdated&&T.onPendingUpdated(),k.loadingRefGraph--)},getSerializableProperties:function(){var I=Cs.superClass.getSerializableProperties.call(this);return I.ref=1,I}}),l.EdgeGroup=function(H,Z){this._70O=H,this._siblings=Z;for(var N,o,F=0,O=H.size(),Y=i[oh];O>F;F++)if(N=H.get(F).getStyle(oh,!1),N!=s){Y=N;break}Y==s&&(Y=!0);var j=k.edgeGroupAgentFunc;for(j&&(o=j(H),o&&o!==H.get(0)&&(H.remove(o),H.add(o,0))),F=0;O>F;F++)H.get(F).s(oh,Y)},tf("EdgeGroup",e,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(S){return this._70O.get(S)},indexOf:function(b){return this._70O.indexOf(b)},each:function(Q,J){this._70O.each(Q,J)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(z,M){this._siblings.each(function(I){I._70O.each(z,M)})}});var Dh=function(M,H,Q){var O=Bp[M]={type:M,action:H};if(Q)for(var o in Q)O[o]=Q[o]};ag(k,{setConnectAction:Dh,getConnectAction:function(i,j){if(!j){if(!i)return null;j=i.getCurrentConnectActionType()}return Bp[j]},doConnectAction:function(C,D,S,G){G=G||C.getCurrentConnectActionType();var U=Bp[G];if(!U)return!1;var Y=U.action;return Y?(D instanceof tg.Group?C.sm().getSelection().each(function(i){Y.call(null,C,i,S)}):Y.call(null,C,D,S),!0):!1},doDeleteConnectionAction:function(V,P,W){W=W||V.getCurrentConnectActionType();var r=Bp[W];if(!r||!r.delete)return!1;var v=r.delete.action;return v?(P instanceof tg.Group?V.sm().getSelection().each(function(P){v.call(null,V,P)}):v.call(null,V,P),!0):!1}});var mk=l.JSONSerializer=function(U,n){this.dm=this._dataModel=U,this._hierarchical=k.forceHierarchicalSerialization?!0:n==s?U.isHierarchicalRendering():n};tf("JSONSerializer",e,{ms_ac:["hierarchical"],serialize:function(g){return k.stringify(this.toJSON(),g)},toJSON:function(){var j=this,A=j.dm,I=A.getRoots(),r=j.json={v:k.getVersion(),p:{},a:{},d:[]},g=A.getSerializableAttrs();A.getInit()&&(r.init=A.getInit()),A.getName()&&(r.p.name=A.getName()),A.getBackground()&&(r.p.background=A.getBackground()),A.getLayers()&&(r.p.layers=A.getLayers()),A.getEnvmap()&&(r.p.envmap=A.getEnvmap()),r.p.autoAdjustIndex=A.isAutoAdjustIndex(),r.p.hierarchicalRendering=A.isHierarchicalRendering();for(var U in g){var F=A.a(U);F!==d&&j[Eg](U,F,r.a)}return ol(r.a)&&delete r.a,j._hierarchical?I.each(j.serializeData,this):A.each(function(p){j.serializeData(p)}),A.fireSerializeEvent({type:"serialize",json:r}),A.getPostProcessingData()&&(r.p.postProcessingData=A.getPostProcessingData()),r},isSerializable:function(){return!0},getProperties:function(h){return h.getSerializableProperties()},getStyles:function(v){return v.getSerializableStyles()},getAttrs:function(T){return T.getSerializableAttrs()},serializeData:function(p){var h=this;if(h.isSerializable(p)&&!p._refGraph){var F,b,x,g,q=iq(p.getClassName())||p.getClass(),m=new q,I={c:p.getClassName(),i:p.getId(),p:{},s:{},a:{}};h.json.d.push(I),F=h.getProperties(p);for(b in F)if(/^_/.test(b)){if(x=p[b],("_width"===b||"_height"===b)&&x===d){var D;((p.s("layout.h")||p.s("layout.v"))&&p.getHost()||p instanceof l.Node&&(D=p.getParent())&&D instanceof l.Block||p.s("fullscreen"))&&(x=p[b]="_width"===b?p.getWidth():p.getHeight())}x!==m[b]&&h[Eg](b.substr(1),x,I.p)}else g=zl(b),p[g]&&(x=p[g](),x!==m[g]()&&h[Eg](b,x,I.p));F=h.getStyles(p);for(b in F)x=p.s(b),x!==m.s(b)&&h[Eg](b,x,I.s);F=h.getAttrs(p);for(b in F)x=p.a(b),x!==m.a(b)&&h[Eg](b,x,I.a);ol(I.p)&&delete I.p,ol(I.s)&&delete I.s,ol(I.a)&&delete I.a}h._hierarchical&&p.getChildren().each(h.serializeData,h)},serializeValue:function(O,U,a){us(U)?U={__a:U._as}:U instanceof ih&&(U={__i:U.getId()}),a[O]=U},deserialize:function(J,c,V){var K=this;return Or(J)&&/.json$/.test(J)?(k.xhrLoad(J,function(J){K.deserializeImpl(J,c,V)}),void 0):K.deserializeImpl(J,c,V)},deserializeImpl:function(F,y,f){var V=this,G=V.dm;f=Zl(f)?{setId:f}:Lo(f)?{finishFunc:f}:f||{},F=V.json=Or(F)?k.parse(F):F,F.a&&F.a.onPreDeserialize&&!f.disableOnPreDeserialize&&F.a.onPreDeserialize(F,G,f.view),G.beginTransaction(),ie++,V._82I={};var T=new bm,S=new bm,X=0,t=F.d.length;if(f.justDatas||(Lo(F.init)&&F.init(G),G.setInit(F.init)),!f.justDatas){for(var g in F.a)G.a(g,V[Jl](F.a[g]));for(var i in F.p)G[Wg(i)](F.p[i])}for(;t>X;X++){var P=F.d[X],z=iq(P.c),j=new z,D=P.i;f.setId&&D!=s&&(j._id=D),V._82I[D]=j,T.add(j),S.add(P)}for(X=0;t>X;X++)V.deserializeData(T.get(X),S.get(X));return T.each(function($){y&&!$.getParent()&&$.setParent(y),G.add($)}),G.fireSerializeEvent({type:"deserialize",json:F}),ie--,G.endTransaction(),F.a&&F.a.onPostDeserialize&&!f.disableOnPostDeserialize&&F.a.onPostDeserialize(F,G,f.view,T),f.finishFunc&&f.finishFunc(F,G,f.view,T),T},deserializeData:function(J,u){for(var M in u.p)J[Wg(M)](this[Jl](u.p[M]));for(M in u.s)J.s(M,this[Jl](u.s[M]));for(M in u.a)J.a(M,this[Jl](u.a[M]))},deserializeValue:function(A){if(qr(A)){var l=A.__i;if(l!=s)return this._82I[l];if(l=A.__a,Cq(l))return new bm(l)}return A}}),ag(Yg,{serialize:function(x,v){return new mk(this,v).serialize(x)},toJSON:function(b){return new mk(this,b).toJSON()},deserialize:function(P,F,$){return new mk(this).deserialize(P,F,$)}});var Jn=l.OverlappingBox=function(V){this.gv=V,this.boxes={}};tf("OverlappingBox",e,{clear:function(){var d,e,J=this.boxes;for(d in J)e=J[d],e.length=0},isOverlapping:function(U,K){var z,Q,S=this,s=S.boxes,r=s[U];r?(z=r.rects,Q=r.length):r=s[U]={rects:z=[],length:Q=0};var g,N,K;for(g=0;Q>g;g++)if(N=z[g],N.x<K.x+K.w&&N.x+N.w>K.x&&N.y<K.y+K.h&&N.h+N.y>K.y)return!0;return z.length<=Q?(z.push(K),r.length++):z[r.length++]=K,!1}}),ag(k,{fetch:function(Z,I){var n="GET",Y=!1,_=null,w="";I&&(n=I.method||"GET",Y=I.sync,w=I.url,_=I.data||null),Z.open(n,w,!Y),I.responseType?Z.responseType=I.responseType:I.overrideMimeType&&Z.overrideMimeType&&Z.overrideMimeType(I.overrideMimeType),Z.send(_)},convertImageSrc:function(e,q){q&&"function"==typeof q||(q=function(){}),q(e)}});var Yp=l.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};tf("Request",e,{_responseType:null,_overrideMimeType:"text/plain",send:function(q){var f=this._xhr,V=this.onload,P=this.onerror;this.getResponseType()?q.responseType=this.getResponseType():this.getOverrideMimeType()&&(q.overrideMimeType=this.getOverrideMimeType()),f.onload=V,f.onerror=P,k.fetch(f,q)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(S){this._responseType=S},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(e){this._overrideMimeType=e},getResponseText:function(){var m=this._xhr;return m.response||m.responseText}}),Lk.GraphView=function(t){var P=this;P._24I={},P._34I=new bm,P._25I={},P._56I={},P._view=Eq(1,P),P._canvas=sb(P._view),P.dm(t?t:new Yg),this._coreInteractor=new ei(this),P.setEditable(!1),P.setScrollBarVisible(k.graphViewScrollBarVisible)},Wp("GraphView",e,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Ce,mm,Yb,jm,"resettable","editInteractor",se,"zoomable","pannable","rectSelectable","autoScrollZone",mb,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:k.graphViewZoomable,_resettable:k.graphViewResettable,_pannable:k.graphViewPannable,_rectSelectable:k.graphViewRectSelectable,_autoScrollZone:k.graphViewAutoScrollZone,_rectSelectBackground:k.graphViewRectSelectBackground,_rectSelectBorderColor:k.graphViewRectSelectBorderColor,_editPointSize:k.graphViewEditPointSize,_editPointBorderColor:k.graphViewEditPointBorderColor,_editPointBackground:k.graphViewEditPointBackground,_scrollBarColor:zo,_scrollBarSize:Ah,_autoHideScrollBar:nl,_autoMakeVisible:Pr,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(Y){this._dataModel.setLayers(Y)},setEditable:function(O){var R=this,t=R.__interactorMap__;if(!t){var Z=Lk.XEditInteractor;t=R.__interactorMap__={scrollBar:new di(R),select:new fb(R),edit:Z?new Z(R):new ks(R),text:new uo(R),move:new Mh(R),"default":new _r(R),touch:new Fl(R,{editable:!1})}}O?(R._uieditable=!0,R.setInteractors([t.scrollBar,t.select,t.edit,t.text,t.move,t.default,t.touch])):(R._uieditable=!1,R.setInteractors([t.scrollBar,t.select,t.move,t.default,t.touch]))},getCanvas:function(){return this._canvas},_33I:function(W){var _=W.getUIClass();return _?new _(this,W):s},getDataUI:function(L){var t=this,E=t._25I[L._id];return E===d&&(E=t._33I(L),t._25I[L._id]=E),E},getNodeRect:function(s){return k.getNodeRect(this,s)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(c){var A=this.getDataUI(c);return A?(A._79o(),A._78o):null},getEdgeSourcePosition:function(B){var H=this,n=H.getDataUI(B),P=n.s,Z=n._data._40I;return Ao(H,Z,P("edge.source.position"),P("edge.source.offset.x"),P("edge.source.offset.y"),P("edge.source.anchor.x"),P("edge.source.anchor.y"))},getEdgeTargetPosition:function(P){var m=this,W=m.getDataUI(P),j=W.s,C=W._data._41I;return Ao(m,C,j("edge.target.position"),j("edge.target.offset.x"),j("edge.target.offset.y"),j("edge.target.anchor.x"),j("edge.target.anchor.y"))},invalidateAll:function(X){var t=this;if(X){for(var c in t._25I){var n=t._25I[c];n&&n.dispose()}t._25I={},t._56I={},t._24I={},t._34I.clear(),t.redraw()}else t.dm().each(function(m){t.invalidateData(m)})},invalidateSelection:function(){var N=this;N.sm().each(function(m){N.invalidateData(m)})},invalidateData:function(S){var K=this;K._24I[S._id]=S,K._21Q(S),K.iv()},_21Q:function(B){var u=this,R=u._24I;if(jo(B)&&Db[B.s(Oe)]){var m=B.getSourceAgent();m&&m.getAgentEdges().each(function(j){R[j._id]=j}),m=B.getTargetAgent(),m&&m.getAgentEdges().each(function(r){R[r._id]=r}),u.iv()}},redraw:function(l){var b=this;b._32I||(l?b._34I.add(l):(b._32I=1,b._34I.clear()),b.iv())},each:function(k,q){var I,R,E,f=0,o=this.getLayers(),Q=this._dataModel,O=Q._datas._as,V=O.length;if(o){for(var u=o.length;u>f;f++)if(E=o[f],qr(E)&&(E=E.name),Q.isHierarchicalRendering()){var m=function(u){return u._layer===E?q?k.call(q,u):k(u):void 0};if(this._dataModel.eachByHierarchical(m)===!1)return}else for(var r=0;V>r;r++)if(I=O[r],I._layer===E&&(R=q?k.call(q,I):k(I),R===!1))return}else if(Q.isHierarchicalRendering())this._dataModel.eachByHierarchical(k,null,q);else for(;V>f;f++)if(I=O[f],R=q?k.call(q,I):k(I),R===!1)return},reverseEach:function(u,F){var Z,c,k,h,K=this._dataModel,M=K._layers,g=K._datas._as,w=g.length;if(M){for(Z=M.length-1;Z>=0;Z--)if(h=M[Z],qr(h)&&(h=h.name),K.isHierarchicalRendering()){var H=function(p){return p._layer===h?F?u.call(F,p):u(p):void 0};if(K.reverseEachByHierarchical(H)===!1)return}else for(var D=w-1;D>=0;D--)if(c=g[D],c._layer===h&&(k=F?u.call(F,c):u(c),k===!1))return}else if(K.isHierarchicalRendering())K.reverseEachByHierarchical(u,null,F);else for(Z=w-1;Z>=0;Z--)if(c=g[Z],k=F?u.call(F,c):u(c),k===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var d=this,n=d._84I;if(!n){var E=this.dm().a("width"),O=this.dm().a("height");E>0&&O>0?d._84I={x:0,y:0,width:E,height:O}:(d.each(function(h){d.isVisible(h)&&(n=$r(n,d.getDataUIBounds(h)))}),d._84I=n?n:sc)}return d._84I},getScrollRect:function(){return $r(this.getContentRect(),this._29I)},makeCenter:function(G,A,E){var V=this;if(!V.getWidth()||!V.getHeight())return E||Ag(V.makeCenter,V,[G,A,!0],500),void 0;V.makeVisible(G),V.validate();var W=V.getDataUIBounds(G);if(W){var u=V.getWidth(),B=V.getHeight(),C=W.x+W.width/2,f=W.y+W.height/2,U=-C*V._zoom+u/2,s=-f*V._zoom+B/2;V.setTranslate(U,s,A)}},fitData:function(m,j,l,x,K){var D=this;if(!D.getWidth()||!D.getHeight())return K||Ag(D.fitData,D,[m,j,l,x,!0],500),void 0;var w=function(){D.makeVisible(m),D.validate();var M=D.getDataUIBounds(m);M&&(M=Tm(M),ho(M,l==s?20:l),D.fitRect(M,j,x))};j?k.callWhenLoaded(w):w()},fitContent:function(A,b,K,O){var Z=this;if(!Z.getWidth()||!Z.getHeight())return O||Ag(Z.fitContent,Z,[A,b,K,!0],500),void 0;var J=function(){Z.validate();var M=Tm(Z.getContentRect());ho(M,b==s?20:b),Z.fitRect(M,A,K)};A?k.callWhenLoaded(J):J()},fitRect:function(G,T,I){var M=this,a=M.getWidth(),X=M.getHeight(),k=G.x+G.width/2,q=G.y+G.height/2,z=B(a/G.width,X/G.height),S=M._zoom,L=-k*S+a/2,H=-q*S+X/2;0===z||isNaN(z)||(I&&(z=B(1,z)),T?(M._65I&&(delete M._65I.finishFunc,M._65I.stop(!0)),M._14o&&M._14o.stop(!0),M.setTranslate(L,H,{finishFunc:function(){M.setZoom(z,T)}})):(M.setTranslate(L,H),M.setZoom(z)))},toCanvas:function(w,r){r=r||this._zoom,this.validateImpl();var s=this,T=s.getContentRect();T.width||(T.width=10),T.height||(T.height=10);var j=sb(),i=T.x*r,G=T.y*r,a=T.width*r,u=T.height*r;Cd(j,a,u,1);var t=wi(j);return w=w||this._dataModel.getBackground(),w&&Gn(t,0,0,a,u,w),bs(t,-i,-G),t.scale(r,r),s._42(t),t.restore(),j},toDataURL:function(w,J,a){return this.toCanvas(w,a).toDataURL(J||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(e,S){var D=this,v=D.dm().getBackground();if(v){var Z=D.dm().a("width"),L=D.dm().a("height");Z>0&&L>0&&Gn(e,0,0,Z,L,v)}var k=D.__htmlOrderList,c=[];if(D._93db(e,S),D.each(function(O){var b=D.getDataUI(O);if(b){var $=D._56I[O._id],B=b._htmlView;if($){var C=b._79o();if(B=b._htmlView,l.HtmlNode&&O instanceof l.HtmlNode)b._42(e);else{var R=D.getViewRect(),F=B&&B.layoutHTML;!S||Ed(S,C)?(F&&(B.layoutHTML(),b.__outerLayout&&delete b.__outerLayout),b._42(e)):Ed(R,C)||!F||b.__outerLayout||(B.layoutHTML(),b.__outerLayout=!0)}}B&&(c.push(B),B.getView&&(B=B.getView()),B.style.display=$?"block":Xo)}}),k&&c.length>0){var N=!1;if(k.length!==c.length)N=!0;else for(var V=0;V<c.length;V++)if(c[V]!==k[V]){N=!0;break}N&&(c.forEach(function(k){k.autoAdjustIndex!==!1&&D.appendHTML(k,!0)}),this.__htmlOrderList=c)}else this.__htmlOrderList=c;D._92db(e,S)},validateImpl:function(){this.tryUpdateRootData();var L,T,l,C,M,D=this,X=D.tx(),$=D.ty(),B=D._zoom,F=D._canvas,v=this.getWidth(),V=this.getHeight(),_=D._29I,x={x:-X/B,y:-$/B,width:v/B,height:V/B},o={},r=D._34I,H=D._24I,q=D._32I,b=D._23I;D._24I={},(v!==F.clientWidth||V!==F.clientHeight)&&(Cd(F,v,V),q=1),q||Ai(x,_)||(q=1),D._29I=x,D.each(function(X){T=X._id;var M=o[T]=D.isVisible(X);M!==D._56I[T]&&(H[T]=X,l=D.getDataUI(H[T]),l&&l._84o(M),D._84o(X,M))},D);for(T in H)l=D.getDataUI(H[T]),l&&(!q&&D._56I[T]&&(M=l._79o(),M&&r.add(M)),l.invalidate()),D._83I=1;if(D._56I=o,!q)for(T in H)o[T]&&(l=D.getDataUI(H[T]),l&&(M=l._79o(),M&&r.add(M)));if(q?C=x:(r.each(function(v){Ed(x,v)&&(C=$r(C,v))}),C&&(ho(C,I(1,1/B)),C.x=G(C.x*B)/B,C.y=G(C.y*B)/B,C.width=y(C.width*B)/B,C.height=y(C.height*B)/B,C=Xg(x,C))),D._74O=C,C){L=wi(F);var n=C.x,U=C.y,u=C.width,p=C.height;n=Math.floor((n*B+X)*He),U=Math.floor((U*B+$)*He),u=Math.ceil(u*B*He)+1,p=Math.ceil(p*B*He)+1,q||(C.x=(n/He-X)/B,C.y=(U/He-$)/B,C.width=u/He/B,C.height=p/He/B),L.beginPath(),L.rect(n,U,u,p),L.clip(),L.clearRect(n,U,u,p),gh(L,X,$,B),D._42(L,C),L.restore(),delete D._74O}if(r.clear(),delete D._32I,b&&v>0&&V>0){var l=D.getDataUI(b);if(l){var M=l._79o(),O=D._29I,f=O.x,Z=O.y,W=O.width,P=O.height,B=D._zoom;M&&!Ed(M,O)&&(M.x+M.width<f&&D.tx(-M.x*B),M.x>f+W&&D.tx(-(M.x+M.width-W)*B),M.y+M.height<Z&&D.ty(-M.y*B),M.y>Z+P&&D.ty(-(M.y+M.height-P)*B))}delete D._23I}D._83I&&(delete D._83I,delete D._84I),D._98O(),D.countFrame(),ol(D._24I)||Ag(D.iv,D)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var r,p=this.getFullscreenDatas();for(var Y in p)r=p[Y],this.scaleRootData(r);this._rootDataUpdating=!1}},scaleRootData:function(U){var F=U.s("fullscreen");if("uniform"===F||"fill"===F){U.getRotation()&&U.setRotation(0);var j=U.s("fullscreen.gap")||0,y=this.getWidth(),o=this.getHeight();if(y&&o){var R,b,B,n=y-2*j,k=o-2*j,i=U.getAnchor(),z=U.getScaledSize(),e=z.width,u=z.height,A=U.s("fullscreen.lock");if(A)return"uniform"===F?n/k>e/u?(R=k/u,e=u*n/k):(R=n/e,u=e*k/n):"v"===A?(R=k/u,e=n/R,U.getWidth()!==e&&U.setWidth(e)):(R=n/e,u=k/R,U.getHeight()!==u&&U.setHeight(u)),this.setZoom(R),b=j-(U.getX()-i.x*e)*R,B=j-(U.getY()-i.y*u)*R,b!==this.tx()&&this.tx(b),B!==this.ty()&&this.ty(B),void 0;b=this.tx(),B=this.ty(),R=this._zoom;var d={x:(-b+j)/R,y:(-B+j)/R,width:n/R,height:k/R};if("uniform"===F){var S=e/u,L=Math.min(d.width,d.height*S),Z=L/S;d.x+=.5*(d.width-L),d.y+=.5*(d.height-Z),d.width=L,d.height=Z}n=d.width/U.getScaleX(),k=d.height/U.getScaleY(),(U.getWidth()!=n||U.getHeight()!==k)&&U.setSize(n,k);var $=d.x+i.x*d.width,H=d.y+i.y*d.height,O=U.getPosition();($!==O.x||H!==O.y)&&U.setPosition($,H)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(F){var n=this;F!==n.isScrollBarVisible()&&(F?(Dj(n._view,n._79O=Lp()),Dj(n._79O,n._27I=Lp()),Dj(n._79O,n._28I=Lp())):(Zb(n._79O),delete n._79O,delete n._27I,delete n._28I),n.fp("scrollBarVisible",!F,F))},getDebugTip:function(){return""},showScrollBar:function(){var R=this;R._79O&&(R._85I||(j(function(){R._86I()},uk),R.iv()),R._85I=new Date)},_86I:function(){var c=this;if(c._85I){var a=new Date,X=a.getTime();X-c._85I.getTime()>=uk?(delete c._85I,c.iv()):j(function(){c._86I()},uk)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var l=this,E=this._27I,x=this._28I;if(l._79O){if(l._autoHideScrollBar&&!l._85I)return E.style.visibility=_n,x.style.visibility=_n,void 0;var R=l.getScrollBarColor(),H=l._zoom,F=l.getScrollBarSize(),S=l.getViewRect(),g=l.getScrollRect(),o=S.height*H,_=g.height*H,$=S.width*H-F-2,A=o*((S.y-g.y)*H/_),f=o*(o/_),B=E.style;_-.5>o?(Hb>f&&(A=A+f/2-Hb/2,0>A&&(A=0),A+Hb>o&&(A=o-Hb),f=Hb),ci(E,$,A,F,f),B.visibility=Wm,B.background=R,B.borderRadius=F/2+Se):B.visibility=_n;var v=S.width*H,i=g.width*H,A=S.height*H-F-2,$=v*((S.x-g.x)*H/i),Q=v*(v/i),B=x.style;i-.5>v?(Hb>Q&&($=$+Q/2-Hb/2,0>$&&($=0),$+Hb>v&&($=v-Hb),Q=Hb),ci(x,$,A,Q,F),B.visibility=Wm,B.background=R,B.borderRadius=F/2+Se):B.visibility=_n}},setDataModel:function(i){var $=this,u=$._dataModel,r=$._selectionModel;u!==i&&(u&&(u.ump($.handleDataModelPropertyChange,$),u.umm($.handleDataModelChange,$),u.umd($.handleDataPropertyChange,$),u.removeIndexChangeListener($._75O,$),u.removeHierarchyChangeListener($.handleHierarchyChange,$),r||u.sm().ums($.handleSelectionChange,$)),$._dataModel=i,i.mp($.handleDataModelPropertyChange,$),i.mm($.handleDataModelChange,$),i.md($.handleDataPropertyChange,$),i.addIndexChangeListener($._75O,$),i.addHierarchyChangeListener($.handleHierarchyChange,$),r?r._21I(i):i.sm().ms($.handleSelectionChange,$),$.invalidateAll(!0),$.fp(df,u,i),$.updateBackground())},getLayersInfo:function(){if(this._layersInfo===d){var e=this.getLayers();e?(this._layersInfo={},e.forEach(function(g){var l=qr(g)?g.name:g;this._layersInfo[l]=g},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(Y,o,b){var y,N,K=this,Z=K.getDataUI(Y),a=Gi(Z),l=Mj(o,function(d){return Ln(a,100*d)},100,.001),U=Ln(a,100*l);if(!b){var j=Wj(Z),v=new Kk(U.x,U.y),W=49/(K._zoom*K._zoom);for(y=0,N=j.length;N>y;y++)if(v.distanceToSquared(j[y])<W)return{index:y,point:j[y],distance:Math.sqrt((j[y].x-o.x)*(j[y].x-o.x)+(j[y].y-o.y)*(j[y].y-o.y))}}return{percent:l,point:U,distance:Math.sqrt((U.x-o.x)*(U.x-o.x)+(U.y-o.y)*(U.y-o.y))}},calculateAttachPoint:function(){var z=new Kk,i=new Kk,m=new Kk;return function(A,Y){var J=this.getAttachPoints(A);if(!J||!J.length)return null;m.set(Y.x,Y.y);for(var W,I,j,r,b=1/0,t=0,V=J.length;V>t;t++)j=J[t],i.x=j.x,i.y=j.y,z.x=j.offsetX||0,z.y=j.offsetY||0,r=Ao(this,A,0,z.x,z.y,i.x,i.y),I=m.distanceToSquared(r),b>I&&(W=t,b=I);b=Math.sqrt(b);var p=this.getAttachStyle(A);if("close"===p){var e=A.s("attach.close.threshold")/this._zoom;if(b>e)return null}return{index:W,distance:b,info:J[W]}}}(),getAttachPoints:function(i){var o=i.s("attach.points");if(o)return o;var X=Qf(i._image);return X?Ud(X.attachPoints,i,this)||null:void 0},getAttachStyle:function(q){var X=q.s("attach.style");if(X)return X;var a=Qf(q._image);return a?Ud(a.attachStyle,q,this)||"close":void 0},updateLayers:function(){this._layersInfo=d,this.invalidateSelection(),this.redraw()},updateBackground:function(){var t=this.dm().a("width"),j=this.dm().a("height");this._canvas.style.background=t>0&&j>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(y){if("background"===y.property){var V=this._canvas.style.background,_=y.newValue||"";this.updateBackground(),this.fp("canvasBackground",V,_),this.redraw()}else"a:width"===y.property||"a:height"===y.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===y.property?this.updateLayers():"hierarchicalRendering"===y.property&&this.redraw()},handleDataPropertyChange:function(T){this.dm().isHierarchicalRendering()&&"parent"===T.property&&T.data.hasChildren()&&this.redraw(),this.invalidateData(T.data)
},onPropertyChanged:function(H){var r=this,J=H.property;if(r.redraw(),"zoom"===J){var R=r.sm().getSelection();R.size()&&R.each(function(B){B.invalidate()})}else"dataModel"===J&&(r._83I=1);vg[J]?r.showScrollBar():J===se&&r.onCurrentSubGraphChanged(H)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(d){var L=this,u=d.kind,z=d.data;if(L._83I=1,"add"===u)L.invalidateData(z),jo(z)&&z.getEdgeGroup()&&z.getEdgeGroup().eachSiblingEdge(L.invalidateData,L);else if(u===ij){L._21Q(z);var S=z._id,g=L._25I[S];if(g){if(L._56I[S]){var c=g._79o();c&&L.redraw(c)}g.dispose(),delete L._25I[S],delete L._24I[S],delete L._56I[S]}z===L._currentSubGraph&&L.setCurrentSubGraph(s)}else u===vj&&(L.invalidateAll(!0),L.setCurrentSubGraph(s))},_75O:function(z){this.invalidateData(z.data)},handleHierarchyChange:function(v){this.dm().isHierarchicalRendering()&&v.data.hasChildren()&&this.redraw(),this.invalidateData(v.data)},adjustIndex:function(G){var M=this;if(M.isVisible(G)){M.dm().beginTransaction();for(var I=G;I._parent&&M.isVisible(I._parent);)I=I._parent;I&&I!==G&&M._dataModel.adjustIndex(I),M._dataModel.adjustIndex(G),M.dm().endTransaction()}},getImage:function(l){return l.getImage?l.getImage():d},getSelectWidth:function(u){var z=Qf(this.getImage(u));return z&&Ud(z.disableSelectedBorder,u,this)?0:u.s("select.width")},getSelectColor:function(g){return g.s("select.color")},isSelectable:function($,o){if(this.isSelected($))return!0;if(!o&&$.getParent()instanceof Rl&&this.isSelectable($.getParent(),!0)&&$.getParent().isSyncSize())return!1;var G=this.getLayersInfo();if(G){var M=G[$._layer];if(M&&M.selectable===!1)return!1}return $.s("2d.selectable")&&this.sm().isSelectable($)},isMovable:function(e){var T=this;if(jo(e)&&e.getStyle(Oe)!==Xh)return!1;var R=this.getLayersInfo();if(R){var G=R[e._layer];if(G&&G.movable===!1)return!1}return e.s("2d.movable")?T._movableFunc?T._movableFunc(e):!0:!1},isEditable:function(M){var Q=this;if(l._uiSerializing)return Q._uieditable;if(!Q._editInteractor||!Q.isSelected(M))return!1;if(ue(M)){var t=Q.getDataUI(M);if(!t||t._88I)return!1}if(jo(M)&&M.getStyle(Oe)!==Xh)return!1;var p=this.getLayersInfo();if(p){var r=p[M._layer];if(r&&r.editable===!1)return!1}return M.s("2d.editable")?Q._editableFunc?Q._editableFunc(M):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(E){return rn(E)&&0!==E.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(E):!0},isRectEditable:function(v){return this._rectEditableFunc?this._rectEditableFunc(v):!0},isAnchorEditable:function(S){return this._anchorEditableFunc?this._anchorEditableFunc(S):!0},isRotationEditable:function(v){return v.setRotation&&v.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(v):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(d){var u=d.getAnchor(),c=d.getScale(),l=this._zoom,T=Vh(d.getRotation(),0,-d.getHeight()*c.y*u.y-(c.y<0?-1:1)*(mo?32:16)/l),q=d.p();return T.x+=q.x,T.y+=q.y,T},getLogicalPoint:function(N){var s=this;return Pp(N,s._canvas,s.tx(),s.ty(),s._zoom,s._zoom)},getScreenPoint:function(F,w){var W,H=this;return"object"==typeof F?F.x!==d?(W=F.x,w=F.y):(W=F[0],w=F[1]):W=F,vp(W,w,H._canvas,H.tx(),H.ty(),H._zoom,H._zoom)},getSelectedDataAt:function(Z){var f=this;return this.getDataAt(Z,function(e){return f.isSelected(e)})},getDataInfoAt:function(R,E,W){var T,_=this.lp(R),D=this.getDataAt(_,E,W);if(D){var q=this.getDataUI(D);T={data:D,ui:q,point:_};var f=q._38o;if(f){var k=f.icons;for(var F in k){var h=k[F],m=f.rects[F];if(m)for(var d=Ud(h.names,D,this),H=d?d.length:0,t=m.rotation,i=H-1;i>=0;i--){var n=d[i],e=m[i];if(Sn(e,_,t))return T.part="icons",T.name=F,T.icon=n,T.rect=e,T.index=i,T.rotation=t,T}}}if(this.isNoteVisible(D)){if(q.note2Info&&Sn(q.note2Info.clickRect,_,s,q.note2Info.scale))return T.part="note2",T;if(q.noteInfo&&Sn(q.noteInfo.clickRect,_,s,q.noteInfo.scale))return T.part="note",T}if(this.isLabelVisible(D)){if(q.label2Info&&Sn(q.label2Info.rect,_,q.label2Info.rotation,q.label2Info.scale))return T.part="label2",T;if(q.labelInfo&&Sn(q.labelInfo.rect,_,q.labelInfo.rotation,q.labelInfo.scale))return T.part="label",T}if(D.isInRect&&D.isInRect(_))return T.part="body",T}return T},getDataAt:function(L,s,G){L.target&&(L=this.lp(L));var B,A=this._zoom;return this.reverseEach(function(p){return(s?s(p):this.isSelectable(p))&&this.rectIntersects(p,qb(L.x,L.y,G,A))?(B=p,!1):void 0},this),B},getIconInfoAt:function(T,K){var c=this;if(T.target&&(T=c.lp(T)),K||(K=c.getDataAt(T)),K){var E=c.getDataUI(K);if(E&&E._38o){var t,D=E._38o,m=new bm;for(t in D.icons)m.add(t);for(var n=m.size()-1;n>=0;n--){t=m.get(n);for(var l=D.rects[t],j=l.rotation,N=l.length-1;N>=0;N--){var H=l[N],h=H.width,e=H.height,J={x:T.x-H.x-h/2,y:T.y-H.y-e/2};j!=s&&(J=Vh(-j,J.x,J.y));var H={x:-h/2,y:-e/2,width:h,height:e};if(Sn(H,J))return{key:t,index:N,name:D.icons[t].names[N],rect:l[N],point:T,rotation:j,relativeRect:H,relativePoint:J,data:K}}}}}return s},getDatasInRect:function(U,S,Q){Q===d&&(Q=1);var e=this,A=new bm;return e.reverseEach(function(v){Q&&!e.isSelectable(v)||(S?e.rectIntersects(v,U):e.rectContains(v,U))&&A.add(v)}),A},moveSelection:function(r,c){var o=this;o.dm().beginTransaction(),Fe(o.sm().toSelection(o.isMovable,o),r,c),o.dm().endTransaction()},moveDatas:function(H,G,o){var Y=this;Y.dm().beginTransaction(),H instanceof bm||(H=new bm(H)),Fe(H,G,o),Y.dm().endTransaction()},getDataUIBounds:function(c){var Q=this.getDataUI(c);return Q?Q._79o():s},drawData:function(p,K,o){var D=this.getDataUI(K);if(D){var C=D._79o();(!o||Ed(o,C))&&(D._42(p),K instanceof l.Block&&K.eachChild(function(L){this.drawData(p,L,o)},this))}},getBoundsForGroup:function(C){return C.s(Er)?this.getDataUIBounds(C):s},isPixelPerfect:function(U){return U.s("pixelPerfect")},rectIntersects:function(I,q){this.validate();var n=s;if(this._56I[I._id]){var i=this._25I[I._id];if(i){var N=i._79o();if(Zi(q,N))n=!0;else if((q=Xg(q,N))&&(i.rectIntersects&&(n=i.rectIntersects(q)),n==s)){if(!this.isPixelPerfect(I))return!0;var F=q.x,v=q.y,Z=q.width,T=q.height,Q=this._zoom,r=k.hitMaxArea,W=Z*T*Q*Q;if(W>r){var J=Math.sqrt(r/W);Q*=J}Z*=Q,T*=Q,2>Z&&(Z=2),2>T&&(T=2),F*=Q,v*=Q;var L=dp(Z,T);bs(L,-F,-v),L.scale(Q,Q),this._drawForChecking=!0,this.drawData(L,I,q),this._drawForChecking=!1;try{for(var l=0,m=L.getImageData(0,0,Z,T).data;l<m.length;l+=4)if(0!==m[l+3]){n=!0;break}L.restore()}catch(h){Nr=s,n=!1}}}}return n?!0:!1},rectContains:function(Q,D){if(this._56I[Q._id]){var Y=this._25I[Q._id];if(Y)return Zi(D,Y._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(p){if(!k.isInput(p.target)){var B=this,b=B._focusData,W=b&&B._25I[b._id],V=0,Z=B._dataModel._datas;if(!(b&&b._enabled&&b._editable&&W&&W.onKeyDown&&W.onKeyDown(p)===!0))if(9===p.keyCode&&(b&&(V=Z.indexOf(b),km(p)?-1===--V&&(V=0):++V===Z.size()&&(V=0)),B._focusData=b=Z.get(V),B.sm().setSelection(b)),mg(p)?B.selectAll():Af(p)&&B.isResettable()&&B.reset(),B.sm().isEmpty()){if(B._editing)return;var M=B.tx(),N=B.ty(),g=!1,o=km()?100:10;lb(p)&&(M-=o,g=!0),Gj(p)&&(N-=o,g=!0),si(p)&&(M+=o,g=!0),ub(p)&&(N+=o,g=!0),g&&B.setTranslate(M,N)}else{hj(p)&&B.handleDelete(p);var O=km()?10:1;lb(p)&&(B.moveSelection(-O,0),B.fi({kind:"moveLeft"})),Gj(p)&&(B.moveSelection(0,-O),B.fi({kind:"moveUp"})),si(p)&&(B.moveSelection(O,0),B.fi({kind:"moveRight"})),ub(p)&&(B.moveSelection(0,O),B.fi({kind:"moveDown"}))}}},handleScroll:function(K,X){if(yc(K),this.isZoomable()){if(!this.getEditInteractor()){var v=this.getDataAt(K);if(v){var d=Qf(this.getImage(v));if(d&&Ud(d.scrollable,v,this))return}}var P=this.lp(K);X>0?this.scrollZoomIn(P):0>X&&this.scrollZoomOut(P)}},handlePinch:function(v,B,s){this.isZoomable()&&(B>s?this.pinchZoomIn(v):this.pinchZoomOut(v))},checkDoubleClickOnNote:function(V,v){var L=this,O=L.lp(V),M=L.getDataUI(v),r=M.note2Info;return r&&v.s("note2.toggleable")&&Sn(r.clickRect,O)?(v.s(qk,!v.s(qk)),L.fi({kind:"toggleNote2",event:V,data:v}),!0):(r=M.noteInfo,r&&v.s("note.toggleable")&&Sn(r.clickRect,O)?(v.s(hg,!v.s(hg)),L.fi({kind:"toggleNote",event:V,data:v}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(Z,O){var r=this,b=r.getAutoScrollZone(),S=b/r.getZoom(),F=b/4,X=r._29I,z=r.lp(Z),v={x:r.tx(),y:r.ty()};return z&&b>0&&X&&(z.x-X.x<S?r.translate(F,0):X.x+X.width-z.x<S&&r.translate(-F,0),z.y-X.y<S?r.translate(0,F):X.y+X.height-z.y<S&&r.translate(0,-F)),v.x=r.tx()-v.x,v.y=r.ty()-v.y,O&&(O.x+=v.x,O.y+=v.y),v},getMoveMode:function(k,f){var B=f.s("2d.move.mode");return B?B:Ob["88"]?"x":Ob["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(J,o,k){var M=this;return"currentSubGraph"===o?{__i:J.getId()}:k.serializeProperty(J,o,M)},deserializeProperty:function(D,I,G){var o=this;if("currentSubGraph"===I){var f=o.dm(),O=f.__idMap;return O[D.__i]}return G.deserializeProperty(D,I,o)},setDefaultCursor:function(g,v){this._defaultCursor=g,v!==!1&&this.setCursor(g)},setCursor:function(J){"default"===J&&(J=this._defaultCursor||J);var O=this.getView().style;O.cursor=J,O.cursor="-webkit-"+J,O.cursor="-moz-"+J},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(S){return S===s||k.getConnectAction(null,S)?(this._currentActionType=S,this.redraw(),!0):!1},getEditStyle:function(R){var i=this.getEditInteractor();return i?i.getStyle(R):d},setEditStyle:function(E,S,K){var H=this.getEditInteractor();return H?(H.setStyle(E,S,K),!0):!1},isConnectActionVisible:function(h){var m=k.getConnectAction(this);if(!m)return!1;var W=m.visible;return Lo(W)&&(W=W(this,h)),W},isInteractive:function(N){var p=Qf(this.getImage(N));return p&&Ud(p.interactive,N,this)?!0:N.s("interactive")},appendHTML:function(v,S){var e=this.getView();if(!(S||v&&v.parentNode!==e))return!1;var A=v.getView&&v.getView();if(!S&&A&&A.parentNode===e)return!1;(v.getView||v.isSelfViewEvent)&&(v=v.getView());var M=this.getEditInteractor();return M&&M._canvas?e.insertBefore(v,M._canvas):this.isScrollBarVisible()?e.insertBefore(v,this.getView().lastChild):Dj(e,v),!0},_layoutHTMLImpl:function(Y,s,H){if(arguments.length>1){var W,L=this,Z=L._zoom;if(s.getView&&(W=s,s=s.getView()),s.style.position="absolute",H){var r=Y.getRect();ci(W||s,L.tx()+r.x*Z,L.ty()+r.y*Z,r.width*Z,r.height*Z)}else{var N=new jr,r=Y.getAnchorRect(),m=Y.getPosition(),j=Y.getScale(),o=s.style;ci(W||s,r),N.appendTranslate(L.tx(),L.ty()),N.appendScale(Z,Z),N.append(new jr(Y.getRotation(),m.x,m.y,j.x,j.y)),kb(o,"transform","matrix("+N.a.toFixed(5)+", "+N.b.toFixed(5)+", "+N.c.toFixed(5)+",\n    "+N.d.toFixed(5)+", "+N.tx.toFixed(5)+", "+N.ty.toFixed(5)+")"),kb(o,"transformOrigin",(-r.x).toFixed(5)+"px "+(-r.y).toFixed(5)+"px"),s.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(B){return B instanceof fc?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(e){var P="state",a=e.s(P);if(a)return a;var K=Qf(e._image);return K?Ud(K[P],e,this)||null:void 0}}),e.defineProperties(Lk.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(v){this._layoutHTML=v}}});var mi=function(Q,G){var n=this;n.gv=Q,n.s=function(F){return G.getStyle(F)},n._data=G,n._87I=new bm};an(mi,e,{_6I:s,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var q=this,o=q.gv.isSelected(q._data);return!o||q.isShadowed()?0:q.gv.getSelectWidth(q._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(K){var o=this._data,S=this.gv.getBodyColor(o);return S?S:K?o.getStyle(K):s},_2Q:function(X){return this.s(X)},_1Q:function(z,F,W,w){var D=this.s,T=D("2d.gray"),K=D(F+".dash.color");if(T&&(K=k.toGrayColor(K)),z.strokeStyle=K,z.lineWidth=W,z.stroke(),D(F+".dash.3d")){var c=D(F+".dash.3d.color");ec(z,K,T?k.toGrayColor(c):c,W,this.gv._zoom,D(F+".dash.3d.accuracy"))}Zh(z,w)},invalidate:function(){this._6I=s},_79o:function(){var x=this;if(!x._6I){var i=x._data,H=x.gv;x.labelInfo=x.label2Info=x.noteInfo=x.note2Info=x._38o=s,x._87I.clear(),x.interactiveInfo=H.isInteractive(i)?{}:s,x._3O(),x._55O=H.isEditable(i)?{_42O:H.isRectEditable(i),_43O:H.isPointEditable(i),_56O:H.isRotationEditable(i)}:s,x._6I=x._81o()}return x._6I},_3O:function(){},getPosition:function(){return sc},_68o:function(Z,b){Z&&this._87I.add(ad(Z,b))},_81o:function(){var d=this,_=d.s;d._24O(sk,"getLabel"),d._24O(vf,"getLabel2"),d._26O(am,"getNote"),d._26O(vm,"getNote2"),d._15O(),d._55O&&d._48O();var K;if(d._87I.each(function(T){K=$r(K,T)}),K&&d.isShadowed()){var M=Tm(K);M.x+=_("shadow.offset.x"),M.y+=_("shadow.offset.y"),ho(M,_("shadow.blur")),K=$r(K,M)}return d._87I.clear(),K},_42:function(R){var k=this,j=k._data,E=k.gv,h=k.s,p=h("opacity"),W=this.isShadowed();if(W){var c=R.shadowOffsetX,o=R.shadowOffsetY,B=R.shadowBlur,Y=R.shadowColor,N=E.getZoom();R.shadowOffsetX=h("shadow.offset.x")*N,R.shadowOffsetY=h("shadow.offset.y")*N,R.shadowBlur=h("shadow.blur")*N,R.shadowColor=k.getSelectColor()}if(p!=s){var Z=R.globalAlpha;R.globalAlpha=p}k._80o(R),E.isLabelVisible(j)&&((!E._drawForChecking||h("label.selectable"))&&wf(R,k.labelInfo),(!E._drawForChecking||h("label2.selectable"))&&wf(R,k.label2Info)),E.isNoteVisible(j)&&(Xq(R,k.noteInfo),Xq(R,k.note2Info)),k._99O(R),p!=s&&(R.globalAlpha=Z),W&&(R.shadowOffsetX=c,R.shadowOffsetY=o,R.shadowBlur=B,R.shadowColor=Y)},_80o:function(){},_47O:function(){},_24O:function(F,n){var A=this,K=A._data,B=A.gv,p=A.s,J=B[n](K);if(J!=s){var j=p(F+".scale"),I=p(F+".max"),g=p(F+".position"),P=A[F+"Info"]={label:J,scale:j,color:B[n+"Color"](K),font:p(F+".font"),opacity:p(F+".opacity"),align:p(F+".align"),rotation:A.getRotation(p(F+".rotation"),!1,g),background:B[n+"Background"](K)},c=Sl(P,J);I>0&&I<c.width&&(P.labelWidth=c.width,c.width=I),1!==j&&(c.width*=j,c.height*=j);var O=A.getPosition(g,p(F+".offset.x"),p(F+".offset.y"),c,p(F+".position.fixed"));if(c.x=O.x-c.width/2,c.y=O.y-c.height/2,A._68o(P.rect=c,P.rotation),1!==j){var o=c.width/j,r=c.height/j;P.rect={x:O.x-o/2,y:O.y-r/2,width:o,height:r}}}},_26O:function(l,$){var _=this,e=_.gv,W=_._data,D=_.s,F=e[$](W);if(F!=s){var T,E,V=D(l+".scale"),L=_[l+"Info"]={note:F,scale:V,data:W,view:e,expanded:D(l+".expanded"),font:D(l+".font"),color:D(l+".color"),opacity:D(l+".opacity"),align:D(l+".align"),icon:D(l+".icon"),backgroundImage:D(l+".backgroundImage"),borderWidth:D(l+".border.width"),borderColor:D(l+".border.color"),background:e[$+"Background"](W)},B=_.getPosition(D(l+".position"),D(l+".offset.x"),D(l+".offset.y")),R=B.x,p=B.y;if(L.expanded){var b,t=D(l+".max"),k=D(l+".backgroundImage");k?(k=Qf(k),b={width:Tb(k,W),height:hd(k,W)}):b=Sl(L,F),b.width+=6,b.height+=2,t>0&&t<b.width&&(L.labelWidth=b.width,b.width=t),T=b.width,E=b.height+8,L.clickRect={x:R-T*V/2,y:p-E*V,width:T*V,height:E*V*b.height/E}}else{var g=D(l+".icon");g?(g=Qf(g),T=Tb(g,W),E=hd(g,W)):(T=12,E=18),L.clickRect={x:R-T*V/2,y:p-E*V,width:T*V,height:E*V}}L.rect={x:R-T/2,y:p-E*V/2-E/2,width:T,height:E};var d=y(L.borderWidth/2)*V;_._68o({x:R-T*V/2-d,y:p-E*V-d,width:T*V+2*d,height:E*V+2*d})}},_48O:function(){},_99O:function(T){var r=this,K=r._38o;if(K){var p=r.gv,c=r._data,f=K.icons,j=r.interactiveInfo;j&&(j._38o={});for(var R in f){var I=f[R],o=K.rects[R];if(o){j&&(j._38o[R]=[]);var l=Ud(I.opacity,c,p),$=Ud(I.names,c,p),e=$?$.length:0,P=o.rotation;if(l!=s){var q=T.globalAlpha;T.globalAlpha*=l}for(var x=0;e>x;x++){var W=$[x],u=Qf(W),d=o[x];if(P){var Q=d.x+d.width/2,b=d.y+d.height/2;T.save(),bs(T,Q,b),Dn(T,P),bs(T,-Q,-b)}j&&j._38o[R].push(T.interactiveInfo={compInfos:[],matrix:P?new jr(P,Q,b).appendTranslate(-Q,-b):new jr}),Iq(T,u,Ud(I.stretch,c,p),d.x,d.y,d.width,d.height,r._data,r.gv),T.interactiveInfo=s,P&&T.restore()}l!=s&&(T.globalAlpha=q)}}}}});var co=function(u,J){$d(co,this,[u,J])};an(co,mi,{_checkEmptyRect:!0,_40O:function(Q,$){var y=this,N=y.s,z=Q.rect;(Q.borderColor=y.gv.getBorderColor(y._data))&&(Q.borderType=N("border.type"),Q.borderWidth=N("border.width"),Q.borderPadding=N("border.padding"),$=I($,Q.borderPadding+Q.borderWidth/2));var k=y._data.getScale(),h=I(1,I(J(k.x),J(k.y)));if(Q.selectWidth=y.getSelectWidth()){var V=y.gv._zoom;Q.selectType=N("select.type"),Q._97o=y.getSelectColor(),Q.selectPadding=N("select.padding"),$=I($,(Q.selectPadding+Q.selectWidth/2/V)/h)}$>0&&($*=h,z=Tm(z),ho(z,$)),y._68o(z)},_39O:function(h,v){var U,H=this,y=v.rect;if(v.borderWidth>0&&(U=v.borderPadding,h.strokeStyle=v.borderColor,h.lineWidth=v.borderWidth,Md(h,v.borderType,{x:y.x-U,y:y.y-U,width:y.width+2*U,height:y.height+2*U}),h.stroke()),v.selectWidth>0){var B=H.gv._zoom;if(U=v.selectPadding,h.strokeStyle=v._97o,h.lineWidth=v.selectWidth/B,v.rotation!=s){h.save(),h.translate(v.position.x,v.position.y),h.rotate(v.rotation);var w=H._data,$=w.getWidth(),b=w.getHeight(),c=v.scale,D=v.anchor;y={x:c.x*-$*D.x,y:c.y*-b*D.y,width:c.x*$,height:c.y*b}}Md(h,v.selectType,{x:y.x-U,y:y.y-U,width:y.width+2*U,height:y.height+2*U}),v.rotation!=s&&h.restore(),h.stroke()}},dispose:function(){var l=this,X=l._htmlView;co.superClass._3O.call(l),X&&(X.onHTMLRemoved&&X.onHTMLRemoved(),Zb(X))},_3O:function(){var A=this,u=A.s,F=A._data,g=A.gv,Q=F.getStyle(mj),R=A.getBodyColor(),C=A._83o=Q?{shape:Q,_53o:A.getBodyColor("shape.background"),_27Q:Qf(u("shape.repeat.image"),R),shapeGradientPack:u("shape.gradient.pack"),_54o:u("shape.border.width"),_55o:u("shape.border.color"),_56o:u("shape.border.3d"),_57o:u("shape.border.3d.color"),_58o:u("shape.border.3d.accuracy"),shapeGradient:u("shape.gradient"),_59o:u("shape.gradient.color"),_60o:u("shape.border.pattern"),_61o:u("shape.border.cap"),_62o:u("shape.border.join"),shapeForeground:u("shape.foreground"),bodyColor:R,gray:u("2d.gray")}:{img:Qf(g.getImage(F),R),bodyColor:R,gray:u("2d.gray"),stretch:u("image.stretch")};if(U&&!Z);else{var P,W=C.img;W&&W.renderHTML?(A._htmlInfo&&A._htmlInfo.img!==W&&(A._htmlInfo=s),A._htmlInfo||(A._htmlInfo={img:W,cache:{}}),P=W.renderHTML(F,g,A._htmlInfo.cache)):A._htmlInfo=s,A._htmlView&&A._htmlView!==P&&(A._htmlView.onHTMLRemoved&&A._htmlView.onHTMLRemoved(),Zb(A._htmlView.getView?A._htmlView.getView():A._htmlView)),(A._htmlView=P)&&g.appendHTML(P)&&(P.onHTMLAddedSync&&P.onHTMLAddedSync(),P.onHTMLAdded&&Ag(P.onHTMLAdded)),C.rect=F.getRect(),C.position=F.p(),C.scale=F.getScale(),C.anchor=F.getAnchor(),C.rotation=F.getRotation(),Q===Vc&&(C._63o=u("shape.depth"));var z=0;if(Q)z=em(s,C._54o/2,C._62o),A.s("shape.dash")&&(z=I(z,(A.s("shape.dash.width")||C._54o)/2));else if(W&&W.boundExtend)if(z=Ud(W.boundExtend,F,g),W.boundExtendAbsolute){var j=F.getScale();z/=g._zoom*I(1,I(J(j.x),J(j.y)))}else if(!Ud(W.fitSize,F,g)){var t=Ud(W.width,F,g),_=Ud(W.height,F,g);z*=I(F.getWidth()/t,F.getHeight()/_)}A._40O(C,z);var x=u("clip.percentage");if(1>x&&(0>x&&(x=0),C.clipRect=Mb(F.getAnchorRect(),u("clip.direction"),x)),Q){var p=u("shape.fill.clip.percentage");1>p&&(0>p&&(p=0),C.shapeClipRect=Mb(F.getAnchorRect(),u("shape.fill.clip.direction"),p));var L=u("shape.foreground.clip.percentage");1>L&&(0>L&&(L=0),C.shapeForegroundClipRect=Mb(F.getAnchorRect(),u("shape.foreground.clip.direction"),L))}}},getPosition:function(J,i,L,G){var Q=Ih(J,this._83o.rect,G);return Q.x+=i,Q.y+=L,Q},_80o:function(d){var x=this,z=x.s,K=x.gv,t=x._data,p=x._83o,G=p.rect,Z=p.position,o=p.rotation,U=p.anchor,R=p.scale,g=p.shape,b=p.clipRect;if(!x._checkEmptyRect||G.width>0&&G.height>0){var X=t.getSize();if(X.x=-X.width*U.x,X.y=-X.height*U.y,d.save(),bs(d,Z.x,Z.y),Dn(d,o),Nj(d,R.x,R.y),b&&(d.beginPath(),d.rect(b.x,b.y,b.width,b.height),d.clip()),K._drawForChecking&&p.img&&Ud(p.img.pixelPerfect,t,K)===!1)Gn(d,X.x,X.y,X.width,X.height,"#888888");else if(x.freeDraw)x.freeDraw(d,X,p);else if(g){var f,l,O,T,S=p._60o,A=dl(d,S),a=p._27Q,r=p._54o,v=p.shapeGradientPack,J=p.gray,C=d.lineJoin,I=d.lineCap,Q=function(n){return J?k.toGrayColor(n):n};"roundRect"===g?f=z("shape.corner.radius"):"polygon"===g?f=z("shape.polygon.side"):"arc"===g&&(f=z("shape.arc.from"),l=z("shape.arc.to"),O=z("shape.arc.close"),T=z("shape.arc.oval")),d.lineJoin=p._62o,d.lineCap=p._61o;var j=Q(p._53o);if(j||a||v){var $=p.shapeClipRect;$&&(d.save(),d.beginPath(),d.rect($.x,$.y,$.width,$.height),d.clip()),Md(d,g,X,f,l,O,T),v?ug(d,v):a?Rf(d,a,Q(p.bodyColor),null,t,K):Wb(d,j,p.shapeGradient,Q(p._59o),X),d.fill(),$&&d.restore(),v&&d.restore(),d!==A&&Md(A,g,X,f,l,O,T)}else Md(A,g,X,f,l,O,T);var e=p.shapeForeground;if(e){d.save();var M=p.shapeForegroundClipRect;M&&(d.beginPath(),d.rect(M.x,M.y,M.width,M.height),d.clip()),Md(d,g,X,f,l,O,T),Wb(d,e,z("shape.foreground.gradient"),Q(z("shape.foreground.gradient.color")),X),d.fill(),d.restore()}if(r>0){var H=z("shape.border.width.absolute");H&&(d.save(),d.setTransform(1,0,0,1,0,0)),d.lineWidth=r;var L=Q(p._55o);d.strokeStyle=L,d.stroke(),H&&d.restore(),p._56o&&ec(d,L,Q(p._57o),r,K._zoom,p._58o)}if(Zh(d,S),z("shape.dash")){var h=z("shape.dash.width")||r;if(h>0){S=z("shape.dash.pattern");var A=dl(d,S,x._2Q("shape.dash.offset"));A!==d&&Md(A,g,X,f,l,O,T),x._1Q(d,"shape",h,S)}}wd(d,j,p._63o,X),d.lineJoin=C,d.lineCap=I}else{var F=x.interactiveInfo;F&&(d.interactiveInfo=F.bodyInfo={compInfos:[],matrix:new jr(o,Z.x,Z.y,R.x,R.y)}),p.gray&&(d.compGray=!0);var P=p.img;P&&P.cacheRule!=s&&(P=zs(d,P,p.stretch,X.width,X.height,t,K,p.bodyColor)),Iq(d,P,p.stretch,X.x,X.y,X.width,X.height,t,K,p.bodyColor),d.compGray=!1,d.interactiveInfo=s}d.restore()}x._39O(d,p)},_48O:function(){},_47O:function(){}});var _o=function(A,w){$d(_o,this,[A,w])},Hp=function(T,m,X,I){var P=Qd(T,m);return X=I?B(X,P):mf(X,P),P?X/=P:X=0,{x:T.x+(m.x-T.x)*X,y:T.y+(m.y-T.y)*X}};an(_o,mi,{_3O:function(){var u,i=this,x=i._data,h=i.gv,L=i.s,e=L(Oe),U=x.isLooped(),v=L("edge.width"),O=L("edge.center"),K=L("edge.offset"),n=h.getBorderColor(x),Z=n?L("border.width"):0,R=i.getSelectWidth(),Y=x._40I,z=x._41I,$=i._78o=Y&&z?{looped:U,type:e,width:v,center:O,color:i.getBodyColor("edge.color"),borderColor:n,borderWidth:Z,_97o:R?i.getSelectColor():s,selectWidth:R,pattern:L("edge.pattern"),cap:L("edge.cap"),join:L("edge.join"),is3d:L("edge.3d"),_67o:L("edge.3d.color"),_66o:L("edge.3d.accuracy"),gray:L("2d.gray")}:s;if($){var p=k.getEdgeType(e);if(p){var T=p(x,Aq(i,h,x,U,e),h,i._19Q);T.points&&T.points.size()>1?($.edgeTypeInfo=T,u=Bc($.edgeTypeInfo.points)):T[lo]&&T.rect&&($.edgeTypeInfo=T,u=T.rect)}else{var l=L("edge.source.anchor.x"),r=L("edge.source.anchor.y"),j=L("edge.target.anchor.x"),S=L("edge.target.anchor.y"),m=rf(h,x,"source"),P=rf(h,x,"target");if(e===Xh){var J=$.points=L(fd)||Qc,E=J.size();$.segments=L("edge.segments");var b=l!==d||r!==d||jo(Y),A=j!==d||S!==d||jo(z);if(!O)if(K)b||(m=Hp(m,E?J.get(0):P,K,E)),A||(P=Hp(P,E?J.get(E-1):m,K,E));else{var F;b||(F=fk(m,E?J.get(0):P,Ui(h,Y)),F&&(m={x:F[0],y:F[1]})),A||(F=fk(E?J.get(E-1):m,P,Ui(h,z)),F&&(P={x:F[0],y:F[1]}))}u=$r(Bc($.points),Bc(m,P))}else{var G=Aq(i,h,x,U,e);if(i._19Q||(G=-G),U)m=Tm(m),m.x=h.getNodeRect(Y).x,$.radius=G,u={x:m.x-G,y:m.y-G,width:2*G,height:2*G};else{var y=Qd(m,P),a=mf(K,y),Q={x:a,y:G},t={x:y-a,y:G},M=c(P.y-m.y,P.x-m.x),H=$.mat=new vk(M);if($.orienAngle=M,$.angle=P.x<m.x?M+N:M,$.rect={x:Q.x,y:Q.y,width:t.x-Q.x,height:0},$.origin=m,Q=H.tf(Q),Q.x+=m.x,Q.y+=m.y,t=H.tf(t),t.x+=m.x,t.y+=m.y,O){var B={x:y,y:0};B=H.tf(B),B.x+=m.x,B.y+=m.y,u=Bc([m,Q,t,B]),$.c1=m,$.c2=B}else u=Bc(Q,t);m=Q,P=t}}$.sourcePoint=m,$.targetPoint=P,x._lastSourcePoint=m,x._lastTargetPoint=P}var w=0;L("edge.dash")&&(w=L("edge.dash.width")||v);var _="square"===$.cap?.71:.5;em(u,I(w*_,v*_+Z+R),$.join),i._68o(u)}},getRotation:function(I,h,N){I=I||0;var L=this._78o;if(L){var w,K=L.angle,i=L.points,C=L.edgeTypeInfo;if(K!=s)return h?L.orienAngle+I:K+I;if(C&&C[lo])return C.getRotation?C.getRotation(this,I,h,N):0;if(C&&C.points){var l=C.points;return w=l.size(),ng[N]?w&&0===w%2?Rm(l.get(w/2-1),l.get(w/2),h,I):I:Qk[N]?Rm(l.get(0),l.get(1),h,I):Rm(l.get(w-2),l.get(w-1),h,I)}if(i)return w=i.size(),ng[N]?w&&0===w%2?Rm(i.get(w/2-1),i.get(w/2),h,I):I:Qk[N]?Rm(L.sourcePoint,w?i.get(0):L.targetPoint,h,I):Rm(w?i.get(w-1):L.sourcePoint,L.targetPoint,h,I)}return I},getPosition:function(p,d,P,D,Y){var i=this._78o;if(i){var V,F=i.type,g=i.points,h=i.edgeTypeInfo,A=i.sourcePoint,j=i.targetPoint;if(!F)return i.looped?{x:A.x-i.radius+d,y:A.y+P}:(Y&&A&&j&&(A.x>j.x||A.x===j.x&&A.y>j.y)&&(p=Bk[p],P=-P),V=Ih(p,i.rect,D),V.x+=d,V.y+=P,V=i.mat.tf(V),V.x+=i.origin.x,V.y+=i.origin.y,V);if(h&&h[lo])return h.getPosition?h.getPosition(this,p,d,P,D,Y):{x:(A.x+j.x)/2,y:(A.y+j.y)/2};if(g){var V,l=g.size();if(ng[p]){if(l){var z=l%2;if(0===z)return wl(g.get(l/2-1),g.get(l/2),p,d,P,D,Y);V=g.get((l-z)/2)}else V={x:(A.x+j.x)/2,y:(A.y+j.y)/2};return V=Ih(p,{x:V.x,y:V.y,width:0,height:0},D),V.x+=d,V.y+=P,V}return Qk[p]?wl(A,l?g.get(0):j,p,d,P,D,Y):wl(l?g.get(l-1):A,j,p,d,P,D,Y)}if(h){var a=h.points,l=a.size();if(ng[p]){var z=l%2;return 0===z?wl(a.get(l/2-1),a.get(l/2),p,d,P,D,Y):(V=a.get((l-z)/2),V=Ih(p,{x:V.x,y:V.y,width:0,height:0},D),V.x+=d,V.y+=P,V)}return Qk[p]?wl(a.get(0),a.get(1),p,d,P,D,Y):wl(a.get(l-2),a.get(l-1),p,d,P,D,Y)}}return sc},_42:function(M){this._78o&&_o.superClass._42.call(this,M)},drawPath:function(H,_){H.beginPath();var t=_.type,G=_.points,Q=_.segments,s=_.edgeTypeInfo;if(!t||G){var w=_.sourcePoint,$=w.x,k=w.y,u=_.targetPoint,g=u.x,j=u.y;if(t)if(Q){var l=new bm({x:$,y:k});l.addAll(G),l.add({x:g,y:j}),hh(H,l,Q)}else H.moveTo($,k),G.each(function(i){H.lineTo(i.x,i.y)}),H.lineTo(g,j);else _.looped?H.arc($,k,_.radius,0,p,!0):_.center?(H.moveTo(_.c1.x,_.c1.y),H.lineTo($,k),H.lineTo(g,j),H.lineTo(_.c2.x,_.c2.y)):(H.moveTo($,k),H.lineTo(g,j))}else s&&(s.points?hh(H,s.points,s.segments):s[lo]&&s[lo](H,s))},_80o:function(S){var q=this,d=q.s,C=q._78o,G=C.width,n=C.selectWidth,y=C.borderWidth,_=S.lineJoin,H=S.lineCap,c=C.gray,L=C.pattern;S.lineJoin=C.join,S.lineCap=C.cap,q.drawPath(dl(S,L),C);var F=d("edge.width.absolute");F&&(S.save(),S.setTransform(1,0,0,1,0,0)),n&&(S.strokeStyle=C._97o,S.lineWidth=G+2*(y+n),S.stroke()),y&&(S.strokeStyle=c?k.toGrayColor(C.borderColor):C.borderColor,S.lineWidth=G+2*y,S.stroke());var X=c?k.toGrayColor(C.color):C.color,j=c?k.toGrayColor(C._67o):C._67o;if(S.strokeStyle=X,S.lineWidth=G,S.stroke(),C.is3d&&ec(S,X,j,G,q.gv._zoom,C._66o),Zh(S,L),d("edge.dash")){L=d("edge.dash.pattern");var V=dl(S,L,q._2Q("edge.dash.offset"));V!==S&&q.drawPath(V,C),q._1Q(S,"edge",d("edge.dash.width")||G,L)}F&&S.restore(),S.lineJoin=_,S.lineCap=H},_48O:function(){},_47O:function(){}});var fj=function(H,U){$d(fj,this,[H,U])};an(fj,co,{_3O:function(){var t,o,b=this,u=b.s,C=b._data,k=b.gv;if(b._88I=s,C.isExpanded()&&C.eachChild(function(E){if(rn(E)){var R=k.getBoundsForGroup(E);R&&(o||(o=[]),o.push(R),t=$r(t,R))}}),t){var V=k.getLabel(C),R=u("group.type");t=Uq(R,o,t),Jh(t,C,"group.padding",1);var _=b._88I={type:R,rect:t,_64o:t};if(!R&&V!=s){var g,q=b.labelInfo={label:V,color:u("group.title.color"),font:u("group.title.font"),align:u("group.title.align")},d=Sl(q,V),$=d.width,l=d.height,E=u("group.title.align"),F=u("group.title.orientation");if((F===rg||F===Rc)&&$>t.width?t.width=$:(F===xb||F===cr)&&$>t.height&&(t.height=$),q.rect={y:t.y-l,width:d.width,height:l},g=E===xb?t.x:E===cr?t.x+t.width-$:t.x+t.width/2-$/2,q.rect.x=g,F===Rc)_.titleRect={x:t.x,y:t.y+t.height,width:t.width,height:l},_.rect={x:t.x,y:t.y,width:t.width,height:t.height+l},q.rect={x:g,y:t.y+t.height,width:$,height:l};else if(F===xb){var I=_.titleRect={x:t.x-l,y:t.y,width:l,height:t.height};_.rect={x:t.x-l,y:t.y,width:t.width+l,height:t.height},q.rect={x:I.x+l/2-t.height/2,y:I.y+t.height/2-l/2,width:t.height,height:l},q.rotation=-Math.PI/2}else if(F===cr){var I=_.titleRect={x:t.x+t.width,y:t.y,width:l,height:t.height};_.rect={x:t.x,y:t.y,width:t.width+l,height:t.height},q.rect={x:I.x+l/2-t.height/2,y:I.y+t.height/2-l/2,width:t.height,height:l},q.rotation=Math.PI/2}else _.titleRect={x:t.x,y:t.y-l,width:t.width,height:l+1},_.rect={x:t.x,y:t.y-l,width:t.width,height:t.height+l}}b._40O(_,u("group.border.width")/2)}else fj.superClass._3O.call(b)},getPosition:function(f,F,U,S){var X=this._88I;if(X){var L=Ih(f,X.rect,S);return L.x+=F,L.y+=U,L}return fj.superClass.getPosition.apply(this,arguments)},_24O:function(F,L){var V=this._88I;(!V||V.type||"label2"===F)&&fj.superClass._24O.call(this,F,L)},_80o:function(u){var U=this,l=U._88I;if(l){var j=U._data,v=U.s,N=U.gv,V=l.type,O=l.rect,D=l._64o,z=l.titleRect,M=U.getBodyColor(),_=Qf(v("group.image"),M),s=v("group.image.stretch"),Q=U.getBodyColor("group.background"),w=Qf(v("group.repeat.image"),M),g=v("group.gradient.pack"),L=v("group.gradient"),B=v("group.gradient.color"),n=v("group.border.width"),k=v("group.border.color"),o=v("group.border.pattern"),r=v("group.title.orientation"),I=v("group.depth");if(V){var T=u.lineJoin,Z=u.lineCap;if(u.lineJoin=v("group.border.join"),u.lineCap=v("group.border.cap"),_){if(u.save(),Md(u,V,O),u.clip(),Iq(u,_,s,O.x,O.y,O.width,O.height,j,N,M),u.restore(),n>0){var H=dl(u,o);Md(H,V,O),u.lineWidth=n,u.strokeStyle=k,u.stroke(),Zh(u,o)}}else{var H=dl(u,o);Q||w||g?(Md(u,V,O),g?ug(u,g):w?Rf(u,w,M,null,j,N):Wb(u,Q,L,B,O),u.fill(),g&&u.restore(),u!==H&&Md(H,V,O)):Md(H,V,O),n>0&&(u.lineWidth=n,u.strokeStyle=v("group.border.color"),u.stroke()),Zh(u,o),V===Vc&&wd(u,Q,I,O)}u.lineJoin=T,u.lineCap=Z}else{var m=v("group.title.background"),b=v("group.border.radius");if(_)Iq(u,_,s,D.x,D.y,D.width,D.height,j,N,U.getBodyColor());else if(Q||w)if(w?Rf(u,w,M,null,j,N):Wb(u,Q,L,B,D),0===n)Md(u,Vc,D),u.fill(),wd(u,Q,I,D);else{switch(u.beginPath(),r){case Rc:Dg(u,D.x,D.y,D.width,D.height,b,b,0,0);break;case xb:Dg(u,D.x,D.y,D.width,D.height,0,b,0,b);break;case cr:Dg(u,D.x,D.y,D.width,D.height,b,0,b,0);break;case rg:Dg(u,D.x,D.y,D.width,D.height,0,0,b,b)}u.fill()}if(z&&m)if(0===n)Gn(u,z.x,z.y,z.width,z.height,m),wd(u,m,I,z);else{switch(u.beginPath(),u.fillStyle=m,r){case Rc:Dg(u,z.x,z.y,z.width,z.height,0,0,b,b);break;case xb:Dg(u,z.x,z.y,z.width,z.height,b,0,b,0);break;case cr:Dg(u,z.x,z.y,z.width,z.height,0,b,0,b);break;case rg:Dg(u,z.x,z.y,z.width,z.height,b,b,0,0)}u.fill()}if(n>0){var H=dl(u,o);if(Md(H,"roundRect",O,b),u.lineWidth=n,u.strokeStyle=k,z&&v("group.splitLine")){var Y=z.x,i=z.y,a=z.width,K=z.height;r===Rc?(u.moveTo(Y,i),u.lineTo(Y+a,i)):r===xb?(u.moveTo(Y+a,i),u.lineTo(Y+a,i+K)):r===cr?(u.moveTo(Y,i),u.lineTo(Y,i+K)):(u.moveTo(Y,i+K),u.lineTo(Y+a,i+K))}u.stroke(),Zh(u,o)}}U._39O(u,l)}else fj.superClass._80o.call(U,u)}});var Vp=function(H,L){$d(Vp,this,[H,L])};an(Vp,co,{_80o:function(C){this._39O(C,this._83o)}});var th=function(Z,_){$d(th,this,[Z,_])};an(th,co,{_3O:function(){var Z=this,f=Z._data,P=Z.s,L=Z.gv,q=f.getPoints(),u=L.getBorderColor(f),d=u?P("border.width"):0,l=Z.getSelectWidth(),e=P("shape.border.width"),T=f.getRect(),D=f.getAnchorRect(),O=L.getBodyColor(f),H=Z._99o=q.isEmpty()?s:{rect:T,rotation:f.getRotation(),fillRule:P("shape.fill.rule"),scale:f.getScale(),position:f.p(),points:q,segments:f.getSegments(),bodyColor:O,borderColor:u,borderWidth:d,_94o:P("shape.border.3d"),_95o:P("shape.border.3d.color"),_96o:P("shape.border.3d.accuracy"),_97o:l?Z.getSelectColor():s,selectWidth:l,_53o:P("shape.background"),_27Q:Qf(P("shape.repeat.image"),O),shapeGradientPack:P("shape.gradient.pack"),_54o:e,_55o:P("shape.border.color"),shapeGradient:P("shape.gradient"),_59o:P("shape.gradient.color"),_60o:P("shape.border.pattern"),_61o:P("shape.border.cap"),_62o:P("shape.border.join"),shapeForeground:P("shape.foreground"),gray:P("2d.gray")};
if(H){D.x+=H.position.x,D.y+=H.position.y,H.gradientRect=D;var o=f.getScale(),G=I(1,I(J(o.x),J(o.y)));P("shape.dash")&&P("shape.dash.width")>e&&(e=P("shape.dash.width"));var a,c=P("shape.border.width.absolute");a=c?(e+d+l)/Z.gv._zoom/G:e*("square"===H._61o?.71:.5)+d+l/Z.gv._zoom/G,a&&(a*=G,T=Tm(T),em(T,a,H._62o)),Z._68o(T);var M=P("clip.percentage");1>M&&(0>M&&(M=0),H.clipRect=Mb(f.getAnchorRect(),P("clip.direction"),M));var $=P("shape.fill.clip.percentage");1>$&&(0>$&&($=0),H.shapeClipRect=Mb(f.getAnchorRect(),P("shape.fill.clip.direction"),$));var R=P("shape.foreground.clip.percentage");1>R&&(0>R&&(R=0),H.shapeForegroundClipRect=Mb(f.getAnchorRect(),P("shape.foreground.clip.direction"),R))}},getPosition:function(J,A,G,Y){var c=this._99o;if(c){var e=Ih(J,c.rect,Y);return e.x+=A,e.y+=G,e}return sc},_42:function(z){this._99o&&th.superClass._42.call(this,z)},_80o:function(M){var Q,e=this,i=e.s,s=e._99o,B=s.position,A=s.scale,a=s.rotation,g=s.borderWidth,j=s.selectWidth/e.gv._zoom,t=s._27Q,u=s.shapeGradientPack,D=s._54o,F=s.clipRect,h=s.shapeClipRect,T=s.points,m=s.segments,o=e._data.isClosePath(),n=s.fillRule,c=s.gray,f=function(l){return c?k.toGrayColor(l):l},x=f(s._53o),_=x||t||u;M.save(),bs(M,B.x,B.y),Dn(M,a),Nj(M,A.x,A.y),F&&(M.beginPath(),M.rect(F.x,F.y,F.width,F.height),M.clip()),_&&h&&(M.save(),M.beginPath(),M.rect(h.x,h.y,h.width,h.height),M.clip()),bs(M,-B.x,-B.y);var R=s._60o,w=dl(M,R),S=M.lineJoin,O=M.lineCap;M.lineJoin=s._62o,M.lineCap=s._61o;var q=f(s.bodyColor);_?(hh(M,T,m,o),u?ug(M,u):t?Rf(M,t,q,null,e._data,e.gv):(Q=q?q:x,Wb(M,Q,s.shapeGradient,f(s._59o),s.gradientRect)),M.fill(n),h&&(M.restore(),bs(M,-B.x,-B.y)),u&&M.restore(),w!==M&&hh(w,T,m,o)):hh(w,T,m,o);var I=s.shapeForeground;if(I){M.save();var K=s.shapeForegroundClipRect;K&&(bs(M,B.x,B.y),M.beginPath(),M.rect(K.x,K.y,K.width,K.height),M.clip(),bs(M,-B.x,-B.y)),hh(M,T,m,o),Wb(M,I,i("shape.foreground.gradient"),f(i("shape.foreground.gradient.color")),s.gradientRect),M.fill(n),M.restore()}var r=i("shape.border.width.absolute");if(r&&(M.save(),M.setTransform(1,0,0,1,0,0)),j&&(M.strokeStyle=s._97o,M.lineWidth=D+2*(g+j),M.stroke()),g&&(M.strokeStyle=f(s.borderColor),M.lineWidth=D+2*g,M.stroke()),D&&(Q=f(s._55o),!x&&q&&(Q=q),M.strokeStyle=Q,M.lineWidth=D,M.stroke(),s._94o&&ec(M,Q,f(s._95o),D,e.gv._zoom,s._96o)),Zh(M,R),i("shape.dash")){var Z=i("shape.dash.width")||D;if(Z>0){R=i("shape.dash.pattern");var w=dl(M,R,e._2Q("shape.dash.offset"));w!==M&&hh(w,T,m,o),e._1Q(M,"shape",Z,R)}}r&&M.restore(),M.lineJoin=S,M.lineCap=O,M.restore()},_48O:function(){},_47O:function(){}});var _m=function(I,y){$d(_m,this,[I,y])};an(_m,th,{getRotation:function(J,h,i){J=J||0;var E=this._data.getPoints(),v=E.size();return v>1?ng[i]?v&&0===v%2?Rm(E.get(v/2-1),E.get(v/2),h,J):J:Qk[i]?Rm(E.get(0),E.get(1),h,J):Rm(E.get(v-2),E.get(v-1),h,J):J},getPosition:function(G,V,b,I,e){var h=this._data.getPoints(),s=h.size();if(s>1){if(ng[G]){var F=s%2;if(0===F)return wl(h.get(s/2-1),h.get(s/2),G,V,b,I,e);var E=h.get((s-F)/2),k={x:E.x,y:E.y,width:0,height:0};return E=Ih(G,k,I),E.x+=V,E.y+=b,E}return Qk[G]?wl(h.get(0),h.get(1),G,V,b,I,e):wl(h.get(s-2),h.get(s-1),G,V,b,I,e)}return sc}});var nn=function(d,B){$d(nn,this,[d,B])};an(nn,co,{_3O:function(){var c=this;nn.superClass._3O.call(c);var C=c.s,D=c._83o;c._82o=D.img||D.shape?s:{background:c.getBodyColor("grid.background"),depth:C("grid.depth"),rect:D.rect,_88o:C("grid.cell.depth"),cellBorderColor:C("grid.cell.border.color"),_89o:C("grid.row.count"),_90o:C("grid.column.count"),block:C("grid.block"),_91o:C("grid.block.color"),_92o:C("grid.block.padding"),_93o:C("grid.block.width")}},_80o:function(h){var X=this,J=X._82o;if(!J)return nn.superClass._80o.call(X,h),void 0;var Q,$,r=X._data,b=J.background,W=J.rect,c=J.block,w=J._91o,e=J._92o,z=J._93o,T=J._88o,H=J.cellBorderColor,F=J._89o,f=J._90o;if(b)if(Gn(h,W.x,W.y,W.width,W.height,b),wd(h,b,J.depth,W),T)for(Q=0;F>Q;Q++)for($=0;f>$;$++)W=r.getCellRect(Q,$),W&&wd(h,b,T,W);else if(H){for(h.beginPath(),Q=0;F>Q;Q++)for($=0;f>$;$++)W=r.getCellRect(Q,$),W&&h.rect(W.x,W.y,W.width,W.height);h.strokeStyle=H,h.lineWidth=1,h.stroke()}if("h"===c)for(Q=0;F>Q;Q++)W=$r(r.getCellRect(Q,0),r.getCellRect(Q,f-1)),ho(W,e),Gr(h,w,W.x,W.y,W.width,W.height,z);else if("v"===c)for($=0;f>$;$++)W=$r(r.getCellRect(0,$),r.getCellRect(F-1,$)),ho(W,e),Gr(h,w,W.x,W.y,W.width,W.height,z);X._39O(h,X._83o)}});var ff=function(L,m){$d(ff,this,[L,m])};an(ff,co,{_checkEmptyRect:!1,_81o:function(){var c=this._data,W=ff.superClass._81o.call(this),O=c.s("text");if(O!=s){var B,J,D=c.s("text.font"),p=c.s("text.align"),_=c.s("text.vAlign"),h=bk(D,O),g=h.width,z=h.height,t=c.getAnchor(),j=c.getWidth(),A=c.getHeight();"left"===p?B=-j*t.x:"center"===p?B=-j*t.x+(j-g)/2:"right"===p&&(B=j*(1-t.x)-h.width),"top"===_?J=-A*t.y:"middle"===_?J=-A*t.y+(A-z)/2:"bottom"===_&&(J=A*(1-t.y)-h.height);var m,Q=c.getMatrix();if(m=Bc([Q.tf(B,J),Q.tf(B+g,J),Q.tf(B+g,J+z),Q.tf(B,J+z)]),W=$r(W,m),W&&c.s("text.shadow")){var l=Tm(W);l.x+=c.s("text.shadow.offset.x"),l.y+=c.s("text.shadow.offset.y"),ho(l,c.s("text.shadow.blur")),W=$r(W,l)}}return W}});var qp=Lk.Interactor=function(i){this.gv=this._graphView=i};Wp("Interactor",e,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(e){this.gv.fi(e)},setCursor:function(C){mo||this.gv.setCursor(C)},startDragging:function(J){var e=this;e._lastClientPoint=xl(J),e._lastLogicalPoint=e.gv.lp(J),Fh(e,J)},clearDragging:function(){var p=this;p._lastClientPoint=p._lastLogicalPoint=p._logicalPoint=s},autoScroll:function(s){return this.gv.autoScroll(s,this._lastClientPoint)}});var Eh=s,Pl=function(s){Eh.handleWindowTouchMove(s)},$q=function(y){Eh.handleWindowTouchEnd(y),f(g,Bi,Pl),f(g,pq,$q),Eh=s},as=function($){Eh.handleWindowMouseMove($)},fn=function(A){Eh.handleWindowMouseUp(A),f(g,$g,as),f(g,Un,fn),Eh=s},Yn=function(c,S){c!==Eh&&(Eh?mo?Eh.handleWindowTouchEnd(S):Eh.handleWindowMouseUp(S):mo?(K(g,Bi,Pl),K(g,pq,$q)):(K(g,$g,as),K(g,Un,fn)),Eh=c)},ei=function(T){var U=this;U.gv=T,U._is2d=T instanceof Lk.GraphView,U._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",tc,"wheel"].forEach(function(j){U.addListener(j)}),U.initImageResource()};an(ei,qp,{enableVR:function(y){var j=this;if(!!j._vrEnable!==y)if(j._vrEnable=y,y)j.gv.vr.mp(j.onVRControllerChange,j);else if(j.gv.vr.ump(j.onVRControllerChange,j),j._vrRayPolyline){var t=j.gv.dm();t.remove(j._vrRayPolyline),t.remove(j._vrRayHitPoint),j._vrRayPolyline=d,j._vrRayHitPoint=d}},onVRControllerChange:function(i){var j=this,h=i.property,I=i.newValue,q=j.gv.vr.getController(I.id),c=q.getRay();c&&("gamepad.button.trigger"===h?"down"===I._62O?j.handle_mousedown(c):j.handleWindowMouseUp(c):"gamepad.pose"===h&&(j.handle_mousemove(c),j.handleWindowMouseMove(c)))},drawVRRay:function(j,b,T){var G,q=this,a=q.gv,N=q._vrRayPolyline,H=!1;if(N)G=q._vrRayHitPoint;else{var D=a.dm();q._vrRayPolyline=N=new l.Polyline,q._vrRayHitPoint=G=new l.Node,G.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),G.setAnchor3d(.5,.5,.499);var v=.2/a.vr.measureOflength;G.s3(v,v,v),N.s("intersect",!1),G.s("intersect",!1),D.add(N),D.add(G),H=!0}if(b){var I=T.world,L=T.worldNormal,h=I.x,u=I.y,E=I.z;N.s("shape.border.color","red"),N.setPoints([{x:j.origin.x,y:j.origin.z,e:j.origin.y},{x:h,y:E,e:u}]),G.s("3d.visible",!0),G.p3(h,u,E),G.lookAtDirection([L.x,L.y,L.z],"front")}else{N.s("shape.border.color","blue");var F=new l.Math.Vector3;F.copy(j.direction).setLength(1e3/q.gv.vr.measureOflength).add(j.origin),N.setPoints([{x:j.origin.x,y:j.origin.z,e:j.origin.y},{x:F.x,y:F.z,e:F.y}]),G.s("3d.visible",!1)}a.fi({kind:"vrRayIntersect",ray:j,data:b,intersect:T,polyline:N,hitNode:G,begin:H})},setPreventEventDefault:function(U,i){var T=this,J=T._eventListeners[U];J?J._prevent=i:T._eventListeners[U]=J={_removal:d,_prevent:i}},removeListener:function(q){var H=this,G=H._eventListeners[q];G&&G._removal&&(G._removal(),G._removal=d)},addListener:function(S){var V=this,E=V._eventListeners[S];if(E||(V._eventListeners[S]=E={_removal:d,_prevent:!0}),!E||!E._removal){var W=function(o){E._prevent&&k.preventDefault(o),V.disabled||("wheel"===S?nr(V,o):V["handle_"+S](o))};K(V.gv.getView(),S,W),E._removal=function(){f(V.gv.getView(),S,W)}}},handleWindowTouchMove:function(I){this.handleWindowMouseMove(I)},handleWindowMouseMove:function(t){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",t):(this.handleDownInfo("onBeginDrag",t),this.isDragging=!0))},handleWindowTouchEnd:function(e){this.handleWindowMouseUp(e)},handleWindowMouseUp:function(R){if(this.isDragging&&(this.handleDownInfo("onEndDrag",R),this.isDragging=!1),this.downInfo){var u=this.handle("onUp",R);if(u&&u.data===this.downInfo.data){this.handleMissingUp(R);var d=this,X=2===R.button?"onContextMenu":"onClick";if(!d._dbclickTimer)return d._dbclickTimer=j(function(){delete d._dbclickTimer,d.handleClick(R,X,u),this.downInfo=s},k.clickDelay),void 0;n(d._dbclickTimer),delete d._dbclickTimer,X="onDoubleClick",d.handleClick(R,X,u)}else this.handleDownInfo("onUp",R);this.downInfo=s}},handle_mouseleave:function(X){var q=this,L=q.gv,t=q.currentInfo?q.currentInfo.data:s;if(t){t.s("onLeave")&&t.s("onLeave")(X,t,L),q.fire("data","onLeave",X,t);var r=q.currentInfo?q.currentInfo.hits:s;if(r)for(var w in r)q.handleLeave(X,w);q.currentInfo=s}},handle_mousewheel:function(H){H.scrollDelta=H.wheelDelta/40,this.handle("onScroll",H)},handle_DOMMouseScroll:function(o){o.scrollDelta=2===o.axis?-o.detail:0,this.handle("onScroll",o)},handle_touchstart:function(s){this.handle_mousedown(s)},handle_touchmove:function(W){this.handle("onMove",W)},handle_mousedown:function(v){this.isDragging&&(this.handleDownInfo("onEndDrag",v),this.isDragging=!1),this.downInfo=this.handle("onDown",v),this.downInfo&&Yn(this,v)},handle_mousemove:function(M){var v=this,d=v.gv;v._hoverTimer&&(n(v._hoverTimer),delete v._hoverTimer);var B,y,e,$=v.handle("onMove",M),f=this.currentInfo?this.currentInfo.data:s,N=this.currentInfo?this.currentInfo.hits:s;if($&&(y=$.data,e=$.hits,v._hoverTimer=j(function(){n(v._hoverTimer),delete v._hoverTimer,v.handle("onHover",M,$)},d.getHoverDelay()||k.hoverDelay)),y!==f){if(f&&(f.s("onLeave")&&f.s("onLeave")(M,f,d),this.fire("data","onLeave",M,f)),y&&(y.s("onEnter")&&y.s("onEnter")(M,y,d),this.fire("data","onEnter",M,y)),N)for(B in N)this.handleLeave(M,B);if(e)for(B in e){var t=e[B];t.target.onEnter&&t.target.onEnter(M,y,d,t.point,t.width,t.height),this.fire(t.type,"onEnter",t.event,t.data,t.image,t.comp,t.point,t)}}else{if(N)for(B in N)e&&e[B]||this.handleLeave(M,B);if(e)for(B in e)if(!N||!N[B]){var t=e[B];t.target.onEnter&&t.target.onEnter(M,y,d,t.point,t.width,t.height),this.fire(t.type,"onEnter",t.event,t.data,t.image,t.comp,t.point,t)}}this.currentInfo=$},handle:function(u,b,L){var x,y=this,E=y.gv;if(y._is2d){if(L=L||E.getDataInfoAt(b),!L||!E.isInteractive(L.data))return;if(x=L.ui.interactiveInfo){var g,A=L.data;if(A.s(u)&&A.s(u)(b,A,E),this.fire("data",u,b,A),"body"===L.part&&x.bodyInfo)g="body",L.hits=this.handleImage(g,E.getImage(A),u,b,A,L.point,x.bodyInfo);else if("icons"===L.part&&x._38o){var k=x._38o[L.name];k&&k[L.index]&&(g="icons|"+L.name+"|"+L.index,L.hits=this.handleImage(g,L.icon,u,b,A,L.point,k[L.index]))}}return L}var A,P;if(!L)if(b&&b instanceof l.Math.Ray){var z=E.vr.intersectWorld(b);if(A=z.data,P=z.intersect,y.drawVRRay(b,A,P),!A)return;var v=E.getData3dUI(A);if(x=v.interactiveInfo,!x)return;L={data:A,part:P.part,ui:v}}else{if(L=E.getDataInfoAt(b),!L)return;L&&(L={data:L.data,part:L.part})}if(E.isInteractive(L.data)){if(!P){A=L.data;var v=E.getData3dUI(A);if(L.ui=v,x=v.interactiveInfo,!x)return L;if(P=E.intersectObject(b,A),!P)return}A.s(u)&&A.s(u)(b,A,E),this.fire("data",u,b,A);var q,n=P.part;return"body"!==n&&(q=A.s(n+".image")||A.s("shape3d."+n+".image")),q||(q=A.s("all.image")||A.s("shape3d.image")),x="object"==typeof q?x[q.uuid]:x[q],x&&x.bodyInfo?(L.part="body",L.interactiveInfo=x,L.point=P.uv.multiply({x:x.bodyInfo.rect.width,y:x.bodyInfo.rect.height}),L.image=q,L.hits=this.handleImage("body",q,u,b,A,L.point,x.bodyInfo),L):L}},_handleLeaveOrMissing:function(Z,I,G){var T="leave"===Z?this.currentInfo:this.downInfo;if(T){var F=T.interactiveInfo||T.ui.interactiveInfo;if(F){var r,h,n=T.data;if(this._is2d){if(h=this.gv.lp(I),"body"===T.part&&F.bodyInfo)r="body","leave"===Z?this.handleLeaveImage(G,r,this.gv.getImage(n),I,n,h,F.bodyInfo):this.handleMissingUpImage(r,this.gv.getImage(n),I,n,h,F.bodyInfo);else if("icons"===T.part&&F._38o){var c=F._38o[T.name];c&&c[T.index]&&(r="icons|"+T.name+"|"+T.index,"leave"===Z?this.handleLeaveImage(G,r,T.icon,I,n,h,c[T.index]):this.handleMissingUpImage(r,T.icon,I,n,h,c[T.index]))}}else{if(!F.bodyInfo)return;var s=this.gv.intersectObject(I,n);h=s?s.uv.multiply({x:F.bodyInfo.rect.width,y:F.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===Z?this.handleLeaveImage(G,"body",T.image,I,n,h,F.bodyInfo):this.handleMissingUpImage("body",T.image,I,n,h,F.bodyInfo)}}}},handleClick:function(E,r,y){var D=this,g=this.downInfo;if(g&&y){var l,N=y.interactiveInfo||y.ui.interactiveInfo,n=y.data,C=this.gv;if(n.s(r)&&n.s(r)(E,n,C),D.fire("data",r,E,n),N)if(this._is2d){if(g.part===y.part){var h=C.lp(E);"body"===y.part&&N.bodyInfo&&(l="body",this.handleClickImage(l,C.getImage(n),r,E,n,h,N.bodyInfo,y))}}else{if(!N.bodyInfo)return;var s=C.intersectObject(E,n);if(!s)return;h=s.uv.multiply({x:N.bodyInfo.rect.width,y:N.bodyInfo.rect.height}),this.handleClickImage("body",g.image,r,E,n,h,N.bodyInfo,y)}}},handleDownInfo:function(J,m){if(this.downInfo){var x=this.downInfo,u=this.gv,g=x.interactiveInfo||x.ui.interactiveInfo;if(g){var e,D=x.data;if(D.s(J)&&D.s(J)(m,D,u),this.fire("data",J,m,D),this._is2d){var y=u.lp(m);if("body"===x.part&&g.bodyInfo)e="body",this.handleDownInfoImage(e,u.getImage(D),J,m,D,y,g.bodyInfo);else if("icons"===x.part&&g._38o){var L=g._38o[x.name];L&&L[x.index]&&(e="icons|"+x.name+"|"+x.index,this.handleDownInfoImage(e,x.icon,J,m,D,y,L[x.index]))}}else{if(!g.bodyInfo)return;var F=u.intersectObject(m,D);if(!F)return;y=F.uv.multiply({x:g.bodyInfo.rect.width,y:g.bodyInfo.rect.height}),this.handleDownInfoImage("body",x.image,J,m,D,y,g.bodyInfo)}}}},fire:function(T,y,O,f,q,u,k,K){this.gv.fi({kind:y,type:T,event:O,data:f,image:q,comp:u,view:this.gv,point:k,width:K?K.width:d,height:K?K.height:d})},handleImage:function(b,J,M,n,y,R,V){var D={};if(J&&(J=Qf(J))){var S=this.gv,x=V.rect,Q=this.convertPoint(R,V);Q.inRect&&(J[M]&&J[M](n,y,S,Q,x.width,x.height),this.fire("image",M,n,y,J,d,Q,x),D[b+"|image"]={target:J,type:"image",image:J,data:y,event:n,point:Q,width:x.width,height:x.height});for(var U=V.compInfos,B=J,w=U.length-1;w>=0;w--){var h=U[w],s=h.comp;if(Q=this.convertPoint(R,h,B,s,S,y),Q.inRect){x=h.rect;var X=y._interactPrefix=h.prefix,$=X&&y.a(X+M)||s[M];$&&$.call(s,n,y,S,Q,x.width,x.height),this.fire("comp",M,n,y,J,s,Q,x),(J=x.image)&&(J[M]&&J[M](n,y,S,Q,x.width,x.height),this.fire("image",M,n,y,J,d,Q,x)),y._interactPrefix=null,D[b+"|"+w]={target:s,type:"comp",comp:s,image:J,data:y,event:n,point:Q,width:x.width,height:x.height},J&&(D[b+"|"+w+"|image"]={target:J,type:"image",image:J,data:y,event:n,point:Q,width:x.width,height:x.height})}}}return D},handleLeave:function(x,U){return this._handleLeaveOrMissing("leave",x,U)},handleMissingUp:function(z){return this._handleLeaveOrMissing("missing",z)},handleLeaveImage:function(X,K,L,g,t,E,Z){if(L&&(L=Qf(L))){var p=this.gv,Y=Z.rect,o=this.convertPoint(E,Z);X===K+"|image"&&(L.onLeave&&L.onLeave(g,t,p,o,Y.width,Y.height),this.fire("image","onLeave",g,t,L,d,o,Y));for(var n=Z.compInfos,F=L,B=n.length-1;B>=0;B--){var m=n[B],H=m.comp;o=this.convertPoint(E,m,F,H,p,t),Y=m.rect;var C=t._interactPrefix=m.prefix;if(X===K+"|"+B){var Q=C&&t.a(C+"onLeave")||H.onLeave;Q&&Q.call(H,g,t,p,o,Y.width,Y.height),this.fire("comp","onLeave",g,t,L,H,o,Y)}(L=Y.image)&&X===K+"|"+B+"|image"&&(L.onLeave&&L.onLeave(g,t,p,o,Y.width,Y.height),this.fire("image","onLeave",g,t,L,d,o,Y)),t._interactPrefix=null}}},handleMissingUpImage:function(g,b,h,Q,H,K){var v="onUp",D=this.downInfo.hits;if(D&&b&&(b=Qf(b))){var c=this.gv,T=K.rect,z=this.convertPoint(H,K);!z.inRect&&D[g+"|image"]&&(b[v]&&b[v](h,Q,c,z,T.width,T.height),this.fire("image",v,h,Q,b,d,z,T));for(var A=K.compInfos,a=b,S=A.length-1;S>=0;S--){var y=A[S],C=y.comp;if(z=this.convertPoint(H,y,a,C,c,Q),!z.inRect){T=y.rect;var P=Q._interactPrefix=y.prefix;if(D[g+"|"+S]){var k=P&&Q.a(P+v)||C[v];k&&k.call(C,h,Q,c,z,T.width,T.height),this.fire("comp",v,h,Q,b,C,z,T)}(b=T.image)&&D[g+"|"+S+"|image"]&&(b[v]&&b[v](h,Q,c,z,T.width,T.height),this.fire("image",v,h,Q,b,d,z,T)),Q._interactPrefix=null}}}},handleDownInfoImage:function(I,G,V,J,L,C,n){var E=this.downInfo.hits;if(E&&G&&(G=Qf(G))){var k=this.gv,U=n.rect,M=this.convertPoint(C,n);E[I+"|image"]&&(G[V]&&G[V](J,L,k,M,U.width,U.height),this.fire("image",V,J,L,G,d,M,U));for(var F=n.compInfos,W=G,r=F.length-1;r>=0;r--){var c=F[r],O=c.comp;M=this.convertPoint(C,c,W,O,k,L),U=c.rect;var g=L._interactPrefix=c.prefix;if(E[I+"|"+r]){var l=g&&L.a(g+V)||O[V];l&&l.call(O,J,L,k,M,U.width,U.height),this.fire("comp",V,J,L,G,O,M,U)}(G=U.image)&&E[I+"|"+r+"|image"]&&(G[V]&&G[V](J,L,k,M,U.width,U.height),this.fire("image",V,J,L,G,d,M,U)),L._interactPrefix=null}}},handleClickImage:function(X,U,Z,f,M,D,L,e){var E=this.downInfo.hits,R=e.hits;if(E&&U&&(U=Qf(U))){var T=this.gv,r=L.rect,q=this.convertPoint(D,L);E[X+"|image"]&&(U[Z]&&U[Z](f,M,T,q,r.width,r.height),this.fire("image",Z,f,M,U,d,q,r));for(var A=L.compInfos,u=U,Y=A.length-1;Y>=0;Y--){var z=A[Y],K=z.comp;q=this.convertPoint(D,z,u,K,T,M),r=z.rect;var _=M._interactPrefix=z.prefix;if(E[X+"|"+Y]&&R[X+"|"+Y]){var o=_&&M.a(_+Z)||K[Z];o&&o.call(K,f,M,T,q,r.width,r.height),this.fire("comp",Z,f,M,U,K,q,r)}(U=r.image)&&E[X+"|"+Y+"|image"]&&(U[Z]&&U[Z](f,M,T,q,r.width,r.height),this.fire("image",Z,f,M,U,d,q,r)),M._interactPrefix=null}}},initImageResource:function(){k.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(O,K,p,I,Z,U){var V=K.rect,m=K.matrix.applyInverse(O).sub(V),F=m.x>=0&&m.y>=0&&m.x<=V.width&&m.y<=V.height;if(!F)return m;if(I&&Ud(I.pixelPerfect,U,Z)){var V,S=1;this._is2d?(S=Z.getZoom(),V=qb(O.x,O.y,d,S)):V=qb(O.x,O.y);var N=!1,G=V.x,z=V.y,Y=V.width,P=V.height,$=k.hitMaxArea,j=Y*P*S*S;if(j>$){var A=Math.sqrt($/j);S*=A}Y*=S,P*=S,2>Y&&(Y=2),2>P&&(P=2),G*=S,z*=S;var X=dp(Y,P),x=new jr(0,-G,-z,S,S);x.append(K.matrix),Z._drawForChecking=!0,I.transform=x;var u=p.comps;p.comps=[I],Jq(X,p,0,0,Y,P,U,self),p.comps=u,delete I.transform,Z._drawForChecking=!1;try{for(var h=0,M=X.getImageData(0,0,Y,P).data;h<M.length;h+=4)if(0!==M[h+3]){N=!0;break}X.restore()}catch(w){Nr=s,N=!1}m.inRect=N}else m.inRect=!0;return m}});var _r=Lk.DefaultInteractor=function(P){$d(_r,this,[P])};Wp("DefaultInteractor",qp,{handle_mousedown:function(n){yc(n);var A=this,C=A.gv,s=C.getDataAt(n);if(C.setFocus(n)&&!C._editing&&!C._scrolling){Ec(n)?C.handleDoubleClick(n,s):C.handleClick(n,s);var z=im(n);!Af()&&!z&&s&&(C.isMovable(s)||C._39Q(s))||!C.isPannable()||!ee(n)&&!z||oo(n)||(A._tx=C.tx(),A._ty=C.ty(),A.startDragging(n))}},handleWindowMouseUp:function(B){var Q=this,c=Q.gv;c._panning&&(delete c._panning,c.onPanEnded(),Q.fi({kind:"endPan",event:B})),delete Q._tx,delete Q._ty,Q.clearDragging()},handle_mousemove:function(U){var w=this,S=w.gv;w._hoverTimer&&(n(w._hoverTimer),delete w._hoverTimer),w._hoverTimer=j(function(){w.fi({kind:"hover",event:U}),n(w._hoverTimer),delete w._hoverTimer},S.getHoverDelay()||k.hoverDelay)},handle_touchmove:function(b){this.handle_mousemove(b)},handleWindowMouseMove:function(G){var C=this,E=C.gv;C.fi({kind:E._panning?"betweenPan":"beginPan",event:G}),E._panning=1;var F=Ge(E,G,C._lastClientPoint);E.setTranslate(C._tx+F.x,C._ty+F.y)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta)},handle_DOMMouseScroll:function(s){2===s.axis&&this.gv.handleScroll(s,-s.detail)},handle_keydown:function(R){this.gv.handleKeyDown(R)}});var fb=Lk.SelectInteractor=function(w){$d(fb,this,[w])};Wp("SelectInteractor",qp,{_42:function(){var A=this,W=A.gv,K=W.getZoom(),s=A.mark,E=A.div;E||(E=A.div=Lp(),Dj(A.getView(),E));var _={};_.x=s.x*K+W.tx(),_.y=s.y*K+W.ty(),_.width=s.width*K,_.height=s.height*K,ci(E,_),this.intersects()?(E.style.border="",E.style.background=W.getRectSelectBackground()):(E.style.background="",E.style.border="1px solid "+W.getRectSelectBorderColor())},handle_mousedown:function($){var g=this,t=g.gv;if(g._57I=s,g.pendingClickThrough=s,!(t._editing||t._scrolling||Af()||im($))){var S=t.getDataAt($),q=t.sm();S?oo($)?q.co(S)?q.rs(S):q.as(S):q.co(S)?S instanceof Rl&&S.isClickThroughEnabled()&&ee($)&&(g.pendingClickThrough=xl($)):q.ss(S):oo($)||!t.isPannable()?ee($)&&(oo($)||q.cs(),t.isRectSelectable()&&(g.startDragging($),t._77O=1)):ee($)&&(g._57I=xl($))}},handle_mouseup:function(E){var k=this,o=k.gv,g=k._57I;if(g&&(Qd(g,xl(E))<=1&&o.sm().cs(),k._57I=s),k.pendingClickThrough){if(Qd(k.pendingClickThrough,xl(E))<=1){var e=o.getDataAt(E);if(e instanceof Rl&&e.isClickThroughEnabled()){var $=o.getDataAt(E,function(q){var t=q.getParent()===e&&o.isSelectable(q,!0);return t});$&&(E.clickThrough=!0,o.sm().ss($))}}k.pendingClickThrough=s}},handleWindowMouseUp:function(Z){this.clear(Z)},handleWindowMouseMove:function(S){var _=this,o=_.gv;_._logicalPoint=o.lp(S),_.mark?(_.fi({kind:"betweenRectSelect",event:S}),o.isPannable()&&_.autoScroll(S),_.redraw()):_.fi({kind:"beginRectSelect",event:S}),_.mark=Bc(_._lastLogicalPoint,_._logicalPoint),_.redraw()},intersects:function(){var n=this,m=n._lastLogicalPoint,Z=n._logicalPoint;return m.x>Z.x||m.y>Z.y},clear:function(X){var L=this,w=L.gv,F=L.mark;if(L._57I=s,L.pendingClickThrough=s,L._lastLogicalPoint){if(F){if(0!==F.width&&0!==F.height){var j=w.getDatasInRect(F,L.intersects());if(!j.isEmpty()){var u=w.sm(),f=u.toSelection();j.each(function(w){u.co(w)?f.remove(w):f.add(w)}),u.ss(f)}}Zb(L.div),delete L.div,delete L.mark,L.redraw(),L.fi({kind:"endRectSelect",event:X}),w.onRectSelectEnded()}L.clearDragging(),delete w._77O}},redraw:function(){var r=this;r._draw||(r._draw=1,j(function(){r.mark&&r._42(),delete r._draw},16))}});var Mh=Lk.MoveInteractor=function(P){$d(Mh,this,[P])};Wp("MoveInteractor",qp,{handle_mousedown:function(t){var k=this,h=k.gv;if(ee(t)&&!h._editing&&!h._scrolling&&!Af()){var W=h.getSelectedDataAt(t);!W||h._39Q(W)&&!h.isMovable(W)?h._focusData=s:(k._data=W,h.handleMouseDown&&h.handleMouseDown(t,W),k.startDragging(t),h.isMovable(W)&&(h._moving=1))}},handleWindowMouseUp:function(v){var p=this,m=p.gv;m.handleMouseUp&&m.handleMouseUp(v,p._data),p.clear(v)},handleWindowMouseMove:function(l){var T=this,q=T._data,a=T.gv;if((!a._93O||!a._93O(l,q))&&a._moving){T._logicalPoint||T.fi({kind:"prepareMove",event:l});var y=T._logicalPoint?"betweenMove":"beginMove",K={kind:y,event:l},g=T._logicalPoint=a.lp(l);"beginMove"!==y||T._alreadyBeginTransaction||(T._alreadyBeginTransaction=!0,a.getDataModel().beginTransaction());var L=T._calcShift(y,l),I=L.x,Z=L.y,x=T.gv.getMoveMode(l,q);x&&("x"===x?Z=0:"y"===x?I=0:"xy"!==x&&(I=Z=0)),a.moveSelection(I,Z),T._lastLogicalPoint=g,T.autoScroll(l),T.fi(K)}},_calcShift:function(){var C=this,o=C._logicalPoint,i=C._lastLogicalPoint,V=o.x-i.x,y=o.y-i.y;return{x:V,y:y}},clear:function(f){var b=this,K=b.gv;b._lastLogicalPoint&&(b._lastLogicalPoint=b._data=K._moving=s,b._logicalPoint&&(b.fi({kind:"endMove",event:f}),K.onMoveEnded()),b.clearDragging()),b._alreadyBeginTransaction&&(b._alreadyBeginTransaction=!1,K.getDataModel().endTransaction())}});var uo=Lk.TextEditInteractor=function(k){$d(uo,this,[k]),this.init()};Wp("TextEditInteractor",qp,{init:function(){var u=this,E=this.input=m.createElement("input"),A=E.style;E.text="text",A.border="1px solid #d8d8d8",A.position="absolute",A.padding="2px 3px",A.outline="none",A.marginLeft="-90px",A.marginTop="-16px",A.backgroundColor="rgba(255,255,255, 0.9)",A.fontSize="14px",A.width="180px",A.height="32px",A.boxShadow="0 0 13px rgba(16,142,233, 0.5)",A.textAlign="center",A.boxSizing="border-box",K(E,"keyup",function(z){Cr(z)&&u.endTextEdit()}),K(E,"focus",function(){E.select()});var r=this.textarea=m.createElement("textarea"),k=this.wrap=m.createElement("div");k.appendChild(r),A=r.style,A.margin=0,A.padding="4px",A.overflow="hidden",A.boxSizing="border-box",A.position="absolute",A.outline="none",A.backgroundColor="transparent",A.resize="none",A.textAlign="center",A.fontSize="14px",A.border="none",A.borderWidth=0,A.width="100%",A.top="50%",A=k.style,A.boxSizing="border-box",A.margin=0,A.padding=0,A.position="absolute",A.boxShadow="0 0 13px rgba(16,142,233, 0.5)",A.border="1px solid #d8d8d8",A.backgroundColor="rgba(255,255,255, 0.9)",A.width="180px",A.marginLeft="-90px",K(r,"keydown",function(T){return(km()||oo())&&Cr(T)?(u.endTextEdit(),void 0):(u.calculateTextareaHeight(String.fromCharCode(T.keyCode)),void 0)}),K(r,"focus",function(){r.select()});var t=function(g){g.stopPropagation()};K(E,"mousedown",t),K(E,"touchstart",t),K(r,"mousedown",t),K(r,"touchstart",t),u.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],u.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",u.handleWindowClick=function(b){var z=u._editingDOM;if(z){var Q=z.getBoundingClientRect(),n=xl(b);Sn(Q,n)||u.endTextEdit()}}},handle_mousedown:function(u){var V=this,z=V.gv;if(Ec(u)&&!z._editing){var F=z.getDataAt(u);if(F){var g=z.getTextEditInfo(F);g&&(this._editInfo=g,this._editTarget=F,z._editing=!0,g.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var Q=this,p=Q.gv,r=Q._editTarget,v=Q.getTargetValue(),f=Q.textarea,L=Q.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===v||v===d)&&(v=""),f.value=v,Q._editingDOM=f,p.getView().appendChild(L),this.layoutHTML(L,r),this.calculateTextareaHeight(),j(function(){f.focus(),K(g,"mousedown",Q.handleWindowClick),K(g,"touchstart",Q.handleWindowClick)},10)},handleTextEdit:function(){var a=this,e=a.gv,y=a._editTarget,X=a.getTargetValue(),B=a.input;(null===X||X===d)&&(X=""),B.value=X,a._editingDOM=B,e.getView().appendChild(B),this.layoutHTML(B,y),j(function(){B.focus(),K(g,"mousedown",a.handleWindowClick),K(g,"touchstart",a.handleWindowClick)},10)},layoutHTML:function(M,Q){var A=this.gv,q=A.getZoom();if(Q instanceof l.Node){var i=Q.getRect();M.style.left=(i.x+i.width/2)*q+A.tx()+"px",M.style.top=(i.y+i.height/2)*q+A.ty()+"px"}else if(Q instanceof l.Edge){var k=A.getDataUI(Q),i=k._6I;M.style.left=(i.x+i.width/2)*q+A.tx()+"px",M.style.top=(i.y+i.height/2)*q+A.ty()+"px"}},endTextEdit:function(){var U=this,j=U._editInfo.isMultiline?U.wrap:U.input,E=U._editInfo.isMultiline?U.textarea:U.input;U.setTargetValue(E.value),U.gv.getView().removeChild(j),U.gv._editing=!1,delete U._editingDOM,f(g,"mousedown",U.handlelick),f(g,"touchstart",U.handleWindowClick)},setTargetValue:function(N){var M=this,W=M._editTarget,w=M._editInfo,m=w.accessType,S=w.name;if(S&&m||(m="p",S="name"),"p"===m){var p=l.Default.setter(S);W[p](N)}else"a"===m?W.a(S,N):W.s(S,N)},getTargetValue:function(){var _=this,x=_._editTarget,v=_._editInfo,V=v.accessType,q=v.name;if(q&&V||(V="p",q="name"),"p"===V){var c=l.Default.getter(q);return x[c]()}return"a"===V?x.a(q):x.s(q)},createHiddenTextarea:function(){this.hiddenTextarea=m.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(j,e){if(e&&this.computedStyleCache)return this.computedStyleCache;var w=this,R=g.getComputedStyle(j),S=R.getPropertyValue("box-sizing")||R.getPropertyValue("-moz-box-sizing")||R.getPropertyValue("-webkit-box-sizing"),k=parseFloat(R.getPropertyValue("padding-bottom"))+parseFloat(R.getPropertyValue("padding-top")),$=parseFloat(R.getPropertyValue("border-bottom-width"))+parseFloat(R.getPropertyValue("border-top-width")),p=w.SIZING_STYLE.map(function(M){return M+":"+R.getPropertyValue(M)}).join(";"),A={sizingStyle:p,paddingSize:k,borderSize:$,boxSizing:S};return e&&(this.computedStyleCache=A),A},calculateTextareaHeight:function(s){s=s||"";var L=this,t=L.textarea,_=L.hiddenTextarea,N=L.wrap,E=32,b=L.calculateHTMLStyle(t,!1),f=b.paddingSize,z=b.borderSize,w=b.boxSizing,S=b.sizingStyle;_.setAttribute("style",S+";"+L.HIDDEN_TEXTAREA_STYLE),_.value=t.value+s;var n=_.scrollHeight;"border-box"===w?n+=z:"content-box"===w&&(n-=f),t.style.height=n+"px",t.style.marginTop=0-.5*n+"px",N.style.height=Math.max(n,E)+"px",N.style.marginTop=n*-.5+"px"}});var di=Lk.ScrollBarInteractor=function(I){$d(di,this,[I])};Wp("ScrollBarInteractor",qp,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(D){var n=this.gv.getViewRect();return this._41o()&&(n.x+n.width-this.gv.lp(D).x)*this.gv.getZoom()<ji},isH:function(P){var k=this.gv.getViewRect();return this._40o()&&(k.y+k.height-this.gv.lp(P).y)*this.gv.getZoom()<ji},handle_mousemove:function(d){this.handle_touchmove(d)},handle_touchmove:function(u){if(!uj&&ee(u)&&this.gv.isScrollBarVisible()){var F=this,T=F.isV(u),G=F.isH(u);(T||G)&&F.gv.showScrollBar(),F.gv._scrolling=T||G}},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)},handleWindowTouchEnd:function(x){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=s,this.fi({kind:"endScroll",event:x})},handle_mousedown:function(i){this.handle_touchstart(i)},handle_touchstart:function(W){var N=this;if(N.gv.setFocus(W),yc(W),N.handle_touchmove(W),!(on(W)>1)&&N.gv._scrolling&&N.gv.isScrollBarVisible()){N._cp=xl(W),N._tx=N.gv.tx(),N._ty=N.gv.ty();var j=N.isV(W);N._state=j?"vScroll":"hScroll",Fh(N,W),N.fi({kind:"beginScroll",event:W})}},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(r){var U=xl(r),H=this.gv.getViewRect(),B=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-U.y)*B.height/H.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-U.x)*B.width/H.width),this.fi({kind:"betweenScroll",event:r})}});var Fl=Lk.TouchInteractor=function(D,t){t=t||{},t.selectable===d&&(t.selectable=!0),t.movable===d&&(t.movable=!0),t.pannable===d&&(t.pannable=!0),t.pinchable===d&&(t.pinchable=!0),t.editable===d&&(t.editable=!0),this.params=t,$d(Fl,this,[D])};Wp("TouchInteractor",qp,{ms_edit:1,setUp:function(){var Q=this;Fl.superClass.setUp.call(Q),mo&&Q.params.editable&&Q.gv.setEditInteractor(Q)},tearDown:function(){var M=this;Fl.superClass.tearDown.call(M),mo&&M.params.editable&&M.gv.setEditInteractor(s)},clear:function(A){var q=this,R=q.gv;R._moving&&(q.fi({kind:"endMove",event:A}),delete R._moving,R.onMoveEnded(),R.dm().endTransaction()),R._panning&&(q.fi({kind:"endPan",event:A}),delete R._panning,R.onPanEnded()),R._pinching&&(q.fi({kind:"endPinch",event:A}),delete R._pinching,R.onPinchEnded()),R._editing&&(q._46O(A),q._77I=q._node=q._edge=q._shape=q._rect=q._89I=q._index=R._editing=s),q._moving=q._panning=q._pinching=q._editing=q._57I=q._data=q._beginHistory=s,q.clearDragging()},handle_touchstart:function(w){var A=this;if(!A.gv._editing){yc(w),A._57I=s;var Z=A.params,Y=A.gv,S=Y.sm(),Q=Y.getDataAt(w),x=on(w);
if(1===x){if(Ec(w))return Y.handleDoubleClick(w,Q),void 0;Y.handleClick(w,Q),Q&&(Y.handleMouseDown&&Y.handleMouseDown(w,Q),A._data=Q),Z.selectable||(Q=s),Q&&(S.co(Q)||S.ss(Q),Z.editable&&Y.isEditable(Q)&&A._79I(w,Q,!0)?(A._editing=1,A.startDragging(w)):Z.movable&&Y.isMovable(Q)&&(A._moving=1,A.startDragging(w))),Q&&Y.isMovable(Q)||(A._57I=xl(w),Z.pannable&&Y.isPannable()&&(A._panning=1,A.startDragging(w),A._translate={x:Y.tx(),y:Y.ty()}))}else if(Z.pinchable&&2===x){if(Q&&Y._39Q(Q))return;A._pinching=1,A.startDragging(w);var q=Y.getView(),d=Y.getZoom(),J=q.getBoundingClientRect(),u=w.touches[0],U=w.touches[1],V={x:(u.clientX+U.clientX)/2-J.left,y:(u.clientY+U.clientY)/2-J.top};V.x-=Y.tx(),V.y-=Y.ty(),V.x/=d,V.y/=d,A._p=V,A._d=Oi(w)}}},handle_touchend:function(t){var k=this,p=k.gv,O=k._57I,a=k._data;O&&(Qd(O,xl(t))<=1&&!p.getDataAt(t)&&p.sm().cs(),k._57I=s),a&&p.handleMouseUp&&p.handleMouseUp(t,a)},handleWindowTouchEnd:function(R){this.clear(R)},handleWindowTouchMove:function(D){var p=this,s=p.gv,M=on(D);if(1===M){if(p._editing&&(p._beginHistory||(p._beginHistory=1,s.dm().beginTransaction()),s._editing=1,p._78I(D)),p._moving)p._beginHistory||(p._beginHistory=1,s.dm().beginTransaction()),p.handleMove(D);else if(p._panning){var R=xl(D),T=Ge(s,R,p._lastClientPoint);s.setTranslate(p._translate.x+T.x,p._translate.y+T.y),p.fi({kind:s._panning?"betweenPan":"beginPan",event:D}),s._panning=1}}else if(2===M&&p._pinching){var d=Oi(D);s.handlePinch(p._p,d,p._d),p._d=d,p.fi({kind:s._pinching?"betweenPinch":"beginPinch",event:D}),s._pinching=1}},handleMove:function(J){var j=this,V=j.gv,r=V.lp(J);V._93O&&V._93O(J,j._data)||(V.moveSelection(r.x-j._lastLogicalPoint.x,r.y-j._lastLogicalPoint.y),j._lastLogicalPoint=r,j.autoScroll(J),j.fi({kind:V._moving?"betweenMove":"beginMove",event:J}),V._moving=1)}});var l=g.ht,tg=l.graph._editor={Math:l.Math,Guide:{}};tg.getStyle=function(z){var k,y=tg.StyleMap;return y&&(k=y[z],k!==d)?k:tg.DefaultStyleMap[z]},tg.setStyle=function(I,P){var Q=tg.StyleMap;Q||(Q=tg.StyleMap={}),Q[I]=P},tg.inEdit=function(r){return r._inXEdit===!0},tg.startEdit=function(R){R._inXEdit=!0,tg.Inject.doInject(R)},tg._46O=function(C){C._inXEdit=!1,tg.Inject.undoInject(C)},tg.toScreenPosition=function(l,d){var b=l.tx(),r=l.ty(),v=l._zoom;return new tg.Math.Vector2(d.x*v+b,d.y*v+r)},tg.checkHit=function(H,A,K){return H.distanceTo(A)<K?!0:!1},tg.toWorldPosition=function(G,x){var r=G.tx(),y=G.ty(),M=G._zoom;return{x:(x.x-r)/M,y:(x.y-y)/M}},tg.setAntialias=function(w,v){for(var E,Z=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],o=0,T=Z.length;T>o&&(E=Z[o],!(E in w));o++);w[E],w[E]=v},tg.getTargetCornersOnScreen=function(d,m){if(!m)return null;var c,g=[];if(rk(m,d)){var x=Ui(d,m);c=[{x:x.x,y:x.y},{x:x.x+x.width,y:x.y},{x:x.x+x.width,y:x.y+x.height},{x:x.x,y:x.y+x.height}]}else{if(!m.getCorners)return null;c=m.getCorners()}return c.forEach(function(N){var l=tg.toScreenPosition(d,N);g.push(l.x,l.y)}),g},tg.log=function(){};var yk=tg.Inject={_modules:[]};yk.registAsModule=function(A,P){var W={},h={};for(var o in A){var y=P.prototype[o];W[o]=y}A.getBackup=function(E){return W[E]},A.getBackups=function(){return W},h.doInject=function(){for(var w in A)"getBackup"!==w&&(P.prototype[w]=A[w])},h.undoInject=function(){for(var e in A)"getBackup"!==e&&(P.prototype[e]=W[e])},yk._modules.push(h)},yk.doInject=function(l){for(var D,L=yk._modules,g=0,q=L.length;q>g;g++)D=L[g],D.doInject(l)},yk.undoInject=function(t){for(var k,Z=yk._modules,c=0,m=Z.length;m>c;c++)k=Z[c],k.undoInject(t)};var qp=l.graph.EditInteractor=function(a){var R=this,B=m.createElement("canvas");B.className="editCanvas",B.style.position="absolute",R._styleMap={},R._canvas=B,R._context=B.getContext("2d"),qp.superClass.constructor.call(R,a),this._editDetail=!1,tg.setAntialias(R._context,!1),R._subModules=[new tg.Anchor(R),new tg.RotateX(R),new tg.MoveDummy(R),new tg.Rect(R),new tg.Curve(R),new tg.MoveHelper(R)],R._gridGuide=new tg.Guide.Grid(R),R._rectGuide=new tg.Guide.Rect(R),R._hoverGuide=new tg.Guide.Hover(R)},ks=qp;l.Default.def(qp,l.graph.Interactor,{ms_edit:1,ms_fire:1}),e.defineProperties(qp.prototype,{editDetail:{get:function(){var W=!!this._editDetail;return W},set:function(v){var q=this,Y=q._editDetail;Y!==v&&(q._editDetail=v,q.gv._editing=v,q.fp("editDetail",Y,v),q.fp("pointsEditingMode",Y,v),q.fi({kind:v?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(r){(!this._editDetail||r)&&(this.gv._editing=r,r||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(N){this._editing=N,this.gvEditing=N}},pointsEditingMode:{get:function(){return this.editDetail},set:function(q){var i=this;i.editDetail!==q&&(q?i._tryEnterEditDetailMode():i._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var E=this._gridEnabled;if(!E)return!1;var x=this.gv;return x?!0:!0},set:function(w){w!==this._gridEnabled&&(this._gridEnabled=w,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(b){b!==this._agEnabled&&(this._agEnabled=b,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),qp.prototype.getSubModule=function(B){var Z,t,q,F=this._subModules;for(t=0,q=F.length;q>t;t++)if(Z=F[t],Z.catalog===B)return Z},qp.prototype.invokeSubModule=function(p,B){var P=this,N=P._subModules;if(N)for(var s,n,L,q=Array.prototype.slice.call(arguments,2),v=0,K=N.length;K>v;v++)if(s=N[v],n=s[p],n&&(L=n.apply(s,q),L!=d&&B))return s},qp.prototype.invokeSubModuleInverse=function(N,i){var O=this,S=O._subModules;if(S)for(var h,t,E,P=Array.prototype.slice.call(arguments,2),W=S.length-1;W>=0;W--)if(h=S[W],t=h[N],t&&(E=t.apply(h,P),E!=d&&i))return h},qp.prototype.setUp=function(){tg.log("setUp");var w=this,v=w.gv,t=v.getView(),H=w._canvas;qp.superClass.setUp.call(w),v.setEditInteractor(w),v._79O?t.insertBefore(H,v._79O):t.appendChild(H),tg.startEdit(v),w.invokeSubModule("setUp"),v.dm().mm(w._onDataModelChanged,w),v.dm().md(w._onDataPropertyChanged,w)},qp.prototype.tearDown=function(){tg.log("tearDown");var v=this,e=v.gv,i=e.getView();v._resetCustomCursorStyle(),qp.superClass.tearDown.call(v),e.dm().umm(v._onDataModelChanged,v),e.dm().umd(v._onDataPropertyChanged,v),e.setEditInteractor(null),i.removeChild(v._canvas),v._drawTimer&&(n(v._drawTimer),v._drawTimer=null),tg._46O(e),v.invokeSubModule("tearDown")},qp.prototype._onDataModelChanged=function(n){var e=this;("clear"===n.kind||"remove"===n.kind&&e.editDetail&&n.data===e.getSubModule("Curve").target)&&(e.editDetail=!1,e._42())},qp.prototype._onDataPropertyChanged=function(t){var l=this;if(l.editDetail){var M=l.getSubModule("Curve"),h=t.data;h===M.target&&(h._writing||M._handleDataChanged(t))}},qp.prototype.clear=function(){tg.log("clear")},qp.prototype.redraw=function(){this._42()},qp.prototype._42=function(){var U=this;U._drawTimer||(U._drawTimer=j(function(){U._drawTimer=null,U.drawImpl()},0))},qp.prototype.drawImpl=function(){var e;for(e in{_42:!0})break;return function(){var z=this,S=z._canvas,X=z.gv,o=X.getWidth(),Z=X.getHeight(),n=z._context,K=l.Default.getInternal(),F=g.devicePixelRatio;(S.width!==o||S.height!==Z)&&K.setCanvas(S,o,Z,F),n.clearRect(0,0,S.width,S.height);var d=z._getValidSelection();n.save(),n.scale(F,F),z._gridGuide._42(),z.invokeSubModuleInverse(e,!1,n,X,d),z._rectGuide._42(),z._hoverGuide._42(),n.restore()}}(),qp.prototype._getValidSelection=function(){var e=this,z=e.gv,$=z.sm().getSelection(),Y=[];return $.each(function(p){z.isVisible(p)&&z.isEditable(p)&&Y.push(p)}),Y},qp.prototype.handle_touchmove=function(B){return this.handle_mousemove(B)},qp.prototype.handle_mousemove=function(T){if(!l.Default.isDragging()){var q=this;if((q.editDetail||!Af()&&!im(T))&&!q.gv._externalEditing)if(q.gvEditing=!1,q._checkEdit(T))q.gvEditing=!0;else{if(!q.getStyle("hoverGuideVisible"))return;q.hoverData=q.gv.getDataAt(T),q._42()}}},qp.prototype.handle_touchstart=function(m){return this.handle_mousedown(m)},qp.prototype.handle_mousedown=function(e){yc(e);var m=this;if((m.editDetail||!Af()&&!im(e))&&!m.gv._externalEditing){if(Ec(e)&&!e.clickThrough){if(m.editDetail){if(m._tryQuitEditDetailMode(e))return}else if(m._tryEnterEditDetailMode())return;m.gv.dm().beginTransaction();var z=m.invokeSubModule("handleDoubleClick",!0,e);if(m.gv.dm().endTransaction(),z)return}var L=m._checkEdit(e);L&&(m._downPosition=m._getLogicalPoint(e),m.gv.dm().beginTransaction(),L.startEdit(m,e),m.editing=!0)}},qp.prototype._checkEdit=function(o){var b=this,F=b.gv,A=b._getLogicalPoint(o),h=b.invokeSubModule("check",!0,F,o,A)||null;return b._editMod=h,h},qp.prototype.handleWindowTouchMove=function(r){return this.handleWindowMouseMove(r)},qp.prototype.handleWindowMouseMove=function(d){var e=this,H=e._downPosition;if(H){var t=e._getLogicalPoint(d);if(t.distanceTo(H)<e.getStyle("moveSensitivity"))return;delete e._downPosition}var n=e._editMod;n&&n.handleEdit(e.gv,d)},qp.prototype._getLogicalPoint=function(Y){var E=this,x=l.Default.getLogicalPoint(Y,E._canvas);return new tg.Math.Vector2(x)},qp.prototype.handleWindowTouchEnd=function(u){return this.handleWindowMouseUp(u)},qp.prototype.handleWindowMouseUp=function(){var b;for(b in{_46O:!0})break;return function(A){var p=this;p.editing=!1,p.setCursor("default"),p.invokeSubModule(b,!1,A),p._42(),p.gv.dm().endTransaction()}}(),qp.prototype.handle_mousewheel=function(V){var t=this;yc(V),t.invokeSubModule("preHandleScroll",!0)||t.gv.handleScroll(V,V.wheelDelta)},qp.prototype.handleDelete=function(){var B=this;if(!B.editDetail){B.gv.dm().beginTransaction();var C=B.invokeSubModule("handleNormalStateDelete",!0);return B.gv.dm().endTransaction(),C||B.gv.removeSelection(),void 0}B.gv.dm().beginTransaction(),B.invokeSubModule("handleDelete",!0),B.gv.dm().endTransaction(),B._42()},qp.prototype.handle_keydown=function(W){var I=this;if((W.metaKey||W.ctrlKey)&&I._42(),Af(W)&&!I.editing)return I.gvEditing=!1,I.setCursor("default"),I._42(),void 0;var M=Cr(W);return I.editDetail?((M||ti(W))&&(I.editDetail=!1,I._42()),I.gv.dm().beginTransaction(),I.invokeSubModule("handle_keydown",!0,W),I.gv.dm().endTransaction(),void 0):(I.gv.dm().beginTransaction(),I.invokeSubModule("handleNormalStateKeyDown",!0,W),I.gv.dm().endTransaction(),M&&I._tryEnterEditDetailMode(),void 0)},qp.prototype.handle_keyup=function(N){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,N),this.gv.dm().endTransaction()},qp.prototype._tryEnterEditDetailMode=function(){var Z=this;return!Z.editDetail&&Z.invokeSubModule("canEnterEditDetailMode",!0)&&1===Z._getValidSelection().length?(Z.editDetail=!0,Z._42(),!0):void 0},qp.prototype._tryQuitEditDetailMode=function(k){var Q=this;return Q.editDetail?!k||Q.invokeSubModule("canQuitEditDetailMode",!0,k)?(Q.editDetail=!1,Q._42(),!0):!1:!1},qp.prototype.setStyle=function(X,e,j){var x=this;j?tg.setStyle(X,e):x._styleMap[X]=e,"baseColor"===X&&(Ig=e),x.fp("styleChanged",null,{key:X,value:e,base:j}),x._42()},qp.prototype.getStyle=function(K){var v=this,_=v._styleMap[K];return _!==d?_:tg.getStyle(K)},qp.prototype.setCursor=function(T){this._resetCustomCursorStyle(),l.graph.EditInteractor.superClass.setCursor.call(this,T)},qp.prototype._resetCustomCursorStyle=function(){var R=this;if(R._customStyle){var I=this.gv.getView();I.classList&&I.classList.remove&&I.classList.remove(R._customStyle),R._customStyle=null}},qp.prototype._setRotateCursor=function(T){var I=this,o=I._cursorFactory;o||(o=I._cursorFactory=new tg.CursorFactory(I));var l=o.getRotateCursor(T),V=I.gv.getView();I._resetCustomCursorStyle(),I._customStyle=l,V.classList&&V.classList.add&&V.classList.add(l)};var Ri=tg.Group=function(j){var m=this;m._entities=j,m._64O=0,m._position={x:0,y:0},m._scale={x:1,y:1},m._anchor={x:.5,y:.5},m._anchor2={x:.5,y:.5}};Ri.prototype={},Ri.prototype.constructor=Ri;var Mg=null;Ri.findOrCreateGroup=function(y){if(Mg&&Mg.checkIsMe(y))return Mg;var v=new tg.Group(y);return v.getKeyOb()?(Mg=v,v):void 0},Ri.prototype.checkIsMe=function(p){var J=this._entities;if(J.length!==p.length)return!1;var B,L={},N=p.length;for(B=0;N>B;B++)L[p[B]._id]=!0;for(B=0;N>B;B++)if(!L[J[B]._id])return!1;return!0},Ri.prototype.getRotation=function(){return this._64O},Ri.prototype.getPosition=function(){return this._position},Ri.prototype.getAnchor=function(){return this._anchor},Ri.prototype.getWidth=function(){return this._width},Ri.prototype.getScale=function(){return this._scale},Ri.prototype.getSize=function(){return{width:this._width,height:this._height}},Ri.prototype.getHeight=function(){return this._height},Ri.prototype.getKeyOb=function(){for(var n=this._entities,L=n.length-1;L>=0;L--){var f=n[L];if(this.isNode(f))return f}},Ri.prototype.getAnchor2=function(){var W=this,z=W.rotateCenter;if(z)return z;var e=W.getKeyOb();if(!e)return W._anchor;var T=W._anchor2,Y=e.getMatrix();return Y.tf({x:e.getWidth()*(T.x-e.getAnchor().x),y:e.getHeight()*(T.y-e.getAnchor().y)})},Ri.prototype.setAnchor2=function(C,Q){var D=this,d=D.getKeyOb();if(d){var c,E=d.getMatrix();c="number"==typeof C?{x:C,y:Q}:C;var G=E.tfi(c);D._anchor2={x:d.getAnchor().x+G.x/d.getWidth(),y:d.getAnchor().y+G.y/d.getHeight()}}},Ri.prototype.setRotation=function(){},Ri.prototype.beginRotate=function(s){this.rotateCenter=s.pos,this.rotateMode=s.groupRotateMode},Ri.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Ri.prototype.addRotation=function(a,J){return"batch"===J?this._addRotationInBatchMode(a):"block"===J?this._addRotationInBlockMode(a):void 0},Ri.prototype._addRotationInBlockMode=function(b){var O=this,E=O.rotateCenter||O.getPosition();O._entities.forEach(function(L){if(O.isNode(L)){var r=L.getMatrix();r.translate(-E.x,-E.y),r.rotate(b),r.translate(E.x,E.y);var i=Math.sign(L.getScale().x);L.setRotation(c(r.b*i,r.a*i)),L.setPosition(r.tx,r.ty)}})},Ri.prototype._addRotationInBatchMode=function(S){var H=this,o=H._anchor2;H._entities.forEach(function(B){if(H.isNode(B)){var u=B.getAnchor(),W=B.getMatrix(),z=W.tf({x:B.getWidth()*(o.x-u.x),y:B.getHeight()*(o.y-u.y)}),T=new tg.Math.Matrix2d;T.set(W.a,W.b,W.c,W.d,W.tx,W.ty),T.translate(-z.x,-z.y),T.rotate(S),T.translate(z.x,z.y);var Q=Math.sign(B.getScale().x);B.setRotation(c(T.b*Q,T.a*Q)),B.setPosition(T.tx,T.ty)}})},Ri.prototype.setPosition=function(P){var A,F,J,C,B=this,r=B._position,e=P.x-r.x,u=P.y-r.y,R=B._entities;for(F=0,J=R.length;J>F;F++)A=R[F],rn(A)&&(C=A.getPosition(),A.setPosition(C.x+e,C.y+u));B._position=P},Ri.prototype.setScale=function(V,d){var e=this,b=V/e._scale.x,q=d/e._scale.y;e._adjustChildScaleOrSize(b,q,"size"),e._scale={x:V,y:d}},Ri.prototype.getRect=function(){var J=this,G=J._position,j=J._width,r=J._height;return{x:G.x-j/2,y:G.y-r/2,width:j,height:r}},Ri.prototype.setSize=function(b,B){var R=this,b=Math.max(1,b),B=Math.max(1,B),v=b/R._width,D=B/R._height;R._adjustChildScaleOrSize(v,D,"size"),R._width=b,R._height=B},Ri.prototype._adjustChildScaleOrSize=function(D,$,L){var M,C,r,T,k,A,v,d,s,e,g,i,O,u,G=this,V=G._position,J=G._entities,n=new tg.Math.Matrix2d;for(C=0,r=J.length;r>C;C++)if(M=J[C],G.isNode(M)){if(T=M.getPosition(),k=M.getRotation(),A=M.getWidth(),v=M.getHeight(),d=M.getScale(),g=d.x*A,i=d.y*v,n.identity().scale(g,i).rotate(k).translate(T.x,T.y).translate(-V.x,-V.y).rotate(-G._64O),k=c(n.b*Math.sign(g),n.a*Math.sign(g)),n.scale(D,$),s=Math.cos(k),e=Math.sin(k),Math.abs(s)<.001?(O=n.b/e,u=-n.c/e):(O=n.a/s,u=n.d/s),"scale"===L)M.setScale(O/A,u/v);else if("size"===L){var q=O/d.x,I=u/d.y;M.setScale(Pj(O)*Math.abs(d.x),Pj(u)*Math.abs(d.y)),M.setSize(Math.max(.1,Math.abs(q)),Math.max(.1,Math.abs(I)))}n.rotate(G._64O).translate(V.x,V.y),M.setPosition(n.tx,n.ty)}},Ri.prototype.getMatrix=function(){var Q=this,t=Q._position,w=l.Default.getInternal(),x=Q._scale;return new w.Mat(Q._64O,t.x,t.y,x.x,x.y)},Ri.prototype.toGlobal=function(N){return this.getMatrix().tf(N)},Ri.prototype.getCorners=function(){var S=this,T=S._width,A=S._height,J=S._anchor,_=-T*J.x,H=-A*J.y,j=S.getMatrix();return[j.tf(_,H),j.tf(_,H+A),j.tf(_+T,H+A),j.tf(_+T,H)]},Ri.prototype.calcInfo=function(){var U,Y,f,X,V,C,Z=this,R=[],c=Z._entities,d=Z._64O;for(X=0,V=c.length;V>X;X++)C=c[X],Z.isNode(C)&&C.getCorners&&R.push.apply(R,C.getCorners());if(R.length){var $=Math.cos(-d),D=Math.sin(-d),y=1/0,W=-1/0,M=1/0,e=-1/0;for(X=0,V=R.length;V>X;X++)f=R[X],U=f.x,Y=f.y,f.x=$*U-D*Y,f.y=D*U+$*Y,y=Math.min(y,f.x),W=Math.max(W,f.x),M=Math.min(M,f.y),e=Math.max(e,f.y);Z._width=(W-y)/Z._scale.x,Z._height=(e-M)/Z._scale.y,$=Math.cos(d),D=Math.sin(d);var _=Z._anchor;U=y+(W-y)*_.x,Y=M+(e-M)*_.y,Z._position={x:$*U-D*Y,y:D*U+$*Y}}},Ri.prototype.isNode=function(m){return rn(m)?rk(m)?!1:!0:!1},Ri.prototype._42=function(o,F,J){var D,M,G,x,H,t,$,v,T=this,V=T._entities,i=T.rotateMode;for("batch"===i&&(v=T.getKeyOb()),D=0,M=V.length;M>D;D++)G=V[D],T.isNode(G)&&(t=G.getRect(),x=tg.toScreenPosition(J,{x:t.x,y:t.y}),H=tg.toScreenPosition(J,{x:t.x+t.width,y:t.y+t.height}),$={min:x,max:H},G===v&&($.isKeyOb=!0),tg.Icons.DrawIcon(o,F,tg.Icons.GroupSubEntityRect,$))};var Pc=tg.CurveActiving=function(O,h){this._curve=O,this._interactor=O._interactor;for(var E in h)this[E]=h[E]};Pc.prototype={},Pc.prototype.constructor=Pc,e.defineProperties(Pc.prototype,{point:{get:function(){return this._point},set:function(w){var m=this;m._point=w,m.editingCtrl||m._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(S){var u=this;u._pairs=S,u.editingCtrl&&u._firePointChange()}}}),Pc.prototype._firePointChange=function(){var B=this,Q=B.getCurrentEditingPoint(),K=B._interactor;if(!Q)return K.fi({kind:"selectPoint"}),void 0;var D=this._curve.target;if(D){var w=tg.getDataMatrix(D).invert(),S=Q.e;Q=w.apply(tg.toWorldPosition(K.gv,Q)),Q.e=S;var X=B._lastFirePoint;X&&Math.abs(Q.x-X.x)<1e-5&&Math.abs(Q.y-X.y)<1e-5&&(Q.e==d&&X.e==d||Math.abs(Q.e-X.e)<1e-5)||(B._lastFirePoint=Q,K.fi({kind:"selectPoint",x:Q.x,y:Q.y,e:Q.e}))}},Pc.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Pc.prototype.getCurrentEditingPoint=function(){var Y=this,i=Y.editingCtrl;if(i){var P=Y.pairs;if(P){var o=P[i.pairId],z=o[i.type];if(z)return z}}return Y._point};var od=tg.CursorFactory=function(s){var W=this;W._interactor=s,W._rotateCursorStyles={}};od.prototype={},od.prototype.constructor=od,od.prototype.getRotateCursor=function(Y){var p=this;0>Y&&(Y+=2*Math.PI);var N=p._interactor,i=N.getStyle("rotateCursorSize"),M=N.getStyle("rotateCursorRound"),k=Math.round(180*(Y/Math.PI)/M);k*M>=360&&(k=0);var H=p._rotateCursorStyles,X="htCustomRotateStyle_"+i+"_"+M+"_"+k;return H[X]||(p._produceRotateCursor(X,i,M,k),H[X]=!0),X},od.prototype._produceRotateCursor=function(j,D,o,F){var r=this;r._interactor;var w=r._canvas;w||(w=r._canvas=m.createElement("canvas")),w.width=w.height=D*devicePixelRatio,w.style.width=w.style.height=D+" px";var p=w.getContext("2d");tg.setAntialias(p,!1),p.scale(devicePixelRatio,devicePixelRatio);var e,q,P,t,B,y=Math.round(D/2),C=""+y+" "+y+",auto !important;",v=4;e=Math.PI/180*F*o,p.clearRect(0,0,D,D),p.save(),p.scale(D/32,D/32),p.translate(16,15),p.rotate(e+Math.PI/2),p.beginPath(),p.moveTo(-8,0),p.lineTo(-8,v),p.lineTo(-8+v,v),p.moveTo(8,0),p.lineTo(8,v),p.lineTo(8-v,v),p.moveTo(-8,v),p.quadraticCurveTo(0,-6,8,v),p.restore(),p.lineCap="round",p.lineJoin="miter",p.strokeStyle="white",p.lineWidth=4,p.stroke(),p.strokeStyle="black",p.lineWidth=2,p.stroke(),q=JSON.stringify(w.toDataURL()),t="cursor:url("+q+")"+C,1!==devicePixelRatio&&(P='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+D+'px" height="'+D+'px"><image xlink:href='+q+' width="'+D+'" height="'+D+'"/></svg>',t+="cursor:url(data:image/svg+xml;base64,"+btoa(P)+")"+C,t+="cursor:-webkit-image-set(url("+q+")"+devicePixelRatio+"x,url("+q+")1x)"+C),B=m.createElement("style"),B.textContent="body."+j+" *, ."+j+"{"+t+"}",m.head.appendChild(B)};var lf=tg.Guide.Grid=function(E){var x=this;x._interactor=E,x._alignmentGuideId=0,x._xAlignmentGuide=[],x._yAlignmentGuide=[]};lf.prototype={},lf.prototype.constructor=lf,e.defineProperties(lf.prototype,{gridBlockSize:{get:function(){var s=this;return s._gridBlockSize||s._interactor.getStyle("gridBlockSize")},set:function(M){this._gridBlockSize=M,this._interactor._42()}},gridThickLinesEvery:{get:function(){var Y=this;return Y._gridThickLinesEvery||Y._interactor.getStyle("gridThickLinesEvery")},set:function(H){this._gridThickLinesEvery=H,this._interactor._42()}},gridEnabled:{get:function(){var Q=this,l=Q._interactor;return l.gridEnabled&&Q.isValidGrid()}}}),lf.prototype._42=function(){var J=this,l=J._interactor;J.gridEnabled&&J.drawGrid(),l.alignmentGuideEnabled&&J.drawAlignmentGuide()},lf.prototype.makeMatrix=function(){var P=this,j=P._interactor.getStyle("gridAngle"),k=P._interactor.getStyle("gridRotation"),m=new tg.Math.Matrix2d,R=Math.sin(j),V=Math.cos(j);return m.set(1,0,V,R,0,0),m.rotate(k),m},lf.prototype.isValidGrid=function(){var I=this,k=Math.PI,q=I._interactor,J=q.gv;if(J._zoom<q.getStyle("gridZoomThreshold"))return!1;var s=q.getStyle("gridAngle"),U=Math.abs(180*(s%k/k)),H=1-1e-8;return H>U||U>180-H?!1:!0},lf.prototype.drawAlignmentGuide=function(){var V=this,c=V._interactor,I=c.gv,d=c._canvas,G=c._context,T=d.width,H=d.height,u=I.tx(),b=I.ty(),s=I._zoom;G.beginPath(),G.strokeStyle=c.getStyle("gridAlignmentGuideColor"),G.lineWidth=1,V._xAlignmentGuide.forEach(function(S){var D=S.p*s+u;G.moveTo(D,0),G.lineTo(D,H)}),V._yAlignmentGuide.forEach(function(R){var p=R.p*s+b;G.moveTo(0,p),G.lineTo(T,p)}),G.stroke()},lf.prototype.drawGrid=function(){function l(J,f,F,k){var y=tg.toScreenPosition(Q,Z.apply({x:J,y:f})),l=tg.toScreenPosition(Q,Z.apply({x:F,y:k}));v.moveTo(y.x,y.y),v.lineTo(l.x,l.y)}var z=this,q=z._interactor,r=z.gridBlockSize,L=z.gridThickLinesEvery,i=q.getStyle("gridThickColor"),M=q.getStyle("gridLightColor"),Q=q.gv,$=q._canvas,v=q._context,F=$.width,T=$.height,Z=z.makeMatrix(),D=Z.applyInverse(tg.toWorldPosition(Q,{x:0,y:0})),_=Z.applyInverse(tg.toWorldPosition(Q,{x:F,y:0})),S=Z.applyInverse(tg.toWorldPosition(Q,{x:0,y:T})),n=Z.applyInverse(tg.toWorldPosition(Q,{x:F,y:T})),N=Math.min(D.x,_.x,S.x,n.x),s=Math.max(D.x,_.x,S.x,n.x),w=Math.min(D.y,_.y,S.y,n.y),I=Math.max(D.y,_.y,S.y,n.y);F=s-N,T=I-w;var C=Math.ceil(N/r),m=Math.floor(s/r),e=Math.ceil(w/r),c=Math.floor(I/r);Q.tx(),Q.ty(),Q._zoom;var f,O,Y;for(v.save(),v.lineWidth=1,v.beginPath(),v.strokeStyle=i,Y=Math.ceil(C/L)*L;m>=Y;Y+=L)f=Y*r,l(f,w,f,I);for(Y=Math.ceil(e/L)*L;c>=Y;Y+=L)O=Y*r,l(N,O,s,O);for(v.stroke(),v.beginPath(),v.strokeStyle=M,Y=C;m>=Y;Y++)0!==Y%L&&(f=Y*r,l(f,w,f,I));for(Y=e;c>=Y;Y++)0!==Y%L&&(O=Y*r,l(N,O,s,O));v.stroke(),v.restore()},lf.prototype.getAlignmentGuides=function(){var V=this;return{x:V._xAlignmentGuide,y:V._yAlignmentGuide}},lf.prototype.addAlignmentGuide=function($,u,k){var Q=this,U="x"===$?Q._xAlignmentGuide:Q._yAlignmentGuide,k=k?k:++Q._alignmentGuideId,J={p:u,id:k};if(U.length){var T=Q._findClosestAlignmentGuide(J.p,U);T.dis<0?U.splice(T.index+1,0,J):U.splice(T.index,0,J)}else U.push(J);return Q._interactor._42(),k},lf.prototype.findClosest=function(Z,B,i){var H=this,R=H._interactor,O=R.gv;i&&(Z=tg.toWorldPosition(O,Z));var u,o,k,Y=1/0,b=1/0,n=Z.x,F=Z.y;if(H.gridEnabled){var q=H.gridBlockSize,v=H.makeMatrix(),K=v.applyInverse(Z);K=v.apply({x:Math.round(K.x/q)*q,y:Math.round(K.y/q)*q}),Y=K.x-n,b=K.y-F,k=!0}if(R.alignmentGuideEnabled&&(u=H._findClosestAlignmentGuide(n,H._xAlignmentGuide).dis,o=H._findClosestAlignmentGuide(F,H._yAlignmentGuide).dis,Math.abs(u)<Math.abs(Y)&&(Y=u,k=!0),Math.abs(o)<Math.abs(b)&&(b=o,k=!0)),k){k=!1;var d=O._zoom,r=R.getStyle("smartGuideThreshold")/d,V={};if(Math.abs(Y)<r&&"y"!==B&&(V.x=i?Y*d:Y,k=!0),Math.abs(b)<r&&"x"!==B&&(V.y=i?b*d:b,k=!0),k)return V}},lf.prototype._findClosestAlignmentGuide=function(e,k){if(!k.length)return{dis:1/0};for(var I,c=0,t=k.length-1;t-c>1;)I=Math.floor((c+t)/2),k[I].p<e?c=I:t=I;var o=k[c].p-e,h=k[t].p-e;return Math.abs(o)<=Math.abs(h)?{line:k[c],dis:o,index:c}:{line:k[t],dis:h,index:t}},lf.prototype.removeAllAlignmentGuide=function(Z){var _=this;"y"!==Z&&(_._xAlignmentGuide=[]),"x"!==Z&&(_._yAlignmentGuide=[]),_._interactor._42()},lf.prototype.removeAlignmentGuide=function(p){for(var u,v,$,z=this,W=z._xAlignmentGuide,Y=0;2>Y;Y++)for(W=0===Y?z._xAlignmentGuide:z._yAlignmentGuide,u=0,v=W.length;v>u;u++)if($=W[u],$.id===p)return W.splice(u,1),z._interactor._42(),{axis:0===Y?"x":"y",position:$.p};return!1},lf.prototype.adjustAlignmentGuide=function(d,e){var x=this,O=x.removeAlignmentGuide(d);return O?(x.addAlignmentGuide(O.axis,e,d),!0):!1};var om=tg.Guide.Rect=function(E){var R=this;R._interactor=E};om.prototype={},om.prototype.constructor=om,om.prototype.gatherRects=function(){var F,l,f,d,B=this,T=B._interactor.gv,X=[],Z=[],H={x:X,y:Z},U={},r=T.getDataModel(),n=r.a("width"),L=r.a("height");n&&L&&(F=0,l=0,f=n,d=L,X.push({node:r,type:0,p:F},{node:r,type:1,p:F+f/2},{node:r,type:2,p:F+f}),Z.push({node:r,type:0,p:l},{node:r,type:1,p:l+d/2},{node:r,type:2,p:l+d}),U[r._id||0]={x:F,y:l,width:f,height:d}),r.each(function(v){if(rn(v)&&!T.isSelected(v)&&T.isVisible(v)&&T.isValidGuideLineSource(v)){var j=!1;if(T.sm().getSelection().each(function(e){j||(v.isHostOn(e)?j=!0:v.isDescendantOf(e)&&(j=!0))}),!j){var h=v.getRect();F=h.x,l=h.y,f=h.width,d=h.height,X.push({node:v,type:0,p:F},{node:v,type:1,p:F+f/2},{node:v,type:2,p:F+f}),Z.push({node:v,type:0,p:l},{node:v,type:1,p:l+d/2},{node:v,type:2,p:l+d}),U[v._id]=h}}}),X.sort(function(n,L){return n.p-L.p}),Z.sort(function(O,b){return O.p-b.p}),B._grid=H,B._87I=U},om.prototype.gatherLines=function(d,C,L){var t,H,e,J,M,i,p,X,K,c,z,w,D=this,O=[D.findClosest({x:d.x,y:d.y},C),D.findClosest({x:d.x+d.w/2,y:d.y+d.h/2},C),D.findClosest({x:d.x+d.w,y:d.y+d.h},C)],S={},s=D._87I;L=L||255;var W,j;for(D._guideLine=[],t=0;2>t;t++)for(S={},0===t?(J="y",X=d.x,K=X+d.w):(J="x",X=d.y,K=X+d.h),H=0;3>H;H++)M=O[H],M&&isFinite(M[J])&&(W=1<<3*t+H,L&W&&(i=M[J+"Line"],p=i.node,j=p._id||0,S[j]||(S[j]=!0,w=s[j],"y"===J?(c=w.x,z=w.x+w.width):(c=w.y,z=w.y+w.height),e=i.p,D._guideLine.push({type:J,a:X,b:K,c:c,d:z,p:e,center:1===i.type}))))},om.prototype._binarySearchClosest=function(r,V){if(!V.length)return{dis:1/0};for(var x,X=0,j=V.length-1;j-X>1;)x=Math.floor((X+j)/2),V[x].p<r?X=x:j=x;var P=V[X].p-r,k=V[j].p-r;return Math.abs(P)<=Math.abs(k)?{line:V[X],dis:P}:{line:V[j],dis:k}},om.prototype.findClosest=function(e,b,t){var D=this,F=D._interactor,H=F.gv,N=D._grid;t&&(e=tg.toWorldPosition(H,e));var T,u=D._binarySearchClosest(e.x,N.x),c=D._binarySearchClosest(e.y,N.y),Z=u.dis,o=c.dis,P=H._zoom,Q=F.getStyle("smartGuideThreshold")/P,z={};return Math.abs(Z)<Q&&"y"!==b&&(z.x=t?Z*P:Z,z.xLine=u.line,T=!0),Math.abs(o)<Q&&"x"!==b&&(z.y=t?o*P:o,z.yLine=c.line,T=!0),T?z:void 0},om.prototype._42=function(){var n=this,A=n._guideLine;if(A&&!l.Default.isCtrlDown()){var L=n._interactor;if(L.getStyle("guideLineVisible")){var N,U,G,q,Y,i,B,R,f,x,C,W,h,H,v,e,X,Z=L.gv,b=L._context,J=Z.tx(),D=Z.ty(),o=Z._zoom,w=L.getStyle("guideLineTextSpacing");for(N=0,U=A.length;U>N;N++)G=A[N],R=G.type,f=G.p,x=G.a,C=G.b,W=G.c,h=G.d,H=Math.min(x,W),v=Math.max(C,h),"x"===R?(q=f*o+J,Y=H*o+D,i=q,B=v*o+D):(q=H*o+J,Y=f*o+D,i=v*o+J,B=Y),tg.Icons.DrawIcon(L,b,tg.Icons.MoveLineGuide,{rect:[q,Y,i,B],center:G.center}),h>=x&&C>=W||(H=x>h?h:C,v=x>h?x:W,X=v-H,"x"===R?(G.center2center||(q-=w,i=q),Y=H*o+D,B=v*o+D,e=tg.Icons.MoveLineGuideDistanceV):"y"===R&&(G.center2center||(Y-=w,B=Y),q=H*o+J,i=v*o+J,e=tg.Icons.MoveLineGuideDistanceH),tg.Icons.DrawIcon(L,b,e,{x0:q,y0:Y,x1:i,y1:B,dis:X}))}}},om.prototype.clear=function(){this._guideLine=null};var ek=tg.Guide.Hover=function(J){var T=this;T._interactor=J};ek.prototype={},ek.prototype.constructor=ek,e.defineProperties(ek.prototype,{}),ek.prototype._42=function(){var N=this._interactor;if(N.getStyle("hoverGuideVisible")&&!N.gvEditing){var d=N.hoverData,I=N.gv;if(!rn(d)||I.isSelected(d))return N.hoverData=null,void 0;var F=Ui(I,d),z=tg.toScreenPosition(I,{x:F.x,y:F.y}),A=tg.toScreenPosition(I,{x:F.x+F.width,y:F.y+F.height});tg.Icons.DrawIcon(N,N._context,tg.Icons.HoverDataRect,{min:z,max:A,color:N.getStyle("hoverGuideColor")||N.getStyle("baseColor")})}},tg.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Fk=tg.Icons={},Pm=1e4,vr=null,Ig=tg.DefaultStyleMap.baseColor,eg="rgb(183,232,135)",tb="rgb(255,204,153)",lm=6;l.Default.setImage("Icons.RectPoint",{width:lm,height:lm,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Ig}},rect:[0,0,lm,lm]}]}),Fk.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var F=Fk.GroupSubEntityRect.data;if(!F)return[];var t=F.min,w=F.max;return[t.x,t.y,t.x,w.y,w.x,w.y,w.x,t.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Fk.GroupSubEntityRect.data.isKeyOb?Ig:Ig}}}]};var uq=4;Fk.HoverDataRect={comps:[{type:"shape",points:{func:function(){var K=Fk.HoverDataRect.data;if(!K)return[];var p=K.min,d=K.max,P=uq;return p.x-=P,p.y-=P,d.x+=P,d.y+=P,[p.x,p.y,p.x,d.y,d.x,d.y,d.x,p.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Fk.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Fk.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Fk.Line.data.P1.x,Fk.Line.data.P1.y],lm,lm]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Fk.Line.data.P2.x,Fk.Line.data.P2.y],lm,lm]}}}]},Fk.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Fk.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Fk.Rect={comps:[{type:"shape",points:{func:function(){var R=Fk.Rect.data;if(!R)return[];var H=R.LT,$=R.LB,B=R.RB,k=R.RT;return[H.x,H.y,$.x,$.y,B.x,B.y,k.x,k.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ig}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},rect:{func:function(){return[[Fk.Rect.data.LT.x,Fk.Rect.data.LT.y],lm,lm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},rect:{func:function(){return[[Fk.Rect.data.LB.x,Fk.Rect.data.LB.y],lm,lm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},rect:{func:function(){return[[Fk.Rect.data.RB.x,Fk.Rect.data.RB.y],lm,lm]
}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},rect:{func:function(){return[[Fk.Rect.data.RT.x,Fk.Rect.data.RT.y],lm,lm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},visible:{func:function(){return Fk.Rect.data.L?!0:!1}},rect:{func:function(){return[[Fk.Rect.data.L.x,Fk.Rect.data.L.y],lm,lm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},visible:{func:function(){return Fk.Rect.data.R?!0:!1}},rect:{func:function(){return[[Fk.Rect.data.R.x,Fk.Rect.data.R.y],lm,lm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},visible:{func:function(){return Fk.Rect.data.T?!0:!1}},rect:{func:function(){return[[Fk.Rect.data.T.x,Fk.Rect.data.T.y],lm,lm]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fk.Rect.data.rotation}},visible:{func:function(){return Fk.Rect.data.B?!0:!1}},rect:{func:function(){return[[Fk.Rect.data.B.x,Fk.Rect.data.B.y],lm,lm]}}}]};var Kj=16;l.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Ig}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Ig}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Fk.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Fk.Anchor.data.POS.x,Fk.Anchor.data.POS.y],Kj,Kj]}}}]},Fk.TipShiftX=12,Fk.TipShiftY=12;var Df=[8,28];Fk.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Fk.TipHelper.data.helperPos.x,Fk.TipHelper.data.helperPos.y,Df[0]*Fk.TipHelper.data.size,Df[1]]}},background:{func:function(){return vr.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Fk.TipHelper.data.text}},rect:{func:function(){return[Fk.TipHelper.data.helperPos.x,Fk.TipHelper.data.helperPos.y,Df[0]*Fk.TipHelper.data.size,Df[1]]}},color:{func:function(){return vr.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var wg=7;Fk.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Fk.ShapePoint.data.dynamicVisible}},rect:{func:function(){var c=Fk.ShapePoint.data.point,p=Fk.ShapePoint.data.size||wg;return[c,p+10,p+10]}},background:{func:function(){var k=Date.now(),i=Fk.ShapePoint.data.dynamicPeriod||1500,m=Math.sin(k%i/i*Math.PI);return"rgba(27,124,22,"+.5*m+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var a=Fk.ShapePoint.data.point,V=Fk.ShapePoint.data.size||wg;return[a,V,V]}},background:{func:function(){var d=Fk.ShapePoint.data.isEnd;return d?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Fk.ShapePoint.data.color||Ig}}},{type:"rect",visible:{func:function(){return!!Fk.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Ig}},rect:{func:function(){var H=5;return[Fk.ShapePoint.data.point,H,H]}}}]},Fk.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Fk.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Fk.ShapeBgCurve.data.P}},segments:{func:function(){return Fk.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var X=Date.now(),W=Fk.ShapeBgCurve.data.dynamicPeriod||1500,_=Math.sin(X%W/W*Math.PI);return"rgba(27,124,22,"+.3*_+")"}}},{type:"shape",points:{func:function(){return Fk.ShapeBgCurve.data.P}},segments:{func:function(){return Fk.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Fk.ShapeBgCurve.data.color||Ig}}}]};var gm=8;Fk.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var G=Fk.ShapeHighlighPoint.data;return[[G.x,G.y],gm,gm]}},background:{func:function(){return vr.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var eh=10;Fk.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var b=Fk.ShapeHighlighRealPoint.data;return[[b.x,b.y],eh,eh]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Ig}}}]};var cn=8;Fk.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var i=Fk.ShapeHighlighCtrlPoint.data,h=i.x,V=i.y,X=cn/2;return[h-X,V-X,h-X,V+X,h+X,V+X,h+X,V-X]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return vr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return vr.getStyle("shapeCtrlPointBorderColor")||Ig}}}]};var Cn=3;Fk.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Fk.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Cn,borderColor:{func:function(){return vr.getStyle("curveHighlightColor")}}}]},Fk.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Fk.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Fk.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Fk.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Fk.MoveLineGuide.data.center?eg:tb}}}]};var qg=5;Fk.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var B=Fk.MoveLineGuideDistanceH.data,U=B.x0,h=B.y0;return[U,h-qg,U,h+qg]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tb},{type:"shape",points:{func:function(){var G=Fk.MoveLineGuideDistanceH.data,W=G.x1,C=G.y1;return[W,C-qg,W,C+qg]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tb},{type:"text",text:{func:function(){return Math.round(Fk.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var z=Fk.MoveLineGuideDistanceH.data;return[[(z.x0+z.x1)/2,z.y0-10],20,20]}},color:tb,font:"12px Arial",align:"center"}]},Fk.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var q=Fk.MoveLineGuideDistanceV.data,V=q.x0,U=q.y0;return[V-qg,U,V+qg,U]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tb},{type:"shape",points:{func:function(){var h=Fk.MoveLineGuideDistanceV.data,_=h.x1,g=h.y1;return[_-qg,g,_+qg,g]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tb},{type:"text",text:{func:function(){return Math.round(Fk.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var T=Fk.MoveLineGuideDistanceV.data;return[[T.x0-10,(T.y0+T.y1)/2],20,20]}},color:tb,font:"12px Arial",align:"center"}]},l.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Fk.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var D=Fk.EdgeElevationGuide.data,g=D.x,S=D.y,N=vr.getStyle("curveElevationIntersectSize"),F=vr.getStyle("curveElevationGuideShift");return g+=F[0],S+=F[1],[g-N,S-N,2*N,2*N]}}}]},l.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),l.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Fk.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Fk.ConnectGuide.data.rotation}},rect:{func:function(){var g=Fk.ConnectGuide.data.connect;g.x,g.y;var u=vr.getStyle("connectGuideIntersectSize");return[[g.x,g.y],2*u,2*u]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var y=Fk.ConnectGuide.data.cursorPos||Fk.ConnectGuide.data.connect,G=vr.getStyle("connectGuideIntersectSize");return[[y.x,y.y],2*G-2,2*G-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var r=Fk.ConnectGuide.data.connect,l=Fk.ConnectGuide.data.cursorPos||r;return[r.x,r.y,r.x+.5*(l.x-r.x),r.y,l.x+.5*(r.x-l.x),l.y,l.x,l.y]}}}]},l.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),l.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Fk.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var I=Fk.ConnectGuideGarbage.data.hover;return I?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var e=Fk.ConnectGuideGarbage.data,h=vr.getStyle("connectGuideGarbageIntersectsize");return e.hover&&(h+=5),[[e.x,e.y],2*h,2*h]}}}]};var Op=6;Fk.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Fk.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var R=Fk.ShapeActivingCtrl.data;return[R.point.x,R.point.y,R.c1.x,R.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Ig}}},{type:"shape",visible:{func:function(){return Fk.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var L=Fk.ShapeActivingCtrl.data;return[L.point.x,L.point.y,L.c2.x,L.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Ig}}},{type:"shape",visible:{func:function(){return Fk.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var J=Fk.ShapeActivingCtrl.data.c1,e=J.x,y=J.y,q=Op/2;return"c1"===Fk.ShapeActivingCtrl.data.hl&&(q+=.5),[e-q,y-q,e-q,y+q,e+q,y+q,e+q,y-q]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return vr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Fk.ShapeActivingCtrl.data.hl?vr.getStyle("shapeCtrlPointHighlightBorder")||Ig:vr.getStyle("shapeCtrlPointBorderColor")||Ig}}},{type:"shape",visible:{func:function(){return Fk.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var Z=Fk.ShapeActivingCtrl.data.c2,F=Z.x,R=Z.y,p=Op/2;return"c2"===Fk.ShapeActivingCtrl.data.hl&&(p+=.5),[F-p,R-p,F-p,R+p,F+p,R+p,F+p,R-p]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return vr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Fk.ShapeActivingCtrl.data.hl?vr.getStyle("shapeCtrlPointHighlightBorder")||Ig:vr.getStyle("shapeCtrlPointBorderColor")||Ig}}}]},Fk.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Ig}},rect:{func:function(){return[[Fk.RoundPoint.data.x,Fk.RoundPoint.data.y],lm,lm]}}}]},Fk.AttachPoint={comps:[{type:"rect",background:{func:function(){return Fk.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Ig}},rect:{func:function(){var r=Fk.AttachPoint.data.isAttach?lm+4:lm;return[[Fk.AttachPoint.data.x,Fk.AttachPoint.data.y],r,r]}}}]},Fk.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Fk.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Fk.SimpleRect.data.color||Ig}},rect:{func:function(){var H=Fk.SimpleRect.data;return[H.x,H.y,H.width,H.height]}}}]},l.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Fk.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var Q=Fk.MoveDummy.data;return[[Q.pos.x,Q.pos.y],2*Q.size,2*Q.size]}}}]},tg.Icons.DrawIcon=function(J,u,U,x){U.width=U.height=Pm,U.data=x,vr=J,l.Default.drawImage(u,U,0,0,Pm,Pm)},tg.Icons.MapPoints=function(G,f){for(var r=0,u=G.length;u>r;r++)G[r]/=f},tg.roundTo=function(j,i,S){var n=Math.abs(j%i);return S>n||S>i-n?i*Math.round(j/i):j},tg.toFixed=function(o){return Math.round(100*o)/100},tg.getDataMatrix=function(w){if(w instanceof l.Shape){var Q=new l.Math.Matrix2d,Y=w.getPosition();return Q.translate(-Y.x,-Y.y).scale(w.getScale().x,w.getScale().y).rotate(w.getRotation()).translate(Y.x,Y.y),Q}return w.getMatrix?w.getMatrix():new l.Math.Matrix2d};var Sq=tg.Math.Curve=function(){this._curves=[]};Sq.prototype={},Sq.prototype.constructor=Sq,Sq.prototype.createFromHtShape=function(J,K,_){K instanceof l.List&&(K=K.toArray());var X,W,B,x,M,c,u,n=this,b=null,s=null,E=0,Q=tg.Math.Vector2,h=tg.Math.CubicBezier,i=function(z){return new Q(J[z],J[z+1],_?_[z/2]:d)};for(W=0,B=K.length;B>W;W++){switch(x=K[W],M=null,x){case 1:s=i(E),b=s,E+=2;break;case 2:X=i(E),E+=2,M=new h(s,s.clone(),X.clone(),X),s=X;break;case 3:c=i(E),X=i(E+2),E+=4,M=new h(s,c.clone().sub(s).multiplyScalar(2/3).add(s),c.clone().sub(X).multiplyScalar(2/3).add(X),X),s=X;break;case 4:c=i(E),u=i(E+2),X=i(E+4),E+=6,M=new h(s,c,u,X),s=X;break;case 5:if(!b)break;M=new h(s,s.clone(),b.clone(),b),s=null,b=null}M&&(M._index=n._curves.length,n._curves.push(M))}},Sq.prototype.checkPoint=function(j,p){var y,P,A,_,M,x=this,q=x._curves;for(y=0,P=q.length;P>y;y++)if(_=q[y],M=_.intersectRect(j,p,p),M.length)return A=0,M.forEach(function(l){A+=l.t}),A/=M.length,j=_.getPointAt(A),j.t=A,{bezier:_,intersection:j}},Sq.prototype.insertKnot=function(f,r){var R=f.insertKnot(r),z=this,V=z._curves;V.splice(f._index,1,R[0],R[1])},Sq.prototype._isCloseEnough=function(o,j){return Math.abs(o.x-j.x)<1e-6&&Math.abs(o.y-j.y)<1e-6},Sq.prototype._isSamePoint=function(D,s){return D===s},Sq.prototype.moveRealPoint=function(Y,e){var n=this,H=n._curves,O=e.clone().sub(Y);H.forEach(function(D){var Q=D._p1;D._p2,D._p3;var w=D._p4;n._isSamePoint(Q,Y)&&(D._p2.add(O),D._p1=e),n._isSamePoint(w,Y)&&(D._p3.add(O),D._p4=e)})},Sq.prototype.moveCtrlDueToRealPointMovement=function(C,O){var e=this,v=e._curves,_=function(x){x.add(O),x.e&&O.e&&(x.e+=O.e)};v.forEach(function(h){var E=h._p1;h._p2,h._p3;var w=h._p4;e._isSamePoint(E,C)&&_(h._p2),e._isSamePoint(w,C)&&_(h._p3)})},Sq.prototype.moveCtrlPoint=function(e,I,m){var t=e[m];if(t){t.e!==d&&(I.e=t.e);var v=this,C=v._curves;I.clone().sub(t),C.forEach(function(W){var O;"c2"===m?O="_p2":"c1"===m&&(O="_p3"),v._isSamePoint(W[O],t)&&(W[O]=I)}),e[m]=I}},Sq.prototype.deleteRealPoint=function(N,W){var x,w,p,z,G,_,A,I=this,j=I._curves,l={},M=[],o=tg.Math.CubicBezier;for(w=0,p=j.length;p>w;w++)x=j[w],z=x._p1,G=x._p2,_=x._p3,A=x._p4,(l[w]||!I._isSamePoint(z,N))&&(I._isSamePoint(A,N)?p>w+1&&I._isSamePoint(j[w+1]._p1,N)&&(W||M.push(new o(z,G,j[w+1]._p3,j[w+1]._p4))):M.push(x));I._curves=M},Sq.prototype.findPairs=function(S,f){var _,W,T,Q,O,p,o,y,v=this,G=v._curves,I={},B=[];for(W=0,T=G.length;T>W;W++)_=G[W],Q=_._p1,O=_._p2,p=_._p3,o=_._p4,!I[W]&&v._isSamePoint(Q,S)&&(f?B.push({point:Q,r2:o}):B.push({point:Q,c2:O})),v._isSamePoint(o,S)&&(y=f?{point:o,r1:Q}:{point:o,c1:p},T>W+1&&v._isSamePoint(G[W+1]._p1,S)&&(f?y.r2=G[W+1]._p4:y.c2=G[W+1]._p2,I[W+1]=!0),B.push(y));return B},Sq.prototype.toHtShape=function(){var z=this,I=z._curves,k=[],U=[],Q={x:1/0,y:1/0};return I.forEach(function(H){var M=H._p1,D=H._p2,e=H._p3,t=H._p4;return z._isCloseEnough(M,Q)||(k.push(1),U.push(M.clone())),Q=t,z._isCloseEnough(M,D)&&z._isCloseEnough(e,t)?(k.push(2),U.push(t.clone()),void 0):(k.push(4),U.push(D.clone(),e.clone(),t.clone()),void 0)}),{segments:k,points:U}};var Vo=tg.Math.CubicBezier=function(j,t,B,s){var x=this;x._id=tg.Math.CubicBezier._globalId++,x._p1=j,x._p2=t,x._p3=B,x._p4=s};Vo._globalId=1,Vo.prototype={},Vo.prototype.constructor=Vo,Vo.prototype.toString=function(){return this._id},Vo.prototype.intersectRect=function(U,Y,P){var o=Y/2,c=P/2,b=U.x,k=U.y,g=tg.Math.Vector2,i=new g(-o+b,-c+k),F=new g(o+b,c+k),S=new g(F.x,i.y),W=new g(i.x,F.y),T=this,H=T.intersectLine(i,S),r=T.intersectLine(S,F),E=T.intersectLine(F,W),N=T.intersectLine(W,i),s=H.concat(r).concat(E).concat(N);return s},Vo.prototype.intersectLine=function(n,f){var T,H,z,t,X,D,C,F,O,v,b,h,L,x=this,k=n.clone().min(f),o=n.clone().max(f);t=x._p1,X=x._p2,D=x._p3,C=x._p4,T=t.clone().multiplyScalar(-1),H=X.clone().multiplyScalar(3),z=D.clone().multiplyScalar(-3),b=T.add(H).add(z).add(C),T=t.clone().multiplyScalar(3),H=X.clone().multiplyScalar(-6),z=D.clone().multiplyScalar(3),v=T.add(H).add(z),T=t.clone().multiplyScalar(-3),H=X.clone().multiplyScalar(3),O=T.add(H),F=t.clone(),L=new tg.Math.Vector2(n.y-f.y,f.x-n.x),h=n.x*f.y-f.x*n.y;for(var E=x.getRoots(L.dot(b),L.dot(v),L.dot(O),L.dot(F)+h),g=new Array,W=0,w=E.length;w>W;W++){var y=E[W];if(!(0>y||y>1)){var q=t.clone().lerp(X,y),B=X.clone().lerp(D,y),l=D.clone().lerp(C,y),G=q.lerp(B,y),K=B.lerp(l,y),R=G.lerp(K,y);R.t=y,n.x==f.x?k.y<=R.y&&R.y<=o.y&&g.push(R):n.y==f.y?k.x<=R.x&&R.x<=o.x&&g.push(R):R.x>=k.x&&R.y>=k.y&&R.x<=o.x&&R.y<=o.y&&g.push(R)}}return g},Vo.prototype.solveTForPoint=function(p){var g,j,X,_,D=this;g=D._p1.x-p.x,j=D._p2.x-p.x,X=D._p3.x-p.x,_=D._p4.x-p.x;for(var Q=D.getRoots(_-3*X+3*j-g,3*X-6*j+3*g,3*j-3*g,g),h=d,c=1/0,I=0,i=Q.length;i>I;I++){var O=Q[I];if(!(0>O||O>1)){var y=D._p1.clone().lerp(D._p2,O),b=D._p2.clone().lerp(D._p3,O),P=D._p3.clone().lerp(D._p4,O),U=y.lerp(b,O),L=b.lerp(P,O),G=U.lerp(L,O);G.t=O;var B=Math.abs(G.y-p.y);c>B&&(c=B,h=G)}}return h},Vo.prototype.getPointAt=function(R){var U=this,k=U._p1,t=U._p2,M=U._p3,H=U._p4,g=k.clone().lerp(t,R),P=t.clone().lerp(M,R),G=M.clone().lerp(H,R),c=g.lerp(P,R),m=P.lerp(G,R);return c.lerp(m,R)},Vo.prototype.getRoots=function(X,t,K,v){var j,p,G,w,I,s=new Array;if(Math.abs(X)<1e-6){var j=t,p=K/j,G=v/j,w=p*p-4*G;if(w>0){var I=Math.sqrt(w);s.push(.5*(-p+I)),s.push(.5*(-p-I))}else 0==w&&s.push(.5*-p)}t/=X,K/=X,v/=X,j=(3*K-t*t)/3,p=(2*t*t*t-9*K*t+27*v)/27;var P=t/3,n=p*p/4+j*j*j/27,H=p/2;if(Math.abs(n)<=1e-6&&(n=0),n>0){var F,r,I=Math.sqrt(n);F=-H+I,r=F>=0?Math.pow(F,1/3):-Math.pow(-F,1/3),F=-H-I,F>=0?r+=Math.pow(F,1/3):r-=Math.pow(-F,1/3),s.push(r-P)}else if(0>n){var z=Math.sqrt(-j/3),D=Math.atan2(Math.sqrt(-n),-H)/3,J=Math.cos(D),i=Math.sin(D),o=Math.sqrt(3);s.push(2*z*J-P),s.push(-z*(J+o*i)-P),s.push(-z*(J-o*i)-P)}else{var F;F=H>=0?-Math.pow(H,1/3):Math.pow(-H,1/3),s.push(2*F-P),s.push(-F-P)}return s},Vo.prototype._70I=function(){var P=this;return P._p1.distanceToSquared(P._p2)<1e-10&&P._p3.distanceToSquared(P._p4)<1e-10},Vo.prototype.insertKnot=function(j){var I=this,x=I._p1,K=I._p2,b=I._p3,k=I._p4,N=x.clone().lerp(K,j),J=K.clone().lerp(b,j),t=b.clone().lerp(k,j),Z=N.clone().lerp(J,j),L=J.clone().lerp(t,j),y=Z.clone().lerp(L,j);return I._70I()?(x.clone().lerp(k,j),[new tg.Math.CubicBezier(x,x.clone(),y.clone(),y),new tg.Math.CubicBezier(y,y.clone(),k.clone(),k)]):[new tg.Math.CubicBezier(x,N,Z,y),new tg.Math.CubicBezier(y,L,t,k)]};var _o=l.Default.getInternal().ui().EdgeUI,wb={_47O:function(e){var Q=this,y=wb.getBackups()._47O;tg.inEdit(Q.gv)||y.call(Q,e)}};tg.Inject.registAsModule(wb,_o);var co=l.Default.getInternal().ui().NodeUI,xk={_47O:function(W){var X=this,w=xk.getBackups()._47O;tg.inEdit(X.gv)||w.call(X,W)},getSelectWidth:function(){var X=this,k=X.gv,U=X._data;if(k.isEditable(U)&&tg.inEdit(k))return 0;var u=xk.getBackup("getSelectWidth");return u.call(X)}};tg.Inject.registAsModule(xk,co);var ni=l.graph.GraphView,kl={_editPointSize:function(){var H=l.Default.isTouchable,A=tg.getStyle("pointSize");return A[H?0:1]}(),isPointEditable:function(U){var x=this;if(tg.inEdit(x))return x._pointEditableFunc?x._pointEditableFunc(U):!0;var i=kl.getBackup("isPointEditable");i.call(x,U)},isEditable:function(M){var a,J=this,L=kl.getBackup("isEditable");if(a=M instanceof tg.Group?!0:L.call(J,M),!tg.inEdit(J))return a;if(!(M instanceof l.Edge))return a;if(!M.s("2d.editable"))return!1;var P=J.getEditableFunc();return P?P(M):!0},_42:function(p,H){var m=this,O=kl.getBackups()._42;if(O.call(m,p,H),tg.inEdit(m)){var i=m.getEditInteractor();i.drawImpl()}}};tg.Inject.registAsModule(kl,ni);var th=l.Default.getInternal().ui().ShapeUI,Cp={_47O:function($){var U=this,S=Cp.getBackups()._47O;tg.inEdit(U.gv)||S.call(U,$)}};tg.Inject.registAsModule(Cp,th);var _r=l.graph.DefaultInteractor,_j={handle_mousewheel:function(X){var s=this,o=_j.getBackup("handle_mousewheel");tg.inEdit(s.gv)||o.call(s,X)}};tg.Inject.registAsModule(_j,_r);var Mh=l.graph.MoveInteractor,cd={_calcShift:function(t,Q){var i=this,h=cd.getBackup("_calcShift"),u=i.gv;if(!tg.inEdit(u))return h.call(i,t,Q);var J=u.getEditInteractor(),W=J.getSubModule("Move").calcShift(t,Q,i);return W||h.call(i,t,Q)},clear:function(A){var d=this,_=cd.getBackup("clear");_.call(d,A);var N=d.gv;if(tg.inEdit(N)){var R=N.getEditInteractor();R.getSubModule("Move").clear(A)}}};tg.Inject.registAsModule(cd,Mh);var om=tg.Rect=function(e){this.catalog="Rect",this._interactor=e};om.prototype={},om.prototype.constructor=om,om.prototype.gatherInfo=function(b,U){var w=this;if(1===U.length){var o=U[0];return o instanceof l.Shape&&o._70I()?w.gatherLine(b,o):rk(o,b)?!1:w.gatherSingleTarget(b,o)}return U.length>1?w.gatherMultiTargets(b,U):!1},om.prototype.gatherSingleTarget=function(_,w){if(w.getCorners){var t,O=this,l=O.info;O.target=w,t=O.screenInfo={};var E=w.getCorners();l.LT=new tg.Math.Vector2(E[0]),l.LB=new tg.Math.Vector2(E[1]),l.RB=new tg.Math.Vector2(E[2]),l.RT=new tg.Math.Vector2(E[3]),l.T=l.LT.clone().add(l.RT).divideScalar(2),l.B=l.LB.clone().add(l.RB).divideScalar(2),l.L=l.LT.clone().add(l.LB).divideScalar(2),l.R=l.RT.clone().add(l.RB).divideScalar(2);for(var A in l)t[A]=tg.toScreenPosition(_,l[A]);var M=O._interactor,L=M.getStyle("checkSize"),z=function(x,Y,c){var w=Y.clone().sub(x).setLength(-L),N=c.clone().sub(x).setLength(-L),_=w.add(N).add(x);return _};return t.rotLT=z(t.LT,t.RT,t.LB),t.rotLB=z(t.LB,t.LT,t.RB),t.rotRB=z(t.RB,t.LB,t.RT),t.rotRT=z(t.RT,t.LT,t.RB),t.rotT=t.rotLT.clone().add(t.rotRT).divideScalar(2),t.rotB=t.rotLB.clone().add(t.rotRB).divideScalar(2),t.rotL=t.rotLT.clone().add(t.rotLB).divideScalar(2),t.rotR=t.rotRT.clone().add(t.rotRB).divideScalar(2),t.rotation=w.getRotation(),O.gatherConnectInfo(),!0}},om.prototype.gatherConnectInfo=function(){var F=this,A=F.target,v=F._interactor,I=F.screenInfo,P=v.gv;if(P.isConnectActionVisible(A)&&v.getStyle("connectGuideVisible")){var m;A.s&&(m=A.s("connectGuideShift")),m||(m=v.getStyle("connectGuideShift"));var i=A.getAnchor(),Q=A.getSize(),t=A.toGlobal({x:Q.width*(m[0]-i.x),y:Q.height*(m[1]-i.y)});t=tg.toScreenPosition(P,t),I.P1?t.add(I.P2.clone().sub(I.P1).setLength(m[2])):(t.add(I.RT.clone().sub(I.LT).setLength(m[2])),t.add(I.LB.clone().sub(I.LT).setLength(m[3]))),I.connect=t}},om.prototype.gatherMultiTargets=function(w,q){var V=tg.Group.findOrCreateGroup(q);if(!V)return!1;var s=this;return s.editing&&"rotate"!==s.editing.mode||V.calcInfo(),s.gatherSingleTarget(w,V)},om.prototype.gatherLine=function(g,v){this.target=v;var G=this.screenInfo={},q=v.getPoints(),o=tg.getDataMatrix(v);return G.P1=tg.toScreenPosition(g,o.apply(q.get(0))),G.P2=tg.toScreenPosition(g,o.apply(q.get(1))),this.gatherConnectInfo(),!0},om.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],om.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],om.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],om.prototype.check=function(x,N,i){if(l.Default.isLeftButton(N)){var Z=this;if(Z.editing=null,Z.tipInfo=null,Z.screenInfo){var G=Z.target,M=x.isEditable(G),V=Z.screenInfo;if(M&&V.connect){var O=Z._checkConnect(i);if(O)return O}if(V.P1)return Z._checkLine(i);var a,I,t,v=null,H=Z._interactor,y=H.getStyle("checkSize");if(M&&x.isRectEditable(G))for(I=0;I<tg.Rect.ResizeKeys.length;I++)if(t=tg.Rect.ResizeKeys[I],tg.checkHit(i,V[t],y)){v=t,a="resize";break}if(!v&&M&&x.isRotationEditable(G)&&!H.getStyle("rotateAsClock")){var e=H.getStyle("rotateCheckSize");for(I=0;I<tg.Rect.RotateKeys.length;I++)if(t=tg.Rect.RotateKeys[I],tg.checkHit(i,V[t],e)){v=t,a="rotate";break}}if(!v)return H.setCursor("default"),void 0;if("rotate"===a){var K,F=x.lp(N);if(G instanceof tg.Group){var X=H.getStyle("groupRotateModeKey");"string"==typeof X&&(X=[X]);for(var C=!1,J=0,P=X.length;P>J;J++)if(N[X[J]]){C=!0;break}var w=H.getStyle("groupRotateModeDefault");K=C?"batch"===w?"block":"batch":w}var Q="batch"===K?G.getAnchor2():G.getPosition(),s=Math.atan2(F.y-Q.y,F.x-Q.x);H._setRotateCursor(s),Z.editing={mode:a,key:v,pos:Q,flipY:G.getScale().y<0,rotation:G.getRotation(),hitRot:s},K&&(Z.editing.groupRotateMode=K)}else{var m=tg.Rect.ResizeKeys.indexOf(v),h=tg.Rect.ResizeDirection[m],b=Math.cos(G.getRotation()),f=Math.sin(G.getRotation()),S=h.x*Math.sign(G.getScale().x),W=h.y*Math.sign(G.getScale().y),L=Math.atan2(-f*S-b*W,b*S-f*W),z=(Math.round(L/(Math.PI/4))+8)%8,n=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][z];this._interactor.setCursor(n);var g=G.getWidth(),B=G.getHeight(),j=G.getAnchor();Z.editing={mode:a,key:v,rect:{x:-g*j.x,y:-B*j.y,width:g,height:B},anchor:j,matrix:G.getMatrix()}}return v}}},om.prototype._checkLine=function(X){var B=this;B.screenInfo;var F,n=B._interactor.getStyle("checkSize");if(tg.checkHit(X,B.screenInfo.P1,n))F="P1";else{if(!tg.checkHit(X,B.screenInfo.P2,n))return this._interactor.setCursor("default"),void 0;F="P2"}return B.editing={mode:"line",key:F},F},om.prototype._checkConnect=function(Q){var W=this,T=W.screenInfo,U=W._interactor,s=U.getStyle("connectGuideIntersectSize"),t=T.connect,d=Q.x,M=t.x;if(M>d&&s>M-d&&Math.abs(t.y-Q.y)<s||d>=M&&tg.checkHit(Q,t,s)){var b="connect",q=k.getConnectAction(U.gv);if(W.editing={mode:b},q&&q.delete)if(W.target instanceof tg.Group){var Z=!0;U.gv.sm().getSelection().each(function(Y){q.delete.visible.call(null,U.gv,Y)||(Z=!1)}),W.editing.hasDeleteAction=Z}else q.delete.visible.call(null,U.gv,W.target)&&(W.editing.hasDeleteAction=!0);return U.setCursor("default"),b}},om.prototype._fireEditEvent=function(R,U){var E=this._interactor,w=this.editing;if(w){var f=w.mode;f="rotate"===f?"Rotation":"connect"===f?"Connection":"resize"===f?"Rect":f[0].toUpperCase()+f.slice(1),E.fi({kind:R+"Edit"+f,event:U})}},om.prototype.startEdit=function(j,L){j.startDragging(L);var D=this;D._interactor.fi({kind:"prepareEdit",event:L});var Y=D.editing,b=D.target;if(Y){if(D._fireEditEvent("begin",L),"rotate"===Y.mode)return Y.groupRotateMode&&b.beginRotate(Y),void 0;if("connect"!==Y.mode)("line"===Y.mode||b&&0===b.getRotation())&&(D._inSmartGuide=!0,D._interactor.rectGuide.gatherRects());else if(Y.hasDeleteAction){var C=j.gv,q=D._interactor.getStyle("connectGuideGarbageShift");Y.garbageInfo={x:C.getWidth()*q[0]+q[2],y:C.getHeight()*q[1]+q[3],size:D._interactor.getStyle("connectGuideGarbageIntersectsize")},j._42()}}},om.prototype._46O=function(W){var X,z,m=this,w=m.editing,I=m.target;if(w){if("connect"===w.mode&&!w.canceled&&!w.deleted)try{w.garbageInfo&&w.garbageInfo.hover?k.doDeleteConnectionAction(m._interactor.gv,I):k.doConnectAction(m._interactor.gv,I,w.target)}catch(E){console.error(E)}z=w.freezeFlag,X=m.editing.groupRotateMode,m._fireEditEvent("end",W),m.editing=null}m.tipInfo=null,m._inSmartGuide&&(m._interactor.rectGuide.clear(),m._inSmartGuide=!1),X&&I&&I.endRotate(),I instanceof l.Block&&(z===d?delete I._freezeSyncFromChildren:I._freezeSyncFromChildren=z,I.updateFromChildren())},om.prototype.handleNormalStateDelete=function(){var F=this,D=F.editing;if(D&&"connect"===D.mode&&!D.canceled&&!D.deleted){if(D.garbageInfo){try{k.doDeleteConnectionAction(F._interactor.gv,F.target)}catch(W){console.error(W)}D.garbageInfo=null}return D.cursorPos=null,D.targetCorners=null,D.deleted=!0,F._interactor._42(),!0}},om.prototype.handleNormalStateKeyDown=function(N){var U=this,j=U.editing;return!j||"connect"!==j.mode||j.canceled||j.deleted?void 0:l.Default.isEsc(N)?(j.cursorPos=null,j.targetCorners=null,j.canceled=!0,U._interactor._42(),!0):void 0
},om.prototype.handleEdit=function(H,o){var s=this,M=s.editing;if(M){var N,C,W,J,G,P=s.target,$=M.key,v=M.mode,t=H.lp(o),k=s._interactor;if("connect"===v){if(M.canceled)return;if(M.deleted)return;M.cursorPos=k._getLogicalPoint(o);var I=M.garbageInfo;return I&&tg.checkHit(M.cursorPos,I,I.size)?(I.hover=!0,M.target=null,M.targetCorners=null):(I&&(I.hover=!1),M.target=H.getDataAt(t,function($){return H.isSelectable($)?rn($)?!0:!1:!1})||null,M.targetCorners=tg.getTargetCornersOnScreen(H,M.target)),k._42(),void 0}if("rotate"===v){var b,D,K=M.pos,a=Math.atan2(t.y-K.y,t.x-K.x);if(M.groupRotateMode?D=a-M.hitRot:(b=a-M.hitRot,D=M.rotation+b),D%=2*Math.PI,0>D&&(D+=2*Math.PI),!l.Default.isCtrlDown(o)){var n,r;km(o)?(n=k.getStyle("shiftRotateRound"),r=n/2):(n=k.getStyle("rotateRound"),r=k.getStyle("rotateSensitivity")),D=tg.roundTo(D,n,r)}M.groupRotateMode?(b=D-(M.lastRotation||0),0!==b&&(P.addRotation(b,M.groupRotateMode),M.lastRotation=D)):P.setRotation(D),k._setRotateCursor(a),D>Math.PI&&(D-=2*Math.PI);var y=180*(D/Math.PI);y=y.toFixed(2),N=""+y+""}else if("resize"===v){var p=M.rect;W=p.x,J=p.y;var f,F=p.width,Q=p.height,X=M.anchor,u=M.matrix,V=P.s&&P.s("keepAspectRatio")||k.getStyle("keepAspectRatio");km(o)&&(V=!V);var e=s._unionPointMode1,S=s._unionPointMode2;if(s._inSmartGuide&&!l.Default.isCtrlDown(o)&&!V){var w;"L"===$||"R"===$?w="x":("T"===$||"B"===$)&&(w="y"),s._adsorbedToClosest(t,w),G=!0}f=u.tfi(t);var q;"LT"===$?(p=e(f,{x:W+F,y:J+Q},F,Q,V),q=9):"T"===$?(p=S({x:W,y:f.y},{x:W+F,y:J+Q},F,Q,V,"v"),q=1):"RT"===$?(p=e(f,{x:W,y:J+Q},F,Q,V),q=33):"L"===$?(p=S({x:f.x,y:J},{x:W+F,y:J+Q},F,Q,V,"h"),q=8):"R"===$?(p=S({x:W,y:J},{x:f.x,y:J+Q},F,Q,V,"h"),q=32):"LB"===$?(p=e(f,{x:W+F,y:J},F,Q,V),q=12):"B"===$?(p=S({x:W,y:J},{x:W+F,y:f.y},F,Q,V,"v"),q=4):"RB"===$&&(p=e(f,{x:W,y:J},F,Q,V),q=36);var i=u.tf(p.x+p.width*X.x,p.y+p.height*X.y);P instanceof l.Block&&(M.hasOwnProperty("freezeFlag")||(M.freezeFlag=P._freezeSyncFromChildren,P._freezeSyncFromChildren=!0)),P.setPosition(i),P.setSize(p.width,p.height),G&&(C=P.getRect(),k.rectGuide.gatherLines({node:P,x:C.x,y:C.y,w:C.width,h:C.height},w,q)),N=""+Math.round(p.width)+" * "+Math.round(p.height)}else if("line"===v){if(km(o)){var T=P.getPoints(),B="P1"===$?T.get(1):T.get(0),d={x:t.x-B.x,y:t.y-B.y},j=k.getStyle("shiftLineRotateRound"),U=s._shiftDirList;if(!U||s._shiftRotateRound!==j){s._shiftRotateRound=j,s._shiftDirList=U=[];for(var Y=0;Y<Math.PI;Y+=j)U.push({x:L(Y),y:O(Y)})}for(var E,x=0,z=0,_=U.length;_>z;z++){var g=U[z],c=g.x*d.x+g.y*d.y;Math.abs(c)>Math.abs(x)&&(x=c,E=g)}t={x:B.x+E.x*x,y:B.y+E.y*x},k.rectGuide.clear()}else s._inSmartGuide&&!l.Default.isCtrlDown(o)&&(s._adsorbedToClosest(t),G=!0);var R=tg.getDataMatrix(P).applyInverse(t);P.setPoint("P1"===$?0:1,R,!0);var A=P.getPoints(),m=A.get(0),Z=A.get(1);W=m.x-Z.x,J=m.y-Z.y,N=" "+Math.round(Math.sqrt(W*W+J*J))+" ",G&&(C=P.getRect(),k.rectGuide.gatherLines({node:P,x:C.x,y:C.y,w:C.width,h:C.height}))}if(N){var h=l.Default.getLogicalPoint(o,k._canvas);h.x+=tg.Icons.TipShiftX,h.y+=tg.Icons.TipShiftY,s.tipInfo={helperPos:h,text:N,size:N.length}}s._fireEditEvent("between",o)}},om.prototype._unionPointMode1=function(C,P,J,v,H){if(H&&J&&v){var B=C.x-P.x,I=C.y-P.y;Math.abs(B*v)<Math.abs(I*J)?(I=Math.sign(I)*Math.abs(B*v/J),C.y=P.y+I):(B=Math.sign(B)*Math.abs(I*J/v),C.x=P.x+B)}return l.Default.unionPoint(C,P)},om.prototype._unionPointMode2=function(E,x,j,t,A,Z){var I=l.Default.unionPoint(E,x);if(A&&j&&t){var b;"v"===Z?(b=I.x+I.width/2,I.width=j*I.height/t,I.x=b-I.width/2):(b=I.y+I.height/2,I.height=t*I.width/j,I.y=b-I.height/2)}return I},om.prototype._adsorbedToClosest=function(P,h){var N=this,x=N._interactor,n=x.rectGuide.findClosest(P,h),S=x.gridGuide.findClosest(P,h),j=1/0,w=1/0;n&&(isFinite(n.x)&&(j=n.x),isFinite(n.y)&&(w=n.y)),S&&(isFinite(S.x)&&Math.abs(S.x)<Math.abs(j)&&(j=S.x),isFinite(S.y)&&Math.abs(S.y)<Math.abs(w)&&(w=S.y)),isFinite(j)&&(P.x+=j),isFinite(w)&&(P.y+=w)},om.prototype._42=function(N,w,M){var i=this;i.info={},i.screenInfo=null;var Z=i._interactor;if(!Z.editDetail&&i.gatherInfo(w,M)){var U=i.editing,V=U?U.groupRotateMode:null,S=i.screenInfo;if("block"!==V){if(S.P1?tg.Icons.DrawIcon(Z,N,tg.Icons.Line,S):tg.Icons.DrawIcon(Z,N,tg.Icons.Rect,S),S.connect&&(tg.Icons.DrawIcon(Z,N,tg.Icons.ConnectGuide,{rotation:S.rotation,connect:S.connect,cursorPos:U?U.cursorPos:null}),U)){if(U.targetCorners){for(var j={x:1/0,y:1/0},L={x:-1/0,y:-1/0},t=0,H=U.targetCorners.length;H>t;t+=2)j.x=Math.min(j.x,U.targetCorners[t]),L.x=Math.max(L.x,U.targetCorners[t]),j.y=Math.min(j.y,U.targetCorners[t+1]),L.y=Math.max(L.y,U.targetCorners[t+1]);tg.Icons.DrawIcon(Z,N,tg.Icons.HoverDataRect,{min:j,max:L,color:Z.getStyle("hoverGuideColor")||Z.getStyle("baseColor")})}U.garbageInfo&&tg.Icons.DrawIcon(Z,N,tg.Icons.ConnectGuideGarbage,U.garbageInfo)}i.tipInfo&&tg.Icons.DrawIcon(Z,N,tg.Icons.TipHelper,i.tipInfo)}i.target instanceof tg.Group&&i.target._42(Z,N,w)}};var ip=tg.Anchor=function(O){this.catalog="Anchor",this._interactor=O};ip.prototype={},ip.prototype.constructor=ip,ip.prototype.gatherInfo=function(d,O){var j=this;if(1===O.length){var k=O[0];if(!k.getAnchor)return;if(k instanceof l.Shape&&k._70I())return;if(rk(k,d))return;return j.gatherSingleTarget(d,O[0])}return O.length>1?j.gatherMultiTargets(d,O):!1},ip.prototype.gatherSingleTarget=function(l,L){var z=this;return z.info.POS=L.getPosition(),z.screenInfo.POS=tg.toScreenPosition(l,z.info.POS),z.target=L,!0},ip.prototype.gatherMultiTargets=function(E,W){var u=this,C=tg.Group.findOrCreateGroup(W);return C?(u.screenInfo.POS=tg.toScreenPosition(E,C.getAnchor2()),u.target=C,!0):!1},ip.prototype.isVisible=function(){var J=this,k=J._interactor;if(k.getStyle("anchorVisible")===!1)return!1;var Y=J.target;if(Y){if(this.editing)return!0;var Q=Y.getAnchor(),y=k.getStyle("anchorOutsideVisibleThreshold");if(Q.x<-y||Q.x>1+y||Q.y<-y||Q.y>1+y)return!0;var p=Y.getSize(),M=Y.getScale(),U=Math.min(Math.abs(p.width*M.x),Math.abs(p.height*M.y));if(U*k.gv._zoom<k.getStyle("anchorHideThreshold"))return!1}return!0},ip.prototype.check=function(T,C,V){if(l.Default.isLeftButton(C)){var g=this,Q=g._interactor;if(g.isVisible()&&Q.getStyle("anchorMovable")!==!1){g.editing=null,g.tipInfo=null;var u=g.target;if(u&&T.isAnchorEditable(u)&&T.isEditable(u)){var k;if(g.screenInfo&&(k=g.screenInfo.POS)&&tg.checkHit(V,new tg.Math.Vector2(k),Q.getStyle("checkSize"))){if(u instanceof tg.Group)return g.editing={},!0;var G=u.getWidth(),J=u.getHeight(),A=u.getAnchor();return g.editing={rect:{x:-G*A.x,y:-J*A.y,width:G,height:J},anchor:A,matrix:u.getMatrix()},!0}}}}},ip.prototype.startEdit=function(p,$){p.startDragging($),p.fi({kind:"beginEditAnchor",event:$})},ip.prototype._46O=function(z){var P=this;P.editing&&(P.editing=null,P._interactor.fi({kind:"endEditAnchor",event:z})),P.tipInfo=null},ip.prototype.handleEdit=function(C,h){var H=this,I=H.target;if(I){var j=H.editing;if(j){var d=C.lp(h),n=H._interactor;if(I instanceof tg.Group)return I.setAnchor2(d),n._42(),void 0;var $=j.matrix,s=$.tfi(d),W=j.rect,b=(s.x-W.x)/W.width,Y=(s.y-W.y)/W.height;if(!l.Default.isCtrlDown(h)){var P=n.getStyle("anchorRound"),m=n.getStyle("anchorSensitivity");b=tg.roundTo(b,P,m),Y=tg.roundTo(Y,P,m)}I.setAnchor(b,Y,!0);var F=l.Default.getLogicalPoint(h,n._canvas);F.x+=tg.Icons.TipShiftX,F.y+=tg.Icons.TipShiftY;var z=""+b.toFixed(2)+", "+Y.toFixed(2);H.tipInfo={helperPos:F,text:z,size:z.length},n.fi({kind:"betweenEditAnchor",event:h})}}},ip.prototype._42=function(T,z,X){var $=this;$.info={},$.screenInfo={};var E=$._interactor;E.editDetail||$.gatherInfo(z,X)&&$.isVisible()&&(tg.Icons.DrawIcon(E,T,tg.Icons.Anchor,$.screenInfo),$.tipInfo&&tg.Icons.DrawIcon(E,T,tg.Icons.TipHelper,$.tipInfo))};var Xf=tg.MoveDummy=function(_){this.catalog="MoveDummy",this._interactor=_};Xf.prototype={},Xf.prototype.constructor=Xf,Xf.prototype.gatherInfo=function(){var W=this,i=this._interactor.getSubModule("Rect");if(i){var Q=i.screenInfo;if(Q){var r=W._interactor,B=W.getMovableTarget(i.target);if(B){var R=r.getStyle("moveDummyThreshold");if(R!==!1){var e=Q.LT||Q.P1,h=Q.RT||Q.P2,v=Q.LB||e;if(e){var m=Q.P1,L=Math.min(e.distanceTo(v),e.distanceTo(h));if(!(R!==!0&&L>R)){var w=r.getStyle("moveDummyPosition"),o=h.clone().sub(e),k=v.clone().sub(e),G=w[2],D=w[3];if(m){var $=r.getStyle("moveDummyLineExtraShift");$&&(G+=$[0],D+=$[1])}var O=e.clone().add(o.clone().multiplyScalar(w[0])).add(o.setLength(G)).add(k.clone().multiplyScalar(w[1])).add(k.setLength(D));return W.screenInfo.pos=O,W.screenInfo.size=r.getStyle("moveDummySensitivity"),!0}}}}}}},Xf.prototype.getMovableTarget=function(J){var l=this._interactor.gv;if(rn(J)){if(l.isMovable(J))return J}else if(J instanceof tg.Group)for(var T=J._entities,f=T.length-1;f>=0;f--){var u=T[f];if(rn(u)&&l.isMovable(u))return u}return null},Xf.prototype.getMoveInteractor=function(){for(var G,y,A,L=this._interactor.gv,m=L.getInteractors(),G=0,y=m.length;y>G;G++)if(A=m.get(G),A instanceof Mh)return A},Xf.prototype.startEdit=function(L,j){L.startDragging(j);var F=this.getMoveInteractor();if(F){var A=this.selectedTarget,H=L.gv;H._moving=1,F._data=A,H.handleMouseDown&&H.handleMouseDown(j,A)}},Xf.prototype._46O=function(C){var H=this,n=H.getMoveInteractor();n&&(n.handleWindowMouseUp(C),H.selectedTarget=null)},Xf.prototype.handleEdit=function(N,l){var c=this.getMoveInteractor();c&&c.handleWindowMouseMove(l)},Xf.prototype.check=function(W,U,F){if(this.selectedTarget=null,l.Default.isLeftButton(U)&&!W._scrolling&&!Af()){var j=this;if(j.screenInfo){var O=j.screenInfo.pos;if(O&&!(F.distanceTo(O)>j.screenInfo.size)){var y=j._interactor;return j.selectedTarget=j.getMovableTarget(y.getSubModule("Rect").target),y.setCursor("default"),!0}}}},Xf.prototype._42=function(z,y,l){var Q=this;Q.screenInfo={};var I=Q._interactor;I.editDetail||Q.gatherInfo(y,l)&&(!I.editing||Q.selectedTarget)&&tg.Icons.DrawIcon(I,z,tg.Icons.MoveDummy,Q.screenInfo)};var lg=tg.RotateX=function(N){this.catalog="RotateX",this._interactor=N};lg.prototype={},lg.prototype.constructor=lg,lg.prototype.gatherInfo=function(w,z){var L=this;if(1===z.length){var b=z[0];return b instanceof l.Shape&&b._70I()||rk(b,w)?!1:L.gatherSingleTarget(w,b)}return z.length>1?L.gatherMultiTargets(w,z):!1},lg.prototype.gatherSingleTarget=function(){var _=new l.Math.Vector2,Q=new l.Math.Vector2,q=new l.Math.Vector2,e=new l.Math.Vector2,u=function(o,P){var g=o.x-P.x,q=o.y-P.y;return g*g+q*q};return function(s,K){if(K.getCorners){var k=this,Y=K.getCorners(),W=15,o=K.getPosition();_.copy(Y[0]),q.copy(Y[1]),e.copy(Y[3]),Q.copy(_).add(e).divideScalar(2).add(_.sub(q).setLength(W/s.getZoom()));var c=Math.max(u(o,Y[0]),u(o,Y[1]),u(o,Y[2]),u(o,Y[3]));return k.info.POS=Q.clone(),k.screenInfo.POS=tg.toScreenPosition(s,k.info.POS),k.screenInfo.LEN=Math.sqrt(c)*s.getZoom()+W,k.screenInfo.CENTER=tg.toScreenPosition(s,o),k.target=K,!0}}}(),lg.prototype.gatherMultiTargets=function(p,y){var P=this,M=tg.Group.findOrCreateGroup(y);if(!M)return!1;var P=this;return P.gatherSingleTarget(p,M)},lg.prototype.isVisible=function(){var $=this._interactor;if(!$.getStyle("rotateAsClock"))return!1;var D=this.target;if(!D)return!0;var c=$.gv;return c.isEditable(D)&&c.isRotationEditable(D)?!0:!1},lg.prototype.check=function(o,g,K){var b=this,t=b._checkImpl(o,g,K);return(t||b._clockPainted)&&b._interactor._42(),t},lg.prototype._checkImpl=function(o,j,z){if(l.Default.isLeftButton(j)){var q=this;q.editing=null,q.tipInfo=null;var r;if(q.screenInfo&&(r=q.screenInfo.POS)&&q.isVisible()){var I=q._interactor;if(tg.checkHit(z,r,I.getStyle("checkSize"))){var C=q.target,Q=o.lp(j),x=C.getPosition(),t=Math.atan2(Q.y-x.y,Q.x-x.x);return I._setRotateCursor(t),q.editing={pos:x,rotation:C.getRotation(),hitRot:t,groupRotateMode:"block",screenInfo:{CENTER:q.screenInfo.CENTER,LEN:q.screenInfo.LEN}},!0}}}},lg.prototype.startEdit=function(M,w){M.startDragging(w),M.fi({kind:"beginEditRotation",event:w}),this.target instanceof tg.Group&&this.target.beginRotate(this.editing)},lg.prototype._46O=function(N){var b=this;b.editing&&(b.editing=null,b._interactor.fi({kind:"endEditRotation",event:N})),b.target instanceof tg.Group&&b.target.endRotate(),b.tipInfo=null},lg.prototype.handleEdit=function(B,b){var H=this,F=H.editing;if(F){var c,v,Y=H.target,V=B.lp(b),i=H._interactor,s=F.pos,R=Math.atan2(V.y-s.y,V.x-s.x),J=Y instanceof tg.Group;if(J?v=R-F.hitRot:(c=R-F.hitRot,v=F.rotation+c),v%=2*Math.PI,0>v&&(v+=2*Math.PI),!l.Default.isCtrlDown(b)){var G,n;km(b)?(G=i.getStyle("shiftRotateRound"),n=G/2):(G=i.getStyle("rotateRound"),n=i.getStyle("rotateSensitivity")),v=tg.roundTo(v,G,n)}J?(c=v-(F.lastRotation||0),0!==c&&(Y.addRotation(c,F.groupRotateMode),F.lastRotation=v)):Y.setRotation(v),i._setRotateCursor(R),v>Math.PI&&(v-=2*Math.PI);var r=180*(v/Math.PI),A=""+r.toFixed(2)+"",I=l.Default.getLogicalPoint(b,i._canvas);I.x+=tg.Icons.TipShiftX,I.y+=tg.Icons.TipShiftY,H.tipInfo={helperPos:I,text:A,size:A.length},i.fi({kind:"betweenEditRotation",event:b})}},lg.prototype._42=function(E,N,x){var o=this;o._clockPainted=!1,o.info={},o.screenInfo={};var q=o._interactor;q.editDetail||o.gatherInfo(N,x)&&o.isVisible()&&(tg.Icons.DrawIcon(q,E,tg.Icons.RoundPoint,o.screenInfo.POS),o.tipInfo&&tg.Icons.DrawIcon(q,E,tg.Icons.TipHelper,o.tipInfo),o.editing&&o.drawClock(E))},lg.prototype.drawClock=function(C){C.save();var $=this;$._clockPainted=!0;var j=$.editing||{},e=j.screenInfo||$.screenInfo,r=e.LEN,E=r+8,_=r+18;C.save(),C.translate(e.CENTER.x,e.CENTER.y),C.beginPath(),C.strokeStyle="rgb(150, 150, 150)";for(var J,k,T,H,U,s=0;360>s;s++)J=s*Math.PI/180,0===s%5&&(k=O(J)*r,T=L(J)*r,H=O(J)*E,U=L(J)*E,C.moveTo(k,T),C.lineTo(H,U)),0===s%45&&(k=O(J)*r,T=L(J)*r,H=O(J)*_,U=L(J)*_,C.moveTo(k,T),C.lineTo(H,U));C.stroke(),C.rotate(-X);var c=j.lastRotation||$.target.getRotation();C.beginPath(),C.fillStyle="rgba(255, 0, 0, 0.1)",C.strokeStyle="rgb(157, 157, 157)",C.moveTo(0,0),C.arc(0,0,_,0,c,!1),C.fill(),C.beginPath(),C.moveTo(0+_,0),C.arc(0,0,_,0,c,!1),C.stroke(),C.restore()};var Sq=tg.Curve=function(s){this.catalog="Curve",this._interactor=s};Sq.prototype={},Sq.prototype.constructor=Sq,e.defineProperties(Sq.prototype,{activing:{get:function(){return this._activing},set:function(H){var m=this;if(H)m._activing=new tg.CurveActiving(this,H);else{var C=m._activing;C&&C.dispose(),m._activing=null}}}}),Sq.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Sq.prototype.setUp=function(){var p=this,s=p._interactor;s&&s.gv.mp(p._onGraphviewPropertyChanged,p)},Sq.prototype._onGraphviewPropertyChanged=function(f){("zoom"===f.property||"translateX"===f.property||"translateY"===f.property)&&this._handleDataChanged()},Sq.prototype.tearDown=function(){var Y=this,G=Y._interactor;G&&G.gv.ump(Y._onGraphviewPropertyChanged,Y)},Sq.prototype.canEnterEditDetailMode=function(){var R=this,Y=R._interactor,H=Y._getValidSelection();if(1===H.length){var y=H[0],K=y instanceof l.Edge;if(y instanceof l.Shape||K){if(K){var C=y.s("edge.type");if(C&&"points"!==C)return}var c=Y.gv;if(c.isPointEditable(y)&&c.isEditable(y))return R.target=y,!0}}},Sq.prototype.canQuitEditDetailMode=function(E){var O=this,j=O._interactor._getLogicalPoint(E);return O._checkEditRealPoint(j)?void 0:O._interactor.gv.getDataAt(E)!==O.target?!0:void 0},Sq.prototype.preHandleScroll=function(){var v=this.editing;return v&&v.inEdit?!0:void 0},Sq.prototype.getCurrentSelectintStatus=function(){var z=this;if(z.activing&&!z.activing.selections){if(z.activing.status!=d)return z.activing.status;var R=function(y){var D=z.activing.status;z.activing.status=y,z._interactor.fp("shapePointStatus",D,y)},r=tg.Curve.PointType,y=z.activing.point,Y=z.activing.pairs;if(!Y||1!==Y.length)return R(r.Mirrored);var e=Y[0],J=e.c1&&e.c1.isNearEnough(y),U=e.c2&&e.c2.isNearEnough(y);if(!e.c1||!e.c2)return J||U?R(r.Straight):R(r.Disconnected);if(J&&U)return R(r.Straight);if(J||U)return R(r.Asymmetric);var o=e.c1.clone().sub(y),f=e.c2.clone().sub(y);return Math.abs(o.x*f.y-o.y*f.x)>1e-5||o.x*f.x>0?R(r.Disconnected):Math.abs(o.length()-f.length())>1e-5?R(r.Asymmetric):R(r.Mirrored)}},Sq.prototype.handle_keydown=function(s){var L=this;if(L._interactor.editDetail){var u=tg.Curve.PointType;"1"===s.key?L._setCurrentSelectionStatus(u.Straight):"2"===s.key?L._setCurrentSelectionStatus(u.Mirrored):"3"===s.key?L._setCurrentSelectionStatus(u.Disconnected):"4"===s.key&&L._setCurrentSelectionStatus(u.Asymmetric)}},Sq.prototype.setCurrentSelectionStatus=function(D){var w=this,u=w._interactor;if(u){var V=u.gv;V.dm().beginTransaction(),this._setCurrentSelectionStatus(D),V.dm().endTransaction()}},Sq.prototype._setCurrentSelectionStatus=function(b){var q=this,n=q.activing;if(n){var Q=q.getCurrentSelectintStatus();if(null!==Q&&Q!==b){n.status=b;var E=q.activing.point,i=q.activing.pairs;if(i&&1===i.length){var t=i[0],P=q.screenInfo.curve,c=tg.Curve.PointType,e=function(){q._writeToHt(),q._interactor.fp("shapePointStatus",Q,b)};if(b===c.Straight)return P.moveCtrlPoint(t,E,"c1"),P.moveCtrlPoint(t,E,"c2"),e(),void 0;if(Q===c.Straight){var T=P.findPairs(E,!0),d=T[0],M=d.r1||E,H=d.r2||E,A=H.clone().sub(M).multiplyScalar(.25);return P.moveCtrlPoint(t,E.clone().sub(A),"c1"),P.moveCtrlPoint(t,E.clone().add(A),"c2"),e(),void 0}var D=t.c1,m=t.c2;if(D&&m){if(b===c.Mirrored)return P.moveCtrlPoint(t,E.clone().multiplyScalar(2).sub(m),"c1"),e(),void 0;if(b===c.Asymmetric&&Q===c.Disconnected){var l=D.clone().sub(E).length(),A=E.clone().sub(m).setLength(l).add(E);return P.moveCtrlPoint(t,A,"c1"),e(),void 0}}n._firePointChange(),q._interactor.fp("shapePointStatus",Q,b)}}}},Sq.prototype._handleDataChanged=function(){var F="points,segments,shape,position,rotation,scale".split(",");return function(Y){var j=this;if(j.screenInfo&&j.target){if(Y&&F.indexOf(Y.property)<0)return;var G=j._interactor;j.gatherSingleTarget(G.gv,j.target,!0),j.check(G.gv,null,new tg.Math.Vector2(G._lastClientPoint)),G._42()}}}(),Sq.prototype.gatherSingleTarget=function(D,A,z){var H,C,L=this;L.screenInfo&&L.screenInfo.curve&&(C=L.screenInfo.curve._curves);var w=L.editing;H=w?L.screenInfo:L.screenInfo={};var v,c,a=A instanceof l.Edge;a?(v=A.s("edge.segments"),c=A.s("edge.points")||new l.List):(v=A._58O,c=A._59O),H.S=v;var M,h=H.P=[],J=tg.getDataMatrix(A);if(A instanceof l.Polyline)M=A.getElevation()||0,H.E=[];else{var o=!1;c.each(function(c){c.e!==d&&(o=!0)}),o&&(H.E=[])}if(c.each(function(V){H.E&&H.E.push(V.e||M),V=J.apply(V);var S=tg.toScreenPosition(D,V);h.push(S.x,S.y)}),a){var O=h.length,q=tg.toScreenPosition(D,A._lastSourcePoint||(O?{x:h[0],y:h[1]}:{x:0,y:0})),N=tg.toScreenPosition(D,A._lastTargetPoint||(O?{x:h[O-2],y:h[O-1]}:{x:0,y:0}));h.splice(0,0,q.x,q.y),h.push(N.x,N.y),H.E&&(H.E.splice(0,0,d),H.E.push(d))}if(!H.S||!H.S.size()){H.S=new l.List,H.S.add(1);for(var u=0;u<h.length/2-1;u++)H.S.add(2)}if((!w||z)&&L.convertToCubicBezier(C),L.activing&&(z||!L.editing||"realPoint"===L.editing.type)){var $=H.curve.findPairs(L.activing.point);L.activing.pairs=$}a&&"points"!==A.s("edge.type")&&L._writeToHt()},Sq.prototype._convertToNewPoint=function(G,b,p,o){var Y,$,_;for(Y=0,$=b.length;$>Y;Y++){if(_=b[Y],_._p1.isNearEnough(G)&&(!o||o.indexOf(_._p1)<0))return _._p1;if(_._p4.isNearEnough(G)&&(!o||o.indexOf(_._p4)<0))return _._p4}if(p)for(Y=0,$=Math.min(p.length,$);$>Y;Y++){if(_=p[Y],_._p1===G&&(!o||o.indexOf(b[Y]._p1)<0))return b[Y]._p1;if(_._p4===G&&(!o||o.indexOf(b[Y]._p4)<0))return b[Y]._p4}},Sq.prototype.convertToCubicBezier=function(e){var N,l,O=this,t=new tg.Math.Curve,E=O.screenInfo;if(t.createFromHtShape(E.P,E.S,E.E),E.curve=t,O.activing){var X=t._curves;N=O.activing.point,l=O._convertToNewPoint(N,X,e);var A=[];if(l&&(O.activing.point=l,A.push(l)),O.activing.selections){var F=-1,T=O.activing.selections;T.forEach(function(W){F++,l=O._convertToNewPoint(W,X,e,A),l&&(T[F]=l,A.push(l))})}}},Sq.prototype.check=function(I,Z,y){if(!Z||ee(Z)||im(Z)){var s=this;if(s._interactor.setCursor("default"),s.editing=null,s.highlight=null,s.tipInfo=null,s.edgeEditResult=null,s.screenInfo){if(Af()||im(Z))return s._interactor._42(),!0;if(s._checkEditCtrlPoint(y))return s._interactor._42(),!0;if(s._checkEditRealPoint(y))return s._interactor._42(),!0;if(s._checkEditElevation(y))return s._interactor._42(),!0;var B=s.screenInfo.curve,F=B.checkPoint(y,s._interactor.getStyle("curveIntersectSize"));if(F){var j=s.highlight={};j.type="insertKnot",j.bezier=F.bezier,j.point=F.intersection}return s._interactor._42(),!0}}},Sq.prototype._checkEditRealPoint=function(V){var b,g,U,$,H,X,x=this,m=x.screenInfo.curve._curves,P=x._interactor.getStyle("curvePointIntersectSize"),Y=1/0;for(P*=P,U=0,$=m.length;$>U;U++)b=m[U],H=b._p1,X=V.distanceToSquared(H),Y>X&&(Y=X,g=H),H=b._p4,X=V.distanceToSquared(H),Y>X&&(Y=X,g=H);if(Y>P)return!1;var o=x.highlight={};return o.type="changeRealPoint",o.point=g,x.editing={type:"realPoint",point:g,shiftGuide:{point:g.clone(),dir:"x",limit:0}},x._interactor.setCursor("crosshair"),!0},Sq.prototype._checkEditElevation=function(j){var r=this;if(!r._interactor.getStyle("curveElevationVisible"))return!1;var $=r.activing;if(!$)return!1;var v=$.getCurrentEditingPoint();if(!v)return!1;var K=r._interactor,B=K.getStyle("curveElevationGuideShift"),d=K.getStyle("curveElevationIntersectSize"),I=j.distanceToSquared({x:v.x+B[0],y:v.y+B[1]});if(!(I>d*d)){var s=r.highlight={};s.type="elevation";var x=new tg.Math.Vector2(j.x,j.y,v.e);return r.editing={type:"elevation",startPoint:x},r._interactor.setCursor("crosshair"),!0}},Sq.prototype._checkEditCtrlPoint=function(A){var g=this;if(g.activing&&!g.activing.selections){var m=g.getCurrentSelectintStatus();if(m!==tg.Curve.PointType.Straight){var a=g.activing.pairs;if(a){var J=g._interactor.getStyle("curvePointIntersectSize");J*=J;var S,Q,W,w,D,E,X,N,O,l=1/0;for(X=0,O=a.length;O>X;X++)for(w=a[X],N=0;2>N;N++)D=0===N?"c1":"c2",w[D]&&(E=A.distanceToSquared(w[D]),l>E&&(l=E,S=w,Q=X,W=D));if(l>J)return!1;g.activing.hlpair=S,g.activing.hltype=W;var Y=g.highlight={};return Y.type="changeCtrlPoint",Y.point=S[W],g.editing={type:"ctrlPoint",pair:S,pairId:Q,ctrlType:W,direction:S[W].clone().sub(g.activing.point).normalize()},g._interactor.setCursor("crosshair"),!0}}}},Sq.prototype.startEdit=function(G,c){G.startDragging(c);var q=this;q.highlight&&"insertKnot"===q.highlight.type&&(q.insertKnot(),q.gatherSingleTarget(q._interactor.gv,q.target),q.activing=null,q._checkEditRealPoint(q._interactor._getLogicalPoint(c)));var p=q._activing;if(p){var b=q.editing?q.editing.type:null;"ctrlPoint"===b?p.editingCtrl={pairId:q.editing.pairId,type:p.hltype}:"realPoint"===b&&(p.editingCtrl=!1)}var D=q.highlight,w=l.Default.isCtrlDown(c);if(!D||Af()||im(c)){var h=q._interactor.gv;if(!h.setFocus(c)||h._scrolling)return;return w?q._multiSelect={startPoint:h.lp(c)}:h.isPannable()&&(ee(c)||im(c))&&(q._pan={tx:h.tx(),ty:h.ty()},G.fi({kind:"beginPan",event:c})),void 0}if("changeRealPoint"===D.type){var s,E=q.activing?q.activing.point:null,U=q.activing?q.activing.selections:null;if(w&&q.activing)E===D.point?(U?(q.activing={point:U[0]},U.length>1&&(U.splice(0,1),q.activing.selections=U)):q.activing=null,q.editing=null):U&&(s=U.indexOf(D.point))>=0?(U.length>1?U.splice(s,1):delete q.activing.selections,q.editing=null):U?(U.push(E),q.activing={point:D.point,selections:U}):q.activing={point:D.point,selections:[E]};else if(U)E===D.point||((s=U.indexOf(D.point))>=0?(U.splice(s,1,E),q.activing={point:D.point,selections:U}):q.activing={point:D.point});else{var Q;E===D.point&&(Q=q.activing.status),q.activing={point:D.point},Q&&(q.activing.status=Q)}G.fi({kind:"beginEditPoint",event:c})}},Sq.prototype.insertKnot=function(){var Q=this,V=Q.highlight,p=Q.screenInfo.curve;p.insertKnot(V.bezier,V.point.t),Q._writeToHt()},Sq.prototype._writeToHt=function(){var D,a,v,J,q=this,X=q.screenInfo.curve,N=X.toHtShape(),H=N.points,u=[],_=N.segments,O=q._interactor.gv,Q=q.target,p=Q instanceof l.Edge,K=tg.getDataMatrix(Q).invert();J=Q instanceof l.Polyline,J&&(v=Q.getElevation());for(var F=0,z=H.length;z>F;F++)D=H[F],a=tg.toWorldPosition(O,D),a=K.apply(a),D.e!=d&&D.e!==v&&(a.e=D.e),u.push(a);if(Q._writing=!0,p){Q.s("edge.type","points"),Q.setStyle("edge.segments",_),Q.setStyle("edge.points",u.slice(1,u.length-1)),Q.setStyle("edge.source.offset.x",0),Q.setStyle("edge.source.offset.y",0),Q.setStyle("edge.target.offset.x",0),Q.setStyle("edge.target.offset.y",0);var P=q._nextChangeEdgeHost;delete q._nextChangeEdgeHost,P&&("source"===P.type?Q.setSource(P.host):Q.setTarget(P.host)),q._writeEdgeHostAnchor("source",u[0]),q._writeEdgeHostAnchor("target",u[u.length-1])}else u.length?(Q.setSegments(_),Q.setPoints(u,!0)):Q.removeFromDataModel();delete Q._writing},Sq.prototype._writeEdgeHostAnchor=function(l,C){var K=this,f=K.target,D=K._calcHostAnchor(f,l,C);D.index!==d?(f.setStyle("edge."+l+".index",D.index),f.setStyle("edge."+l+".percent",d),f.setStyle("edge."+l+".anchor.x",d),f.setStyle("edge."+l+".anchor.y",d)):D.percent!==d?(f.setStyle("edge."+l+".percent",D.percent),f.setStyle("edge."+l+".index",d),f.setStyle("edge."+l+".anchor.x",d),f.setStyle("edge."+l+".anchor.y",d)):(f.s("edge."+l+".anchor.x",D.x),f.s("edge."+l+".anchor.y",D.y),D.offsetX||D.offsetY?(f.s("edge."+l+".offset.x",D.offsetX),f.s("edge."+l+".offset.y",D.offsetY)):(f.s("edge."+l+".offset.x",0),f.s("edge."+l+".offset.y",0)))},Sq.prototype._calcHostAnchor=function(E,G,y,f){f||(f="source"===G?E.getSource():E.getTarget());var J=this._interactor.gv,w=J.calculateAttachPoint(f,y);if(w)return w.info;if(jo(f)){var q=J.calculateEdgePosition(f,y);return q}var o=f.getRotation(),N=f.getAnchor();rk(f,J)&&(o=0);var x=f.getScale();if(o||x.x<0||x.y<0){var W=f.getMatrix(),U=W.tfi(y),B=f.getSize();return{x:U.x/B.width+N.x,y:U.y/B.height+N.y}}var C=Ui(J,f),e={x:(y.x-C.x)/C.width,y:(y.y-C.y)/C.height};return e},Sq.prototype._handlePanning=function(M){var T=this,k=T._pan;if(k){k.started=!0;var X=T._interactor,c=X.gv,u=X._lastClientPoint,I=xl(M),Z=Ge(c,I,u);c.setTranslate(k.tx+Z.x,k.ty+Z.y),T.gatherSingleTarget(X.gv,T.target),X._42(),X.fi({kind:"betweenPan",event:M})}},Sq.prototype.handleEdit=function(F,z){var $=this,K=$.editing;if($._pan)return $._handlePanning(z),void 0;if($._multiSelect)return $._multiSelect.endPoint=F.lp(z),$._interactor.redraw(),void 0;if(K){K.inEdit=!0;var x,T,y,G=$._interactor._getLogicalPoint(z),N=l.Default.isCtrlDown(z),f=l.Default.isShiftDown(z),V=K.type,D=$.activing;if($._guideInfo=null,"ctrlPoint"===V&&f){var U=$.editing.direction.clone();x=D.point;var e=U.dot(G.clone().sub(x));G=U.setLength(e).add(x)}else if("ctrlPoint"===V||"realPoint"===V){var U;if("realPoint"===V&&f){var E=$.editing.shiftGuide;T=E.point;var M=Math.abs(G.x-T.x),c=Math.abs(G.y-T.y);M>c&&M>E.limit&&"y"===E.dir&&(E.dir="x"),c>M&&c>E.limit&&"x"===E.dir&&(E.dir="y"),U=E.dir,"x"===U?(G.y=T.y,E.limit=Math.max(E.limit,M)):"y"===U&&(G.x=T.x,E.limit=Math.max(E.limit,c))}var J=$._isEditEdgeSourceTarget();if(J){var k=$._editEdgeSourceTarget(J,G,N);k&&($.edgeEditResult=k,y=k.tipText)}else if(!N){var w=$._guidingToEdit(G,U),v="realPoint"===V?$._interactor.gridGuide.findClosest(G,U,!0):null,i=1/0,A=1/0;v&&(v.x&&(i=v.x),v.y&&(A=v.y));var b=!1;w&&(w.xList&&(Math.abs(w.x)<=Math.abs(i)?(b=!0,i=w.x):delete w.xList),w.yList&&(Math.abs(w.y)<=Math.abs(A)?(b=!0,A=w.y):delete w.yList),b&&($._guideInfo=w)),isFinite(i)&&(G.x+=i),isFinite(A)&&(G.y+=A),b&&(w.v=G)}}var H=$.screenInfo.curve;if("realPoint"===K.type){x=K.point,x.e!==d&&(G.e=x.e),H.moveRealPoint(x,G),K.point=G,$.highlight.point=G;var j=D.status,t=D.selections;if($.activing={point:G,status:j},t){var _=G.clone().sub(x),p=0;t.forEach(function(q){var P=q.clone().add(_);H.moveRealPoint(q,P),t[p++]=P}),$.activing.selections=t}}else if("ctrlPoint"===K.type){var h=D.pairs,o=h[K.pairId];H.moveCtrlPoint(o,G,K.ctrlType);var Y=D.status,P=tg.Curve.PointType;if((Y===P.Mirrored||Y===P.Asymmetric)&&o.c1&&o.c2){var x=new tg.Math.Vector2(D.point),X="c1"===K.ctrlType?"c2":"c1";if(Y===tg.Curve.PointType.Mirrored)H.moveCtrlPoint(o,x.clone().multiplyScalar(2).sub(G),X);else if(Y===P.Asymmetric){var e=o[X].clone().sub(x).length(),s=x.clone().sub(o[K.ctrlType]).setLength(e).add(x);isNaN(s.x)||H.moveCtrlPoint(o,s,X)}}D._firePointChange()}else if("elevation"===K.type){T=K.startPoint;var Q=T.e+(T.y-G.y)/F._zoom;$._setCurrentPointImpl("e",Q),D._firePointChange(),y="E: "+tg.toFixed(Q)}var L=l.Default.getLogicalPoint(z,$._interactor._canvas);if(L.x+=tg.Icons.TipShiftX,L.y+=tg.Icons.TipShiftY,!y){var R=tg.toWorldPosition(F,G);y=""+tg.toFixed(R.x)+", "+tg.toFixed(R.y)}$.tipInfo={helperPos:L,text:y,size:y.length},$._writeToHt(),$._interactor.fi({kind:"betweenEditPoint",event:z})}},Sq.prototype._setCurrentPointImpl=function(_,W){var m=this,i=m._activing;if(!i)return!1;var X=m.target;if(!X)return!1;var J=i.getCurrentEditingPoint();if(!J)return!1;var e=i.editingCtrl;if(!e)var S=J.clone();if("e"===_)J.e=W;else{var p;if("x"===_||"y"===_){var T=i._lastFirePoint;p="x"===_?{x:W,y:T?T.y:0}:{x:T?T.x:0,y:W}}else"object"==typeof _?(p=_,_.e!==d&&(J.e=_.e)):(p={x:arguments[0],y:arguments[1]},arguments[2]!==d&&(J.e=arguments[2]));var j=tg.getDataMatrix(X);p=tg.toScreenPosition(m._interactor.gv,j.apply(p)),J.x=p.x,J.y=p.y}if(!e){var F=S.multiplyScalar(-1).add(J);J.e&&S.e&&(F.e=J.e-S.e),m.screenInfo.curve.moveCtrlDueToRealPointMovement(J,F)}return!0},Sq.prototype.setCurrentPoint=function(C,H){return this._setCurrentPointImpl(C,H)?(this._writeToHt(),!0):!1},Sq.prototype._isEditEdgeSourceTarget=function(){var z=this,u=z.target;if(!(u instanceof l.Edge))return!1;var U=z.editing.point,f=z.screenInfo.curve._curves;return U===f[0]._p1?"source":U===f[f.length-1]._p4?"target":!1},Sq.prototype._editEdgeSourceTarget=function(G,y,H){var N,w=this,i=w.target;if(N="source"===G?i.getSource():i.getTarget()){var k,Q=w._interactor.gv,u=tg.toWorldPosition(Q,y),q=w._calcHostAnchor(i,G,u,N);if(k=q.index!==d||q.percent!==d?q.distance*Q.getZoom()>w._interactor.getStyle("edgeHostEdgeMaxDistance"):w._interactor.getStyle("edgeHostDetectPerFrame")?!0:q.x<0||q.x>1||q.y<0||q.y>1?!0:!1){var _=Q.getDataAt(u,function(l){return Q.isSelectable(l)?Q.isSourceTargetEditable(i,l,G)?i.canSetSourceTarget(l,G)?!0:!1:!1:!1});if(_){var g=w._calcHostAnchor(i,G,u,_);N=_,w._nextChangeEdgeHost={type:G,host:_},q=g}}var A,D,I;if(H||q.x===d)(q.percent!==d||q.index!==d)&&(D=q.point);else{var B=w._interactor.getStyle("anchorRound"),n=w._interactor.getStyle("anchorSensitivity");A=Q.calculateAttachPoint(N,u),A?q=A.info:(q.x=tg.roundTo(q.x,B,n),q.y=tg.roundTo(q.y,B,n)),D=Ao(Q,N,0,q.offsetX||0,q.offsetY||0,q.x,q.y)}D&&(I=tg.toScreenPosition(Q,D),y.x=I.x,y.y=I.y),w._edgeHostGuideInfo={corners:tg.getTargetCornersOnScreen(Q,N),attach:A?A.index:-1,host:N};var j;return q.percent!==d?j="percent: "+q.percent.toFixed(2):q.index!==d?j="index: "+q.index:(j=""+q.x.toFixed(2)+", "+q.y.toFixed(2),(q.offsetX||q.offsetY)&&(j+=" offset: "+q.offsetX.toFixed(2)+", "+q.offsetY.toFixed(2))),{host:N,anchor:q,tipText:j}}},Sq.prototype._guidingToEdit=function(Q,J){var Y,N,K=this;if(Y=K.screenInfo.curve){N=Y._curves;var f,U,r,B,V,q,m,t,k=1/0,c=1/0,v=[];for(K.editing&&"realPoint"===K.editing.type&&(t=K.editing.point),V=0,q=2*N.length;q>V;V++)m=N[Math.floor(V/2)][V%2?"_p4":"_p1"],v.indexOf(m)>=0||(v.push(m),t&&t===m||(r=m.x-Q.x,B=m.y-Q.y,Math.abs(r)<Math.abs(k)?(k=r,f=[m]):r===k&&f.push(m),Math.abs(B)<Math.abs(c)?(c=B,U=[m]):B===c&&U.push(m)));var o=K._interactor.getStyle("smartGuideThreshold");if((Math.abs(k)>o||"y"===J)&&(f=null),(Math.abs(c)>o||"x"===J)&&(U=null),f||U){var S=!1,M={};if(f&&(S=!0,M.xList=f,M.x=k),U&&(S=!0,M.yList=U,M.y=c),S)return M}}},Sq.prototype._46O=function(I){var h=this;h.editing&&(h.editing=null,h._interactor.fi({kind:"endEditPoint",event:I})),h._guideInfo=null,h._edgeHostGuideInfo=null,h._pan&&(h._pan=null,h._interactor.fi({kind:"endPan",event:I})),h._multiSelect&&(h._handleMultiSelect(h._multiSelect),h._multiSelect=null),h.tipInfo=null,h.edgeEditResult=null},Sq.prototype._handleMultiSelect=function(t){if(t.startPoint&&t.endPoint){var C,D,V,k,P,O=this,p=O._interactor,Q=p.gv,N=tg.toScreenPosition(Q,t.startPoint),L=tg.toScreenPosition(Q,t.endPoint),J=l.Default.unionPoint(N,L),o=O.screenInfo.curve._curves,A=[],Z=function(X){X.x>=J.x&&X.y>=J.y&&X.x<=J.x+J.width&&X.y<=J.y+J.height&&A.indexOf(X)<0&&A.push(X)
};for(C=0,D=o.length;D>C;C++)P=o[C],Z(P._p1),Z(P._p4);if(A.length){var G=O.activing||{},F=G.selections||[];for(G.point&&F.push(G.point),C=0,D=F.length;D>C;C++)V=F[C],k=A.indexOf(V),k>=0?A[k]=d:A.push(V);var y=A;for(A=[],C=0,D=y.length;D>C;C++)y[C]&&A.push(y[C]);D=A.length,0===D?O.activing=null:1===D?O.activing={point:A[0]}:(V=A[D-1],O.activing={point:V,selections:A.splice(0,D-1)}),p.redraw()}}},Sq.prototype._canDeletePoint=function(N,V){var r=this.target;if(!(r instanceof l.Edge))return!0;var Z=N._curves[0],d=N._curves[N._curves.length-1];return Z._p1===V||d._p4===V?!1:!0},Sq.prototype.handleDelete=function(){var C=this;if(C.activing&&C.screenInfo){var J=l.Default.isShiftDown(),N=C.screenInfo.curve;C._canDeletePoint(N,C.activing.point)&&N.deleteRealPoint(C.activing.point,J),C.activing.selections&&C.activing.selections.forEach(function(I){C._canDeletePoint(N,I)&&N.deleteRealPoint(I,J)}),C.activing=null,delete C.editing,delete C.tipInfo,delete C.edgeEditResult,delete C._pan,delete C._multiSelect,C._writeToHt(),C._interactor.fp("deleteShapePoint",!1,!0)}},Sq.prototype.handleDoubleClick=function(H){var C=this,U=C._interactor._getLogicalPoint(H);if(C.screenInfo&&C._checkEditRealPoint(U)){var r=C.getCurrentSelectintStatus(),S=tg.Curve.PointType;return r=r===S.Mirrored?S.Straight:S.Mirrored,C._setCurrentSelectionStatus(r),C._interactor._42(),!0}},Sq.prototype._drawHighlight=function(X){var p=this,M=p.highlight;if(M){var D=M.bezier,m=p._interactor;D&&tg.Icons.DrawIcon(m,X,tg.Icons.ShapeHighlightCurve,[D._p1.x,D._p1.y,D._p2.x,D._p2.y,D._p3.x,D._p3.y,D._p4.x,D._p4.y]);var O=M.point;O&&"insertKnot"===M.type&&tg.Icons.DrawIcon(m,X,tg.Icons.ShapeHighlighPoint,O)}},Sq.prototype._drawGuide=function(K){var N=this,q=N._guideInfo;if(q){var R,L,V,u,O=q.v;for(R=0;2>R;R++)if(u=0===R?q.xList:q.yList)for(L=0,V=u.length;V>L;L++)tg.Icons.DrawIcon(N._interactor,K,tg.Icons.ShapeGuideLine,[O.x,O.y,u[L].x,u[L].y])}},Sq.prototype._drawCurrentPoint=function(p){var E=this;if(E.activing){var x=E.activing,o=E.getCurrentSelectintStatus(),b=E._interactor;if(o!==tg.Curve.PointType.Straight){var G=x.pairs;x.hlpair,x.hltype;var t=x.selections,N=x.editingCtrl;if(G&&!t){var c,C,U;for(C=0,U=G.length;U>C;C++)c=G[C],N&&C===N.pairId&&c[N.type]?tg.Icons.DrawIcon(b,p,tg.Icons.ShapeActivingCtrl,{point:c.point,c1:c.c1,c2:c.c2,hl:N.type}):tg.Icons.DrawIcon(b,p,tg.Icons.ShapeActivingCtrl,c)}}tg.Icons.DrawIcon(b,p,tg.Icons.ShapeHighlighRealPoint,E.activing.point),t&&t.forEach(function(r){tg.Icons.DrawIcon(b,p,tg.Icons.ShapeHighlighRealPoint,r)})}},Sq.prototype.clear=function(){var o=this;o.editing=null,o._guideInfo=null,o.activing=null,o.highlight=null},Sq.prototype._42=function(q){var N=this;N.info={},N.editing||(N.screenInfo=null);var x=N._interactor;if(!x.editDetail)return N.clear(),void 0;var B=x.gv;if(!N.target||!B.isSelected(N.target)||!B.isVisible(N.target))return x.editDetail=!1,N.clear(),void 0;if(N.gatherSingleTarget(B,N.target),tg.Icons.DrawIcon(x,q,tg.Icons.ShapeBgCurve,N.screenInfo),N._drawHighlight(q),N._drawCurrentPoint(q),N._getRealPoint().forEach(function(m){tg.Icons.DrawIcon(x,q,tg.Icons.ShapePoint,m)}),N._drawGuide(q),N.tipInfo&&tg.Icons.DrawIcon(x,q,tg.Icons.TipHelper,N.tipInfo),N._edgeHostGuideInfo){tg.Icons.DrawIcon(x,q,tg.Icons.NodeHoverGuide,N._edgeHostGuideInfo.corners);var e=N._edgeHostGuideInfo.host;if(e){var Q=B.getAttachPoints(e);if(Q&&Q.length)for(var F=0,i=Q.length;i>F;F++){var w=Q[F],p=Ao(B,e,0,w.offsetX||0,w.offsetY||0,w.x,w.y);p=tg.toScreenPosition(B,p),p.isAttach=N._edgeHostGuideInfo.attach===F,tg.Icons.DrawIcon(x,q,tg.Icons.AttachPoint,p)}}}if(N._interactor.getStyle("curveElevationVisible")&&N.target instanceof l.Polyline&&N.activing){var E=N.activing.getCurrentEditingPoint();E&&tg.Icons.DrawIcon(x,q,tg.Icons.EdgeElevationGuide,E)}if(N.edgeEditResult&&N._drawEdgeHostHighlight(q,N.edgeEditResult.host,N.edgeEditResult.anchor),N._multiSelect&&N._multiSelect.endPoint){var d=l.Default.unionPoint(tg.toScreenPosition(B,N._multiSelect.startPoint),tg.toScreenPosition(B,N._multiSelect.endPoint));d.color=B.getRectSelectBorderColor(),q.save(),q.setTransform(1,0,0,1,0,0);var P=g.devicePixelRatio,K=d.borderWidth=Math.round(P);K/=2,d.x=Math.round(d.x*P)+K,d.y=Math.round(d.y*P)+K,d.width=Math.round(d.width*P),d.height=Math.round(d.height*P),tg.Icons.DrawIcon(x,q,tg.Icons.SimpleRect,d),q.restore()}},Sq.prototype._drawEdgeHostHighlight=function(P,q,f){this.drawEdgeHostHighlight(P,q,f),this._interactor.redraw()},Sq.prototype.drawEdgeHostHighlight=function(u,H,o){if(jo(H)){var N,g,r,U,Y=this,m=Y._interactor,P=m.gv,b=P.getDataUI(H),y=Qg(b),p=[];for(r=0,U=y.points.length;U>r;r++)g=tg.toScreenPosition(P,y.points.get(r)),p.push(g.x,g.y);y.segments&&(N=y.segments.toArray());var e=m.getStyle("edgeHostHighlighPeriod"),G=m.getStyle("edgeHostEdgeHighlighColor");tg.Icons.DrawIcon(m,u,tg.Icons.ShapeBgCurve,{P:p,S:N,color:G,dynamicVisible:o.index===d,dynamicPeriod:e}),G=m.getStyle("edgeHostPointHighlighColor");var W=Wj(b);for(r=0,U=W.length;U>r;r++){var R=W[r],K=tg.toScreenPosition(P,R);tg.Icons.DrawIcon(m,u,tg.Icons.ShapePoint,{point:{x:K.x,y:K.y},color:G,size:12,dynamicVisible:r===o.index,dynamicPeriod:e})}}},Sq.prototype._getRealPoint=function(){var T,W=this.screenInfo,l=W.P,o=W.S,f=-1,Z=[],I=-1,A=o.length;return o.each(function(g){I++;var u=1;if(3===g)u=2;else if(4===g)u=3;else if(5===g)return;f+=u,T=I+1>=A?!0:1===o.get(I+1)?!0:!1,Z.push({point:{x:l[2*f],y:l[2*f+1]},segmentIndex:I,pointIndex:f,isEnd:T})}),Z},Sq.prototype.getEditingPointsInfo=function(M){var S=this,P=S.activing;if(!P)return!1;var D=P.point;if(!D)return!1;var j=this._getRealPoint(),v=[{screen:D}];P.selections&&P.selections.forEach(function($){v.push({screen:$})});var g,q,V=j.length;return v.forEach(function($){for(g=0;V>g;g++)if(q=j[g],$.screen.isNearEnough(q.point)){$.segmentIndex=q.segmentIndex,$.pointIndex=q.pointIndex,$.point=S.target.getPoints().get(q.pointIndex);break}}),M&&v.sort(function($,d){return $.segmentIndex-d.segmentIndex}),v};var Sh=tg.MoveHelper=function(U){var F=this;F.catalog="Move",F._interactor=U};Sh.prototype={},Sh.prototype.constructor=Sh,Sh.prototype.calcShift=function(R,Y,f){var m,i,D=this,I=D._interactor.gv,C=I.lp(Y);if("beginMove"===R&&D._gatherGridInfo(f._lastLogicalPoint||C),m=D._target){var U=m.downPosition;if(U){var d=D._interactor.getStyle("moveSensitivity")/I._zoom;if(U.distanceTo(C)<d)return{x:0,y:0};delete m.downPosition}var e;i=l.Default.isShiftDown(Y),i&&(C=D._dealShiftDown(C),e=m.shiftGuide.dir);var E,T=m.rawPos={x:m.pos.x+C.x-m.lp.x,y:m.pos.y+C.y-m.lp.y};if(l.Default.isCtrlDown(Y)){if(E=D._calcShiftByAddon(),D._target.node instanceof tg.Group){var $=D._target.node;$._position.x+=E.x,$._position.y+=E.y}return E}for(var x,Q=m.x+T.x,P=m.y+T.y,j={x:Q,y:P},u={x:Q+m.w/2,y:P+m.h/2},Z={x:Q+m.w,y:P+m.h},g=D._interactor.rectGuide,z=D._interactor.gridGuide,c=[g.findClosest(j,e),g.findClosest(u,e),g.findClosest(Z,e),z.findClosest(j,e),z.findClosest(u,e),z.findClosest(Z,e)],S=1/0,O=1/0,q=0,b=c.length;b>q;q++)x=c[q],x&&(Q=x.x,P=x.y,isFinite(Q)&&Math.abs(Q)<Math.abs(S)&&(S=Q),isFinite(P)&&Math.abs(P)<Math.abs(O)&&(O=P));if(isFinite(S)||(S=0),isFinite(O)||(O=0),E=D._calcShiftByAddon(S,O),D._target.node instanceof tg.Group){var $=D._target.node;$._position.x+=E.x,$._position.y+=E.y}var k=m.node;if(!rk(k,I)){var v=T.x+S,H=T.y+O;D._interactor.rectGuide.gatherLines({node:k,x:m.x+v,y:m.y+H,w:m.w,h:m.h},e)}return E}},Sh.prototype._calcShiftByAddon=function(A,G){var E=this._target,p=E.rawPos,m=E.node.getPosition();return A=A||0,G=G||0,{x:p.x-m.x+A,y:p.y-m.y+G}},Sh.prototype._dealShiftDown=function(K){var A=this,e=A._target.shiftGuide,n=A._target.lp,C=Math.abs(K.x-n.x),J=Math.abs(K.y-n.y);C>J&&C>e.limit&&"y"===e.dir&&(e.dir="x"),J>C&&J>e.limit&&"x"===e.dir&&(e.dir="y");var v=e.dir;return"x"===v?(K.y=n.y,e.limit=Math.max(e.limit,C)):"y"===v&&(K.x=n.x,e.limit=Math.max(e.limit,J)),K},Sh.prototype._gatherGridInfo=function(u){var e,R=this,P=R._interactor,W=P._getValidSelection();if(W.length){if(1===W.length){if(e=W[0],!e.getRect)return R._target=null,void 0}else if(e=tg.Group.findOrCreateGroup(W),!e)return R._target=null,void 0}else{var W=P.gv.sm().getSelection();if(W.length&&(e=W.get(0),!e.getRect))return R._target=null,void 0}var s=e.getPosition(),X=e.getRect();R._target={node:e,x:X.x-s.x,y:X.y-s.y,w:X.width,h:X.height,lp:{x:u.x,y:u.y},pos:{x:s.x,y:s.y},shiftGuide:{dir:"x",limit:0},downPosition:new tg.Math.Vector2(u)},P.rectGuide.gatherRects()},Sh.prototype.clear=function(){var Y=this;Y._interactor.rectGuide.clear(),Y._interactor._42()};var tr="directional",Nm="point",Bm="spot",wj="light.color",Rq={},To=function(T,P){Or(P)&&Ub.test(P)?Hk(T,P):qr(P)&&P.modelType?Ib(T,P):Rg[T]=P},ym=function(w){if(qr(w))return w.modelType?w.uuid?Rg[w.uuid]:(w.uuid=l.Math.generateUUID(),Ib(w.uuid,w),d):w;var m=Rg[w];return w&&m===d&&Ub.test(w)&&(bl&&bl[w]||Hk(w,w)),m},xh=function(c,h){c.frameStack?c.frameStack.push(h):c.frameStack=[h],c.bindFramebuffer(c.FRAMEBUFFER,h)},oe=function(m){var L=m.frameStack;if(L){if(L.pop(),L.length)return m.bindFramebuffer(m.FRAMEBUFFER,L[L.length-1]),void 0;m.frameStack=null}m.bindFramebuffer(m.FRAMEBUFFER,null)};ag(k,{graph3dViewAttributes:s,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:N/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:ir,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:N,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:N/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:To,getShape3dModel:ym,createMatrix:function(G,C){Cq(G)||(G=[G]);for(var n=G.length-1;n>=0;n--){var m=G[n];C=Sr(m.mat,m.s3,m.r3,m.rotationMode,m.t3,C)}return C},transformVec:function(f,E){return hs(f,E)},glBindFrame:xh,glUnbindFrame:oe,createBoxModel:function(){return{vs:Ii,ns:Dk,uv:ab,is:un}},createRoundRectModel:function(r,T){return te.roundRect(r,T)},createStarModel:function(A,v){return te.star(A,v)},createRectModel:function(V,L){return te.rect(V,L)},createTriangleModel:function(f,g){return te.triangle(f,g)},createRightTriangleModel:function(J,S){return te.rightTriangle(J,S)},createParallelogramModel:function(C,f){return te.parallelogram(C,f)},createTrapezoidModel:function(V,U){return te.trapezoid(V,U)},createSmoothSphereModel:function(w,p,s,S,m,Y,d){return bd(new Fq(w,p,s,S,m,Y,d))},createSphereModel:function(t,q,R,y,U,K,F){return t?qi(t,q,R,y,U,K,F):k.createSmoothSphereModel()},createSmoothConeModel:function(n,i,q,Y,E){return Of(n,i,q,Y,E)},createConeModel:function(P,T,H,S,Y,t){return P?ps(P,T,H,S,Y,t):Of(t)},createSmoothCylinderModel:function(F,P,K,E,m,Y,Q,Z){return bd(new yo(F,P,K,E,m,Y,Q,Z))},createCylinderModel:function(W,f,k,s,b,g,Q,w){return W?ds(W,f,k,s,b,g,Q,w):nq(g,Q)},createSmoothTorusModel:function(K,e,s,V,M,H){return bd(new jk(K,e,s,V,M,H))},createTorusModel:function(x,X,B,t,W,i,j,g){return x?ib(x,X,B,t,W,i,j,g):Vq(i,j)},createExtrusionModel:function(k,h,v,x,d,G,_,Z){return Um(k,h,v,x,d,G,_,Z)},createSmoothRingModel:function(p,i,b,I,x,w){for(var O=[],h=0;h<p.length-1;h+=2)O.push({x:p[h],y:p[h+1]});for(p=Si(O,i,b)[0],O=[],h=0;h<p.length;h++){var c=p[h];O.push(new kj(c.x,0,c.y))}return bd(new Uk(O,w,I,x))},createTextGeometry:function(y,f){return bd(new mp(y,f))},loadFontFace:function($,g){k.xhrLoad($,function(B){if(!B)return g();var O;try{O=JSON.parse(B)}catch(u){O=JSON.parse(B.substring(65,B.length-2))}Tq.loadFace(O),g&&g(O.familyName.toLowerCase())},g?null:{sync:!0})},createRingModel:function(r,S,u,W,Y,i,X,U,A,b){for(var c=[],g=0;g<r.length-1;g+=2)c.push({x:r[g],y:r[g+1]});i=i||k.shapeSide,X=X||0,U=U||i;var o,C,Q,H,$,l,t,G,w,R,g,p,z,M,N,x,Z,J,f=[],v=[],j=A?[]:s,_=A?[]:s,m=b?[]:s,B=b?[]:s,K=W?[]:s,h=W?[]:s,E=Y?[]:s,F=Y?[]:s,r=Si(c,S,u),D=nm(r),q=0,n=2*Math.PI/i;return r.forEach(function(c){if(Q=c.length,Q>1){if(H=c[0],W)for(l=H.x,G=H.y,g=X;U>g;g++)p=g+1,z=g*n,M=p*n,N=O(z),x=L(z),Z=O(M),J=L(M),K.push(N*l,G,-x*l,Z*l,G,-J*l,0,G,0),h.push(.5-.5*N,.5-.5*x,.5-.5*Z,.5-.5*J,.5,.5);for(R=0;Q>R;R++){for($=c[R],l=H.x,t=$.x,G=H.y,w=$.y,o=q/D,q+=Qd(H,$),C=q/D,g=X;U>g;g++)p=g+1,z=g*n,M=p*n,N=O(z),x=L(z),Z=O(M),J=L(M),f.push(N*t,w,-x*t,Z*t,w,-J*t,N*l,G,-x*l,Z*t,w,-J*t,Z*l,G,-J*l,N*l,G,-x*l),v.push(g/i,C,p/i,C,g/i,o,p/i,C,p/i,o,g/i,o),A&&g===X&&(j.push(0,G,0,0,w,0,N*t,w,-x*t,N*t,w,-x*t,N*l,G,-x*l,0,G,0),_.push(0,.5-G,0,.5-w,2*t,.5-w,2*t,.5-w,2*l,.5-G,0,.5-G)),b&&p===U&&(m.push(0,G,0,Z*t,w,-J*t,0,w,0,Z*t,w,-J*t,0,G,0,Z*l,G,-J*l),B.push(1,.5-G,1-2*t,.5-w,1,.5-w,1-2*t,.5-w,1,.5-G,1-2*l,.5-G));H=$}if(Y)for(l=H.x,G=H.y,g=X;U>g;g++)p=g+1,z=g*n,M=p*n,N=O(z),x=L(z),Z=O(M),J=L(M),E.push(Z*l,G,-J*l,N*l,G,-x*l,0,G,0),F.push(.5-.5*Z,.5+.5*J,.5-.5*N,.5+.5*x,.5,.5)}}),{vs:f,uv:v,bottom_vs:E,bottom_uv:F,top_vs:K,top_uv:h,from_vs:j,from_uv:_,to_vs:m,to_uv:B}}},!0),ag(i,{"3d.move.mode":d,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":d,"edge.gradient.color":d,"edge.source.t3":d,"edge.target.t3":d,"light.type":Nm,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":N/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":xr,"wf.short":!1,"wf.mat":d,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:d,"transparent.mask":!1,brightness:d,"select.brightness":.7,"repeat.uv.length":d,alphaTest:.4,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":Oh,"label.t3":d,"label.r3":d,"label.texture.scale":2,"label.rotationMode":Mm,"label.light":!1,"label.blend":d,"label.reverse.flip":!1,"label.reverse.color":zr,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Oh,"label2.t3":d,"label2.r3":d,"label2.texture.scale":2,"label2.rotationMode":Mm,"label2.light":!1,"label2.blend":d,"label2.reverse.flip":!1,"label2.reverse.color":zr,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Oh,"note.t3":d,"note.r3":d,"note.texture.scale":2,"note.rotationMode":Mm,"note.light":!1,"note.blend":d,"note.reverse.flip":!1,"note.reverse.color":zr,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Oh,"note2.t3":d,"note2.r3":d,"note2.texture.scale":2,"note2.rotationMode":Mm,"note2.light":!1,"note2.blend":d,"note2.reverse.flip":!1,"note2.reverse.color":zr,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:d,"shape3d.color":Fj,"shape3d.top.color":d,"shape3d.bottom.color":d,"shape3d.from.color":d,"shape3d.to.color":d,"shape3d.image":d,"shape3d.top.image":d,"shape3d.bottom.image":d,"shape3d.from.image":d,"shape3d.to.image":d,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":d,"shape3d.side.to":d,"shape3d.smooth":d,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":d,"shape3d.opacity":d,"shape3d.reverse.flip":!1,"shape3d.reverse.color":zr,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":d,"shape3d.uv.scale":d,"shape3d.top.uv.offset":d,"shape3d.top.uv.scale":d,"shape3d.bottom.uv.offset":d,"shape3d.bottom.uv.scale":d,"shape3d.from.uv.offset":d,"shape3d.from.uv.scale":d,"shape3d.to.uv.offset":d,"shape3d.to.uv.scale":d,"shape3d.top.cap":d,"shape3d.bottom.cap":d,"shape3d.start.angle":0,"shape3d.sweep.angle":p,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":d,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"texture.mipmap.max":d,"texture.filter":d,"texture.filter.min":d,"texture.filter.mag":d,"all.light":!0,"all.visible":!0,"all.color":Fj,"all.image":d,"all.blend":d,"all.opacity":d,"all.reverse.flip":!1,"all.reverse.color":zr,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":d,"all.uv.offset":d,"all.uv.scale":d,"all.discard.selectable":!0,mat:d,"left.mat":d,"right.mat":d,"top.mat":d,"bottom.mat":d,"front.mat":d,"back.mat":d},!0);var Gc,Pq=!1,fh=[0,0,0,0],pr={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:xb,2:cr,3:rg,4:Rc,5:Oh,6:ss}},me=function(w,_,c,v){if(_.getFaceVisible(w,c)){ll(_,No(w,_.getFaceMat(w,c)||_.getMat(w)));var q=_._26I;_.getFaceReverseCull(w,c)?q.enable(q.CULL_FACE):q.disable(q.CULL_FACE),is(q,_._prg.uFixPickReverseColor,pr[c]),bf(q),_g(q,v,6),wq(q),li(_)}},Tf=function(o){return o instanceof qs},nf=function(X){return[X.x,X.e||0,X.y]},Xp=function(_,H,W){for(var H=id(H),R=H[0],$=H[1],e=H[2];W--;)_.push(R,$,e)},Ap=function($,s,R){for(var s=id(s),X=s[0],b=s[1],U=s[2],Y=s[3];R--;)$.push(X,b,U,Y)},os=function(o,C,a){if(C)for(var U,E,b,f=C[0],P=C[1],t=C[2],q=C[4],O=C[5],w=C[6],G=C[8],L=C[9],F=C[10],X=C[12],Q=C[13],l=C[14],H=a.length,D=0,D=0;H>D;D+=3)U=a[D],E=a[D+1],b=a[D+2],o.push(f*U+q*E+G*b+X,P*U+O*E+L*b+Q,t*U+w*E+F*b+l);else Hi(o,a)},Qp=function(D,i){var T=i.s("light.intensity"),h=id(i.s(wj)),m=h[0],u=h[1],c=h[2];1!==T&&(m*=T,u*=T,c*=T),D.push(m,u,c,i.s("light.disabled")?1:0)},tj=function(Z,U,t){is(U,t.uHeadlightRange,Z._headlightRange),is(U,t.uHeadlightAmbientIntensity,Z._headlightAmbientIntensity);var $=Z._headlightIntensity,v=id(Z._headlightColor);1!==$&&(v=[v[0]*$,v[1]*$,v[2]*$]),is(U,t.uHeadlightColor,[v[0],v[1],v[2],Z._headlightDisabled?1:0]);var g=Z._59O,Q=Z._spots,p=Z._dirs;if(g.length){var L=[],i=[],_=[];g.forEach(function(H){Qp(L,H),Hi(i,Z._transformPointToViewSpace(H.p3())),_.push(H.s("light.range"))}),U.uniform4fv(t.uPointColor,L),U.uniform1fv(t.uPointRange,_),U.uniform3fv(t.uPointPosition,i)}if(Q.length){var N=[],s=[],F=[],c=[],M=[],w=[];Q.forEach(function(b){Qp(N,b),Hi(s,Z._transformPointToViewSpace(b.p3())),Hi(M,Z._transformDirectionToViewSpace(b.p3(),b.s("light.center"))),F.push(b.s("light.range")),c.push(O(b.s("light.angle")/2)),w.push(b.s("light.exponent"))}),U.uniform4fv(t.uSpotColor,N),U.uniform1fv(t.uSpotRange,F),U.uniform1fv(t.uSpotAngle,c),U.uniform1fv(t.uSpotExponent,w),U.uniform3fv(t.uSpotPosition,s),U.uniform3fv(t.uSpotDirection,M)}if(p.length){var y=[],q=[];p.forEach(function(v){Qp(y,v),Hi(q,Z._transformDirectionToViewSpace(v.p3()))}),U.uniform4fv(t.uDirColor,y),U.uniform3fv(t.uDirDirection,q)}},Sd=function(X){return Math.max(k.graph3dViewMinPhi+no,Math.min(k.graph3dViewMaxPhi-no,X))},zd=function(){return.05+T()/2},$i=function(Q,w,N,h){var $,S=Q.getEye();return Q.isOrtho()?($=ke(Q.getCenter(),S),$[0]+=h[0],$[1]+=h[1],$[2]+=h[2]):$=S,pi(w,N,h,$)},pi=function(g,o,H,_){var b=Eb(g,o),d=ke(_,H,!0),U=Eb(d,o);if(J(U)<no)return s;var M=(b-Eb(H,o))/U;return[H[0]+d[0]*M,H[1]+d[1]*M,H[2]+d[2]*M]},Ij=function(h,C){return{x:2*h.x-C.x,y:2*h.y-C.y}},zi=function(w,y,S,u){var B,P;if(!w)return B=c(y.y-S.y,S.x-y.x),{x:y.x+u*L(B),y:y.y+u*O(B)};if(!S)return B=c(w.y-y.y,y.x-w.x),{x:y.x+u*L(B),y:y.y+u*O(B)};var i=ke([w.x,w.y,0],[y.x,y.y,0],!0),$=ke([S.x,S.y,0],[y.x,y.y,0],!0),X=-(i[0]+$[0])/2,E=-(i[1]+$[1])/2,l=r(X*X+E*E);if(no>l)return B=c(w.y-y.y,y.x-w.x),{x:y.x+u*L(B),y:y.y+u*O(B)};var s=w.x-y.x,m=w.y-y.y,z=S.x-y.x,p=S.y-y.y,n=r(s*s+m*m),C=r(z*z+p*p);B=M(Eb(i,$))/2,P=i[1]*$[0]-i[0]*$[1]>0?-1:1,X/=l,E/=l;var H=u/L(B),N=I(n,C)/O(B);l=Math.min(H,N);var x={x:y.x+P*l*X,y:y.y+P*l*E};return S.b&&H>C/O(B)&&(x.adjust=!0),x},lq=function(c){var f=c[1],m=c[2],b=c[3],C=c[6],v=c[7],k=c[11];c[1]=c[4],c[2]=c[8],c[3]=c[12],c[4]=f,c[6]=c[9],c[7]=c[13],c[8]=m,c[9]=C,c[11]=c[14],c[12]=b,c[13]=v,c[14]=k},Cj=function(H){var d=H[0],A=H[1],u=H[2],i=H[3],l=H[4],y=H[5],C=H[6],j=H[7],U=H[8],Z=H[9],T=H[10],W=H[11],D=H[12],r=H[13],R=H[14],n=H[15],B=d*y-A*l,m=d*C-u*l,k=d*j-i*l,_=A*C-u*y,P=A*j-i*y,I=u*j-i*C,z=U*r-Z*D,x=U*R-T*D,h=U*n-W*D,p=Z*R-T*r,b=Z*n-W*r,Q=T*n-W*R,V=B*Q-m*b+k*p+_*h-P*x+I*z;return V?(V=1/V,H[0]=(y*Q-C*b+j*p)*V,H[1]=(u*b-A*Q-i*p)*V,H[2]=(r*I-R*P+n*_)*V,H[3]=(T*P-Z*I-W*_)*V,H[4]=(C*h-l*Q-j*x)*V,H[5]=(d*Q-u*h+i*x)*V,H[6]=(R*k-D*I-n*m)*V,H[7]=(U*I-T*k+W*m)*V,H[8]=(l*b-y*h+j*z)*V,H[9]=(A*h-d*b-i*z)*V,H[10]=(D*P-r*k+n*B)*V,H[11]=(Z*k-U*P-W*B)*V,H[12]=(y*x-l*p-C*z)*V,H[13]=(d*p-A*x+u*z)*V,H[14]=(r*m-D*_-R*B)*V,H[15]=(U*_-Z*m+T*B)*V,void 0):s},Vf=function(e,L){if(L){var x=L[0],J=L[1],n=L[2];e[12]=e[0]*x+e[4]*J+e[8]*n+e[12],e[13]=e[1]*x+e[5]*J+e[9]*n+e[13],e[14]=e[2]*x+e[6]*J+e[10]*n+e[14],e[15]=e[3]*x+e[7]*J+e[11]*n+e[15]}},ig=function(M,I){if(I){var u=I[0],Z=I[1],m=I[2];M[0]=M[0]*u,M[1]=M[1]*u,M[2]=M[2]*u,M[3]=M[3]*u,M[4]=M[4]*Z,M[5]=M[5]*Z,M[6]=M[6]*Z,M[7]=M[7]*Z,M[8]=M[8]*m,M[9]=M[9]*m,M[10]=M[10]*m,M[11]=M[11]*m}},so=function(r,B,o){var x=B[0],F=B[1],b=B[2],g=B[3],n=B[4],h=B[5],W=B[6],c=B[7],l=B[8],j=B[9],f=B[10],G=B[11],m=B[12],S=B[13],P=B[14],Y=B[15],H=o[0],O=o[1],p=o[2],U=o[3];return r[0]=H*x+O*n+p*l+U*m,r[1]=H*F+O*h+p*j+U*S,r[2]=H*b+O*W+p*f+U*P,r[3]=H*g+O*c+p*G+U*Y,H=o[4],O=o[5],p=o[6],U=o[7],r[4]=H*x+O*n+p*l+U*m,r[5]=H*F+O*h+p*j+U*S,r[6]=H*b+O*W+p*f+U*P,r[7]=H*g+O*c+p*G+U*Y,H=o[8],O=o[9],p=o[10],U=o[11],r[8]=H*x+O*n+p*l+U*m,r[9]=H*F+O*h+p*j+U*S,r[10]=H*b+O*W+p*f+U*P,r[11]=H*g+O*c+p*G+U*Y,H=o[12],O=o[13],p=o[14],U=o[15],r[12]=H*x+O*n+p*l+U*m,r[13]=H*F+O*h+p*j+U*S,r[14]=H*b+O*W+p*f+U*P,r[15]=H*g+O*c+p*G+U*Y,r},Ic=function(B,Q,o,Z){var j,T,l,$,_,g,x,s,z,U,t=Q[0],h=Q[1],D=Q[2],R=Z[0],C=Z[1],P=Z[2],f=o[0],M=o[1],a=o[2];return J(t-f)<no&&J(h-M)<no&&J(D-a)<no?xq(B):(x=t-f,s=h-M,z=D-a,U=1/r(x*x+s*s+z*z),x*=U,s*=U,z*=U,j=C*z-P*s,T=P*x-R*z,l=R*s-C*x,U=r(j*j+T*T+l*l),U?(U=1/U,j*=U,T*=U,l*=U):(j=0,T=0,l=0),$=s*l-z*T,_=z*j-x*l,g=x*T-s*j,U=r($*$+_*_+g*g),U?(U=1/U,$*=U,_*=U,g*=U):($=0,_=0,g=0),B[0]=j,B[1]=$,B[2]=x,B[3]=0,B[4]=T,B[5]=_,B[6]=s,B[7]=0,B[8]=l,B[9]=g,B[10]=z,B[11]=0,B[12]=-(j*t+T*h+l*D),B[13]=-($*t+_*h+g*D),B[14]=-(x*t+s*h+z*D),B[15]=1,B)},Yq=function(o,y,G,c,r){var K=1/q(y/2),a=1/(c-r);return o[0]=K/G,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=K,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(r+c)*a,o[11]=-1,o[12]=0,o[13]=0,o[14]=2*r*c*a,o[15]=0,o},Li=function(y,X,K,D,t,H,F){var E=1/(X-K),x=1/(D-t),b=1/(H-F);return y[0]=-2*E,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=-2*x,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=2*b,y[11]=0,y[12]=(X+K)*E,y[13]=(t+D)*x,y[14]=(F+H)*b,y[15]=1,y},Jd=function(m,c){var A=c[0],D=c[1],T=c[2],i=c[3],J=A*A+D*D+T*T+i*i,P=J?1/J:0;return m[0]=-A*P,m[1]=-D*P,m[2]=-T*P,m[3]=i*P,m},_l=function(g,c){var Q=c[0]+c[5]+c[10],$=0;return Q>0?($=2*Math.sqrt(Q+1),g[3]=.25*$,g[0]=(c[6]-c[9])/$,g[1]=(c[8]-c[2])/$,g[2]=(c[1]-c[4])/$):c[0]>c[5]&c[0]>c[10]?($=2*Math.sqrt(1+c[0]-c[5]-c[10]),g[3]=(c[6]-c[9])/$,g[0]=.25*$,g[1]=(c[1]+c[4])/$,g[2]=(c[8]+c[2])/$):c[5]>c[10]?($=2*Math.sqrt(1+c[5]-c[0]-c[10]),g[3]=(c[8]-c[2])/$,g[0]=(c[1]+c[4])/$,g[1]=.25*$,g[2]=(c[6]+c[9])/$):($=2*Math.sqrt(1+c[10]-c[0]-c[5]),g[3]=(c[1]-c[4])/$,g[0]=(c[8]+c[2])/$,g[1]=(c[6]+c[9])/$,g[2]=.25*$),g},of=function(O,C,I){var Y=C[0],z=C[1],f=C[2],S=C[3],n=Y+Y,w=z+z,J=f+f,m=Y*n,H=Y*w,K=Y*J,p=z*w,M=z*J,P=f*J,V=S*n,B=S*w,l=S*J;return O[0]=1-(p+P),O[1]=H+l,O[2]=K-B,O[3]=0,O[4]=H-l,O[5]=1-(m+P),O[6]=M+V,O[7]=0,O[8]=K+B,O[9]=M-V,O[10]=1-(m+p),O[11]=0,O[12]=I[0],O[13]=I[1],O[14]=I[2],O[15]=1,O},gi=function(g,F){if(g.vr.enable){var h=g.vr.getViewMatrix(F);if(h)return h}return Ic(F?F:Il(),g._eye,g._center,g._up)},ws=function(M,s){if(M.vr.enable){var L=M.vr.getProjectMatrix();if(L)return L}if(!s&&M._computedProjectMatrix)return ri(M._computedProjectMatrix);var p=M.getAspect(),F=M._near,U=M._far,h=Il();if(M._ortho){var o=M._orthoWidth/2,C=o/p;Li(h,-o,o,-C,C,F,U)}else Yq(h,M._fovy,p,F,U);return h},Pk=function(z,v){if(!z)return s;var f=0,R=1,$=2,N=[],S=0,c=z.length,I=c/3;if(v){for(;c>S;S++)N[S]=0;for(S=0;S<v.length;S+=3){var E=[],b=[],u=[];E[f]=z[3*v[S+1]+f]-z[3*v[S]+f],E[R]=z[3*v[S+1]+R]-z[3*v[S]+R],E[$]=z[3*v[S+1]+$]-z[3*v[S]+$],b[f]=z[3*v[S+2]+f]-z[3*v[S+1]+f],b[R]=z[3*v[S+2]+R]-z[3*v[S+1]+R],b[$]=z[3*v[S+2]+$]-z[3*v[S+1]+$],u[f]=E[R]*b[$]-E[$]*b[R],u[R]=E[$]*b[f]-E[f]*b[$],u[$]=E[f]*b[R]-E[R]*b[f];for(var J=0;3>J;J++)N[3*v[S+J]+f]+=u[f],N[3*v[S+J]+R]+=u[R],N[3*v[S+J]+$]+=u[$]}}else for(S=0;I>S;S+=3){var E=[],b=[],u=[];E[f]=z[3*(S+1)+f]-z[3*S+f],E[R]=z[3*(S+1)+R]-z[3*S+R],E[$]=z[3*(S+1)+$]-z[3*S+$],b[f]=z[3*(S+2)+f]-z[3*(S+1)+f],b[R]=z[3*(S+2)+R]-z[3*(S+1)+R],b[$]=z[3*(S+2)+$]-z[3*(S+1)+$],u[f]=E[R]*b[$]-E[$]*b[R],u[R]=E[$]*b[f]-E[f]*b[$],u[$]=E[f]*b[R]-E[R]*b[f];for(var J=0;3>J;J++)N[3*(S+J)+f]=u[f],N[3*(S+J)+R]=u[R],N[3*(S+J)+$]=u[$]}for(S=0;c>S;S+=3){var Q=[];Q[f]=N[S+f],Q[R]=N[S+R],Q[$]=N[S+$];var T=r(Q[f]*Q[f]+Q[R]*Q[R]+Q[$]*Q[$]);0===T&&(T=no),Q[f]=Q[f]/T,Q[R]=Q[R]/T,Q[$]=Q[$]/T,N[S+f]=Q[f],N[S+R]=Q[R],N[S+$]=Q[$]}return new vi(N)},yq=function(j,g,X,S){if(X||(X=j.createTexture()),g){var N=j.TEXTURE_2D,Z=j.REPEAT,e=j.CLAMP_TO_EDGE,w=j.TEXTURE_MIN_FILTER;S=S||md;var H=S.minFilter||S.filter||j.LINEAR,B=S.magFilter||S.filter||j.LINEAR;ik(j,X),j.texImage2D(N,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,g),jg(j,j.TEXTURE_MAG_FILTER,B);var r=g.naturalWidth||g.width,T=g.naturalHeight||g.height;bq.isPOT(r)&&bq.isPOT(T)&&!g.clampToEdge?(jg(j,j.TEXTURE_WRAP_S,Z),jg(j,j.TEXTURE_WRAP_T,Z),jg(j,w,H===j.NEAREST?j.NEAREST_MIPMAP_NEAREST:j.LINEAR_MIPMAP_LINEAR),S.mipmapMaxLevel!==d&&jg(j,j.TEXTURE_MAX_LEVEL,S.mipmapMaxLevel),j.generateMipmap(N)):(jg(j,j.TEXTURE_WRAP_S,e),jg(j,j.TEXTURE_WRAP_T,e),jg(j,w,H)),ik(j,s)}return X},Mq=function(c,u){var b=new Uint8Array(4);return u=u||c.createTexture(),ik(c,u),jg(c,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,b),u},Zf=function(a){a._26I&&a._prg&&(a._26I.deleteProgram(a._prg),a._prg=s)},Yd=function(u,T,Q,p){var U=u.createShader(Q);return u.shaderSource(U,p),u.compileShader(U),u.attachShader(T,U),U},Mo=function(P){return P.createBuffer()},ik=function(y,Z){y.bindTexture(y.TEXTURE_2D,Z)},jg=function(k,U,d){k.texParameteri(k.TEXTURE_2D,U,d)},Zc=function(N,S){N.enable(N.POLYGON_OFFSET_FILL),N.polygonOffset(S[0],S[1])},yi=function(x){x.disable(x.POLYGON_OFFSET_FILL)},nj=function(X,K){if(K){var K=id(K);X.clearColor(K[0],K[1],K[2],K[3])}},ur=function(J,I){is(J,I.uFix,!0),ch(J,I.aNormal)},xo=function(L,S){is(L,S.uFix,!1),Sc(L,S.aNormal)},yl=function(M,q,Y,w,A,X,R,J){M._picking||(Y?(is(M,q.uBlend,!0),is(M,q.uBlendColor,Y)):is(M,q.uBlend,!1),is(M,q.uLight,w==s?!0:w),hk(A)&&1!==A&&is(M,q.uPartOpacity,A),is(M,q.uReverseFlip,X==s?!1:X),is(M,q.uFixPickReverseColor,R||zr)),J?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE)},fm=function(D,Y){D._picking||is(D,Y.uPartOpacity,1)},bf=function(){var F=[0,0,1,1];return function(O,n,o,P,j,Q,q,z,G){return o?(is(O,n.uTexture,!0),is(O,n.uDiscardSelectable,Zl(P)?P:!0),Sc(O,n.aUv),Bg(O,j,Q,n.aUv,2),G?(is(O,n.uBlendTexture,!0),O.activeTexture(O.TEXTURE1),ik(O,G),O.uniform1i(n.uBlendSampler,1)):(is(O,n.uBlendTexture,!1),O.activeTexture(O.TEXTURE1),ik(O,O._emptyBlendTexture)),O.activeTexture(O.TEXTURE0),ik(O,o),O.uniform1i(n.uSampler,0),q?(F[0]=q[0],F[1]=q[1]):(F[0]=0,F[1]=0),z?(F[2]=z[0],F[3]=z[1]):(F[2]=1,F[3]=1),is(O,n.uOffsetScale,F),void 0):(O.activeTexture(O.TEXTURE0),ik(O,O._emptyTexture),O.activeTexture(O.TEXTURE1),ik(O,O._emptyBlendTexture),void 0)}}(),wq=function(E,h,A){E.activeTexture(E.TEXTURE0),ik(E,s),E.activeTexture(E.TEXTURE1),ik(E,s),A&&(ch(E,h.aUv),is(E,h.uTexture,!1),is(E,h.uBlendTexture,!1))},hr=function(T,V,j,M,c,N){!j||$l||lk||T.lineWidth(j),M&&!T._picking&&is(T,V.uFixPickReverseColor,M),c&&Bg(T,c,N,V.aPosition)},$b=function(G,t,N,I){Gc&&(I=G[Gc]),G.drawArrays(I==s?G.TRIANGLES:I,t,N);var M=G._renderInfo;M&&(M.calls++,M.vertices+=N,(I==s||I===G.TRIANGLES)&&(M.faces+=N/3),I===G.LINES&&(M.lines+=N/2))},_g=function(H,E,F,g){Gc&&(g=H[Gc]),H.drawElements(g==s?H.TRIANGLES:g,F,H.UNSIGNED_SHORT,E==s?0:2*E);var t=H._renderInfo;t&&(t.calls++,t.vertices+=F,(g==s||g===H.TRIANGLES)&&(t.faces+=F/3),g===H.LINES&&(t.lines+=F/2))},Sg=function(R,x,S,m,k){var T=R.ARRAY_BUFFER;R.bindBuffer(T,x),S&&R.bufferData(T,S,R.STATIC_DRAW),m!=s&&R.vertexAttribPointer(m,k?k:3,R.FLOAT,!1,0,0)},Bg=function(A,G,T,V,J){return T?(bj(A,A.ARRAY_BUFFER,G,T),V!=s&&A.vertexAttribPointer(V,J?J:3,A.FLOAT,!1,0,0),void 0):Sg(A,G,T,V,J)},Vm=function(N,v,M){var k=N.ELEMENT_ARRAY_BUFFER;N.bindBuffer(k,v),M&&N.bufferData(k,M,N.STATIC_DRAW)},Di=function(q,g,L){bj(q,q.ELEMENT_ARRAY_BUFFER,g,L)},bj=function(D,K,r,p){var G=p._bufId;G||(G=p._bufId=l.Math.generateIncreasingID());var r,y=D._bufPool;(r=y[G])&&r._buf?D.bindBuffer(K,r._buf):(r=y[G]={_buf:Mo(D)},D.bindBuffer(K,r._buf),D.bufferData(K,p,D.STATIC_DRAW)),r._fid=D._renderInfo.frame},is=function(k,x,j){if(j!=s&&x!=s){j=id(j);var d=j.length;3===d?k.uniform3fv(x,j):4===d?k.uniform4fv(x,j):16===d?k.uniformMatrix4fv(x,!1,j):Zl(j)?k.uniform1i(x,j?1:0):2===d?k.uniform2fv(x,j):k.uniform1f(x,j)}},Sc=function(u,G){G!=s&&G>=0&&u.enableVertexAttribArray(G)},ch=function(W,U){U!=s&&U>=0&&W.disableVertexAttribArray(U)},li=function(g,j){var E=g.getGL(),y=g._prg;g._7O=g._8O.pop(),j&&(is(E,y.uMVMatrix,g._7O),g._6O=j,is(E,y.uNMatrix,j))},gr=function(C,v){return v||(v=Il()),Ug(v,C),Cj(v),lq(v),v},ll=function($,V){var a=$.getGL(),w=$._prg,Y=$._7O;V&&($._8O.push(ri(Y)),is(a,w.uMMatrix,V),so(Y,Y,V),$._7O=Y),is(a,w.uMVMatrix,Y),is(a,w.uNMatrix,gr(Y,$._6O))},Od=function(q,T,t,w,J,h){if(t){if(w){var V=t.value++,X=2147483648|V,j=[(255&X>>16)/255,(255&X>>8)/255,(255&X)/255,(255&X>>24)/255];t[V]={data:J,part:h}}else j=fh;return is(q,T.uFixPickReverseColor,j),j}},Oo=function(){var E={center:function(O,Z,l,i,d){var h=-Z[1]/2,k={x:-Z[0]/2,y:h,width:Z[0],height:Z[1]},p=Ih(O,k,l);return[p.x+i,-p.y-d,zd()]},front:function(B,x,Z,q,F){var K=-x[1]/2,M={x:-x[0]/2,y:K,width:x[0],height:x[1]},I=Ih(B,M,Z);return[I.x+q,-I.y-F,x[2]/2+zd()]},back:function(F,U,k,G,O){var W=-U[0]/2,g=-U[1]/2,S={x:W,y:g,width:U[0],height:U[1]},d=Ih(F,S,k);return[-d.x-G,-d.y-O,-U[2]/2-zd()]},left:function(k,$,h,Z,B){var x=-$[1]/2,W={x:-$[2]/2,y:x,width:$[2],height:$[1]},q=Ih(k,W,h);return[-$[0]/2-zd(),-q.y-B,q.x+Z]},right:function(n,i,D,L,e){var C=-i[2]/2,g=-i[1]/2,R={x:C,y:g,width:i[2],height:i[1]},b=Ih(n,R,D);return[i[0]/2+zd(),-b.y-e,-b.x-L]},top:function(z,K,D,u,v){var y={x:-K[0]/2,y:-K[2]/2,width:K[0],height:K[2]},c=Ih(z,y,D);return[c.x+u,K[1]/2+zd(),c.y+v]},bottom:function(y,a,O,j,$){var r=-a[2]/2,d={x:-a[0]/2,y:r,width:a[0],height:a[2]},T=Ih(y,d,O);return[T.x+j,-a[1]/2-zd(),-T.y-$]}};return function(R,h,s,G,L,l){return E[G](R,h,s,L||0,l||0)}}(),jj=function(k,A,h,m,Z,Y,r,q,o,p){if(Z&&(A[0]+=Z[0],A[1]+=Z[1],A[2]+=Z[2]),Vf(k,h),q){var E=Il();if(kk(E,o,p),hs(A,E),Vf(k,A),k.auto=q,k.pos=hs([0,0,0],k),Y){var U=k.mat2=Il();kk(U,Y,r)}}else kk(k,o,p),Vf(k,A),m===xb?ze(k,-X):m===cr?ze(k,X):m===rg?Uc(k,-X):m===Rc?Uc(k,X):m===ss&&ze(k,N),kk(k,Y,r);return k},zp=function(V,Z){var A=Z.auto,z=Z.mat2,w=V.gv;if(A){var v,d=Il(),D=[0,0,0,0];v="string"==typeof A?[A.indexOf("x")<0?w._eye[0]:w._center[0],A.indexOf("y")<0?w._eye[1]:w._center[1],A.indexOf("z")<0?w._eye[2]:w._center[2]]:w._eye,_l(D,Ic(Il(),v,w._center,w._up)),of(d,Jd(D,D),Z.pos),z&&so(d,d,z),ll(w,d)}else ll(w,Z)},to=function(i,W,f,B,I){var E=i.s,x=i.gv,G=x.getGL(),p=x._prg,S=x._buffer,H=x._1O;yq(G,Nr,H),zp(i,f),yl(G,p,E(W+".blend"),E(W+".light"),E(W+".opacity"),E(W+".reverse.flip"),E(W+".reverse.color"),E(W+".reverse.cull")),bf(G,p,H,I,S.uv,Lj),Bg(G,S.vs,B,p.aPosition),Bg(G,S.ns,Ok,p.aNormal),Di(G,S.is,Gg),_g(G,0,Gg.length),wq(G,p,H),fm(G,p),li(x)
},Nd=function(P,Q,C){var j=P.gv,r=P.data,b=P[Q]={blend:j.getBodyColor(r)||j.getFaceBlend(r,Q),light:j.getFaceLight(r,Q),color:j.getFaceColor(r,Q),opacity:j.getFaceOpacity(r,Q),transparent:j.getFaceTransparent(r,Q),reverseFlip:j.getFaceReverseFlip(r,Q),reverseColor:j.getFaceReverseColor(r,Q),reverseCull:j.getFaceReverseCull(r,Q),texture:j.getFaceImage(r,Q),blendTexture:j.getFaceBlendImage(r,Q),discardSelectable:j.getFaceDiscardSelectable(r,Q)};if("csg"!==Q){b.uv=j.getFaceUv(r,Q)||C&&C[Q+"Uv"],b.uvScale=j.getFaceUvScale(r,Q)||C&&C[Q+"UvScale"],b.uvOffset=j.getFaceUvOffset(r,Q)||C&&C[Q+"UvOffset"];var g=j.getFaceMat(r,Q);g&&(b.mat=No(r,g))}return b},Kc=function(A,Y,t,w,W){if(w){if(!W(w.transparent))return;var O=A.data,R=A.gv,k=R._buffer,M=R.getTexture(w.texture,O),S=R.getTexture(w.blendTexture,O);bf(Y,t,M,w.discardSelectable,k.uv,w.tuv,w.uvOffset,w.uvScale,S),yl(Y,t,w.blend,w.light,w.opacity,w.reverseFlip,w.reverseColor,w.reverseCull),is(Y,t.uDiffuse,w.color||i["color.empty"]),Bg(Y,k.vs,w.vs,t.aPosition),Bg(Y,k.ns,w.ns,t.aNormal),$b(Y,0,w.vs.length/3),fm(Y,t),wq(Y,t,M)}},pj=function(R,E,z,Y,L,g){var X,$,M,w,j,A,T,o,G,B,i,O=[Y-E,L-z],v=R?R.length:0;for(M=0;v>M;M++){for(w=2,X=R[M],j=X[0],A=X[1];w+1<X.length;){if(T=X[w],o=X[w+1],$=Br(E,z,Y,L,j,A,T,o,!0)){G=[T-j,o-A],B=Qd(G),G[0]/=B,G[1]/=B,B=Eb(O,G),B=B>0?g:-g,i=[G[0]*B,G[1]*B];break}j=T,A=o,w+=2}if(i)break}if(i)for(Y=E+i[0],L=z+i[1],M=0;v>M;M++)for(w=2,X=R[M],j=X[0],A=X[1];w+1<X.length;){if(T=X[w],o=X[w+1],$=Br(E,z,Y,L,j,A,T,o,!0))return[0,0];j=T,A=o,w+=2}return i?i:[Y-E,L-z]},gd=l.graph3d={},Ab=function(E,N,d){an(A+".graph3d."+E,N,d)},_i="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",_k="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";ag(k,{setBatchInfo:function(_,S){al[_]=S},getBatchInfo:function(B){return al[B]}},!0);var Ml=[1,1,1],fg=[1,0,0,0,0,1,0,1,1,1,1,0],_f=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Ek=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],dh=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Ue=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],zn=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Rd=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],sm=function(y,$){Mp(y,$,"_batchModelMap","_batchIndexMap"),Ph(y,$,"_wireframeModelMap","_wireframeIndexMap"),Ph(y,$,"_polylineModelMap","_polylineIndexMap"),Ph(y,$,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ph(y,$,"_polylineModelMapSwap","_polylineIndexMapSwap")},Mp=function(d,r,T,v){if(!r)return d[T]={},d[v]={},void 0;var E=r._id,W=d[v],s=W[E];if(s){var D=d[T],L=s.batch,Q=D[L],b=Q.ds,K=s.index;if(Q.invalidate=!0,delete W[E],b.splice(K,1),lp(b))return delete D[L],void 0;for(var O=s.begin,F=s.size,f=3*O,V=3*F,c=4*O,M=4*F,h=Q.vs,Y=Q.ps,g=Q.uv,e=Q.cs,G=Q.bs,B=Q.rs,l=Q.ns,q=Q.ls;K<b.length;K++)s=W[b[K]._id],s.index--,s.begin-=F;h.splice(f,V),Y.splice(c,M),g&&g.splice(2*O,2*F),e&&e.splice(c,M),G&&G.splice(f,V),B&&B.splice(O,F),l&&l.splice(f,V),q&&q.splice(O,F)}},Ph=Mp,nd=function(t,k,v,J){if(!J)return s;var P=k[J];if(!P){var O=al[J]||md,w=O.image?[]:s;P=k[J]={vs:[],ns:[],uv:w,cs:w?s:O.color?s:[],bs:O.blend?[]:s,ps:[],rs:O.brightness?[]:s,ds:[]}}return P.invalidate=!0,t[v._id]={index:P.ds.length,begin:P.vs.length/3,batch:J},P.ds.push(v),P},hi=function(R,j){return j!=s&&1!==j?[R[0]*j,R[1]*j,R[2]*j,R[3]]:R},Im=function(){var y;return function(Z,V,b){var v=Z.getData3dUI(V),s=v.shapeModel;s||(s=As(v));var o,T=V.s("wf.combineTriangle");if(b.geometry){if(!s&&(V instanceof l.Node&&!(V instanceof l.Shape)?(y||(y={vs:Ii,is:un,uv:ab}),s=y):s=[v.left,v.front,v.right,v.back,v.top,v.bottom],!s))return d;if(T?(T=0|Math.min(3,Math.max(1,isNaN(T)?1:T)),o=yg[T-1](s)):o=er(s),!o||0===o.length)return}else o=b.short?Ke:jn;var P=Z.getBrightness(V),N=id(b.color||"white"),r=N[3]<1,m=Math.ceil(b.width)||1,c=(r?"T":"O")+m,A=Z._wireframeIndexMap,Y=Z._wireframeModelMap,X=Y[c];X||(X=Y[c]={vs:[],cs:[],ps:[],ds:[],T:r,W:m}),X.invalidate=!0;var G=X.vs,e=X.cs,I=X.ds,F=A[V._id]={index:I.length,begin:G.length/3,batch:c};I.push(V);var z=v.mat;if(!z||!b.geometry&&V instanceof l.Shape){z=No(V,b.mat);var W=v._calcAnchorMat(V);W&&so(z,z,W)}os(G,z,o);var i=F.size=G.length/3-F.begin;Ap(e,hi(N,P),i)}}(),cg=function(k,B,$,M,q,c,E,n,W){var x=k.getBrightness(B);x==s&&(x=1);var N=hi(id(M),x),m=N[3]<1;c=Math.ceil(c)||1;var J=(m?"T":"O")+c;if(E){var Q=E[0],I=(E[1]||Q)+Q;J+="-"+Q+"-"+I,W&&(J+="-"+$h(W)+"-"+x,W=hi(id(W),x))}var U=k._polylineIndexMap,G=k._polylineModelMap,v=G[J];v||(v=G[J]={vs:[],cs:[],ps:[],ds:[],ls:E?[]:s,T:m,W:c},E&&(v.D=Q,v.G=I,v.A=W)),v.invalidate=!0;var d,y=v.vs,C=v.cs,X=v.ds,g=v.ls,l=U[B._id]={index:X.length,begin:y.length/3,batch:J};X.push(B),Hi(y,$);var o,F=l.size=y.length/3-l.begin,A=$.length,H=0,w=[];if(E||q)for(d=0;A>d;d+=6)o=Qd([$[d],$[d+1],$[d+2]],[$[d+3],$[d+4],$[d+5]]),w.push(o),H+=o;if(H&&q){var e,_=hi(id(q),x),L=[_[0]-N[0],_[1]-N[1],_[2]-N[2],_[3]-N[3]],a=0;for(d=0;A>d;d+=6)e=a/H,Ap(C,[N[0]+L[0]*e,N[1]+L[1]*e,N[2]+L[2]*e,N[3]+L[3]*e],1),a+=w[d/6],e=a/H,Ap(C,[N[0]+L[0]*e,N[1]+L[1]*e,N[2]+L[2]*e,N[3]+L[3]*e],1)}else Ap(C,N,F);if(E)for(a=n||0,d=0;A>d;d+=6)g.push(a),a+=w[d/6],g.push(a)},ld=function(o,j,I){if(j)for(var c=4*j.begin,$=I[j.batch].ps,C=0;C<j.size;C++)$[c++]=o[0],$[c++]=o[1],$[c++]=o[2],$[c++]=o[3]},Me=function(c,M){var w=M+["32"],q=c[M],m=c[w];q?m&&m.length===q.length?(m.set(q),m._bufId=null):c[w]=new vi(q):delete c[w]},Ff=function(B,E,X,e,F,s,T,d,_){if(Cq(X))X.forEach(function(G){Ff(B,E,G,e,F,s,T,d,_)});else if(Or(X))Ff(B,E,As(e,X),e,F,s,T,d,_);else if(qr(X)){var h,q=Ud(X.mat,E,B),V=Ud(X.s3,E,B),g=Ud(X.t3,E,B),b=Ud(X.r3,E,B);if((V||b||g||q)&&(h=Sr(q,V,b,Ud(X.rotationMode,E,B),g),s.push(h)),X.shape3d)Ff(B,E,X.shape3d,e,F,s,T,d,X);else{var o=e.s;_=_||md;var a=s[0],Y=s.length,M=o("shape3d.color",X.color,_.color);if(F||(F=o("shape3d.blend",X.blend,_.blend)),Y>1){a=ri(a);for(var S=1;Y>S;S++)so(a,a,s[S])}X.vs&&o(Bj,X.visible,_.visible)&&hb(a,T,d,X.vs,X.uv,X.is,F,M),X.top_vs&&o(xc,X.topVisible,_.topVisible)&&hb(a,T,d,X.top_vs,X.top_uv,X.top_is,F,o("shape3d.top.color",X.topColor,_.topColor)||M),X.bottom_vs&&o(Cg,X.bottomVisible,_.bottomVisible)&&hb(a,T,d,X.bottom_vs,X.bottom_uv,X.bottom_is,F,o("shape3d.bottom.color",X.bottomColor,_.bottomColor)||M),X.from_vs&&o(If,X.fromVisible,_.fromVisible)&&hb(a,T,d,X.from_vs,X.from_uv,X.from_is,F,o("shape3d.from.color",X.fromColor,_.fromColor)||M),X.to_vs&&o(bn,X.toVisible,_.toVisible)&&hb(a,T,d,X.to_vs,X.to_uv,X.to_is,F,o("shape3d.to.color",X.toColor,_.toColor)||M)}h&&s.pop()}},hb=function(f,I,S,T,X,r,d,k){var O,V=I.cs,R=I.uv,v=I.bs;if(r){O=r.length;for(var F=0;O>F;F++){var A=r[F];os(S,f,[T[3*A],T[3*A+1],T[3*A+2]]),R&&Hi(R,[X[2*A],X[2*A+1]])}}else O=T.length/3,os(S,f,T),R&&Hi(R,X);V&&Ap(V,k,O),v&&(d?Xp(v,d,O):Hi(v,Ml,O))},Gp=function(m,V,X,L){var A=[];L?Ff(m.gv,m.data,L,m,m.getBodyColor(),[V],X,A):(xs(m,xb,V,X,A),xs(m,cr,V,X,A),xs(m,Oh,V,X,A),xs(m,ss,V,X,A),xs(m,rg,V,X,A),xs(m,Rc,V,X,A),xs(m,"csg",V,X,A)),A.length&&(Hi(X.vs,A),Hi(X.ns,Pk(A)))},xs=function(P,r,l,q,I){var M=P[r];if(M){var c=M.tuv;if(c){var t,j,$,Y,L=M.uvScale,K=M.uvOffset;if(L)for(t=c.length,j=L[0],$=L[1],Y=0;t>Y;Y+=2)c[Y]*=j,c[Y+1]*=$;if(K)for(t=c.length,j=K[0],$=K[1],Y=0;t>Y;Y+=2)c[Y]+=j,c[Y+1]+=$}hb(l,q,I,M.vs,c,s,M.blend,M.color)}},Ur=function(y,d,Z,S,j,f,I,B){var D,i=Z.cs,U=Z.uv,R=Z.bs;if(y.getFaceVisible(d,f)){var Y=y.getFaceMat(d,f);if(Y&&(j=No(d,Y)),os(I,j,B),i&&Ap(i,y.getFaceColor(d,f),6),U){var K=y.getFaceUv(d,f)||S[f+"Uv"],$=y.getFaceUvScale(d,f)||S[f+"UvScale"],F=y.getFaceUvOffset(d,f)||S[f+"UvOffset"];K=K?[K[6],K[7],K[0],K[1],K[2],K[3],K[2],K[3],K[4],K[5],K[6],K[7]]:fg;var v=K[0],s=K[1],g=K[2],h=K[3],l=K[4],L=K[5],x=K[6],k=K[7],m=K[8],J=K[9],W=K[10],T=K[11];if($){var G=$[0],E=$[1];v*=G,s*=E,g*=G,h*=E,l*=G,L*=E,x*=G,k*=E,m*=G,J*=E,W*=G,T*=E}if(F){var o=F[0],C=F[1];v+=o,s+=C,g+=o,h+=C,l+=o,L+=C,x+=o,k+=C,m+=o,J+=C,W+=o,T+=C}U.push(v,s,g,h,l,L,x,k,m,J,W,T)}R&&(D=y.getBodyColor(d)||y.getFaceBlend(d,f),D?Xp(R,D,6):Hi(R,Ml,6))}},Fg=function(z,Y,O,m){var H=z.getGL(),a=z._prg,e=z._buffer;if(!z.drawFilter&&!ol(Y)){ll(z),ur(H,a);for(var l in Y){var R=Y[l];if(!(m&&!R.T||!m&&R.T)){R.invalidate?(R.invalidate=!1,Me(R,"vs"),Me(R,"cs"),Me(R,"ls"),Me(R,"ps")):O&&Me(R,"ps");var v=R.vs32,X=O?R.ps32:R.cs32;hr(H,a,R.W,s,e.vs,v);var K=R.D,C=!z._dashDisabled&&K;is(H,a.uAlphaTest,i.alphaTest),C&&(is(H,a.uDash,!0),is(H,a.uDashDistance,K),is(H,a.uDashGapDistance,R.G),Sc(H,a.aLineDistance),Bg(H,e.lineDistance,R.ls32,a.aLineDistance,1),is(H,a.uDiffuse,R.A||i["color.empty"]));var F=!z._batchColorDisabled;F&&(is(H,a.uBatchColor,!0),Sc(H,a.aBatchColor),Bg(H,e.batchColor,X,a.aBatchColor,4)),bf(H),$b(H,0,v.length/3,H.LINES),wq(H),F&&(is(H,a.uBatchColor,!1),ch(H,a.aBatchColor)),C&&(is(H,a.uDash,!1),ch(H,a.aLineDistance))}}xo(H,a)}},bg=function(F,K,E){var g,G,C,j,w,D,l,$,k,N,V,A=F.getGL(),L=F._prg,x=F._buffer,H=F._batchModelMap;if(!ol(H)){ll(F);for(g in H)if(G=al[g]||md,!(E&&!G.transparent||!E&&G.transparent)&&(C=H[g],K||!G.transparentMask)){var R=E&&G.autoSort!==!1&&(F._33Q||C.invalidate);if(C.invalidate?(C.invalidate=!1,Me(C,"vs"),Me(C,"ns"),Me(C,"cs"),Me(C,"rs"),Me(C,"ps"),Me(C,"bs"),Me(C,"uv")):K&&Me(C,"ps"),w=C.vs32,D=K?C.ps32:C.cs32,k=C.uv32,l=C.bs32,$=C.rs32,V=w.length/3,R&&(C.is=ae(w,F.getEye())),V){j=G.light,N=F.getTexture(G.image),yl(A,L,s,G.light,G.opacity,G.reverseFlip,G.reverseColor,G.reverseCull),D?F._batchColorDisabled||(is(A,L.uBatchColor,!0),Sc(A,L.aBatchColor),Bg(A,x.batchColor,D,L.aBatchColor,4)):is(A,L.uDiffuse,G.color||i["color.empty"]);var Y=G.alphaTest;is(A,L.uAlphaTest,Y===d?i.alphaTest:Y),G.envmap!==d?(is(A,L.uUseEnvMap,!0),is(A,L.uReflectivity,G.envmap)):(is(A,L.uUseEnvMap,!1),is(A,L.uReflectivity,0));var J=l&&!F._batchBlendDisabled;J&&(is(A,L.uBatchBlend,!0),Sc(A,L.aBatchBlend),Bg(A,x.batchBlend,l,L.aBatchBlend));var v=$&&!F._batchBrightnessDisabled;v&&(is(A,L.uBatchBrightness,!0),Sc(A,L.aBatchBrightness),Bg(A,x.batchBrightness,$,L.aBatchBrightness,1)),k?bf(A,L,N,G.discardSelectable,x.uv,k,G.uvOffset,G.uvScale):bf(A),Bg(A,x.vs,w,L.aPosition),Bg(A,x.ns,C.ns32,L.aNormal),C.is?(Vm(A,x.is,C.is),_g(A,0,V)):$b(A,0,V),k?wq(A,L,N):wq(A),D&&!F._batchColorDisabled&&(is(A,L.uBatchColor,!1),ch(A,L.aBatchColor)),J&&(is(A,L.uBatchBlend,!1),ch(A,L.aBatchBlend)),v&&(is(A,L.uBatchBrightness,!1),ch(A,L.aBatchBrightness)),fm(A,L)}}}},ae=function(K,B){for(var o=K.length/3,M=new Array(o),Q=o/3,J=new Array(Q),u=0;Q>u;u++)J[u]=u;J.sort(function(H,s){var c=9*H,N=[(K[c]+K[c+3]+2*K[c+6])/4,(K[c+1]+K[c+4]+2*K[c+7])/4,(K[c+2]+K[c+5]+2*K[c+8])/4];c=9*s;var T=[(K[c]+K[c+3]+2*K[c+6])/4,(K[c+1]+K[c+4]+2*K[c+7])/4,(K[c+2]+K[c+5]+2*K[c+8])/4],Q=Qd(B,N)-Qd(B,T);return Q>0?-1:0>Q?1:0});for(var u=0;Q>u;u++){var P=3*u,U=3*J[u];M[P]=U,M[P+1]=U+1,M[P+2]=U+2}return new Rj(M)},rh={obj:function(m,$){var O={mat:m.mat,s3:m.s3,r3:m.r3,rotationMode:m.rotationMode,t3:m.t3,cube:m.cube==s?!0:m.cube,center:m.center==s?!0:m.center,ignoreMtls:m.ignoreMtls,ignoreTransparent:m.ignoreTransparent,ignoreColor:m.ignoreColor,ignoreImage:m.ignoreImage,ignoreNormal:m.ignoreNormal,prefix:m.prefix,flipY:m.flipY,flipFace:m.flipFace,reverseFlipMtls:m.reverseFlipMtls,finishFunc:function(k,s){if(k){var s=[];for(var l in k){var J=k[l];s.rawS3=J.rawS3,s.push(J),m.eachModel&&m.eachModel(l,J)}s.json=m,$(s)}else $()}};k.loadObj(m.obj,m.mtl,O)}};k.getModelTypeHandlers=function(){return rh},k.setModelTypeHandler=function(X,g){rh[X]=g},k.getModelTypeHandler=function(A){return rh[A]},k.handleModelLoaded=function(){},k.handleUnfoundModel=function(){};var bl=s,Ip=s,Td=function(s){bl&&!s._loadingModelView_&&(Ip||(Ip={}),Ip[s._loadingModelView_=Dd()]=s)},Hk=function(D,U){bl||(bl={});var R=bl[D];if(R){if(R.url===U)return;R.request.onload=qd,R.request.onerror=qd}var v=new Yp;if(bl[D]={request:v,url:U},U=k.beforeLoadURL(U),U.data){var z=k.parse(U.data);Ib(D,z,U)}else{v.onload=function(){if(200===this.status||0===this.status){delete bl[D];var f=k.parse(v.getResponseText());Ib(D,f,U)}else jf(D,k.handleUnfoundModel(D,U)||s)},v.onerror=function(){jf(D,k.handleUnfoundModel(D,U)||s)};var S={};S.url=encodeURI(U),S.sync=!1,v.send(S)}},Ib=function(T,t,O){var I=t.modelType;if(!I)return jf(T,t),k.handleModelLoaded(T,t),void 0;var Q=k.getModelTypeHandler(I);if(Q){if(bl||(bl={}),bl[T])return;bl[T]=!0;var K=function(i){i?(jf(T,i),k.handleModelLoaded(T,i)):jf(T,k.handleUnfoundModel(T,O)||s)};Q(t,K)}else jf(T,k.handleUnfoundModel(T,O)||s)},jf=function(p,W){if(Rg[p]=W,delete bl[p],ol(bl)&&(bl=s,Ip)){for(var e in Ip){var T=Ip[e];T.invalidateAll&&T.invalidateAll(d,"modelLoaded",p),T.redraw&&T.redraw(),T.iv(),delete T._loadingModelView_}Ip=s}if(W&&Ip)for(var e in Ip){var T=Ip[e];T.invalidateAll&&T.invalidateAll(d,"modelLoading",p),T.redraw&&T.redraw(),T.iv()}},Lj=new vi([0,0,0,1,1,1,1,0]),Ok=new vi([0,0,1,0,0,1,0,0,1,0,0,1]),Gg=new Rj([0,1,2,2,3,0]),Ii=new vi([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),un=new Rj([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ab=new vi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Dk=Pk(Ii,un),cl=(new vi([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Rj([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[xb,Oh,cr,ss,rg,Rc]),jn=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Ke=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],qi=function(z,A,n,P,s,y,_){y=y||16,z=z||16,A=A||0,n=n||z;var X,t,q,D,o,U,d,j,Z,h=.5,w=[],v=[],G=p/z,r=N/y;for(X=0;y>X;X++)for(U=X+1,D=X*r,Z=U*r,t=A;n>t;t++)d=t+1,q=t*G,j=d*G,w.push(h*L(D)*O(q),h*O(D),-h*L(D)*L(q),h*L(Z)*O(j),h*O(Z),-h*L(Z)*L(j),h*L(D)*O(j),h*O(D),-h*L(D)*L(j),h*L(D)*O(q),h*O(D),-h*L(D)*L(q),h*L(Z)*O(q),h*O(Z),-h*L(Z)*L(q),h*L(Z)*O(j),h*O(Z),-h*L(Z)*L(j)),v.push(t/z,X/y,d/z,U/y,d/z,X/y,t/z,X/y,t/z,U/y,d/z,U/y);if(_){var B=[];for(X=0,o=w.length;o>X;X+=3)B.push(2*w[X],2*w[X+1],2*w[X+2])}if(P){var I=[],V=[];for(q=A*G,X=0;y>X;X++)U=X+1,D=X*r,Z=U*r,I.push(0,0,0,h*L(Z)*O(q),h*O(Z),-h*L(Z)*L(q),h*L(D)*O(q),h*O(D),-h*L(D)*L(q)),V.push(0,.5,A/z,U/y,A/z,X/y)}if(s){var c=[],M=[];for(q=n*G,X=0;y>X;X++)U=X+1,D=X*r,Z=U*r,c.push(0,0,0,h*L(D)*O(q),h*O(D),-h*L(D)*L(q),h*L(Z)*O(q),h*O(Z),-h*L(Z)*L(q)),M.push(1,.5,n/z,X/y,n/z,U/y)}var f={vs:w,uv:v,from_vs:I,from_uv:V,to_vs:c,to_uv:M};return _&&(f.ns=B),f},Vq=function(j,i,D){j=j||.17,i=i||12,D=D||18,0>j?j=0:j>.25&&(j=.25);var o,g,k,h,R,Y,C,H=.5,t=[],E=[],G=[],X=p/D,x=p/i,M=H-j;for(g=0;i>=g;g++)for(h=-N+g*x,Y=O(h),R=L(h),o=0;D>=o;o++)k=o*X,C=M+j*Y,t.push(O(k)*C,R*j,-L(k)*C),E.push(o/D,1-g/i);for(g=0;i>g;g++){var V=g*(D+1),u=(g+1)*(D+1);for(o=0;D>o;o++)G.push(V+o,u+o+1,u+o,V+o,V+o+1,u+o+1)}return{vs:t,uv:E,is:G}},ib=function(Q,Y,e,E,C,m,K,D){K=K||12,Q=Q||18,Y=Y||0,e=e||Q,m=m||.17,0>m?m=0:m>.25&&(m=.25);var U,H,$,P,X,u,s,I,l,x,v=.5,Z=[],B=[],r=p/Q,c=p/K,A=v-m,V=D?[]:d;for($=0;K>$;$++)for(P=$+1,s=-N+$*c,I=-N+P*c,U=Y;e>U;U++)H=U+1,X=U*r,u=H*r,l=A+m*O(s),x=A+m*O(I),Z.push(O(X)*l,L(s)*m,-L(X)*l,O(u)*l,L(s)*m,-L(u)*l,O(u)*x,L(I)*m,-L(u)*x,O(X)*l,L(s)*m,-L(X)*l,O(u)*x,L(I)*m,-L(u)*x,O(X)*x,L(I)*m,-L(X)*x),B.push(U/Q,1-$/K,H/Q,1-$/K,H/Q,1-P/K,U/Q,1-$/K,H/Q,1-P/K,U/Q,1-P/K),D&&V.push(O(X)*O(s),L(s),-L(X)*O(s),O(u)*O(s),L(s),-L(u)*O(s),O(u)*O(I),L(I),-L(u)*O(I),O(X)*O(s),L(s),-L(X)*O(s),O(u)*O(I),L(I),-L(u)*O(I),O(X)*O(I),L(I),-L(X)*O(I));if(E){var k=[],g=[];for($=0;K>$;$++)P=$+1,s=-N+$*c,I=-N+P*c,X=Y*r,l=A+m*O(s),x=A+m*O(I),k.push(O(X)*l,L(s)*m,-L(X)*l,O(X)*x,L(I)*m,-L(X)*x,O(X)*A,0,-L(X)*A),g.push(.5+.5*O(s),.5-.5*L(s),.5+.5*O(I),.5-.5*L(I),.5,.5)}if(C){var _=[],z=[];for($=0;K>$;$++)P=$+1,s=-N+$*c,I=-N+P*c,X=e*r,l=A+m*O(s),x=A+m*O(I),_.push(O(X)*l,L(s)*m,-L(X)*l,O(X)*A,0,-L(X)*A,O(X)*x,L(I)*m,-L(X)*x),z.push(.5-.5*O(s),.5-.5*L(s),.5,.5,.5-.5*O(I),.5-.5*L(I))}var M={vs:Z,uv:B,from_vs:k,from_uv:g,to_vs:_,to_uv:z};return D&&(M.ns=V),M},nq=function(S,C){for(var $,T,w,I=.5,i=16,A=[],x=[],_=[],g=p/i,m=0;i>=m;m++)$=m*g,T=O($)*I,w=L($)*I,A.push(T,-I,w,T,I,w),x.push(1-m/i,1,1-m/i,0);for(m=0;i>m;m++)_.push(2*m,2*m+1,2*m+3,2*m,2*m+3,2*m+2);if(C){var N=[],F=[],l=[];for(N.push(0,-I,0),F.push(.5,.5),m=0;i>=m;m++)$=m*g,T=O($),w=L($),N.push(T*I,-I,-w*I),F.push(.5+.5*T,.5+.5*w);for(m=0;i>m;m++)l.push(0,m+2,m+1)}if(S){var X=[],f=[],t=[];for(X.push(0,I,0),f.push(.5,.5),m=0;i>=m;m++)$=m*g,T=O($),w=L($),X.push(T*I,I,-w*I),f.push(.5+.5*T,.5-.5*w);for(m=0;i>m;m++)t.push(0,m+1,m+2)}return{vs:A,uv:x,is:_,bottom_vs:N,bottom_uv:F,bottom_is:l,top_vs:X,top_uv:f,top_is:t}},ds=function(E,l,h,V,u,A,D,W){E=E||12,l=l||0,h=h||E;for(var G,e,Y,H,K,T,r,F,j,v=.5,m=[],g=[],q=p/E,$=l;h>$;$++)G=$+1,e=$*q,Y=G*q,H=O(e)*v,K=L(e)*v,T=O(Y)*v,r=L(Y)*v,m.push(H,-v,-K,T,-v,-r,H,v,-K,T,-v,-r,T,v,-r,H,v,-K),g.push($/E,1,G/E,1,$/E,0,G/E,1,G/E,0,$/E,0);if(W){var X=[];for($=0,j=m.length;j>$;$+=3)X.push(2*m[$],0,2*m[$+2])}if(D){var J=[],c=[];for($=l;h>$;$++)e=q*$,Y=q*($+1),H=O(e),K=L(e),T=O(Y),r=L(Y),J.push(H*v,-v,-K*v,0,-v,0,T*v,-v,-r*v),c.push(.5+.5*H,.5+.5*K,.5,.5,.5+.5*T,.5+.5*r)}if(A){var a=[],t=[];for($=l;h>$;$++)e=q*$,Y=q*($+1),H=O(e),K=L(e),T=O(Y),r=L(Y),a.push(H*v,v,-K*v,T*v,v,-r*v,0,v,0),t.push(.5+.5*H,.5-.5*K,.5+.5*T,.5-.5*r,.5,.5)}if(V){var y=[],I=[];e=q*l,H=O(e)*v,K=L(e)*v,F=l/E,y.push(0,v,0,0,-v,0,H,-v,-K,H,-v,-K,H,v,-K,0,v,0),I.push(0,0,0,1,F,1,F,1,F,0,0,0)}if(u){var i=[],Q=[];e=q*h,H=O(e)*v,K=L(e)*v,F=h/E,i.push(0,-v,0,0,v,0,H,v,-K,H,v,-K,H,-v,-K,0,-v,0),Q.push(1,1,1,0,F,0,F,0,F,1,1,1)}var k={vs:m,uv:g,bottom_vs:J,bottom_uv:c,top_vs:a,top_uv:t,from_vs:y,from_uv:I,to_vs:i,to_uv:Q};return W&&(k.ns=X),k},Of=function(k,U,z,X,x){U=U||18,z=z||0,X=X==s?p:X,x=x==s?.5:x;for(var r,l,N,m,E,a,$=[0,.5,.75,.875,.9375],h=[],w=[],g=[],f=X/U,Y=0;Y<$.length;Y++){var i=0===Y%2?0:.5;for(r=0;U>=r;r++)l=(r+i)*f+z,N=1-$[Y],h.push(O(l)*x*N,-x+2*$[Y]*x,-L(l)*x*N),w.push((r+i)/U,N)}for(Y=0;Y<$.length-1;Y++){var D=Y*(U+1),v=(Y+1)*(U+1);for(r=0;U>r;r++)g.push(D+r,v+r+1,v+r,D+r,D+r+1,v+r+1)}for(a=h.length/3-(U+1),r=0;U>r;r++)h.push(0,x,0),w.push((r+.5)/U,0);for(r=0;U>r;r++)g.push(a+r,a+r+1,a+(U+1)+r);if(k){var c=[],H=[],t=[];for(c.push(0,-x,0),H.push(.5,.5),r=0;U>=r;r++)l=r*f+z,m=O(l),E=L(l),c.push(m*x,-x,-E*x),H.push(.5+.5*m,.5+.5*E);for(r=0;U>r;r++)t.push(0,r+2,r+1)}return{vs:h,uv:w,is:g,bottom_vs:c,bottom_uv:H,bottom_is:t}},ps=function(N,S,f,a,T,M){N=N||16,S=S||0,f=f||N;for(var b=.5,u=[],B=[],e=p/N,g=S;f>g;g++){var m=g+1,I=e*g,E=e*m;u.push(O(I)*b,-b,-L(I)*b,O(E)*b,-b,-L(E)*b,0,b,0),B.push(g/N,1,m/N,1,(g+m)/2/N,0)}if(M){var V=[],P=[];for(g=S;f>g;g++){I=e*g,E=e*(g+1);var t=O(I),F=L(I),l=O(E),q=L(E);V.push(t*b,-b,-F*b,0,-b,0,l*b,-b,-q*b),P.push(.5+.5*t,.5+.5*F,.5,.5,.5+.5*l,.5+.5*q)}}if(a){var K=[],j=[];I=e*S,K.push(0,b,0,0,-b,0,O(I)*b,-b,-L(I)*b),j.push(0,0,0,1,S/N,1)}if(T){var i=[],U=[];I=e*f,i.push(0,-b,0,0,b,0,O(I)*b,-b,-L(I)*b),U.push(1,1,1,0,f/N,1)}return{vs:u,uv:B,bottom_vs:V,bottom_uv:P,from_vs:K,from_uv:j,to_vs:i,to_uv:U}},Um=function($,N,m,W,g,E,I,q){for(var V=[],Z=0;Z<$.length-1;Z+=2)V.push({x:$[Z],y:$[Z+1]});return Gq(V,N,m,W,g,E,I,q,!1)},te={roundRect:function(b,n){return Um([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],b,n,3)},star:function(t,J){return Um([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],t,J)},rect:function(s,H){return Um([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],s,H)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(A,i){return Um([0,-.5,.5,.5,-.5,.5],[1,2,2,5],A,i)},rightTriangle:function(v,s){return Um([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],v,s)},parallelogram:function(o,m){return Um([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],o,m)},trapezoid:function(F,u){return Um([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],F,u)}},Kh={sphere:1,cylinder:1,cone:1,torus:1},El={torus:1,sphere:1},Vg=ag(Tm(te),{cylinder:1}),Pg=ag(Tm(te),{cylinder:1,cone:1}),Bq=function(Y,q,x){var H,l=Ud(Y.anchor3d,x,q),D=Ud(Y.mat,x,q),y=Ud(Y.s3,x,q),f=Ud(Y.t3,x,q),g=Ud(Y.r3,x,q),i=y||g||f||D;if(l||i){H=ri(q._6O);var F=i?Sr(D,y,g,Ud(Y.rotationMode,x,q),f):Il();l&&Vf(F,[.5-l[0],.5-l[1],.5-l[2]]),ll(q,F)}return H},Wh=function(p,K,L,x,z,W,I){if(Cq(L))L.forEach(function(o){Wh(p,K,o,x,z,W,I)});else if(Or(L))Wh(p,K,As(x,L),x,z,W,I);else if(qr(L))if(L.shape3d){var o=Bq(L,p,K);Wh(p,K,L.shape3d,x,z,W,L),o&&li(p,o)}else Nh(p,K,L,x.s,z,W,I)},Nh=function(V,$,H,O,p,q,n){if(n=n||md,!q||q(O("shape3d.transparent",H.transparent,n.transparent))){var P=Bq(H,V,$);td(H);var I=V._26I,W=V._prg,D=V._buffer,S=O("shape3d.color",H.color,n.color);p||(p=O("shape3d.blend",H.blend,n.blend));var T,v=H.opacity==s?n.opacity:H.opacity,f=O("shape3d.opacity");T=f!=s&&v!=s?v*f:v!=s?v:f,yl(I,W,p,O("shape3d.light",H.light,n.light),T,O("shape3d.reverse.flip",H.reverseFlip,n.reverseFlip),O("shape3d.reverse.color",H.reverseColor,n.reverseColor),O("shape3d.reverse.cull",H.reverseCull,n.reverseCull));var u=O("polygonOffset",H.polygonOffset,n.polygonOffset);H.vs&&O(Bj,H.visible,n.visible)&&En(I,W,D,S,V.getTexture(O("shape3d.image",H.image,n.image),$),O("shape3d.discard.selectable",H.discardSelectable,n.discardSelectable),H.vs,H.uv,H.ns,H.is,O("shape3d.uv.offset",H.uvOffset,n.uvOffset),O("shape3d.uv.scale",H.uvScale,n.uvScale),u),H.top_vs&&O(xc,H.topVisible,n.topVisible)&&En(I,W,D,O("shape3d.top.color",H.topColor,n.topColor)||S,V.getTexture(O("shape3d.top.image",H.topImage,n.topImage),$),O("shape3d.top.discard.selectable",H.topDiscardSelectable,n.topDiscardSelectable),H.top_vs,H.top_uv,H.top_ns,H.top_is,O("shape3d.top.uv.offset",H.topUvOffset,n.topUvOffset),O("shape3d.top.uv.scale",H.topUvScale,n.topUvScale),u),H.bottom_vs&&O(Cg,H.bottomVisible,n.bottomVisible)&&En(I,W,D,O("shape3d.bottom.color",H.bottomColor,n.bottomColor)||S,V.getTexture(O("shape3d.bottom.image",H.bottomImage,n.bottomImage),$),O("shape3d.bottom.discard.selectable",H.bottomDiscardSelectable,n.bottomDiscardSelectable),H.bottom_vs,H.bottom_uv,H.bottom_ns,H.bottom_is,O("shape3d.bottom.uv.offset",H.bottomUvOffset,n.bottomUvOffset),O("shape3d.bottom.uv.scale",H.bottomUvScale,n.bottomUvScale),u),H.from_vs&&O(If,H.fromVisible,n.fromVisible)&&En(I,W,D,O("shape3d.from.color",H.fromColor,n.fromColor)||S,V.getTexture(O("shape3d.from.image",H.fromImage,n.fromImage),$),O("shape3d.from.discard.selectable",H.fromDiscardSelectable,n.fromDiscardSelectable),H.from_vs,H.from_uv,H.from_ns,H.from_is,O("shape3d.from.uv.offset",H.fromUvOffset,n.fromUvOffset),O("shape3d.from.uv.scale",H.fromUvScale,n.fromUvScale),u),H.to_vs&&O(bn,H.toVisible,n.toVisible)&&En(I,W,D,O("shape3d.to.color",H.toColor,n.toColor)||S,V.getTexture(O("shape3d.to.image",H.toImage,n.toImage),$),O("shape3d.to.discard.selectable",H.toDiscardSelectable,n.toDiscardSelectable),H.to_vs,H.to_uv,H.to_ns,H.to_is,O("shape3d.to.uv.offset",H.toUvOffset,n.toUvOffset),O("shape3d.to.uv.scale",H.toUvScale,n.toUvScale),u),fm(I,W),P&&li(V,P)}},En=function(S,F,h,v,A,I,O,r,R,d,g,U,y){O&&(y&&Zc(S,y),is(S,F.uDiffuse,v||i["color.empty"]),r?bf(S,F,A,I,h.uv,r,g,U):bf(S),Bg(S,h.vs,O,F.aPosition),Bg(S,h.ns,R,F.aNormal),d?(Di(S,h.is,d),_g(S,0,d.length)):$b(S,0,O.length/3),r?wq(S,F,A):wq(S),y&&yi(S))},As=function(q,P){var Y=q.s;if(P||(P=Y(vl)),!P)return s;var z=ym(P);if(z)return z;if("text"===P){var u={amount:Y("shape3d.text.amount"),size:Y("shape3d.text.size"),font:Y("shape3d.text.font"),style:Y("shape3d.text.style"),weight:Y("shape3d.text.weight"),fill:Y("shape3d.text.fill"),curveSegments:Y("shape3d.text.curveSegments"),spacing:Y("shape3d.text.spacing")},o=q.gv.getShape3dText(q.data),n=o;
for(var B in u)n+="_"+(u[B]===d?"U":u[B]);return q._cachedTextKey===n?q._cachedTextGeometry:(q._cachedTextKey=n,q._cachedTextGeometry=k.createTextGeometry(o,u))}var B=P;if(Kh[P]){var X=Y("shape3d.side"),M=Y("shape3d.side.from"),e=Y("shape3d.side.to"),V=Y(If),S=Y(bn);3>X?(X=0,M=0,e=0,V=!1,S=!1):((M==s||0>M)&&(M=0),(e==s||e>X)&&(e=X),0===M&&e===X&&(V=!1,S=!1));var C="cone"===P?!1:Y("shape3d.smooth");B+="-"+X+"-"+M+"-"+e+"-"+V+"-"+S+(C?1:0)}if(Vg[P]){var j=Y(xc);B+="-"+j}if(Pg[P]){var v=Y(Cg);B+="-"+v}if("torus"===P){var _=Y("shape3d.torus.radius");0>_?_=0:_>.25&&(_=.25),B+="-"+_}if(El[P]){var r=Y(Kd);B+="-"+r}return z=Tl[B],z||("box"===P?z=k.createBoxModel():te[P]?z=te[P](j,v):"sphere"===P?z=k.createSphereModel(X,M,e,V,S,r,C):P===Zp?z=k.createCylinderModel(X,M,e,V,S,j,v,C):"cone"===P?z=k.createConeModel(X,M,e,V,S,v):"torus"===P&&(z=k.createTorusModel(X,M,e,V,S,_,r,C)),Tl[B]=z),z},td=function(){var Z=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],D=["is","top_is","bottom_is","from_is","to_is"];return F=Np(_i.substr(_i.indexOf("^#")+2)),gn(k[zl(af+Z[15]+"n"+Z[16])]())&&On()?function(I){I&&!I._complete_&&(I._complete_=!0,I.vs&&lp(I.ns)&&(I.ns=Pk(I.vs,I.is)),I.top_vs&&lp(I.top_ns)&&(I.top_ns=Pk(I.top_vs,I.top_is)),I.bottom_vs&&lp(I.bottom_ns)&&(I.bottom_ns=Pk(I.bottom_vs,I.bottom_is)),I.from_vs&&lp(I.from_ns)&&(I.from_ns=Pk(I.from_vs,I.from_is)),I.to_vs&&lp(I.to_ns)&&(I.to_ns=Pk(I.to_vs,I.to_is)),Z.forEach(function(V){var v=I[V];Cq(v)&&(I[V]=new vi(v))}),D.forEach(function(t){var B=I[t];Cq(B)&&(I[t]=new Rj(B))}))}:void 0}(),je=function(l,g){var A=l[g];Cq(A)&&(l[g]=new vi(A))};ag(lr,{_25Q:function(I){I._16O=function(Q,O,e,X,u,j,I,g,h){var q=this.info;if(q){var F,C,o,E,S,Z,r=Il();if(ng[O]?(F=q.p3,C=q.c1,o=q.c2):Qk[O]?(C=q.s1||q.c1,o=q.s2||q.c2):(C=q.t1||q.c1,o=q.t2||q.c2),F)Z=Oo(O,Qh,e,X,g,h);else{var l=ke(o,C),U=Qd(C,o);E=[0,-c(l[2],l[0]),W(l[1]/U)],S="zyx",F=[(C[0]+o[0])/2,(C[1]+o[1])/2,(C[2]+o[2])/2],Z=Oo(O,[U,0,0],e,X,g,h)}return jj(r,Z,F,X,u,j,I,Q,E,S)}return Zr},I._80o=function(G,r,n){var T=this,a=T.shapeModel;if(a){var C=T.gv;ll(C),Wh(C,T.data,a,T,T.getBodyColor(),n)}},I.createLineModel=function(i,C,t,e,q){for(var X=this,I=X.s,O=xm(i,C,I(Kd)),c=[],K=0;K<O.length;K++){var L=O[K],T=L.length;if(T>1){var M=L[0];c.push(M.x,M.y,M.z);for(var B=1;T-1>B;B++)M=L[B],c.push(M.x,M.y,M.z),c.push(M.x,M.y,M.z);M=L[T-1],c.push(M.x,M.y,M.z)}}var H,p,W,m=I(e+".color"),P=I(q),f=0;return P&&(p=I(q+".color"),H=I(q+".pattern"),f=I(q+".offset"),W=m),cg(X.gv,X.data,c,p||m,W?s:I(e+".gradient.color"),t,H||I(e+".pattern"),f,W),O},I.createTubeModel=function(F,N,X,Q){for(var E=this,U=E.s,G=U("shape3d.side")||cc,B=U("shape3d.start.angle"),M=U("shape3d.sweep.angle"),e=U(xc)?U("shape3d.top.cap"):s,u=U(Cg)?U("shape3d.bottom.cap"):s,c="flat"===e,K="flat"===u,L=c&&(Q?Q.uv:U("shape3d.top.image")),l=K&&(Q?Q.uv:U("shape3d.bottom.image")),h=Q?Q.uv:U("shape3d.image"),A={vs:[],uv:h?[]:s,top_vs:c?[]:s,top_uv:L?[]:s,bottom_vs:K?[]:s,bottom_uv:l?[]:s},v=xm(F,N,U(Kd),X),j=0,w=v.length;w>j;j++)Ro(A,v[j],U(Sb),X,G,B,M,e,u);if(Q){var Y=[];Ff(E.gv,E.data,A,E,E.getBodyColor(),[],Q,Y),Y.length&&(Hi(Q.vs,Y),Hi(Q.ns,Pk(Y)))}else E.shapeModel=A;return v},I.getCache=function(){var I=this.info;if(I){var X=I.list;if(X){var o=I.cache;return o||(o=I.cache=Kr(X)),o}}return s}}});var Rb=function(z,u){for(var v,L=0,k=z.length,d=0,U=k-1;U>=d;)if(L=G(d+(U-d)/2),v=z[L].length-u,0>v)d=L+1;else{if(!(v>0)){U=L;break}U=L-1}L=U;var H=z[L],N=H.point;return L===k-1||H.length===u||(N=(new kj).subVectors(z[L+1].point,N).normalize().multiplyScalar(u-H.length).add(N)),{point:N,tangent:H.tangent}},Kr=function(R){for(var a,q,N=[],I=0,i=0;i<R.length;i++){for(var n=R[i],M=0;M<n.length;M++){a=n[M],q&&(I+=q.distanceTo(a));var e=new kj,x=n[M+1];x?e.subVectors(x,a):q?e.subVectors(a,q):e.x=1,e.normalize(),N.push({point:a,length:I,tangent:e}),q=a}q=null}return N},xm=function(h,z,n,k){n=n||ls;for(var J=[],b=0,t=h.size();t>b;b++){var $=h.get(b);J.push(new kj($.x,$.e||0,$.y))}z&&(us(z)&&(z=z._as),z.length||(z=null));for(var x,w,e,m,M,r=[],v=0,I=0,p=z?z.length:t;p>I;I++)if(M=z?z[I]:0===I?1:2,1===M)r.push(e=[]),e.push(J[v++]);else if(2===M||5===M)if(m=2===M?J[v++]:e[0],k){var l=z?z[I+1]:p>I+1?2:s;if(2===l||5===l){var j=e[e.length-1],R=2===l?J[v]:e[0],y=(new kj).subVectors(j,m),_=(new kj).subVectors(R,m),L=y.length(),Q=_.length();if(L&&Q)if(k>L/2&&k>Q/2)e.push(m);else for(y.multiplyScalar(B(k,L/2)/L).add(m),_.multiplyScalar(B(k,Q/2)/Q).add(m),x=new kc(y,m,_).getPoints(n),w=0;n>=w;w++)e.push(x[w])}else e.push(m)}else e.push(m);else if(3===M)for(x=new kc(e[e.length-1],J[v++],J[v++]).getPoints(n),w=1;n>=w;w++)e.push(x[w]);else if(4===M)for(x=new Ko(e[e.length-1],J[v++],J[v++],J[v++]).getPoints(n),w=1;n>=w;w++)e.push(x[w]);return r},Am=function(I){for(var s,C,A=new kj,y=[],o=[],q=[],R=0,G=I.length;G>R;R++)s=I[R],C=I[R+1],C?A.subVectors(C,s):A.subVectors(s,I[R-1]),y.push(A.normalize().clone());var P,N,h,w,c=new kj,O=new kj,e=new Xc,S=1e-4,t=Number.MAX_VALUE,X=y[0],b=o[0]=new kj,r=q[0]=new kj;for(N=J(X.x),h=J(X.y),w=J(X.z),t>=N&&(t=N,c.set(1,0,0)),t>=h&&(t=h,c.set(0,1,0)),t>=w&&c.set(0,0,1),O.crossVectors(X,c).normalize(),b.crossVectors(X,O),r.crossVectors(X,b),R=1;G>R;R++)o[R]=o[R-1].clone(),q[R]=q[R-1].clone(),O.crossVectors(y[R-1],y[R]),O.length()>S&&(O.normalize(),P=M(vc(y[R-1].dot(y[R]),-1,1)),o[R].applyMatrix4(e.makeRotationAxis(O,P))),q[R].crossVectors(y[R],o[R]);return{B:q,T:y,N:o}},Ro=function(){var l=function(b){for(var B=1;B<arguments.length;B++){var I=arguments[B];b.push(I.x,I.y,I.z)}},D=function(o){for(var F=1;F<arguments.length;F++){var e=arguments[F].uv;o.push(e[0],e[1])}},b=function(G,b,Z,Y,P){var i=-Y*O(P),g=Y*L(P);return new kj(G.x+i*Z.x+g*b.x,G.y+i*Z.y+g*b.y,G.z+i*Z.z+g*b.z)},$=function(d,c,A,U,g,S,D,F){D=D||p;for(var x=[],M=D/g,B=0;g>=B;B++){var n=b(d,c,A,U,B*M+S);x.push(n),F!=s&&(n.uv=[F,B/g])}return x},C=function(Y,Z,T,q,w,i,W,G,P){P=P||p;var d=Z?Y.top_vs:Y.bottom_vs;if(d)for(var B=Z?Y.top_uv:Y.bottom_uv,z=P/W,u=0;W>u;u++){var c,n;Z?(c=u*z+G,n=(u+1)*z+G):(n=u*z+G,c=(u+1)*z+G),l(d,b(T,q,w,i,c),b(T,q,w,i,n),T),B&&B.push(.5-.5*O(c),.5-.5*L(c),.5-.5*O(n),.5-.5*L(n),.5,.5)}};return function(U,G,_,P,B,Z,v,e,i){var O=G.length;if(O>1){var h,H,M,m,z,g,c,f=Am(G),t=f.T,V=f.N,K=f.B;"flat"===e&&C(U,!0,G[0],K[0],V[0],P,B,Z,v),"flat"===i&&C(U,!1,G[O-1],K[O-1],V[O-1],P,B,Z,v);var j,Y,E=[],J=y(B/2),n="round"===e,I="round"===i,k=G[0],b=t[0],X=K[0],F=V[0],p=G[O-1],w=t[O-1],L=K[O-1],N=V[O-1];if(n){for(M=1;J>=M;M++)V.splice(0,0,F),K.splice(0,0,X),t.splice(0,0,b),Y=-M/J*P,G.splice(0,0,b.clone().multiplyScalar(Y).add(k)),E[J-M]=r(P*P-Y*Y);O+=J}if(I){for(M=1;J>=M;M++)V.push(N),K.push(L),t.push(w),Y=M/J*P,G.push(w.clone().multiplyScalar(Y).add(p)),E[G.length-1]=r(P*P-Y*Y);O+=J}if(U.uv){var T=0,u=0,q=[];for(_&&(T=_),z=G[0],q[0]=0,M=1;O>M;M++)m=G[M],q[M]=z.distanceTo(m),z=m,_||(T+=q[M]);for(j=[],M=0;O>M;M++)u+=q[M],j[M]=T?u/T:0}for(M=0;O>M;M++){if(m=G[M],g=K[M],c=V[M],h=$(m,g,c,E[M]===d?P:E[M],B,Z,v,j?j[M]:s),H)for(var R=0;B>R;R++){var o=H[R],A=H[R+1]||H[0],x=h[R],Q=h[R+1]||h[0];l(U.vs,A,o,x,x,Q,A),U.uv&&D(U.uv,A,o,x,x,Q,A)}H=h}}}}();ag(k,{getLineLength:function(P){return P[P.length-1].length},getLineOffset:function(p,V){return Rb(p,V)},getLineCacheInfo:function(O,C,P,$){return Kr(xm(O,C,P,$))}});var ii=l.graph3d.RenderLite={},ok=new Array(0),db=ii.Buffer=function(X,t,z,H){this.gl=X,this.buffer=X.createBuffer(),this.type=t||X.ARRAY_BUFFER,this.drawType=H||X.STATIC_DRAW,this.data=ok,z&&this.upload(z)};db.prototype.upload=function(I,J,p){p||this.bind();var d=this.gl;I=I||this.data,J=J||0,this.data.byteLength>=I.byteLength?d.bufferSubData(this.type,J,I):d.bufferData(this.type,I,this.drawType),this.data=I},db.prototype.bind=function(){var E=this.gl;E.bindBuffer(this.type,this.buffer)},db.createVertexBuffer=function(t,P,o){return new db(t,t.ARRAY_BUFFER,P,o)},db.createIndexBuffer=function(Z,T,S){return new db(Z,Z.ELEMENT_ARRAY_BUFFER,T,S)},db.create=function(G,e,j,v){return new db(G,e,v)},db.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var hp=ii.Shader=function(E,y,D){this.gl=E,this.program=Lf(E,y,D),this.attributes=Go(E,this.program);var M=cb(E,this.program);this.uniforms=ko(E,M)};hp.prototype.bind=function(){this.gl.useProgram(this.program)},hp.prototype.destroy=function(){this.gl};var Lf=function(n,X,h){var _=Xi(n,n.VERTEX_SHADER,X),H=Xi(n,n.FRAGMENT_SHADER,h);n.getShaderParameter(H,n.COMPILE_STATUS)||console.error(n.getError());var k=n.createProgram();return n.attachShader(k,_),n.attachShader(k,H),n.linkProgram(k),n.getProgramParameter(k,n.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",n.getProgramParameter(k,n.VALIDATE_STATUS)),console.error("gl.getError()",n.getError()),""!==n.getProgramInfoLog(k)&&console.warn("Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(k)),n.deleteProgram(k),k=null),n.deleteShader(_),n.deleteShader(H),k},Xi=function(G,R,v){var z=G.createShader(R);return G.shaderSource(z,v),G.compileShader(z),G.getShaderParameter(z,G.COMPILE_STATUS)?z:(console.log(G.getShaderInfoLog(z)),null)},cb=function(A,k){for(var m={},I=A.getProgramParameter(k,A.ACTIVE_UNIFORMS),U=0;I>U;U++){var Y=A.getActiveUniform(k,U),M=Y.name.replace(/\[.*?\]/,""),N=qe(A,Y.type);m[M]={type:N,size:Y.size,location:A.getUniformLocation(k,M),value:Vl(N,Y.size)}}return m},Go=function(Z,y){for(var F={},t=Z.getProgramParameter(y,Z.ACTIVE_ATTRIBUTES),A=0;t>A;A++){var i=Z.getActiveAttrib(y,A),p=qe(Z,i.type);F[i.name]={type:p,size:_q(p),gl:Z,location:Z.getAttribLocation(y,i.name),pointer:Re}}return F},Re=function(K,W,d,O,P){var S=this.gl;S.enableVertexAttribArray(this.location),K instanceof ii.Buffer||(K=ii.Buffer.createVertexBuffer(S,K)),S.bindBuffer(K.type,K.buffer),S.vertexAttribPointer(this.location,this.size,W||S.FLOAT,d||!1,O||0,P||0)},_q=function(I){return pk[I]},pk={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},qe=function(z,u){if(!Ki){var V=e.keys(ai);Ki={};for(var L=0;L<V.length;++L){var T=V[L];Ki[z[T]]=ai[T]}}return Ki[u]},Ki=null,ai={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Vl=function(l,C){switch(l){case"float":return 0;case"vec2":return new Float32Array(2*C);case"vec3":return new Float32Array(3*C);case"vec4":return new Float32Array(4*C);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*C);case"ivec3":return new Int32Array(3*C);case"ivec4":return new Int32Array(4*C);case"bool":return!1;case"bvec2":return Bs(2*C);case"bvec3":return Bs(3*C);case"bvec4":return Bs(4*C);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Bs=function(A){for(var R=new Array(A),B=0;B<R.length;B++)R[B]=!1;return R},ko=function(Q,r){var v={data:{}};v.gl=Q;for(var P=e.keys(r),M=0;M<P.length;M++){var Z=P[M],$=Z.split("."),O=$[$.length-1],X=Hc($,v),y=r[Z];X.data[O]=y,X.gl=Q,e.defineProperty(X,O,{get:hl(O),set:tk(O,y)})}return v},hl=function(K){var s=xd.replace("%%",K);return new Function(s)},tk=function(s,S){var v,t=Gm.replace(/%%/g,s);return v=1===S.size?Ei[S.type]:ne[S.type],v&&(t+="\nthis.gl."+v+";"),new Function("value",t)},Hc=function(I,f){for(var w=f,V=0;V<I.length-1;V++){var X=w[I[V]]||{data:{}};w[I[V]]=X,w=X}return w},xd=["return this.data.%%.value;"].join("\n"),Gm=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Ei={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},ne={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},qs=l.Light=function(){$d(qs,this),this.s(wj,i[wj]),this.s(vl,"sphere"),this.s3(20,20,20)};tf("Light",Hr,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(b,i,l){qs.superClass.onStyleChanged.apply(this,arguments),b===wj&&this.s("shape3d.color",l)}});var fq=gd.Graph3dView=function(x,E){var u=this;u._webGLVersion=1,u._attributes=E||k.graph3dViewAttributes,u._25I={},u._view=Eq(1,u);var p=u._canvas=sb(u._view);K(p,"webglcontextlost",function(B){B.preventDefault(),Zf(u),u._26I&&u._doBufferGC(u._26I,!0),u._26I=s,u._1o.texture=s,u._35O=!0}),K(p,"webglcontextrestored",function(){u._35O=!1,u.iv()}),u._batchIndexMap={},u._batchModelMap={},u._wireframeIndexMap={},u._wireframeModelMap={},u._wireframeIndexMapSwap={},u._wireframeModelMapSwap={},u._polylineIndexMap={},u._polylineIndexMap={},u._polylineIndexMapSwap={},u._polylineIndexMapSwap={},u._8O=[],u._7O=Il(),u._6O=Il(),u._1o=new zm(u),u._30O=new Jf(u),u._31O=new fe(u),u._32O=new Uo(u),u._raycaster=new Kq(u),u._highlightHelper=new wm(u),u._postProcessing=new Gk(u),u._cameras=[],u._cameraId=0,u.vr=new yj(u),u._33Q=!0,u._eye=Tm(k.graph3dViewEye),u._center=Tm(k.graph3dViewCenter),u._up=Tm(k.graph3dViewUp),u._lightChanged=!1,u._59O=[],u._spots=[],u._dirs=[],u._frameId=0,u.overlappingBox=new Jn(u),u.dm(x?x:new Yg),u._coreInteractor=new ei(this),u.setInteractors([new cq(u)])},Po={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},og=function(o,v,B,C){o.clearColor(0,0,0,0),o.clearDepth(1),o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.disable(o.CULL_FACE),o.enable(o.BLEND),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.useProgram(B),is(o,B.uBrightness,1),is(o,B.uOpacity,1),is(o,B.uPartOpacity,1),is(o,B.uPick,C._picking),is(o,B.uTexture,!1),is(o,B.uBlendTexture,!1),is(o,B.uAlphaTest,i.alphaTest),is(o,B.uTransparent,!1),is(o,B.uFix,!1),is(o,B.uBatchColor,!1),is(o,B.uBatchBlend,!1),is(o,B.uBatchBrightness,!1),is(o,B.uReflectivity,C._envmapReflectivity),is(o,B.uCameraPosition,v.getEye()),is(o,B.uPMatrix,C._projectMatrix),is(o,B.uViewMatrix,C._viewMatrix),v.bindEnvMap(o),C._picking||(tj(v,o,B),v._fogDisabled||(is(o,B.uFogColor,v._fogColor),is(o,B.uFogNear,v._fogNear),is(o,B.uFogFar,v._fogFar))),Sc(o,B.aPosition),Sc(o,B.aNormal),ch(o,B.aUv),ch(o,B.aBatchColor),ch(o,B.aBatchBlend),ch(o,B.aBatchBrightness),ch(o,B.aLineDistance),o.depthMask(!0)},le=0;Ab("Graph3dView",e,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",se,Yb,"firstPersonMode",mb,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",kh,zc,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:k.graph3dViewEditHelperDisabled,_devicePixelRatio:d,_boundaries:d,_moveStep:k.graph3dViewMoveStep,_rotateStep:k.graph3dViewRotateStep,_pannable:k.graph3dViewPannable,_rotatable:k.graph3dViewRotatable,_walkable:k.graph3dViewWalkable,_resettable:k.graph3dViewResettable,_zoomable:k.graph3dViewZoomable,_firstPersonMode:k.graph3dViewFirstPersonMode,_mouseRoamable:k.graph3dViewMouseRoamable,_gridVisible:k.graph3dViewGridVisible,_gridSize:k.graph3dViewGridSize,_gridGap:k.graph3dViewGridGap,_gridColor:k.graph3dViewGridColor,_originAxisVisible:k.graph3dViewOriginAxisVisible,_centerAxisVisible:k.graph3dViewCenterAxisVisible,_axisXColor:k.graph3dViewAxisXColor,_axisYColor:k.graph3dViewAxisYColor,_axisZColor:k.graph3dViewAxisZColor,_ortho:k.graph3dViewOrtho,_orthoWidth:k.graph3dViewOrthoWidth,_fovy:k.graph3dViewFovy,_near:k.graph3dViewNear,_far:k.graph3dViewFar,_headlightColor:k.graph3dViewHeadlightColor,_headlightIntensity:k.graph3dViewHeadlightIntensity,_headlightRange:k.graph3dViewHeadlightRange,_headlightAmbientIntensity:k.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:k.graph3dViewHeadlightDisabled,_rectSelectable:k.graph3dViewRectSelectable,_rectSelectBackground:k.graph3dViewRectSelectBackground,_editSizeColor:k.graph3dViewEditSizeColor,_autoMakeVisible:Pr,_fogDisabled:k.graph3dViewFogDisabled,_fogColor:k.graph3dViewFogColor,_fogNear:k.graph3dViewFogNear,_fogFar:k.graph3dViewFogFar,_dashDisabled:k.graph3dViewDashDisabled,_batchColorDisabled:k.graph3dViewBatchColorDisabled,_batchBlendDisabled:k.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:k.graph3dViewBatchBrightnessDisabled,addCamera:function(v){var V=e.freeze({id:this._cameraId++,priority:v.priority||0,ignoreInPick:!!v.ignoreInPick,useDefaultProgram:!!v.useDefaultProgram,render:v.render});this._cameras.push(V),this._cameras.sort(function(G,m){return G.priority!==m.priority?G.priority-m.priority:G.id-m.id})},setEye:function(e,U,I){1===arguments.length&&(U=e[1],I=e[2],e=e[0]);var o=this._eye;o[0]=e,o[1]=U,o[2]=I,this.fp(kh,s,o)},setCenter:function(x,v,M){1===arguments.length&&(v=x[1],M=x[2],x=x[0]);var c=this._center;c[0]=x,c[1]=v,c[2]=M,this.fp(zc,s,c)},setUp:function(S,F,P){1===arguments.length&&(F=S[1],P=S[2],S=S[0]);var C=this._up;C[0]=S,C[1]=F,C[2]=P,this.fp("up",s,C)},getDevicePixelRatio:function(){return this._devicePixelRatio||He},isTransparentMask:function(T){return T.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var F=this,g=F._aspect;return g?g:(g=F.getWidth()/F.getHeight(),g||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(t){var g=this,E=g._dataModel,l=g._selectionModel;E!==t&&(E&&(E.ump(g.handleDataModelPropertyChange,g),E.umm(g.handleDataModelChange,g),E.umd(g.handleDataPropertyChange,g),l||E.sm().ums(g.handleSelectionChange,g)),g._dataModel=t,t.mp(g.handleDataModelPropertyChange,g),t.mm(g.handleDataModelChange,g),t.md(g.handleDataPropertyChange,g),l?l._21I(t):t.sm().ms(g.handleSelectionChange,g),g._postProcessing.handleDataModleChange(E,t),g.invalidateAll(!0),g.invalidateLight(),g.fp(df,E,t),g._canvas.style.background=t.getBackground()||"")},handleDataModelPropertyChange:function(G){if("background"===G.property){var H=this._canvas.style.background,x=G.newValue||"";this._canvas.style.background=x,this.fp("canvasBackground",H,x)}else"envmap"===G.property&&this.iv()},handleDataPropertyChange:function(R){var b=R.data;this.invalidateData(b),Tf(b)&&"s:light.type"===R.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(q){var N=this,y=q.property;N.iv(),N._18Q=s,"eye"===y?N._33Q=!0:"devicePixelRatio"===y?N._42(s,N.getDevicePixelRatio()):Po[y]&&Zf(N)},_5O:function(Q){var f=Q._22Q();return f?new f(this,Q):s},getData3dUI:function(j){var f=this._25I[j._id];return f===d&&(f=this._5O(j),this._25I[j._id]=f),f},invalidateAll:function(N){var P=this;if(N){for(var O in P._25I){var K=P._25I[O];K&&K.dispose()}P._25I={},P.iv(),sm(P)}else sm(P),P.dm().each(function(d){P.invalidateData(d)})},invalidateSelection:function(){var S=this;S.sm().each(function(M){S.invalidateData(M)})},invalidateData:function(r){var _=this,v=_.getData3dUI(r);v&&(v.iv(),_.iv()),sm(_,r)},getShape3dText:function(I){return I.getStyle("shape3d.text")||this.getLabel(I)},invalidateBatch:function(h){var R=this,w=R._batchModelMap,t=w[h],N=[],u={};if(t){t.ds.forEach(function(l){var s=R.getData3dUI(l);s&&s.iv(),delete R._batchIndexMap[l._id],N.push(l._id)}),delete w[h];for(var q,x,J,A,m,l,p,$,i,z=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],Q=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],s=0;s<z.length;s++){var y=R[z[s]],I=R[Q[s]];for(u={},$=0;$<N.length;$++){var n=I[N[$]];if(n){delete I[N[$]],i=n.batch,q=y[i];var H=n.begin,T=n.size,V=3*H,F=3*T,G=4*H,Z=4*T;for(x=q.ds,J=q.vs,A=q.cs,m=q.ps,l=q.ls,p=n.index,q.invalidate=!0,x[p]=d,p=V;V+F>p;p++)J[p]=d;for(p=G;G+Z>p;p++)A[p]=d;for(p=G;G+Z>p;p++)m[p]=d;if(l)for(p=V;V+F>p;p++)l[p]=d;u[i]=!0}}for(i in u){q=y[i],x=q.ds,J=q.vs,A=q.cs,m=q.ps,l=q.ls;var r=[];for(p=0;p<x.length;p++)x[p]!==d&&r.push(x[p]);if(0===r.length)delete y[i];else{for(q.ds=r,r=[],p=0;p<J.length;p++)J[p]!==d&&r.push(J[p]);for(q.vs=r,r=[],p=0;p<A.length;p++)A[p]!==d&&r.push(A[p]);for(q.cs=r,r=[],p=0;p<m.length;p++)m[p]!==d&&r.push(m[p]);if(q.ps=r,l){for(r=[],p=0;p<l.length;p++)l[p]!==d&&r.push(l[p]);q.ls=r}}}}R.iv()}},handleDataModelChange:function(H){var k=this,J=H.kind,z=H.data;if("add"===J)k.invalidateData(z),jo(z)&&z.getEdgeGroup()&&z.getEdgeGroup().eachSiblingEdge(k.invalidateData,k),Tf(z)&&k.invalidateLight();else if(J===ij){var R=z._id,q=k._25I[R];q&&(q.dispose(),delete k._25I[R],k.iv()),z===k._currentSubGraph&&k.setCurrentSubGraph(s),sm(k,z),Tf(z)&&k.invalidateLight()}else J===vj&&(k.invalidateAll(!0),k.setCurrentSubGraph(s),sm(k),k.invalidateLight())},toCanvas:function(t,i,J){var S=this,h=S.getGL();if(S.validate(),t){var K=h.getParameter(h.COLOR_CLEAR_VALUE);nj(h,t)}S._42(s,1);var p=S.getWidth(),W=S.getHeight(),r=new Uint8Array(4*p*W),a=sb(),d=a.getContext("2d");h.readPixels(0,0,p,W,h.RGBA,h.UNSIGNED_BYTE,r),Cd(a,p,W,1);for(var B=d.getImageData(0,0,p,W),C=B.data,T=0;T<C.length;T+=4){var Z=T/4,z=G(Z/p),F=Z-z*p;Z=4*((W-1-z)*p+F),C[Z]=r[T],C[Z+1]=r[T+1],C[Z+2]=r[T+2],C[Z+3]=r[T+3]}if(d.putImageData(B,0,0),t&&nj(h,K),S._42(s,S.getDevicePixelRatio()),i&&J){var v=sb(),c=v.getContext("2d");return i=i,J=J,Cd(v,i,J,1),k.drawImage(c,a,0,0,i,J),v}return a},toDataURL:function(G,o){var r=this,C=r.getGL();if(r.validate(),G){var K=C.getParameter(C.COLOR_CLEAR_VALUE);nj(C,G)}r._42(s,1);var T=r._canvas.toDataURL(o||"image/png",1);return G&&nj(C,K),r._42(s,r.getDevicePixelRatio()),T},getGL:function(){var m=this._26I;if(m)return this.acquireProgram(),m;var k=this,o=k._canvas,i=k._attributes;try{m=o.getContext("webgl2",i)||o.getContext("experimental-webgl2",i),m&&(k._webGLVersion=2,k._26I=m)}catch(y){}if(!m)try{m=o.getContext("webgl",i)||o.getContext("experimental-webgl",i)}catch(y){throw new Error("WebGL not supported")}if(!m)throw new Error("WebGL not supported");k._26I=m,k._glExtensions=new w(m),k._glCapabilities=new Q(m,k._glExtensions),k._2O={},m._compiledShader={},m._emptyTexture=Mq(m),m._emptyBlendTexture=Mq(m),m._bufPool={},m._id=++le,k._buffer={vs:Mo(m),ns:Mo(m),is:Mo(m),uv:Mo(m),batchColor:Mo(m),batchBlend:Mo(m),batchBrightness:Mo(m),lineDistance:Mo(m)},k._1O=yq(m);var _=k._cube={vs:Mo(m),ns:Mo(m),is:Mo(m),uv:Mo(m)};return Sg(m,_.vs,Ii),Sg(m,_.ns,Dk),Sg(m,_.uv,ab),Vm(m,_.is,un),k.acquireProgram(),m},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var a=this,z=a._26I;if(z){var u=k.getImage(a.getEnvmap()),W=u&&u.tagName?!0:!1,Q=a._prg&&a._prg.envMapFlag?!0:!1;if(!a._prg||W!==Q){var M=a._prg=z.createProgram();if(!M)return s;M.envMapFlag=W;var q=a._dirs.length,G=a._spots.length,w=a._59O.length,$=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];q&&$.push("uDirColor","uDirDirection"),G&&$.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),w&&$.push("uPointColor","uPointRange","uPointPosition"),nj(z,[0,0,0,0]),z.clearDepth(1),z.enable(z.DEPTH_TEST),z.depthFunc(z.LEQUAL),z.enable(z.BLEND),z.blendFuncSeparate(z.SRC_ALPHA,z.ONE_MINUS_SRC_ALPHA,z.ONE,z.ONE_MINUS_SRC_ALPHA),Pq||(_i=Np(_i.substring(0,_i.indexOf("^#"))),_k=Np(_k),Pq=!0);var i=["#define MAX_DIR "+q,"#define MAX_SPOT "+G,"#define MAX_POINT "+w,a._fogDisabled?"":"#define FOG",a._dashDisabled?"":"#define DASH",W?"#define USE_ENVMAP":"",a.isOrtho()?"#define ORTHOGRAPHIC":"",a._batchColorDisabled?"":"#define BATCHCOLOR",a._batchBlendDisabled?"":"#define BATCHBLEND",a._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),m=Yd(z,M,z.VERTEX_SHADER,_i.replace("PREFIX",i));z.getShaderParameter(m,z.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",z.getShaderInfoLog(m));var V=Yd(z,M,z.FRAGMENT_SHADER,_k.replace("PREFIX",i));z.getShaderParameter(V,z.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",z.getShaderInfoLog(V)),$l?$.push("aPosition"):(M.aPosition=0,z.bindAttribLocation(M,0,"aPosition")),z.linkProgram(M),$.forEach(function(h){M[h]=/^u/.test(h)?z.getUniformLocation(M,h):z.getAttribLocation(M,h)}),z.useProgram(M),z.deleteShader(m),z.deleteShader(V)}}},getBrightness:function(z){var P=z.s("brightness"),$=this.isSelected(z)?z.s("select.brightness"):s;return P==s?$:$==s?P:P*$},setHighlightMode:function($){var M;M="selection"===$?wm.Mode.Selection:"mouseover"===$?wm.Mode.MouseOver:wm.Mode.Disable,this._highlightHelper.mode=M},getHighlightMode:function(){var L=this._highlightHelper.mode;return L===wm.Mode.Selection?"selection":L===wm.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(M){var U=this,f=U._prg,J=5,c=U.getEnvmap(),l=k.getImage(c);if(l&&l.tagName){if(c!==U._lastEnvMap){l=k.resizeImagePOT(l,!0),U._envMapTexture&&M.deleteTexture(U._envMapTexture);var $=U._envMapTexture=M.createTexture();M.activeTexture(M.TEXTURE0),M.bindTexture(M.TEXTURE_CUBE_MAP,$),M.texParameteri(M.TEXTURE_CUBE_MAP,M.TEXTURE_MAG_FILTER,M.LINEAR),M.texParameteri(M.TEXTURE_CUBE_MAP,M.TEXTURE_MIN_FILTER,M.LINEAR),M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,l),M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,l),M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,l),M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,l),M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,l),M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,l),M.bindTexture(M.TEXTURE_CUBE_MAP,null),U._lastEnvMap=c}M.activeTexture(M.TEXTURE0+J),M.bindTexture(M.TEXTURE_CUBE_MAP,U._envMapTexture),M.uniform1i(f.uEnvMap,J)}},getWireframe:function(q){var g=q.s("wf.visible"),k=q.s("wf.width");return g===!0||k>0&&"selected"===g&&this.isSelected(q)?{color:q.s("wf.color"),width:k,"short":q.s("wf.short"),mat:q.s("wf.mat")}:void 0},_transformPointToViewSpace:function(c){var H=[c[0],c[1],c[2]];return hs(H,this._viewMatrix),H},_transformDirectionToViewSpace:function(R,T){var t=[R[0],R[1],R[2]];hs(t,this._viewMatrix);var n=T?[T[0],T[1],T[2]]:[0,0,0];hs(n,this._viewMatrix);var q=n[0]-t[0],I=n[1]-t[1],r=n[2]-t[2],A=Math.sqrt(q*q+I*I+r*r);return A?[q/A,I/A,r/A]:[q,I,r]},getWireframeGeometry:function(r){return r.s("wf.geometry")?{color:r.s("wf.color"),width:r.s("wf.width"),mat:r.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(Y){return Y.s("body.color")},getMat:function(p){return p.getMat?p.getMat():p.s("mat")},getFaceMat:function(g,k){return g.getFaceMat?g.getFaceMat(k):g.s(k+".mat")},getFaceBlend:function(P,R){return P.s(R+".blend")||P.s("all.blend")},getFaceColor:function(q,N){return q.s(N+".color")||q.s("all.color")},getFaceImage:function(y,R){return y.s(R+".image")||y.s("all.image")},getFaceBlendImage:function(k,t){return k.s(t+".blend.image")||k.s("all.blend.image")},getFaceDiscardSelectable:function(d,Y){var J=d.s(Y+".discard.selectable");return J==s?d.s("all.discard.selectable"):J},getFaceUv:function(V,i){return V.s(i+".uv")||V.s("all.uv")},getFaceUvOffset:function(N,x){return N.s(x+".uv.offset")||N.s("all.uv.offset")},getFaceUvScale:function(c,_){return c.s(_+".uv.scale")||c.s("all.uv.scale")},getFaceLight:function(z,b){var v=z.s(b+".light");return v==s?z.s("all.light"):v},getFaceVisible:function(P,b){var g=P.s(b+".visible");return g==s?P.s("all.visible"):g},getFaceOpacity:function(V,K){var N=V.s(K+".opacity");return N==s?V.s("all.opacity"):N},getFaceTransparent:function(V,F){var j=V.s(F+".transparent");return j==s?V.s("all.transparent"):j},getFaceReverseColor:function(b,P){return b.s(P+".reverse.color")||b.s("all.reverse.color")},getFaceReverseFlip:function(V,z){var k=V.s(z+".reverse.flip");return k==s?V.s("all.reverse.flip"):k},getFaceReverseCull:function(r,G){var x=r.s(G+".reverse.cull");return x==s?r.s("all.reverse.cull"):x},getTextureMap:function(){return this._2O},deleteTexture:function(k){var $=this,Q=$._2O[k];Q&&(delete $._2O[k],$.getGL().deleteTexture(Q))},invalidateShape3dCachedImage:function(T){var b=this.getData3dUI(T);b.invalidateCachedTexture(this.getGL())},isInteractive:function(i){return i.s("interactive")},getTexture:function(A,D){if(!A)return s;var m=this,o=m.getGL(),T=m._2O[A];if(!T){var b=Qf(A),B={mipmapMaxLevel:D?D.s("texture.mipmap.max"):d};if(!b)return o._emptyTexture;if(b.uuid||(b.uuid=l.Math.generateUUID()),b.tagName){if(b.dynamic)return yq(o,b,m._1O,B);T=m._2O[A]=yq(o,b,d,B)}else{var N,Q=D&&D.s("shape3d.image.cache")&&!m.isInteractive(D),L=m.vr.isPresenting();if(L&&(D._textureUpdateFrame===o._renderInfo.frame?Q=!0:D._textureUpdateFrame=o._renderInfo.frame),Q&&(N=m.getData3dUI(D),T=N.getCachedTexture()),!T){var R=o._renderInfo.textureCache;if(Q){if(R.time>k.graph3dMaxVectorCacheTime)return m.redraw(),o._emptyTexture;if(!kq(b,D))return o._emptyTexture}var Z,_=D&&D.s("shape3d.fixSizeOnScreen"),V=_?o.NEAREST:o.LINEAR;_||D&&D.s("shape3d.vector.dynamic")&&(N||(N=m.getData3dUI(D)),_=N.getVectorDynamicSize(),_&&(Z=m.getDevicePixelRatio(),_[0]*=Z,_[1]*=Z));var h,W,f,z=D&&D.s("shape3d.texture.scale")||1,S=D&&D.s("shape3d");"billboard"===S?f=D.getTall()/D.getWidth():"plane"===S&&(f=D.getHeight()/D.getWidth());var c=Tb(b,D);if(_?(Z||(Z=m.getDevicePixelRatio()),h=_[0]>0?_[0]:z*c*Z,W=_[1]>0?_[1]:z*(f?hd(b,D,m,Math.min(4096,c*f)):hd(b,D))*Z):(h=z*c,W=z*(f?hd(b,D,m,Math.min(4096,c*f)):hd(b,D))),h>=1&&W>=1){var H=0;Q&&(H=Date.now());var w=dp(h,W);if(!N&&D&&(N=m.getData3dUI(D)),N&&N.interactiveInfo){var y=A;"object"==typeof y&&(y=y.uuid||(y.uuid=l.Math.generateUUID()));var O=N.interactiveInfo[y]={};w.interactiveInfo=O.bodyInfo={compInfos:[],matrix:new jr,rect:{x:0,y:0,width:h,height:W}}}Jq(w,b,0,0,h,W,D,m),w.interactiveInfo&&(w.interactiveInfo=null),w.restore(),R.count++,R.pixels+=h*W,B.minFilter=D.s("texture.filter.min")||D.s("texture.filter")||V,B.magFilter=D.s("texture.filter.mag")||D.s("texture.filter")||V,Q||L?(T=yq(o,Nr,null,B),N.setCachedTexture(T),R.time+=Date.now()-H,Nr=null):T=yq(o,Nr,m._1O,B)
}}}}return T},redraw:function(){this.iv()},validateImpl:function(){var W=this;if(W._lightChanged){W._lightChanged=!1;var z=[],l=[],i=[];W.dm().each(function(c){if(Tf(c)){var u=c.s("light.type");u===Nm?z.push(c):u===Bm?l.push(c):u===tr&&i.push(c)}}),(z.length!==W._59O.length||l.length!==W._spots.length||i.length!==W._dirs.length)&&Zf(W),W._59O=z,W._spots=l,W._dirs=i}W._42(),W._1o.iv()},getRenderInfo:function(){var _=this.getGL();return _?_._renderInfo:void 0},getDebugTip:function(){var n=this,T=n.getRenderInfo();if(T){var c=n.getGL()._validBufCount||0,e="Draw Calls: "+T.calls+"<br/>"+"Vertices: "+T.vertices+"<br/>"+"Faces: "+T.faces+"<br/>"+"Lines: "+T.lines+"<br/>"+"Buffer Count: "+c;n.vr.isPresenting()&&(e+="<br/>VR fps: "+n.vr.getFps());var t=T.textureCache.count;if(e+="<br/>2D Dynamic Textures: "+T.textureCache.count,t>0){var K,C=T.textureCache.pixels;K=C>1e6?Math.round(C/1e6)+"M":C>1e3?Math.round(C/1e3)+"K":Math.round(C),e+="<br/>2D Dynamic pixels: "+K}return e}},_42:function(k,b){var M=this;if(!M._35O&&(!jd||mq(jd))){var J,G;k&&(k instanceof Hr?G=k:J=k);var a=M._canvas,h=M.getGL(),r=M._prg;if(h){var K=M.getWidth(),t=M.getHeight();if(K&&t){b?k||Cd(a,K,t,b):(b=M.getDevicePixelRatio(),k||K===a.clientWidth&&t===a.clientHeight||(Cd(a,K,t,b),K&&Math.abs(h.drawingBufferWidth-K*b)>1&&(M.setDevicePixelRatio(b=h.drawingBufferWidth/K),Cd(a,K,t,b)))),h.clear(h.COLOR_BUFFER_BIT),M.drawFilter||(h._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:k?M._frameId:++M._frameId,textureCache:{time:0,count:0,pixels:0}});var e,o=this._cameras,P=0,Y=o.length,R=!1,g=l.Default.cameraPriority.skybox,F=l.Default.cameraPriority.main,y=l.Default.cameraPriority.top,v=K*b,T=t*b,O=function(){M.overlappingBox.clear(),M._81O=s,h.clear(h.DEPTH_BUFFER_BIT),h._picking=!!k;var Z={_picking:!!k,_envmapReflectivity:M._envmapReflectivity||.5,_projectMatrix:M._projectMatrix=ws(M),_viewMatrix:gi(M,M._7O)};if(M._viewMatrix=ri(M._7O),G){og(h,M,r,Z);var z=h.getParameter(h.COLOR_CLEAR_VALUE);h.clearColor(0,0,0,0),h.disable(h.BLEND),ch(h,r.aNormal),Sg(h,M._cube.vs,s,r.aPosition),Vm(h,M._cube.is),me(G,M,xb,0),me(G,M,Oh,6),me(G,M,cr,12),me(G,M,ss,18),me(G,M,rg,24),me(G,M,Rc,30),Sc(h,r.aNormal),nj(h,z)}else if(J){for(J.value=2;Y>P;P++)if(e=o[P],!e.ignoreInPick){if(e.priority>=F)break;e.useDefaultProgram&&og(h,M,r,Z),e.render(h,M,J)}og(h,M,r,Z);var z=h.getParameter(h.COLOR_CLEAR_VALUE);for(h.clearColor(0,0,0,0),h.disable(h.BLEND),M._95I(h,r,J),bg(M,J),Fg(M,M._polylineModelMap,J),Fg(M,M._wireframeModelMap,J),is(h,r.uTransparent,!0),M._95I(h,r,J,!0),bg(M,J,!0),Fg(M,M._polylineModelMap,J,!0),Fg(M,M._wireframeModelMap,J,!0),is(h,r.uTransparent,!1);Y>P;P++)if(e=o[P],!e.ignoreInPick){if(e.priority>=y)break;e.useDefaultProgram&&og(h,M,r,Z),e.render(h,M,J),R=!0}for(R&&(og(h,M,r,Z),R=!1),h.clear(h.DEPTH_BUFFER_BIT),M._swapLineMap(),M._95I(h,r,J,!1,!0),Fg(M,M._polylineModelMap,J),Fg(M,M._wireframeModelMap,J),M._swapLineMap(),M._swapLineMap(),M._95I(h,r,J,!1,!0),Fg(M,M._polylineModelMap,J),Fg(M,M._wireframeModelMap,J),is(h,r.uTransparent,!0),M._95I(h,r,J,!0,!0),Fg(M,M._polylineModelMap,J,!0),Fg(M,M._wireframeModelMap,J,!0),is(h,r.uTransparent,!1),M._swapLineMap(),h.disable(h.DEPTH_TEST),M.drawFilter||M._30O._42(h,r,J),h.enable(h.DEPTH_TEST);Y>P;P++)e=o[P],e.ignoreInPick||(e.useDefaultProgram&&og(h,M,r,Z),e.render(h,M,J));nj(h,z)}else{for(;Y>P&&(e=o[P],!(e.priority>=g));P++)e.useDefaultProgram&&og(h,M,r,Z),e.render(h,M);for(og(h,M,r,Z),h.disable(h.BLEND),M.drawSky(h,r),M.drawReflectors(h,v,T,O,k)&&(Z._projectMatrix=M._projectMatrix=ws(M),Z._viewMatrix=gi(M,M._7O),M._viewMatrix=ri(M._7O),og(h,M,r,Z));Y>P&&(e=o[P],!(e.priority>=F));P++)e.useDefaultProgram&&og(h,M,r,Z),e.render(h,M),R=!0;for(R&&(og(h,M,r,Z),R=!1),M._31O._42(h,r),M._95I(h,r),bg(M),Fg(M,M._polylineModelMap),Fg(M,M._wireframeModelMap),h.enable(h.BLEND),h.depthMask(!1),is(h,r.uTransparent,!0),M._95I(h,r,s,!0),bg(M,s,!0),Fg(M,M._polylineModelMap,s,!0),Fg(M,M._wireframeModelMap,s,!0),h.depthMask(!0),is(h,r.uTransparent,!1);Y>P&&(e=o[P],!(e.priority>=y));P++)e.useDefaultProgram&&og(h,M,r,Z),e.render(h,M),R=!0;for(R&&(og(h,M,r,Z),R=!1),h.clear(h.DEPTH_BUFFER_BIT),M._swapLineMap(),h.disable(h.BLEND),M._95I(h,r,s,!1,!0),Fg(M,M._polylineModelMap),Fg(M,M._wireframeModelMap),h.enable(h.BLEND),is(h,r.uTransparent,!0),h.depthMask(!1),M._95I(h,r,s,!0,!0),Fg(M,M._polylineModelMap,s,!0),Fg(M,M._wireframeModelMap,s,!0),h.depthMask(!0),is(h,r.uTransparent,!1),M._swapLineMap(),h.disable(h.DEPTH_TEST),h.disable(h.BLEND),M._32O._42(h,r),M._30O._42(h,r),M._highlightHelper._42(h,r),h.enable(h.DEPTH_TEST);Y>P;P++)e=o[P],e.useDefaultProgram&&og(h,M,r,Z),e.render(h,M)}Sg(h,s),Vm(h,s)},V=!1,C=M.vr;C.enable&&C._42(h,v,T,O)&&(V=!0);var D=M.envRenderer;D&&D.enable&&D._42(h,v,T,O)&&(V=!0);var L=M._postProcessing;L._42(h,v,T,O,k)&&(V=!0),V||(M.setViewport(h,0,0,K*b,t*b),O()),M._33Q=!1,M.drawFilter||M.countFrame(),M._doBufferGC(h)}}}},drawReflectors:function(J,_,d,Q,e){var q,h,G,C=this,A=C._dataModel.getReflectors(),v=!1;for(q in A)h=A[q],C.isVisible(h)&&(G=C.getData3dUI(h),G&&G.drawReflector(J,_,d,Q,e)&&(v=!0));return v},enablePostProcessing:function(b,d){return this._postProcessing.enableModule(b,d)},getPostProcessingModule:function(i){return this._postProcessing.getModule(i)},setViewport:function(l,L,$,Y,Q){this._viewport=[L,$,Y,Q],l.viewport(L,$,Y,Q)},getViewport:function(){return this._viewport},setBufferGCInterval:function(O){this._bufferGCInterval=O},_doBufferGC:function(K,o){var X,j,a=K._bufPool,D=0,e=0,U=K._renderInfo.frame,m=this._bufferGCInterval||10;for(X in a)D++,j=a[X],j&&(o||U-j._fid>m?(K.deleteBuffer(j._buf),j._buf=null,a[X]=null):e++);if(D/2>e&&D>128){var S={};for(X in a)a[X]&&(S[X]=a[X]);K._bufPool=S}K._validBufCount=e},_swapLineMap:function(){var i=this;rb=i._polylineModelMap,i._polylineModelMap=i._polylineModelMapSwap,i._polylineModelMapSwap=rb,rb=i._wireframeModelMap,i._wireframeModelMap=i._wireframeModelMapSwap,i._wireframeModelMapSwap=rb,rb=i._polylineIndexMap,i._polylineIndexMap=i._polylineIndexMapSwap,i._polylineIndexMapSwap=rb,rb=i._wireframeIndexMap,i._wireframeIndexMap=i._wireframeIndexMapSwap,i._wireframeIndexMapSwap=rb},_updateSkyBox:function(f){if(this._skyBox&&f){var U=f.property,c=!1,g=this._skyBox;if("eye"===U||"forceUpdate"===U){var t=this._eye;g.p3(t[0],t[1],t[2]),c=!0}if("near"===U||"far"===U||"forceUpdate"===U){var D=this._near,e=this._far,G=g.getFinalScale3d();if(G[0]/=2,G[1]/=2,G[2]/=2,G[0]<=D||G[0]>=e||G[1]<=D||G[1]>=e||G[2]<=D||G[2]>=e){var w=2*D*e/(D+e),y=Math.min(G[0],G[1],G[2]),u=w/y,r=g.getScale3d();g.setScale3d(r[0]*u,r[1]*u,r[2]*u),c=!0}}c&&this.invalidateData(g)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(t){var W=this._skyBox;W&&(this._skyBoxStyleMap&&W.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&W.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&W.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=t,this.ump(this._updateSkyBox,this),t&&(t.dm()&&t.dm().remove(t),this._skyBoxStyleMap=l.Default.clone(t.getStyleMap()),this._skyBoxAnchor3d=t.getAnchor3d(),t.setAnchor3d(.5,.5,.5),this._skyBoxP3=t.p3().slice(0),t.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",W,t)},drawSky:function(S,p,n){var W=this,M=W._skyBox;if(M){var N=W._headlightIntensity,g=id(W._headlightColor),p=W._prg;1!==N&&(g=[g[0]*N,g[1]*N,g[2]*N]),is(S,p.uHeadlightColor,[g[0],g[1],g[2],1]);var s=W.getData3dUI(M);if(s){var j,H=W.isOrtho(),l=H||this._computedProjectMatrix;l&&(j=W._projectMatrix,H&&(W._ortho=!1),is(S,p.uPMatrix,W._projectMatrix=ws(W,!0)));var R=M.p3(),V=this._eye;(R[0]!==V[0]||R[1]!==V[1]||R[2]!==V[2])&&(M._position.x=V[0],M._54O=V[1],M._position.y=V[2]),s._42(S,p,n,function(){return!0}),l&&(H&&(W._ortho=!0),is(S,p.uPMatrix,W._projectMatrix=j))}S.clear(S.DEPTH_BUFFER_BIT),is(S,p.uHeadlightColor,[g[0],g[1],g[2],W._headlightDisabled?1:0])}},_95I:function(s,_,D,C,Y){function G(V){if(!!V.s("shape3d.alwaysOnTop")==!!Y&&I.isVisible(V)&&(!U||Z)){if(!D&&I.isTransparentMask(V))return;var w=I.getData3dUI(V);w&&w._42(s,_,D,o)}}var I=this,o=function(B){return C?B:!B};I.sky&&s.clear(s.DEPTH_BUFFER_BIT);var d=I.drawFilter;d?I.dm().each(function(c){d(c)||G(c)}):I.dm().each(function(O){G(O)})},getLogicalPoint:function(F){return Pp(F,this._canvas)},isRectOverlapping:function(p){var K=this.getData3dUI(p);return K._rectOverlapping},getHitFaceInfo:function(D){D.target&&(D=this.lp(D));var E=this.getDataInfoAt(D);if(E){var B=this._1o.face(E.data,qb(D.x,D.y));if(B)return{data:E.data,face:B}}return s},unproject:function(Q,P){var w=this,h=w.getWidth(),f=w.getHeight(),$=Q.target?w.lp(Q):Q,l=$.x-h/2,r=$.y-f/2,D=2*(l/h),Y=2*(-1*r/f);P=P||0;var d=Il(),I=ws(w),k=gi(w);so(d,I,k),Cj(d);var x=$o([D,Y,P,1],d);return[x[0]/x[3],x[1]/x[3],x[2]/x[3]]},getDataAt:function(q){var D=this.getDataInfoAt(q);return D?D.data:s},getDataInfoAt:function(g,h){return g.target&&(g=this.lp(g)),this._1o.get(qb(g.x,g.y,h),!0)},getDatasInRect:function(u){return this._1o.get(u)},setEditable:function(U){var q=this,s=q._editable;q._editable=U,this.fp(fs,s,U)},isEditable:function(o){var n=this;return n._editable?rn(o)?o.s("3d.editable")?n._editableFunc?n._editableFunc(o):!0:!1:!1:!1},isSelectable:function(J){return J.s("3d.selectable")&&this.sm().isSelectable(J)},isMovable:function(Y){var b=this;return jo(Y)&&Y.getStyle(Oe)!==Xh?!1:Y.s("3d.movable")?b._movableFunc?b._movableFunc(Y):!0:!1},isSizeEditable:function(U){return rn(U)?this._sizeEditableFunc?this._sizeEditableFunc(U):!0:!1},isRotationEditable:function(R){return rn(R)&&R.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(R):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(z){this.setZoom(be,z)},zoomOut:function(_){this.setZoom(1/be,_)},setZoom:function(C,L){if(1!==C){var y=this;if(y._ortho)return y.setOrthoZoom(C,L),void 0;y._14o&&y._14o.stop(!0);var A=1/C,j=y._eye,z=y._center,$=z[0]+(j[0]-z[0])*A-j[0],_=z[1]+(j[1]-z[1])*A-j[1],n=z[2]+(j[2]-z[2])*A-j[2];if(!(Qd(j,z)<y._moveStep&&1>A)){if(L=jb(L)){var c=Tm(j);return L.action=function(X){y.fi({kind:y._zooming?"betweenZoom":"beginZoom"}),y._zooming=1,j[0]=c[0]+$*X,j[1]=c[1]+_*X,j[2]=c[2]+n*X,y.fp(kh,s,j)},L._37o=function(){delete y._14o,delete y._zooming,y.fi({kind:"endZoom"}),y.onZoomEnded()},y._14o=gp(L)}j[0]+=$,j[1]+=_,j[2]+=n,y.fp(kh,s,j)}}},setOrthoZoom:function(y,L){if(1!==y){var a=this;a._14o&&a._14o.stop(!0);var n=a._orthoWidth,s=n/y-n;if(!(n<a._moveStep&&y>1))return(L=jb(L))?(L.action=function(R){a.fi({kind:a._zooming?"betweenZoom":"beginZoom"}),a._zooming=1,a.setOrthoWidth(n+s*R)},L._37o=function(){delete a._14o,delete a._zooming,a.fi({kind:"endZoom"}),a.onZoomEnded()},a._14o=gp(L)):(a.setOrthoWidth(n/y),void 0)}},getPositionInfo:function(D){var u=this,J=u._eye,Q=u._center,z=u.getAspect(),I=D?Eb(ke(Q,J,!0),ke(D,J)):Qd(J,Q);if(u._ortho){var M=u._orthoWidth;return{length:I,height:M/z,width:M}}var _=2*q(u._fovy/2)*I;return{length:I,height:_,width:_*z}},getCenterInfo:function(){var z=this;return z._81O||(z._81O=z.getPositionInfo()),Tm(z._81O)},rotate:function(m,y,X,Y){var J=this;if(m||y){Y==s&&(Y=J._firstPersonMode),J._88O&&J._88O.stop(!0);var P=J._center,F=J._eye,o=J.getCenterInfo().length,M=Y?P:F,D=Y?F:P,b=ke(M,D),W=c(b[0],b[2]),Z=c(r(b[0]*b[0]+b[2]*b[2]),b[1]),U=Y?zc:kh;return Y&&(y=-y),(X=jb(X))?(X.action=function(C){J.fi({kind:J._rotating?"betweenRotate":"beginRotate"}),J._rotating=1;var c=W+m*C,A=Z+y*C;A=Sd(A),b[0]=o*L(A)*L(c),b[1]=o*O(A),b[2]=o*L(A)*O(c),M[0]=D[0]+b[0],M[1]=D[1]+b[1],M[2]=D[2]+b[2],J.fp(U,s,M)},X._37o=function(){delete J._88O,delete J._rotating,J.fi({kind:"endRotate"}),J.onRotateEnded()},J._88O=gp(X)):(W+=m,Z+=y,Z=Sd(Z),b[0]=o*L(Z)*L(W),b[1]=o*O(Z),b[2]=o*L(Z)*O(W),M[0]=D[0]+b[0],M[1]=D[1]+b[1],M[2]=D[2]+b[2],J.fp(U,s,M),void 0)}},pan:function(i,B,Q,O){if(i||B){var X=this;O==s&&(O=X._firstPersonMode),X._89O&&X._89O.stop(!0);var $=gi(X),E=[$[0]*i,$[4]*i,$[8]*i],n=[$[1]*B,$[5]*B,$[9]*B],I=E[0]+n[0],C=E[1]+n[1],f=E[2]+n[2],P=X._center,_=X._eye;if(O){var q=pj(X.getBoundaries(),_[0],_[2],_[0]+I,_[2]+f,r(I*I+f*f));I=q[0],f=q[1]}if(Q=jb(Q)){var A=Tm(_),c=Tm(P);return Q.action=function(b){X.fi({kind:X._panning?"betweenPan":"beginPan"}),X._panning=1,P[0]=c[0]+I*b,P[1]=c[1]+C*b,P[2]=c[2]+f*b,_[0]=A[0]+I*b,_[1]=A[1]+C*b,_[2]=A[2]+f*b,X.fp(kh,s,_),X.fp(zc,s,P)},Q._37o=function(){delete X._89O,delete X._panning,X.fi({kind:"endPan"}),X.onPanEnded()},X._89O=gp(Q)}P[0]+=I,P[1]+=C,P[2]+=f,_[0]+=I,_[1]+=C,_[2]+=f,X.fp(kh,s,_),X.fp(zc,s,P)}},walk:function(q,O,o){if(q){var Z=this;o==s&&(o=Z._firstPersonMode),Z._90O&&Z._90O.stop(!0);var D=Z._center,g=Z._eye,m=ke(D,g,!0);if(o){var W=pj(Z.getBoundaries(),g[0],g[2],g[0]+m[0]*q,g[2]+m[2]*q,J(q));if(q=Qd(W),!q)return;m=[W[0]/q,0,W[1]/q]}if(O=jb(O)){var $=Tm(g),v=Tm(D);return O.action=function(L){Z.fi({kind:Z._walking?"betweenWalk":"beginWalk"}),Z._walking=1;var R=q*L;g[0]=$[0]+m[0]*R,g[1]=$[1]+m[1]*R,g[2]=$[2]+m[2]*R,D[0]=v[0]+m[0]*R,D[1]=v[1]+m[1]*R,D[2]=v[2]+m[2]*R,Z.fp(kh,s,g),Z.fp(zc,s,D)},O._37o=function(){delete Z._90O,delete Z._walking,Z.fi({kind:"endWalk"}),Z.onWalkEnded()},Z._90O=gp(O)}g[0]+=m[0]*q,g[1]+=m[1]*q,g[2]+=m[2]*q,D[0]+=m[0]*q,D[1]+=m[1]*q,D[2]+=m[2]*q,Z.fp(kh,s,g),Z.fp(zc,s,D)}},handleScroll:function(S,v){S.preventDefault();var c=this,A=c._moveStep,_=c.getDataInfoAt(S);if(_){var o=_.data;if(o&&c.isInteractive(o)){var Q=c.intersectObject(S,o);if(Q){var p=Q.part,b=Qf(o.s(p+".image")||o.s("shape3d."+p+".image")||o.s("all.image")||o.s("shape3d.image"));if(b&&Ud(b.scrollable,o,c))return}}}c.isFirstPersonMode()?c.isPannable()&&c.pan(0,v>0?A:-A):c.isZoomable()&&c.setZoom(0>v?1/Lr:Lr)},handlePinch:function(w,T){this.isZoomable()&&this.setZoom(T>w?1/fr:fr)},reset:function(){this.setCenter(k.graph3dViewCenter),this.setEye(k.graph3dViewEye),this.setUp(k.graph3dViewUp)},moveSelection:function(y,B,n){var X=this;X.dm().beginTransaction(),Fe(this.sm().toSelection(this.isMovable,this),y,B,n),X.dm().endTransaction()},getMoveMode:function(p,f){var T=f.s("3d.move.mode");if(T)return T;var M="88",r="89",I="90";return km(p)||Ob[M]&&Ob[r]&&Ob[I]?"xyz":Ob[M]&&Ob[r]?"xy":Ob[M]&&Ob[I]?"xz":Ob[r]&&Ob[I]?"yz":Ob[M]?"x":Ob[r]?"y":Ob[I]?"z":"xz"},handleTick:function(){var F=this,y=!1,V=F._moveStep,U=V,r=!1,A=!0,Y=F._rotateStep*(A?-1:1);if(F.isWalkable()||(U=0),F.isPannable()||(V=0),F.isRotatable()||(Y=0),F._32Q){var f=(Xl()-F._32Q)/50;U*=f,V*=f,Y*=f}F._31Q&&(An(F._31Q),delete F._31Q,delete F._32Q),$k()&&(y=!0,F.pan(-V,0,r,A)),Ie()&&(y=!0,F.pan(V,0,r,A)),ic()&&(y=!0,km()?F.pan(0,V,r,A):F.walk(U,r,A)),Wk()&&(y=!0,km()?F.pan(0,-V,r,A):F.walk(-U,r,A)),lb()&&(y=!0,F.rotate(-Y,0,r,A)),si()&&(y=!0,F.rotate(Y,0,r,A)),Gj()&&(y=!0,F.rotate(0,-Y/2,r,A)),ub()&&(y=!0,F.rotate(0,Y/2,r,A)),y&&(F._32Q=Xl(),F._31Q=Ag(F.handleTick,F))},handleKeyDown:function(P){var t=this;!oo(P)&&gq[P.keyCode]?t.handleTick():mg(P)?t.selectAll():hj(P)?t.handleDelete(P):Af(P)&&this.isResettable()&&t.reset()},checkDoubleClickOnNote:function(b,I,h){var _=this;if(h===am){if(I.s("note.toggleable"))return I.s(hg,!I.s(hg)),_.fi({kind:"toggleNote",event:b,data:I,part:h}),!0}else if(h===vm&&I.s("note2.toggleable"))return I.s(qk,!I.s(qk)),_.fi({kind:"toggleNote2",event:b,data:I,part:h}),!0;return!1},checkDoubleClickOnRotation:function(T,R,b){return b===bp?(R.setRotationX(0),!0):b===io?(R.setRotationY(0),!0):b===oi?(R.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(v){var h=this;if(h.isOrtho())return h.getWidth()/h.getOrthoWidth();var y=h.getCenter(),I=h.getHeight(),Q=h.getEye(),W=[y[0]-Q[0],y[1]-Q[1],y[2]-Q[2]],c=[v[0]-Q[0],v[1]-Q[1],v[2]-Q[2]],s=Math.sqrt(W[0]*W[0]+W[1]*W[1]+W[2]*W[2]),b=1/Math.tan(h.getFovy()/2);return I*s*b/(c[0]*W[0]+c[1]*W[1]+c[2]*W[2])},inViewSpace:function(r){var N,D=this,t=D._transformPointToViewSpace(r),B=D.getAspect(),T=D.getNear(),i=D.getFar();return-t[2]<T||-t[2]>i?!1:D.isOrtho()?(N=D.getOrthoWidth()/2,Math.abs(t[0])<=N&&Math.abs(t[1]*B)<=N):(N=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])*Math.tan(D.getFovy()/2),Math.abs(t[1]<=N)&&Math.abs(t[0])<=N*B)},getPVMatrix:function(){var h=this,E=h.getWidth()/2,O=h.getHeight()/2,B=h._18Q;return B&&B._wh===E/O||(B=ws(h),h._18Q=so(B,B,gi(h)),h._18Q._wh=E/O),B},getFrustum:function(){var M=new pl,r=new ep,j=new Array(16);return function(){for(var w=this.getPVMatrix(),y=!1,k=0;16>k;k++)w[k]!==j[k]&&(y=!0,j[k]=w[k]);return y&&r.setFromMatrix(M.fromArray(w)),r}}(),toViewPosition:function(R){var v=this,D=v.getWidth()/2,L=v.getHeight()/2,M=v.getPVMatrix();return R=$o([R[0],R[1],R[2],1],M),{x:D+D*R[0]/R[3],y:L-L*R[1]/R[3],z:R[2]/R[3]}},getHitPosition:function(v,w,K){var A=this,I=A.getWidth(),z=A.getHeight(),D=v.target?A.lp(v):v,B=D.x-I/2,b=D.y-z/2,_=A.getCenterInfo(),C=gi(A);w=w?w:[0,0,0],K=K?K:[0,1,0],B=B/I*_.width,b=-1*b/z*_.height;var Q=[C[0]*B,C[4]*B,C[8]*B],V=[C[1]*b,C[5]*b,C[9]*b],N=[Q[0]+V[0],Q[1]+V[1],Q[2]+V[2]],l=A.getCenter(),o=$i(A,w,K,[N[0]+l[0],N[1]+l[1],N[2]+l[2]]);return o?o:[0,0,0]},intersectObject:function(J,D){return this._raycaster.intersectObject(J,D)},intersectObjects:function(v,u,R){return this._raycaster.intersectObjects(v,u,R)},getLineLength:function(A){this.validate();var w=this.getData3dUI(A);if(w&&w.getCache){var s=w.getCache();if(s)return s[s.length-1].length}return 0},getLineOffset:function(r,G){var j=this.getData3dUI(r);if(j&&j.getCache){var Q=j.getCache();if(Q){var m=Rb(Q,G),i=r.r3();if(0===i[0]&&0===i[1]&&0===i[2])return m;var f=new wo(r.p3()),z=new wo(m.point).sub(f),w=new wo(m.tangent).add(z),u=(new tl).setFromEuler(new sr(i,r.getRotationMode(),!0));return z.applyQuaternion(u),w.applyQuaternion(u),{point:z.add(f),tangent:w.sub(z).normalize()}}}return s},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(Z,K,e){var u=this,N=u.getEye();N=[N[0],N[1],N[2]];var p=u.getCenter();if(p=[p[0],p[1],p[2]],Z||(Z=N),K||(K=p),u._flyAnim&&u._flyAnim.stop(!0),e=jb(e),!e)return u.setEye(Z[0],Z[1],Z[2]),u.setCenter(K[0],K[1],K[2]),delete u._flyAnim,!0;var n=[Z[0]-N[0],Z[1]-N[1],Z[2]-N[2]],q=[K[0]-p[0],K[1]-p[1],K[2]-p[2]];return e.action=function($){u.setCenter(p[0]+q[0]*$,p[1]+q[1]*$,p[2]+q[2]*$),u.setEye(N[0]+n[0]*$,N[1]+n[1]*$,N[2]+n[2]*$)},e._37o=function(){delete u._flyAnim},u._flyAnim=gp(e)},flyTo:function(){function U(U,M,o){if(o instanceof l.Node){e.fromArray(No(o,M.getMat(o)));var j=o.getAnchor3d();U.push((new wo).set(0-j.x,0-j.y,0-j.z).applyMatrix4(e)),U.push((new wo).set(0-j.x,0-j.y,1-j.z).applyMatrix4(e)),U.push((new wo).set(0-j.x,1-j.y,0-j.z).applyMatrix4(e)),U.push((new wo).set(0-j.x,1-j.y,1-j.z).applyMatrix4(e)),U.push((new wo).set(1-j.x,0-j.y,0-j.z).applyMatrix4(e)),U.push((new wo).set(1-j.x,0-j.y,1-j.z).applyMatrix4(e)),U.push((new wo).set(1-j.x,1-j.y,0-j.z).applyMatrix4(e)),U.push((new wo).set(1-j.x,1-j.y,1-j.z).applyMatrix4(e))}}var K=new wo,H=new wo,T=new wo,C=new wo,e=new pl,E=new l.Math.Quaternion,v=new sr;return function(W,N,r){var s=this;if(r!==d)N={animation:N,ratio:r};else{var m=typeof N;("boolean"===m||"object"===m&&N.duration)&&(N={animation:N})}N=N||{},K.fromArray(s.getEye()),H.fromArray(s.getCenter());var a,b,t=[],D=N.center,n=N.distance===d;if(D&&T.fromArray(D),W instanceof l.Node)D||T.fromArray(W.p3()),n&&(U(t,s,W),a=t.length);else{if(W||(W=s.dm().getDatas()),!W.length)return;if((n||!D)&&(t=[],W.forEach(function(l){U(t,s,l)}),a=t.length,!a))return;if(!D){for(T.set(0,0,0),b=0;a>b;b++)T.add(t[b]);T.multiplyScalar(1/a)}}if(s.setCenter(T.x,T.y,T.z),C.subVectors(K,H),N.direction||N.worldDirection){!N.worldDirection&&W instanceof l.Node?E.setFromEuler(v.set(W.r3(),W.getRotationMode(),!0)):E.set(0,0,0,1);var w=C.length();C.fromArray(N.worldDirection||N.direction).applyQuaternion(E).setLength(w)}var Z=0;if(n){var B,I,y,r=N.ratio||.8,R=N.xRatio||r,L=N.yRatio||r;if(s.isOrtho()){var P=-1/0;for(s._eye[0]=C.x+T.x,s._eye[1]=C.y+T.y,s._eye[2]=C.z+T.z,B=ws(s),so(B,B,gi(s)),b=0;a>b;b++)y=t[b],I=$o([y.x,y.y,y.z,1],B),P=Math.max(P,Math.max(Math.abs(I[0])/R,Math.abs(I[1])/L));Z=s.getOrthoWidth()*P,C.add(T)}else{for(var O,j,A=s.getNear(),h=10;h--;){for(s._eye[0]=C.x+T.x,s._eye[1]=C.y+T.y,s._eye[2]=C.z+T.z,B=ws(s),so(B,B,gi(s)),O=!0,j=-1/0,b=0;a>b;b++){if(y=t[b],I=$o([y.x,y.y,y.z,1],B),I[3]<A&&h){C.multiplyScalar(2),O=!1;break}j=Math.max(j,Math.max(Math.abs(I[0])/R,Math.abs(I[1])/L)-I[3])}if(O)break}C.setLength(j+C.length()).add(T)}}else C.setLength(N.distance).add(T);s._flyAnim&&s._flyAnim.stop(!0);var J=jb(N.animation);if(J){s.setEye(K.x,K.y,K.z),s.setCenter(H.x,H.y,H.z);var g=(new wo).subVectors(C,K),Y=(new wo).subVectors(T,H);if(Z)var e=s.getOrthoWidth();var F=new wo,q=new wo,_=J.action,X=J._37o;return J.action=function(L,t){F.copy(K).addScaledVector(g,L),q.copy(H).addScaledVector(Y,L),s.setCenter(q.x,q.y,q.z),s.setEye(F.x,F.y,F.z),Z&&s.setOrthoWidth((Z-e)*L+e),_&&_(L,t)},J._37o=function(){delete s._flyAnim,X&&X()},{lastEye:K,lastCenter:H,eye:C,center:T,orthoWidth:Z,animation:s._flyAnim=gp(J)}}return s.setEye(C.x,C.y,C.z),Z&&s.setOrthoWidth(Z),delete s._flyAnim,{lastEye:K,lastCenter:H,eye:C,center:T,orthoWidth:Z}}}(),getBoundingBox:function(){function m(o,u,U){p.fromArray(No(U,u.getMat(U)));var j=U.getAnchor3d();o.push((new wo).set(0-j.x,0-j.y,0-j.z).applyMatrix4(p)),o.push((new wo).set(0-j.x,0-j.y,1-j.z).applyMatrix4(p)),o.push((new wo).set(0-j.x,1-j.y,0-j.z).applyMatrix4(p)),o.push((new wo).set(0-j.x,1-j.y,1-j.z).applyMatrix4(p)),o.push((new wo).set(1-j.x,0-j.y,0-j.z).applyMatrix4(p)),o.push((new wo).set(1-j.x,0-j.y,1-j.z).applyMatrix4(p)),o.push((new wo).set(1-j.x,1-j.y,0-j.z).applyMatrix4(p)),o.push((new wo).set(1-j.x,1-j.y,1-j.z).applyMatrix4(p))}var p=new pl;return function(C){if(C=C||this.sm().getSelection(),C instanceof l.Node&&(C=[C]),0===C.length)return s;var P=[];C.forEach(function(d){m(P,this,d)},this);var f=[1/0,1/0,1/0],$=[-1/0,-1/0,-1/0];return P.forEach(function(c){f[0]=Math.min(c.x,f[0]),f[1]=Math.min(c.y,f[1]),f[2]=Math.min(c.z,f[2]),$[0]=Math.max(c.x,$[0]),$[1]=Math.max(c.y,$[1]),$[2]=Math.max(c.z,$[2])}),{min:f,max:$}}}()}),gd.RenderEnv=function(H){this.gv=H,this.enable=!1},e.defineProperties(gd.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(m){this._debugOn=m,this.capture&&this.capture()}}}),e.assign(gd.RenderEnv.prototype,{renderEnvToCube:function(N,B,d,I){var O=this,Q=O.gv;if(!N||!B||!d)return O.enable=!1,O._42=null,void 0;O.enable=!0;var Z=Math.floor(I/N*B),f=Q.getGL(),g=O._renderTargets;g?g.length<d&&(g=O._renderTargets=g.concat(new Array(d-g.length))):g=O._renderTargets=new Array(d);for(var D=0;d>D;D++)g[D]?g[D].setSize(f,I,Z):g[D]=new gd.RenderTarget(Q,f,I,Z);var k=!1;O.capture=function(){k=!0,Q._42(),k=!1};var R=new wo,v=new wo,p=new wo,h=new wo,P=(new wo).setY(0),l=2*Math.PI/d,w=N/2/Math.tan(Math.PI/d),t=2*Math.atan2(B/2,w),m=N/B;O._42=function(V,U,e,b){var B=O._debugOn;if(!k&&!B)return!1;R.copy(Q.getEye()),h.copy(Q.getCenter()).sub(R);var N=Math.atan2(h.z,h.x),J=Q.getNear(),q=Q.getFovy(),s=Q.getAspect();v.copy(Q.getCenter());for(var Y,A=0;d>A;A++)if(Y=g[A],P.setZ(Math.cos(N)).setX(Math.sin(N)).multiplyScalar(w),N-=l,p.addVectors(R,P),Q.setNear(w),Q.setCenter([p.x,p.y,p.z]),Q.setFovy(t),Q.setAspect(m),B){var K=Math.round(U/d);V.viewport(K*A,0,K,e),b()}else xh(V,Y.frame),V.viewport(0,0,Y.width,Y.height),V.clear(V.COLOR_BUFFER_BIT),b(),oe(V),Y.assureTexture();return Q.setNear(J),Q.setCenter([v.x,v.y,v.z]),Q.setFovy(q),Q.setAspect(s),!0},O.capture()},getTextureInfo:function(O){var S=this._renderTargets;if(!S)return null;var L=this._renderTargets[O];return L?{index:O,texture:L.texture,textureName:L.uuid}:null}}),e.assign(gd.Graph3dView.prototype,{renderEnvToCube:function(R,v,e,S){var j=this;j.envRenderer||(j.envRenderer=new gd.RenderEnv(j)),j.envRenderer.renderEnvToCube(R,v,e,S)}}),gd.RenderTarget=function(u,g,z,r,o){var e=this;o=o||{},o.samples=Math.min(u._glCapabilities.maxSamples,o.samples&&o.samples>1&&2===u._webGLVersion?o.samples:0),e.options=o,e.uuid=l.Math.generateUUID(),e.gv=u,e.init(u,g,o),o.samples&&!u._glCapabilities._maxSamplesChecked?e.setSize(g,z||1,r||1):e.setSize(g,z,r)},e.assign(gd.RenderTarget.prototype,{bind:function(V){xh(V,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(Q){oe(Q),this.options.samples&&(Q.bindFramebuffer(Q.READ_FRAMEBUFFER,this._MSAAFbo),Q.bindFramebuffer(Q.DRAW_FRAMEBUFFER,this.frame),Q.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,Q.COLOR_BUFFER_BIT,Q.NEAREST),Q.bindFramebuffer(Q.READ_FRAMEBUFFER,null),Q.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null))},init:function(p,q,a){var j=this,z=j.texture=q.createTexture();q.activeTexture(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,z),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE);var i=a.samples,x=i?q.NEAREST:q.LINEAR;q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,a.minFilter||x),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,a.magFilter||x),q.bindTexture(q.TEXTURE_2D,null),j.render=q.createRenderbuffer(),j.frame=q.createFramebuffer(),p._2O[j.uuid]=z},assureTexture:function(){var G=this,F=G.uuid,M=G.gv._2O;M[F]||(M[F]=G.texture)},setSize:function(A,t,f){var o=this;if(t&&f&&(o.width!==t||o.height!==f)){var N=A.RGBA,k=A.TEXTURE_2D,Q=A.RENDERBUFFER,J=A.FRAMEBUFFER,G=o.options.samples;if(ik(A,o.texture),A.texImage2D(k,0,N,t,f,0,N,A.UNSIGNED_BYTE,s),A.bindRenderbuffer(Q,o.render),G){var r=o.gv._glCapabilities;if(r._maxSamplesChecked)A.renderbufferStorageMultisample(Q,G,A.DEPTH_COMPONENT16,t,f);else{for(A.getError();G>1&&(A.renderbufferStorageMultisample(Q,G,A.DEPTH_COMPONENT16,t,f),A.getError());)G=Math.floor(G>>1);1>=G&&(G=0,A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,o.options.minFilter||A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,o.options.magFilter||A.LINEAR),A.renderbufferStorage(Q,A.DEPTH_COMPONENT16,t,f)),r._maxSamplesChecked=!0,r.maxSamples=o.options.samples=G}}else A.renderbufferStorage(Q,A.DEPTH_COMPONENT16,t,f);G&&!o._MSAAFbo&&(o._MSAAFbo=A.createFramebuffer(),o._MSAARbO=A.createRenderbuffer()),xh(A,o.frame),A.framebufferTexture2D(J,A.COLOR_ATTACHMENT0,k,o.texture,0),G||A.framebufferRenderbuffer(J,A.DEPTH_ATTACHMENT,Q,o.render),oe(A),G&&(A.bindRenderbuffer(A.RENDERBUFFER,o._MSAARbO),A.renderbufferStorageMultisample(A.RENDERBUFFER,G,A.RGBA8,t,f),xh(A,o._MSAAFbo),A.framebufferRenderbuffer(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.RENDERBUFFER,o._MSAARbO),A.framebufferRenderbuffer(J,A.DEPTH_ATTACHMENT,Q,o.render),oe(A)),ik(A,s),A.bindRenderbuffer(Q,s),o.width=t,o.height=f}},toCanvas:function(){var r=this,b=r.gv.getGL();xh(b,r.frame);var O=r.width,u=r.height,o=new Uint8Array(4*O*u);b.readPixels(0,0,O,u,b.RGBA,b.UNSIGNED_BYTE,o),oe(b);var d=m.createElement("canvas");d.width=O,d.height=u;var e=d.getContext("2d"),q=e.createImageData(O,u);return q.data.set(o),e.putImageData(q,0,0),d}});var Do=gd.Interactor=function(E){this.gv=E};Ab("Interactor",e,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var cq=gd.DefaultInteractor=function(j){$d(cq,this,[j])};Ab("DefaultInteractor",Do,{handle_contextmenu:function(a){yc(a)},handle_mousewheel:function(K){this.gv.handleScroll(K,K.wheelDelta/40)},handle_DOMMouseScroll:function(Z){2===Z.axis&&this.gv.handleScroll(Z,-Z.detail)},handle_keydown:function(t){this.gv.handleKeyDown(t)},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(g){yc(g);var q=this,w=q.gv,H=ee(g),W=w.getDataInfoAt(g),h=W?W.data:s,C=W?W.part:s,c=w.sm(),B=Yj(g),f=on(g);w.setFocus(g)&&(q._62O=s,q._57I=s,h?oo(g)?c.co(h)?c.rs(h):c.as(h):c.co(h)||c.ss(h):H&&(oo(g)?w.isRectSelectable()&&(q._62O=Xb):q._57I=xl(g)),q._31Q&&(An(q._31Q),delete q._31Q,delete q._32Q),q._62O||(w.isFirstPersonMode()&&(km(g)||im(g)||f>2?q._62O="pan":w.isMouseRoamable()||mo?(q._62O="roaming",q.foward=B&&ee(g),q._32Q=Xl(),q._31Q=Ag(q.tick,q)):H||(q._62O="roaming")),q._62O||(H&&B&&oc[C]?(q._62O=C,q.p3=h.p3()):H&&B&&rn(h)&&w.isSelected(h)?w.isMovable(h)?(q._62O="move",q.p3=h.p3(),q.movedata=h):w._39Q(h)&&(q._62O="none"):mo&&(f>2?q._62O="pan":2===f&&(q.dist=Oi(g),q._62O="pinch")))),q.point=w.lp(g),Fh(q,g),Ec(g)?w.handleDoubleClick(g,h,C):w.handleClick(g,h,C))},tick:function(){var u=this,Y=u.gv,h=Y._moveStep;u.point&&Y.isWalkable()&&(u._32Q&&(h*=(Xl()-u._32Q)/50),Y.walk(u.foward?h:-h),u._32Q=Xl(),u._31Q=Ag(u.tick,u))},handle_mouseup:function(Q){this.handle_touchend(Q)},handle_touchend:function(Y){var r=this._57I;r&&(Qd(r,xl(Y))<=1&&this.gv.sm().cs(),this._57I=s)},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(G){var P,S,N=this,o=N.gv,g=N._62O,Z=N.point,a=o.dm(),x=o.lp(G),n=x.x-Z.x,y=x.y-Z.y,Y=o.getWidth(),W=o.getHeight();if(Y&&W){var D=-p*n/Y,E=-p*y/W;if("roaming"===g)N.rotate(G,D/2,E/2);else if(g===bp||g===io||g===oi)o._86O||a.beginTransaction(),o.fi({kind:o._86O?"betweenEditRotation":"beginEditRotation",event:G}),o._86O=1,o.sm().each(function(Z){if(rn(Z)&&o.isRotationEditable(Z)){var v=J(D)>J(E)?D:E;g===bp?Z.setRotationX(Z.getRotationX()+v):g===io?Z.setRotationY(Z.getRotationY()+v):g===oi&&Z.setRotationZ(Z.getRotationZ()+v)}});else if("move"===g||oc[g]){g===Hl||g===Om||g===Hh?(o._87O||a.beginTransaction(),o.fi({kind:o._87O?"betweenEditScale":"beginEditScale",event:G}),o._87O=1):(o._moving||a.beginTransaction(),o.fi({kind:o._moving?"betweenMove":"beginMove",event:G}),o._moving=1);var K,e=N.p3,q=o.getPositionInfo(e),B=gi(o);K=g===lc?"x":g===Ul?"y":g===Qb?"z":g===Hl?"sx":g===Om?"sy":g===Hh?"sz":o.getMoveMode(G,N.movedata),n=n/Y*q.width,y=-1*y/W*q.height;var b,m,v=[B[0]*n,B[4]*n,B[8]*n],w=[B[1]*y,B[5]*y,B[9]*y],R=v[0]+w[0],M=v[1]+w[1],O=v[2]+w[2],u=[e[0]+R,e[1]+M,e[2]+O],s=ke(o.getEye(),u,!0);if("xyz"===K?(b=u,o.moveSelection(R,M,O)):"xz"===K?(b=$i(o,e,[0,1,0],u),b&&o.moveSelection(b[0]-e[0],0,b[2]-e[2])):"xy"===K?(b=$i(o,e,[0,0,1],u),b&&o.moveSelection(b[0]-e[0],b[1]-e[1],0)):"yz"===K?(b=$i(o,e,[1,0,0],u),b&&o.moveSelection(0,b[1]-e[1],b[2]-e[2])):"x"===K||"sx"===K?(s[0]=0,b=$i(o,e,s,u),b&&(m=b[0]-e[0],"x"===K?o.moveSelection(m,0,0):o.sm().each(function(j){rn(j)&&o.isSizeEditable(j)&&(P=j.getScaleX()+m/100,S=P/j.getScaleX(),j.setScaleX(P),km(G)&&(j.setScaleY(j.getScaleY()*S),j.setScaleTall(j.getScaleTall()*S)))}))):"y"===K||"sy"===K?(s[1]=0,b=$i(o,e,s,u),b&&(m=b[1]-e[1],"y"===K?o.moveSelection(0,m,0):o.sm().each(function(J){rn(J)&&o.isSizeEditable(J)&&(P=J.getScaleTall()+m/100,S=P/J.getScaleTall(),J.setScaleTall(P),km(G)&&(J.setScaleY(J.getScaleY()*S),J.setScaleX(J.getScaleX()*S)))}))):("z"===K||"sz"===K)&&(s[2]=0,b=$i(o,e,s,u),b&&(m=b[2]-e[2],"z"===K?o.moveSelection(0,0,m):o.sm().each(function(n){rn(n)&&o.isSizeEditable(n)&&(P=n.getScaleY()+m/100,S=P/n.getScaleY(),n.setScaleY(P),km(G)&&(n.setScaleX(n.getScaleX()*S),n.setScaleTall(n.getScaleTall()*S)))}))),!b)return;N.p3=b}else if(g===Xb){var t=N.div;t||(t=N.div=Lp(),Dj(N.getView(),t),t.op=Z,t.style.background=o.getRectSelectBackground()),o.fi({kind:o._rectSelecting?"betweenRectSelect":"beginRectSelect",event:G}),o._rectSelecting=1,t.rect=Bc(t.op,x),ci(t,t.rect)}else if("pinch"===g&&2===on(G)){o.fi({kind:o._pinching?"betweenPinch":"beginPinch",event:G}),o._pinching=1;var m=Oi(G);o.handlePinch(m,N.dist),N.dist=m}else"pan"===g||km(G)||im(G)?N.pan(G,n,y):"none"===g||o.isFirstPersonMode()||N.rotate(G,D,E);N.point=x}},pan:function(c,i,L){var d=this.gv;if(d.isPannable()){var x=d.getWidth(),S=d.getHeight();if(!x||!S)return;var F=d.getCenterInfo(),k=i/x*F.width,H=-1*L/S*F.height;d.fi({kind:d._panning?"betweenPan":"beginPan",event:c}),d._panning=1,d.pan(-k,-H)}},rotate:function(k,$,D){var H=this.gv;H.isRotatable()&&(H.fi({kind:H._rotating?"betweenRotate":"beginRotate",event:k}),H._rotating=1,H.rotate($,D))
},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},handleWindowTouchEnd:function(o){var I=this,M=I.gv,P=M.dm(),X=I.div;if(X){var T=M.getDatasInRect(X.rect);if(!T.isEmpty()){var V=M.sm(),L=V.toSelection();T.each(function(n){V.co(n)?L.remove(n):L.add(n)}),V.ss(L)}Zb(X)}M._moving&&(delete M._moving,M.fi({kind:"endMove",event:o}),M.onMoveEnded(),P.endTransaction()),M._panning&&(delete M._panning,M.fi({kind:"endPan",event:o}),M.onPanEnded()),M._rotating&&(delete M._rotating,M.fi({kind:"endRotate",event:o}),M.onRotateEnded()),M._86O&&(delete M._86O,M.fi({kind:"endEditRotation",event:o}),P.endTransaction()),M._87O&&(delete M._87O,M.fi({kind:"endEditScale",event:o}),P.endTransaction()),M._pinching&&(delete M._pinching,M.fi({kind:"endPinch",event:o}),M.onPinchEnded()),M._rectSelecting&&(delete M._rectSelecting,M.fi({kind:"endRectSelect",event:o}),M.onRectSelectEnded()),M._walking&&(delete M._walking,M.fi({kind:"endWalk",event:o}),M.onWalkEnded()),I.dist=I.point=I._62O=I.p3=I.movedata=I.div=I._57I=I._32Q=I._31Q=I.foward=s}});var mc=gd.MapInteractor=function(_){$d(mc,this,[_]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Ab("MapInteractor",Do,{handle_contextmenu:function(T){yc(T)},handle_mousewheel:function(w){this.gv.handleScroll(w,w.wheelDelta/40)},handle_DOMMouseScroll:function(r){2===r.axis&&this.gv.handleScroll(r,-r.detail)},handle_keydown:function(s){this.gv.handleKeyDown(s)},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(M){yc(M);var F=this,i=F.gv;if(i.setFocus(M)){var v=i.getDataInfoAt(M),$=v?v.data:s,c=v?v.part:s,p=F.editing={point:i.lp(M)};mo?p.touch=!0:(p.touch=!1,p.clickLeft=ee(M),p.pan=im(M)?!0:"left"===this.panButton===p.clickLeft),$&&i._39Q($)&&(p.preventDefault=!0),Fh(F,M),Ec(M)?i.handleDoubleClick(M,$,c):i.handleClick(M,$,c)}},handle_mouseup:function($){this.handle_touchend($)},handle_touchend:function(){},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(W){var c=this,_=c.gv,J=c.editing;if(J){var k=_.lp(W),d=J.point,o=k.x-d.x,$=k.y-d.y;if(!J.moved){if(Math.abs(o)<c.threshold&&Math.abs($)<c.threshold&&!(W.touches&&W.touches.length>1))return;J.moved=!0}if(!J.preventDefault)if(J.point=k,J.touch){var j=W.touches.length;if(2!==j)c.pan(W,o,$);else{if(1>=j)return;var e=W.touches,h={x:e[0].clientX,y:e[0].clientY},V={x:e[1].clientX,y:e[1].clientY},P={x:V.x-h.x,y:V.y-h.y},B=J.lastCenter,n=Math.atan2(P.y,P.x),Y=J.theta,K=0;Y==s?Y=J.theta=n:(K=n-Y,J.thetaStarted||Math.abs(K)>c.touchRotateThreshold?(J.thetaStarted=!0,J.theta=n):K=0);var l=N*(h.y+V.y)/2/_.getHeight(),T=J.phi,i=0;T==s?T=J.phi=l:(i=l-T,J.phiStarted||Math.abs(i)>c.touchRotateThreshold?(J.phiStarted=!0,J.phi=l):i=0);var X,F=Math.sqrt(P.x*P.x+P.y*P.y),z=J.vlen;if(z){var r=h.x-B.x,y=h.y-B.y,O=V.x-B.x,t=V.y-B.y,U=Math.sqrt(r*r+y*y),H=Math.sqrt(O*O+t*t),a=z/2,E=c._sign2(U-a),L=c._sign2(H-a);0>E*L||0===E&&0===L?(X=1,J.vlen=F):(X||(X=F/z),J.scaleStarted||Math.abs(X-1)>c.touchScaleThreshold?(J.vlen=F,J.scaleStarted=!0):X=1)}else z=J.vlen=F,X=1;1!==X&&_.setZoom(X),(i||K)&&c.rotate(W,K,-i),J.lastCenter={x:(V.x+h.x)/2,y:(V.y+h.y)/2}}}else if(J.pan)c.pan(W,o,$);else{var I=_.getWidth(),f=_.getHeight();if(!I||!f)return;var Q=-p*o/I,D=-p*$/f;c.rotate(W,Q,D)}}},_sign2:function(e){return Math.abs(e)<this._touchScaleCheckAccuracy?0:e>0?1:-1},handleWindowMouseUp:function(P){this.handleWindowTouchEnd(P)},handleWindowTouchEnd:function(A){var l=this,o=l.editing;if(l.editing=null,o){var G=l.gv;if(o.moved||!o.clickLeft&&!o.touch)G._panning=null,G._rotating=null,G.fi({kind:o.pan?"endPan":"endRotate",event:A});else{var m=G.getDataAt(A);m?G.sm().setSelection([m]):G.sm().clearSelection()}}},pan:function(v,K,G){var t=this,c=t.gv;if(c.isPannable()){var p=c.getWidth(),J=c.getHeight();if(p&&J){var l=c.getCenterInfo(),z=-K/p*l.width,u=1*G/J*l.height;c.fi({kind:c._panning?"betweenPan":"beginPan",event:v}),c._panning=1;var Q=t.keepHorizon,B=t.editing.touch;if((B&&v.touches&&v.touches.length>1||!B&&km(v))&&(Q=!Q),!Q)return c.pan(z,u);if(z||u){var g=gi(c),P=[g[0]*z,g[4]*z,g[8]*z],C=[g[1],0,g[9]],r=Math.sqrt(C[0]*C[0]+C[2]*C[2]);r&&(C=[C[0]/r*u,0,C[2]/r*u]);var d=P[0]+C[0],M=P[1]+C[1],_=P[2]+C[2],R=c._center,y=c._eye;R[0]+=d,R[1]+=M,R[2]+=_,y[0]+=d,y[1]+=M,y[2]+=_,c.fp(kh,s,y),c.fp(zc,s,R)}}}},rotate:function(X,L,Q){var k=this,_=k.gv;if(_.isRotatable()){var G=_._center,v=_._eye,U=ke(v,G),M=c(r(U[0]*U[0]+U[2]*U[2]),U[1]),Z=Sd(M+Q);Q=Z-M,_.fi({kind:_._rotating?"betweenRotate":"beginRotate",event:X}),_._rotating=1,_.rotate(L,Q)}}}),e.defineProperties(mc.prototype,{panButton:{get:function(){return this._panButton},set:function(V){this._panButton=V}},minPhi:{get:function(){return k.graph3dViewMinPhi},set:function(Q){k.graph3dViewMinPhi=Q}},maxPhi:{get:function(){return k.graph3dViewMaxPhi},set:function(j){k.graph3dViewMaxPhi=j}},keepHorizon:{get:function(){return this._keepHorizon},set:function(k){this._keepHorizon=k}},threshold:{get:function(){return this._threshold},set:function(Q){this._threshold=Q}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(l){this._touchScaleThreshold=l}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(D){this._touchRotateThreshold=D}}});var Lc,zh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",bc=32,Ym=gd.GlobeInteractor=function(V,a){$d(Ym,this,[V]);var T,Z=a.radius||6378137,E=this,N=null;Lc||(Lc=Lp(),Lc.style.border="",Lc.style.backgroundImage="url("+zh+")");var m=new tl,J=new wo,v=new wo,q=new wo,F=new Sp,d="number"==typeof Z?{x:Z,y:Z,z:Z}:Z,D={center:new wo(0,0,0),radius:d},Q=function(O){V._81O=null;var m=V.getHitPosition(O,V.getCenter(),J.copy(V.getEye()).sub(v.copy(V.getCenter())).toArray());return F.origin.copy(V.getEye()),F.direction.copy(m).sub(F.origin).normalize(),F.intersectEllipsoid(D)},h=function(c,E){V._81O=null,F.origin.copy(V.getEye());for(var L,d,S=V.getCenter(),u=J.copy(V.getEye()).sub(v.copy(V.getCenter())).toArray(),$=1,p=16,H=0,a=1,A={x:0,y:0};p--;){if(A.x=E.x+(c.x-E.x)*$,A.y=E.y+(c.y-E.y)*$,L=V.getHitPosition(A,S,u),F.direction.copy(L).sub(F.origin).normalize(),d=F.intersectEllipsoid(D),d&&1===$)return{hit:d};d?H=$:a=$,$=(H+a)/2}return{hit:d,out:1>$}},$=function(o,a){if(N){var S=Date.now();N.deltaTime=N.lastTime?S-N.lastTime:1e3,N.lastTime=S,N.lastAxis=o,N.lastAngle=a}a&&(m.setFromAxisAngle(o,a),V.setEye(J.copy(V.getEye()).applyQuaternion(m).toArray()),V.setCenter(J.copy(V.getCenter()).applyQuaternion(m).toArray()),V.setUp(J.copy(V.getUp()).applyQuaternion(m).toArray()))};E._showCrossIcon=function(r){Dj(E.getView(),Lc),ci(Lc,{x:r.clientX-bc/2,y:r.clientY-bc/2,width:bc,height:bc})},E._hideCrossIcon=function(){Zb(Lc)},E._scrollImpl=function(j,Z){N={point:V.lp(j),screen:xl(j),hit:Q(j),type:"right"},N.hitNormalize=N.hit?N.hit.clone().normalize():new wo;var e={clientX:N.screen.x,clientY:N.screen.y+10*Z};E._handleMoveImpl(e),E._endMoveImpl(e)},E._startMoveImpl=function(a){T&&(T.stop(!0),T=null),N={point:V.lp(a),screen:xl(a),hit:Q(a)},N.hitNormalize=N.hit?N.hit.clone().normalize():new wo,mo?1===a.touches.length?N.hit&&(N.type="left"):2===a.touches.length&&(N.type="touch2"):(ee(a)?N.hit&&(N.type="left"):dq(a)?N.type="right":im(a)&&N.hit&&(N.type="middle"),!N.hit||"right"!==N.type&&"middle"!==N.type||E._showCrossIcon(a)),N.type&&Fh(E,a)},E._handleMoveImpl=function(V){if(N)switch(N.type){case"left":return E._handleLeft(V);case"right":return E._handleRight(V);case"middle":return E._handleMiddle(V);case"touch2":return E._handleTouch2(V)}},E._endMoveImpl=function(){if(N){if(this._hideCrossIcon(),"left"===N.type||"middle"===N.type){var J=1e3*(N.lastAngle/(N.deltaTime||30)),W=N.lastAxis,c=N.lastTime,M=function(){var y=Date.now(),o=(y-c)/1e3;return c=y,J*=Math.pow(Math.abs(E.decelerationRate),3*o),Math.abs(J)<.01?(J=0,T&&T.stop(),void 0):($(W,J*o),void 0)};T=gp({action:function(){M(arguments)},duration:5e3})}N=null}},E._handleLeft=function(n){if(!N.finished){var P=xl(n),Q=h(P,N.lastScreen||N.screen);if(N.lastScreen=P,!Q.hit)return N.finished=!0,E._endMoveImpl(n),void 0;var T=Q.hit;T.normalize();var t=N.hitNormalize,K=Math.acos(T.dot(t)),e=T.cross(t).normalize();$(e,K),Q.out&&(N.finished=!0,E._endMoveImpl(n))}},E._handleRight=function(o){var G=N.lastScreen||N.screen,Y=G.y;G=N.lastScreen=xl(o);var M=G.y,h=M-Y;if(h){var x=Math.min(.5,h*E.scaleSpeed);J.copy(V.getEye());var s=N.hit;s||(s=J.clone().divide(d).normalize().multiply(d)),v.copy(J).lerp(s,x),V.setEye(v.toArray()),J.copy(V.getUp()),v.normalize();var P=J.clone().cross(v).normalize();if(q.copy(V.getCenter()),q.sub(P.multiplyScalar(q.dot(P))),V.setCenter(q.toArray()),N.hit){var S=Q(N.screen),m=N.hitNormalize;if(S){S.normalize();var l=Math.acos(S.dot(m)),p=S.cross(m).normalize();l&&$(p,l)}}}};var P=function(q){return Math.abs(q)<.01?0:q>0?1:-1};E._handleTouch2=function(E){var x=E.touches.length;if(2===x){var z=E.touches,d={x:z[0].clientX,y:z[0].clientY},h={x:z[1].clientX,y:z[1].clientY},G={x:h.x-d.x,y:h.y-d.y},y=N.lastCenter,l=Math.atan2(G.y,G.x),W=N.theta,S=0;W==s?W=N.theta=l:(S=l-W,N.thetaStarted||Math.abs(S)>.03?(N.thetaStarted=!0,N.theta=l):S=0);var M,u=Math.sqrt(G.x*G.x+G.y*G.y),k=N.vlen;if(k){var w=d.x-y.x,A=d.y-y.y,m=h.x-y.x,T=h.y-y.y,p=Math.sqrt(w*w+A*A),O=Math.sqrt(m*m+T*T),r=k/2,j=P(p-r),n=P(O-r);0>j*n||0===j&&0===n?(M=1,N.vlen=u):(M||(M=u/k),N.scaleStarted||Math.abs(M-1)>.05?(N.vlen=u,N.scaleStarted=!0):M=1)}else k=N.vlen=u,M=1;var G=v.copy(V.getEye()).clone();1!==M&&V.setEye(G.setLength((G.length()-Z)/M+Z).toArray()),S&&$(G.normalize(),S),N.lastCenter={x:(h.x+d.x)/2,y:(h.y+d.y)/2}}},E._handleMiddle=function(d){var P=xl(d),f=N.screen;N.screen=P;var s=(P.y-f.y)/180*Math.PI*E.rollSpeed;v.copy(V.getCenter()).sub(J.copy(V.getEye())).normalize(),J.copy(V.getUp()).cross(v).normalize(),v.copy(V.getEye()).sub(N.hit).applyAxisAngle(J,s).add(N.hit);var G=v.clone();v.copy(V.getCenter()).sub(N.hit).applyAxisAngle(J,s).add(N.hit);var i=v.clone(),h=v.copy(V.getUp()).applyAxisAngle(J,s).clone(),x=!1;s>0&&(q.copy(h),v.copy(i).sub(G).normalize(),J.copy(G).multiplyScalar(-1).normalize(),J.dot(q)-v.dot(q)>0&&(x=!0)),x||q.copy(N.hit).sub(G).dot(N.hitNormalize)>=0&&(x=!0),x||(V.setEye(G.toArray()),V.setCenter(i.toArray()),V.setUp(h.toArray()));var t=-(P.x-f.x)/180*Math.PI*E.rotateSpeed;$(N.hitNormalize,t)}};Ab("GlobeInteractor",Do,{handle_contextmenu:function(q){yc(q)},handle_mousewheel:function(b){this._scrollImpl(b,b.wheelDelta/40)},handle_DOMMouseScroll:function(i){2===i.axis&&this._scrollImpl(i,-i.detail)},handle_keydown:function(D){this.gv.handleKeyDown(D)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(d){yc(d);var _=this.gv;if(_.setFocus(d)){var i=_.getDataInfoAt(d),n=i?i.data:s;n&&_.isInteractive(n)||this._startMoveImpl(d);var U=i?i.part:s;Ec(d)?_.handleDoubleClick(d,n,U):_.handleClick(d,n,U)}},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(){},handleWindowMouseMove:function(j){this.handleWindowTouchMove(j)},handleWindowTouchMove:function(X){this._handleMoveImpl(X)},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},handleWindowTouchEnd:function(t){this._endMoveImpl(t)}}),e.defineProperties(Ym.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(b){this._rotateSpeed=b}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(U){this._rollSpeed=U}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(X){this._scaleSpeed=X}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(A){this._decelerationRate=A}}});var zm=function(e){this.gv=e};an(zm,e,{_iv:!0,iv:function(){this._iv=!0},face:function(z,i){var b=this,x=b.gv.getGL();if(!x||!rn(z))return s;var M=i.x,u=i.width,P=i.height,V=b.height-i.y-P,f=G(u/2),F=new Uint8Array(4*u*P),j=0;for(b.iv(),b.validate(z),xh(x,b.frame),x.readPixels(M,V,u,P,x.RGBA,x.UNSIGNED_BYTE,F),oe(x),b.iv();f>=j;j++)for(var J=f-j,l=f+j,v=J;l>=v;v++)for(var H=J;l>=H;H++)if(v===J||v===l||H===J||H===l){var y=pr.m[F[4*(v*u+H)]];if(y)return y}},get:function(f,h){this.validate();var V=this,i=V.gv.getGL();if(!i)return s;var L,o,F=f.x,r=f.width,g=f.height,v=V.height-f.y-g,H=G(r/2),P=new Uint8Array(4*r*g),U=0,Y=P.length,j=h?s:new bm,I=h?s:{};if(xh(i,V.frame),i.readPixels(F,v,r,g,i.RGBA,i.UNSIGNED_BYTE,P),oe(i),h){for(;H>=U;U++)for(var l=H-U,M=H+U,c=l;M>=c;c++)for(var k=l;M>=k;k++)if((c===l||c===M||k===l||k===M)&&(L=V.info(P,4*(c*r+k))))return L}else for(;Y>U;U+=4)L=V.info(P,U),L&&(o=L.data,I[o._id]||(j.add(o),I[o._id]=o));return j},info:function(k,N){return this.colorMap[(k[N]<<16)+(k[N+1]<<8)+k[N+2]+((127&k[N+3])<<24)]},validate:function(g){var w=this,L=w.gv,Z=L.getGL();if(Z){var c=L.getWidth(),X=L.getHeight(),S=Z.RGBA,N=Z.TEXTURE_2D,T=Z.RENDERBUFFER,i=Z.FRAMEBUFFER;w.texture||(w.texture=yq(Z),w.render=Z.createRenderbuffer(),w.frame=Z.createFramebuffer()),(w.width!==c||w.height!==X)&&(ik(Z,w.texture),Z.texImage2D(N,0,S,c,X,0,S,Z.UNSIGNED_BYTE,s),jg(Z,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.bindRenderbuffer(T,w.render),Z.renderbufferStorage(T,Z.DEPTH_COMPONENT16,c,X),xh(Z,w.frame),Z.framebufferTexture2D(i,Z.COLOR_ATTACHMENT0,N,w.texture,0),Z.framebufferRenderbuffer(i,Z.DEPTH_ATTACHMENT,T,w.render),ik(Z,s),Z.bindRenderbuffer(T,s),oe(Z),w.width=c,w.height=X),w._iv&&(w._iv=!1,xh(Z,w.frame),L._42(g||(w.colorMap={}),1),oe(Z))}}});var fe=function(e){this.gv=e};an(fe,e,{gap:0,size:0,_42:function(p,a){var y=this,X=y.gv,G=X._gridGap,K=X._gridSize;if(X._gridVisible){if(y.gap!==G||y.size!==K){for(var A=[],B=X._gridSize/2,R=G*B,Y=0;2*B+1>Y;Y++){var N=6*Y,u=6*(2*B+1)+N;A[N]=-R,A[N+1]=0,A[N+2]=-R+Y*G,A[N+3]=R,A[N+4]=0,A[N+5]=-R+Y*G,A[u]=-R+Y*G,A[u+1]=0,A[u+2]=-R,A[u+3]=-R+Y*G,A[u+4]=0,A[u+5]=R}y.vs=new vi(A),y.gap=G,y.size=K}ll(X),ur(p,a),bf(p),hr(p,a,1,X._gridColor,X._buffer.vs,y.vs),$b(p,0,y.vs.length/3,p.LINES),wq(p),xo(p,a)}else y.vs=y.gap=y.size=s}});var Uo=function(e){this.gv=e};an(Uo,e,{_42:function(j,I){var _=this.gv,g=_._buffer.vs,i=_._axisXColor,q=_._axisYColor,m=_._axisZColor,o=_._originAxisVisible,c=_._centerAxisVisible;if(o||c){var K=$l?j.TRIANGLES:j.TRIANGLE_FAN,J=j.LINES;if(ll(_),ur(j,I),bf(j),o){var Q=_.getCenterInfo(),p=B(Q.width,Q.height)/5,w=.8*p,F=.05*p;hr(j,I,1.5,i,g,new vi([0,0,0,p,0,0,w,F,0,w,0,F,w,-F,0,w,0,-F,w,F,0,0,0,0,0,p,0,F,w,0,0,w,F,-F,w,0,0,w,-F,F,w,0,0,0,0,0,0,p,F,0,w,0,F,w,-F,0,w,0,-F,w,F,0,w])),$b(j,0,2,J),$b(j,1,6,K),hr(j,I,s,q),$b(j,7,2,J),$b(j,8,6,K),hr(j,I,s,m),$b(j,14,2,J),$b(j,15,6,K)}if(c){var Y=_._center,R=Y[0],T=Y[1],D=Y[2],Q=_.getPositionInfo(Y);p=B(Q.width,Q.height)/20,hr(j,I,1.5,i,g,new vi([R,T,D,R+p,T,D,R,T,D,R,T+p,D,R,T,D,R,T,D+p])),$b(j,0,2,J),hr(j,I,s,q),$b(j,2,2,J),hr(j,I,s,m),$b(j,4,2,J)}wq(j),xo(j,I)}}});var wm=function(S){this.gv=S,this.onMouseOver=this.onMouseOver.bind(this),this.mode=wm.Mode.Disable};wm.Mode={Disable:0,Selection:1,MouseOver:2},an(wm,e,{onMouseOver:function(C){k.preventDefault(C);var x=this.gv.getDataAt(C);x!==this.mouseOverData&&(this.mouseOverData=x,this.gv.iv())},setFetchTargetFunc:function(X){this.fetchTargetFunc=X},_42:function(X,z){var d,j=this,B=j._mode;if(B!==wm.Mode.Disable&&(B===wm.Mode.Selection?d=j.gv.sm().getSelection().toArray(function(N){return N.s("highlight.visible")}):B===wm.Mode.MouseOver&&j.mouseOverData&&j.mouseOverData.s("highlight.visible")&&(d=[j.mouseOverData]),j.fetchTargetFunc&&(d=j.fetchTargetFunc(d)),d&&d.length)){var f=j.gv,c=f.vr.isPresenting(),Q=f.getWidth();if(c){var R=f.getWidth;Q/=2,f.getWidth=function(){return Q};var s=f.getViewport()}var M,g=f.getDevicePixelRatio(),V=Q*g,n=f.getHeight()*g;(M=j._renderTarget)?M.setSize(X,V,n):j._renderTarget=M=new gd.RenderTarget(f,X,V,n),xh(X,M.frame),f.drawFilter=function(h){return d.indexOf(h)<0?!0:void 0},f._42({}),f.drawFilter=null,oe(X),c&&(f.getWidth=R,f.setViewport(X,s[0],s[1],s[2],s[3]));var a=X._compiledShader.highlight;if(a||(a=X._compiledShader.highlight=new ii.Shader(X,ah.vs,ah.fs)),a.bind(),X.enable(X.BLEND),X.activeTexture(X.TEXTURE0+0),X.bindTexture(X.TEXTURE_2D,M.texture),a.uniforms.image=0,a.uniforms.textureSize=[V,n],a.uniforms.edgeWidth=i["highlight.width"],j.highlightColor!==i["highlight.color"]){var q=$h(j.highlightColor=i["highlight.color"]);j.highlightColorData=[q[0]/255,q[1]/255,q[2]/255,q[3]/255]}a.uniforms.edgeColor=j.highlightColorData,j.ibuffer?(j.ibuffer.upload(),j.vbuffer.upload()):(j.ibuffer=ii.Buffer.createIndexBuffer(X,new Uint16Array([0,2,1,1,2,3])),j.vbuffer=ii.Buffer.createVertexBuffer(X,new Float32Array([0,0,1,0,0,1,1,1]))),a.attributes.pos.pointer(j.vbuffer),X.drawElements(X.TRIANGLES,6,X.UNSIGNED_SHORT,0),X.disable(X.BLEND),X.bindTexture(X.TEXTURE_2D,null),X.useProgram(z)}}}),e.defineProperties(wm.prototype,{mode:{get:function(){return this._mode},set:function(M){var J=this._mode;M!==J&&(this._mode=M,M===wm.Mode.MouseOver?K(this.gv.getView(),"mousemove",this.onMouseOver):J===wm.Mode.MouseOver&&f(this.gv.getView(),"mousemove",this.onMouseOver))}}});var ah={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Jf=function(l){this.gv=l},lc="edit_tx",Ul="edit_ty",Qb="edit_tz",bp="edit_rx",io="edit_ry",oi="edit_rz",Hl="edit_sx",Om="edit_sy",Hh="edit_sz",oc={};oc[lc]=1,oc[Ul]=1,oc[Qb]=1,oc[bp]=1,oc[io]=1,oc[oi]=1,oc[Hl]=1,oc[Om]=1,oc[Hh]=1,an(Jf,e,{_42:function(S,m,H){var t=this,o=t.gv,s=o.sm().ld();if(s&&o.isEditable(s)&&!o.isEditHelperDisabled()&&rn(s)&&(!o.isFirstPersonMode()||!o.isMouseRoamable()&&!mo)){ll(o);var u,i,q=o.isMovable(s),$=o.isRotationEditable(s),z=o.isSizeEditable(s),E=o._axisXColor,N=o._axisYColor,U=o._axisZColor,W=o._editSizeColor,Z=s.p3(),J=Qd(o.getEye(),Z)/10,h=J/(H?5:10),X=.7*J,c=.4*X,D=Z[0],w=Z[1],y=Z[2];u=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],q&&t._17O(S,m,s,H,lc,E,u,[D,w-h,y,D+X,w-h,y,D+X,w,y,D+X,w,y,D,w,y,D,w-h,y,D,w-h,y+h,D+X,w-h,y+h,D+X,w-h,y,D+X,w-h,y,D,w-h,y,D,w-h,y+h]),i=D+X,z&&t._17O(S,m,s,H,Hl,W,u,[i,w-h,y,i+c,w-h,y,i+c,w,y,i+c,w,y,i,w,y,i,w-h,y,i,w-h,y+h,i+c,w-h,y+h,i+c,w-h,y,i+c,w-h,y,i,w-h,y,i,w-h,y+h]),i+=c,$&&t._17O(S,m,s,H,bp,E,u,[i,w-h,y,i+c,w-h,y,i+c,w,y,i+c,w,y,i,w,y,i,w-h,y,i,w-h,y+h,i+c,w-h,y+h,i+c,w-h,y,i+c,w-h,y,i,w-h,y,i,w-h,y+h]),u=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],q&&t._17O(S,m,s,H,Ul,N,u,[D,w,y,D,w+X,y,D-h,w+X,y,D-h,w+X,y,D-h,w,y,D,w,y,D,w,y,D,w,y-h,D,w+X,y-h,D,w+X,y-h,D,w+X,y,D,w,y]),i=w+X,z&&t._17O(S,m,s,H,Om,W,u,[D,i,y,D,i+c,y,D-h,i+c,y,D-h,i+c,y,D-h,i,y,D,i,y,D,i,y,D,i,y-h,D,i+c,y-h,D,i+c,y-h,D,i+c,y,D,i,y]),i+=c,$&&t._17O(S,m,s,H,io,N,u,[D,i,y,D,i+c,y,D-h,i+c,y,D-h,i+c,y,D-h,i,y,D,i,y,D,i,y,D,i,y-h,D,i+c,y-h,D,i+c,y-h,D,i+c,y,D,i,y]),u=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],q&&t._17O(S,m,s,H,Qb,U,u,[D,w,y,D,w,y+X,D,w-h,y+X,D,w-h,y+X,D,w-h,y,D,w,y,D,w-h,y,D-h,w-h,y,D-h,w-h,y+X,D-h,w-h,y+X,D,w-h,y+X,D,w-h,y]),i=y+X,z&&t._17O(S,m,s,H,Hh,W,u,[D,w,i,D,w,i+c,D,w-h,i+c,D,w-h,i+c,D,w-h,i,D,w,i,D,w-h,i,D-h,w-h,i,D-h,w-h,i+c,D-h,w-h,i+c,D,w-h,i+c,D,w-h,i]),i+=c,$&&t._17O(S,m,s,H,oi,U,u,[D,w,i,D,w,i+c,D,w-h,i+c,D,w-h,i+c,D,w-h,i,D,w,i,D,w-h,i,D-h,w-h,i,D-h,w-h,i+c,D-h,w-h,i+c,D,w-h,i+c,D,w-h,i])}},_17O:function(L,G,y,Y,N,u,l,n){var K=this.gv._buffer;Od(L,G,Y,!0,y,N),yl(L,G,s,!0,s,!0,s,!1),is(L,G.uDiffuse,u),Sg(L,K.vs,new vi(n),G.aPosition),Sg(L,K.ns,new vi(l),G.aNormal),bf(L),$b(L,0,12),wq(L),fm(L,G)}});var Kq=l.Raycaster=function(I){this.gv=I,this.maxTriangleTest=1/0,this.backfaceCulling=!0};tf("Raycaster",e,{intersect:function(M){var B=this,F=B.gv,N=F.getDataAt(M);return N?B.intersectObject(M,N):null},intersectObjects:function(A,n,C){var l,q,_,h,c=this,f=1/0,N=A.origin||(new wo).fromArray(c.gv.getEye()),b=c.maxTriangleTest,I=[];return n.forEach(function(T){C&&C(T)===!1||T.s("intersect")!==!1&&I.push(T)}),I.sort(function(z,g){return N.distanceToSquared2(z.p3())-N.distanceToSquared2(g.p3())}),c.countTriangles=0,I.forEach(function(x){c.countTriangles>b||(l=c.intersectObject(A,x),l&&(q=N.distanceToSquared(l.world),f>q&&(_=x,h=l,f=q)))}),c.countTriangles=0,{data:_,intersect:h}},intersectObject:function(D,w){if(D instanceof Sp)return this._intersectObjectImpl(D,w);var V=this,B=V.gv,f=B.unproject(D),v=new wo,Q=B.getEye(),A=new wo;if(B.isOrtho()){var L=new wo(Q);A.copy(B.getCenter()).sub(L).normalize();var C=v.copy(f).sub(L).dot(A);v.copy(A).setLength(-C).add(L.copy(f))}else v.copy(Q),A.copy(f).sub(v).normalize();var s=new l.Math.Ray(v,A);return V._intersectObjectImpl(s,w)},_intersectObjectImpl:function(){function L(){var V=new wo;return V.subVectors(P,s),$.subVectors(Z,s),V.cross($).normalize(),V}function H(l,u,m,b,z,s,N){return Vi.barycoordFromPoint(l,u,m,b,K),z.multiplyScalar(K.x),s.multiplyScalar(K.y),N.multiplyScalar(K.z),z.add(s).add(N),z.clone()}var T=new pl,W=new pl,q=new Sp,J=new wo,Q=new wo,f=new wo,V=new wo,g=new wo,Z=new wo,s=new wo,P=new wo,c=new Kk,R=new Kk,N=new Kk,$=new wo,x={vs:Ii,is:un,uv:ab},K=new wo;return function(y,o){var k=this.gv.getData3dUI(o),i=o.mat||k.mat;if(i){T.fromArray(i),W.getInverse(T),q.copy(y).applyMatrix4(W);var p,X,e="body",C=k.shapeModel;if(C||(C=As(k)),C||(o instanceof l.Node&&!(o instanceof l.Shape)?(p=!0,C=x):(X=!0,C=[k.left,k.front,k.right,k.back,k.top,k.bottom])),!C)return console.log("Can not find shape model."),null;Cq(C)||(C=[C]);var h,m,_,z,O,K,F,b,t,G,M,w,v,D,U,S,Y=1/0,n=["","top_","bottom_"],d=!1,A=this.backfaceCulling;for(h=0,m=C.length;m>h;h++)if(v=C[h])for(_=0,z=n.length;z>_;_++)if(D=n[_],F=v[D+"vs"],b=v[D+"is"],t=v[D+"uv"]||v[D+"tuv"],F){if(U=v[D+"boundingBox"]){var M=q.intersectBox(U);if(!M)continue;if(q.origin.distanceTo(M)>Y)continue;S=!1}else v[D+"boundingBox"]=U=new l.Math.Box3,S=!0;for(O=0,K=b?b.length:F.length/3;K>O;O+=3)this.countTriangles++,b?(Q.fromArray(F,3*b[O]),f.fromArray(F,3*b[O+1]),V.fromArray(F,3*b[O+2])):(Q.fromArray(F,3*O),f.fromArray(F,3*(O+1)),V.fromArray(F,3*(O+2))),S&&(U.expandByPoint(Q),U.expandByPoint(f),U.expandByPoint(V)),G=q.intersectTriangle(Q,f,V,A,J),G&&(w=q.origin.distanceTo(G),Y>w&&(Y=w,g.copy(G),Z.copy(Q),s.copy(f),P.copy(V),""!==D?e=D.slice(0,-1):p?e=cl[Math.floor(O/6)]:X&&(e=cl[h]),t&&(d=!0,b?(c.fromArray(t,2*b[O]),R.fromArray(t,2*b[O+1]),N.fromArray(t,2*b[O+2])):(c.fromArray(t,2*O),R.fromArray(t,2*(O+1)),N.fromArray(t,2*(O+2))))))}if(!isFinite(Y))return null;var E,r=g.clone().applyMatrix4(T);d&&(E=H(g,Z,s,P,c,R,N));var a=L(Z,s,P),$=L(Z.applyMatrix4(T),s.applyMatrix4(T),P.applyMatrix4(T)),u=q.direction.dot(a);return u>0&&(a.multiplyScalar(-1),$.multiplyScalar(-1)),{world:r,local:g.clone(),worldNormal:$,normal:a,uv:E,part:e}}}}()});var Cb=function(m,j){this.gv=m,this.s=function(Z,p,k){return p==s&&(p=k),p==s?j.getStyle(Z):Ud(p,j,m)},this.data=j};an(Cb,e,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(O,E,w,q){var Z=this,A=Z.data;if(!(A instanceof Rl)){var C,J,x,c,N,_,V,B=Z.gv,G=A._id,X=Z.s("shape3d.alwaysOnTop")?null:Z.s("batch"),n=B._batchIndexMap,r=B._batchModelMap,h=B.isSelectable(A),z=B.getBrightness(A),u=z!=s&&1!==z;if(Z.needValidate(O)){if(x=nd(n,r,A,X),Z.validate(x,X?al[X]||md:s),x&&(c=n[G],N=c.size=x.vs.length/3-c.begin,V=x.rs))for(z=u?z:1,_=0;N>_;_++)V.push(z);if(rn(A)){var Q=B.getWireframeGeometry(A);if(Q)Im(B,A,Q);else{var P=B.getWireframe(A);P&&Im(B,A,P)}}Z.labelInfo=Z.label2Info=Z.noteInfo=Z.note2Info=Z._38o=s,Z._24O(sk,"getLabel"),Z._24O(vf,"getLabel2"),Z._26O(am,"getNote"),Z._26O(vm,"getNote2"),Z._15O(),Z.interactiveInfo=B.isInteractive(A)?{}:s,Z._iv=!1}u&&is(O,E.uBrightness,z),is(O,E.uAlphaTest,Z.s("alphaTest")),is(O,E.uUseEnvMap,A.s("envmap")?!0:!1),is(O,E.uReflectivity,A.s("envmap")||.01),J=Od(O,E,w,h,A,qn),J&&(ld(J,n[G],r),ld(J,B._polylineIndexMap[G],B._polylineModelMap),ld(J,B._wireframeIndexMap[G],B._wireframeModelMap)),n[G]||Z._80o(O,E,q),B.isLabelVisible(A)&&((C=Z.labelInfo)&&(Od(O,E,w,h,A,sk),Z._28O(C,sk,q)),(C=Z.label2Info)&&(Od(O,E,w,h,A,vf),Z._28O(C,vf,q))),B.isNoteVisible(A)&&((C=Z.noteInfo)&&(Od(O,E,w,h,A,am),Z._29O(C,am,q)),(C=Z.note2Info)&&(Od(O,E,w,h,A,vm),Z._29O(C,vm,q))),(C=Z._38o)&&Z._99O(O,E,C,w,h,q),u&&is(O,E.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Zr},_80o:function(){},dispose:function(){},_calcAnchorMat:function(W){if(W.hasOwnProperty("_anchor")||W.hasOwnProperty("_anchorElevation")){var X=W.getAnchor3d(),Q={x:X.x-.5,y:X.y-.5,z:X.z-.5},n=Il();return Vf(n,[-Q.x,-Q.y,-Q.z]),n}},getBodyColor:function(V){var z=this.data,u=this.gv.getBodyColor(z);return u?u:V?z.getStyle(V):s},_24O:function(P,c){var F=this,W=F.data,r=F.gv,e=F.s,l=r[c](W);if(l!=s){var J=e(P+".scale"),_=e(P+".max"),$=F[P+"Info"]={label:l,textureScale:e(P+".texture.scale"),color:r[c+"Color"](W),font:e(P+".font"),align:e(P+".align"),background:r[c+"Background"](W)},h=$.rect=Sl($,l);_>0&&_<h.width&&($.labelWidth=h.width,h.width=_),h.x=h.y=0,h.width*=J,h.height*=J,$.mat=F._16O(e(P+".autorotate"),e(P+".position"),h,e(P+".face"),e(P+".t3"),e(P+".r3"),e(P+".rotationMode"));var b=h.width/2,Z=h.height/2;$.vs=new vi([-b,Z,0,-b,-Z,0,b,-Z,0,b,Z,0]),h.width/=J,h.height/=J}},_26O:function(E,V){var P=this,G=P.data,z=P.gv,H=P.s,Y=z[V](G);if(Y!=s){var C=H(E+".scale"),$=this[E+"Info"]={note:Y,textureScale:H(E+".texture.scale"),expanded:H(E+".expanded"),font:H(E+".font"),color:H(E+".color"),align:H(E+".align"),borderWidth:H(E+".border.width"),borderColor:H(E+".border.color"),background:z[V+"Background"](G)};if($.expanded){var S=H(E+".max"),h=Sl($,Y);h.width+=6,h.height+=2,S>0&&S<h.width&&($.labelWidth=h.width,h.width=S);var w={x:-h.width/2,y:-8-h.height,width:h.width,height:h.height+8}}else w={x:-6,y:-18,width:12,height:18};$.mat=P._16O(H(E+".autorotate"),H(E+".position"),s,H(E+".face"),H(E+".t3"),H(E+".r3"),H(E+".rotationMode")),$.rect=w,1!==C&&(w=Tm(w),w.x*=C,w.height*=C,w.y=-w.height,w.width*=C);var y=w.x,f=w.y,D=w.width,Z=w.height;$.vs=new vi([y,-f,0,y,-f-Z,0,y+D,-f-Z,0,y+D,-f,0])}},invalidateCachedTexture:function(r){var i,j,I,E=this;if((I=E._shape3dCachedImage)&&(r.deleteTexture(I),E._shape3dCachedImage=null),j=E._cubeCachedImage){for(i in j)r.deleteTexture(j[i]);E._cubeCachedImage=null}},_28O:function(J,i,E){if(E(this.s(i+".transparent"))){var O=J.rect,o=J.textureScale,U=O.width*o,B=O.height*o;if(U>=1&&B>=1){var c=dp(U,B);1!==o&&(c.translate(c,O.x,O.y),c.scale(o,o),c.translate(c,-O.x,-O.y)),wf(c,J),c.restore(),to(this,i,J.mat,J.vs,!0)}}},_29O:function(u,n,o){if(o(this.s(n+".transparent"))){var B=u.rect,C=u.textureScale,E=B.x,k=B.y,w=B.width*C,G=B.height*C;if(w>=1&&G>=1){B.x=B.y=0;var i=dp(w,G);1!==C&&i.scale(C,C),Xq(i,u),i.restore(),B.x=E,B.y=k,to(this,n,u.mat,u.vs,!1)}}},_99O:function(U,e,E,p,B,C){if(E){var u=this,_=u.gv,K=u.data,R=_._buffer,X=_._1O,N=E.icons;for(var i in N){var D=N[i],g=E.rects[i];if(g&&C(Ud(D.transparent,K,_))){Od(U,e,p,B,K,i);var j=Ud(D.shape3d,K,_),o=j?[j]:Ud(D.names,K,_),H=o?o.length:0,J=Ud(D.textureScale,K,_)||1,r=Ud(D.light,K,_);r==s&&(r=j?!0:!1),yl(U,e,Ud(D.blend,K,_),r,Ud(D.opacity,K,_),Ud(D.reverseFlip,K,_),Ud(D.reverseColor,K,_),Ud(D.reverseCull,K,_));for(var k=0;H>k;k++){var P=o[k],G=g[k];if(zp(u,G.mat),j)Wh(_,K,As(u,j),u);else{var d=Qf(P);if(d){var q=G.width*J,F=G.height*J;if(q>=1&&F>=1){var c=dp(q,F);Iq(c,d,Ud(D.stretch,K,_),0,0,q,F,K,_),c.restore(),yq(U,Nr,X),bf(U,e,X,Ud(D.discardSelectable,K,_),R.uv,Lj),Sg(U,R.vs,G.vs,e.aPosition),Bg(U,R.ns,Ok,e.aNormal),Di(U,R.is,Gg),_g(U,0,Gg.length),wq(U,e,X)}}}li(_)}fm(U,e)}}}}});var xi=function(A,N){$d(xi,this,[A,N])};an(xi,Cb,{_16O:function(F,I,r,h,Z,k,u,p,X){var m=this.data,w=m.getFinalScale3d(),Y=Oo(I,w,r,h,p,X);if(m.hasOwnProperty("_anchor")||m.hasOwnProperty("_anchorElevation")){var c=m.getAnchor3d();Y[0]-=(c.x-.5)*w[0],Y[1]-=(c.y-.5)*w[1],Y[2]-=(c.z-.5)*w[2]}return jj(Il(),Y,m.p3(),h,Z,k,u,F,m.getFinalRotation3d(),m.getRotationMode())},clear:function(){var J=this;J.faceMat=J.mat=J.shapeModel=J.left=J.right=J.front=J.back=J.top=J.bottom=J.csg=s},needValidate:function(W){if(this._iv)return this._validateFrameId=W._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var R=W._renderInfo.frame;if(this._validateFrameId!==R)return this._validateFrameId=R,!0}return!1},validate:function(B,n){var K=this,s=K.gv,P=K.data,b=K.shapeName=K.s(vl),x=As(K,b);K._updateAutoRotation(),K._updateFixSize2d(),K._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Ph(s,P,"_wireframeModelMap","_wireframeIndexMap"),Ph(s,P,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var S=No(P,s.getMat(P),x?K.s("shape3d.scaleable"):!0),T=K._calcAnchorMat(P);if(T&&so(S,S,T),P.mat=S,K.clear(),x||!b)if(B){var q=[];x?Ff(s,P,x,K,K.getBodyColor(),[S],B,q):(Ur(s,P,B,n,S,xb,q,_f),Ur(s,P,B,n,S,cr,q,Ek),Ur(s,P,B,n,S,rg,q,dh),Ur(s,P,B,n,S,Rc,q,Ue),Ur(s,P,B,n,S,Oh,q,zn),Ur(s,P,B,n,S,ss,q,Rd)),q.length&&(Hi(B.vs,q),Hi(B.ns,Pk(q)))}else K.mat=S,(K.shapeModel=x)||(K._cubeUvs=null,K.vf(xb,0),K.vf(cr,16),K.vf(Oh,8),K.vf(ss,24),K.vf(rg,32),K.vf(Rc,40))},_updateAutoRotation:function(){var m=new sr,i=new pl,d=new wo,I=new wo,b=new wo;return function(){var s=this,W=s.data,x=s.s("shape3d.autorotate");if(!x)return W._dynamicRotation&&delete W._dynamicRotation,void 0;var X=s.gv;b.copy(s.s("shape3d.autorotate.up")||X._up);var R;R="string"==typeof x?[x.indexOf("x")<0?X._eye[0]:X._center[0],x.indexOf("y")<0?X._eye[1]:X._center[1],x.indexOf("z")<0?X._eye[2]:X._center[2]]:X._eye;
var Z=X._center,r=W.p3();d.copy(r),I.set(R[0]-Z[0],R[1]-Z[1],R[2]-Z[2]).add(d),i.lookAt(I,d,b),m.set(0,0,0,W.getRotationMode(),!0).setFromRotationMatrix(i);var S=W._dynamicRotation;S&&Math.abs(S[0]-m.x)<1e-5&&Math.abs(S[1]-m.y)<1e-5&&Math.abs(S[2]-m.z)<1e-5||(W._dynamicRotation=[m.x,m.y,m.z])}}(),_updateFixSize2d:function(){var C=this,j=C.data,q=C.s("shape3d.fixSizeOnScreen");if(!q)return j._dynamicScale3d&&delete j._dynamicScale3d,void 0;var d=C.gv,L=No(j,d.getMat(j)),B=hs([0,0,0],L),D=d.toViewPosition(B);if(!isNaN(D.x)&&!isNaN(D.y)){var w=hs([1,0,0],L),n=d.toViewPosition(w),P=hs([0,1,0],L),A=d.toViewPosition(P),a=n.x-D.x,r=A.y-D.y;if(a&&r){var k,K,T=j._dynamicScale3d||[1,1,1],t=Qf(j.s("shape3d.image"));if(q[0]>0&&(k=q[0]),q[1]>0&&(K=q[1]),!k||!K){var V=q>0?q:1;k||(k=t?Tb(t,j)*V:20),K||(K=t?hd(t,j)*V:20)}var Y=Math.abs(a/k),M=Math.abs(r/K);Math.abs(Y-1)<.001&&Math.abs(M-1)<.001||(j._dynamicScale3d=[T[0]/Y,T[1]/M,T[2]])}}},_updateOverlapping:function(){var q=this,A=q.s("hide.overlapping.group");if(!A)return q._rectOverlapping&&(q._rectOverlapping=d),void 0;var y,C,c,j=q.gv,B=q.data,P=No(B,j.getMat(B)),o=1/0,U=1/0,M=-1/0,K=-1/0,n=B.getAnchor3d(),w=n.x,G=n.y,F=n.z;for(y=0;8>y;y++){if(C=hs([(y>>2)-w,(1&y>>1)-G,(1&y)-F],P),c=j.toViewPosition(C),isNaN(c.x)||isNaN(c.y))return;o=Math.min(o,c.x),M=Math.max(M,c.x),U=Math.min(U,c.y),K=Math.max(K,c.y)}var V={x:o,y:U,w:M-o,h:K-U};q._rectOverlapping=j.overlappingBox.isOverlapping(A,V)},getVectorDynamicSize:function(){var B,c=this,N=c.s("shape3d"),L=c.data;if("billboard"===N||"plane"===N||(B=L._currentCubeElementId)!=s){var X,J,v=c.gv,r=No(L,v.getMat(L)),H=L.getAnchor3d(),E=.5-H.x,Z=.5-H.y,y=.5-H.z,Q=c.s("shape3d.vector.dynamic.maxsize"),P=function(S,$){S[0]+=E,S[1]+=Z,S[2]+=y,$[0]+=E,$[1]+=Z,$[2]+=y;var X=v.toViewPosition(hs(S,r)),b=v.toViewPosition(hs($,r)),F=X.x-b.x,Y=X.y-b.y;return Math.min(Q,Math.sqrt(F*F+Y*Y))};if("billboard"===N)X=P([-.5,0,0],[.5,0,0]),J=P([0,-.5,0],[0,.5,0]);else if("plane"===N)X=P([-.5,0,0],[.5,0,0]),J=P([0,0,-.5],[0,0,.5]);else if(L._currentCubeElementId!=s){var K=3*un[B+1],I=3*un[B],l=3*un[B+2];X=P([Ii[K],Ii[K+1],Ii[K+2]],[Ii[l],Ii[l+1],Ii[l+2]]),J=P([Ii[K],Ii[K+1],Ii[K+2]],[Ii[I],Ii[I+1],Ii[I+2]])}return[X,J]}},getCachedTexture:function(){var B=this,K=B.data,J=K._currentCubeElementId;return J!=s?B._cubeCachedImage?B._cubeCachedImage[J]:null:B._shape3dCachedImage},setCachedTexture:function(Q){var f=this,c=f.data,R=c._currentCubeElementId;R!=s?(f._cubeCachedImage||(f._cubeCachedImage={}),f._cubeCachedImage[R]=Q):f._shape3dCachedImage=Q},vf:function(N,D){var P=this;if(P.gv.getFaceVisible(P.data,N)){var q=Nd(P,N);q.mat&&(P.faceMat=!0);var Y=q.uv;if(Y){var f=P._cubeUvs;f||(f=P._cubeUvs=new vi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var o=0;8>o;o++)f[D+o]=Y[o]}return q}},_billboardInView:function(){var i=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],D=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],S=new Zo,h=new wo,U=new pl;return function(R){var Q=this;if(!Q.mat)return!0;var E=Q.gv.getFrustum(),m="billboard"===R?i:D;S.makeEmpty(),U.fromArray(Q.mat);for(var v=0,P=m.length;P>v;v+=3)S.expandByPoint(h.fromArray(m,v).applyMatrix4(U));return E.intersectsBox(S)}}(),_80o:function(p,w,C){var U=this;if(U._rectOverlapping)return!0;var g=U.shapeModel;if(g||!U.shapeName){var q=U.s("shape3d");if(("billboard"===q||"plane"===q)&&!U._billboardInView(q))return!0;var t=U.gv,v=U.data,Y=t._cube;ll(t,U.mat),U.s("shape3d.reflector")&&!p._picking||(g?Wh(t,v,g,U,U.getBodyColor(),C):(Sg(p,Y.vs,s,w.aPosition),Sg(p,Y.ns,s,w.aNormal),Vm(p,Y.is),U._18O(p,w,U.left,0,C),U._18O(p,w,U.front,6,C),U._18O(p,w,U.right,12,C),U._18O(p,w,U.back,18,C),U._18O(p,w,U.top,24,C),U._18O(p,w,U.bottom,30,C))),li(t),U.faceMat&&(U._18O(p,w,U.left,0,C,!0),U._18O(p,w,U.front,6,C,!0),U._18O(p,w,U.right,12,C,!0),U._18O(p,w,U.back,18,C,!0),U._18O(p,w,U.top,24,C,!0),U._18O(p,w,U.bottom,30,C,!0))}},_18O:function(y,V,S,J,G,Y){if(S){if(!G(S.transparent))return;if(Y&&!S.mat||!Y&&S.mat)return;var f=this.data.s("polygonOffset");f&&Zc(y,f),Y&&ll(this.gv,S.mat);var t=this,k=t.data;k._currentCubeElementId=J;var E=t.gv,C=E.getTexture(S.texture,k),B=S.uv,c=S.uvScale,v=S.uvOffset,l=S.discardSelectable;C?B?bf(y,V,C,l,E._buffer.uv,t._cubeUvs,v,c):bf(y,V,C,l,E._cube.uv,s,v,c):bf(y),yl(y,V,S.blend,S.light,S.opacity,S.reverseFlip,S.reverseColor,S.reverseCull),is(y,V.uDiffuse,S.color||i["color.empty"]),_g(y,J,6),fm(y,V),wq(y,V,C),Y&&li(E),f&&yi(y),k._currentCubeElementId=null}},drawReflector:function(){var u=new wo,k=new wo,b=new sr,f=new pl,C=new wo,n=new wo,W=new wo,Y=new wo,B=new pl,M=new pl,t=new ob,A=new Lq,g=new Lq,H=function(E,L,z){E[z]=L[0],E[z+1]=L[1],E[z+2]=L[2]},q=function($,M){H($,M.getEye(),0),H($,M.getCenter(),3),H($,M.getUp(),6)},G=function(r,M){M._eye=[r[0],r[1],r[2]],M._center=[r[3],r[4],r[5]],M._up=[r[6],r[7],r[8]],M._18Q=s;var q=M._skyBox;q&&(q.p3([r[0],r[1],r[2]]),M.getData3dUI(q).iv())};return function(L,Q,T,_,p){var J=this;J._reflectorInfo=null;var i=J.data;if(i._reflecting)return!1;var Z=J.gv;if(p)return!1;var E=J._reflectorRenderTarget;E?E.setSize(L,Q,T):E=J._reflectorRenderTarget=new gd.RenderTarget(Z,L,Q,T),u.copy(i.p3()),k.copy(Z.getEye()),f.makeRotationFromEuler(b.set(i.r3(),i.getRotationMode(),!0));var I;if(!J._reflectNormal){var I=As(J,J.s("shape3d"));if(!I)return!1;if(!I.ns&&I.length&&(I=I[0]),!I.ns||!I.vs)return!1;J._reflectNormal=[I.ns[0],I.ns[1],I.ns[2]],J._reflectorVbuffer=ii.Buffer.createVertexBuffer(L,new Float32Array(I.vs))}if(C.copy(J._reflectNormal),C.applyMatrix4(f),n.subVectors(u,k),n.dot(C)>0)return!1;n.reflect(C).negate(),n.add(u),W.copy(Z.getCenter()).negate().add(u),W.reflect(C).negate(),W.add(u),Y.copy(Z.getUp()),Y.reflect(C);var l=[0,0,0,0,0,0,0,0,0];q(l,Z),Z._eye=n.toArray(),Z._center=W.toArray(),Z._up=Y.toArray(),Z._18Q=s;var m=Z._skyBox;m&&(m.p3(Z._eye),Z.getData3dUI(m).iv()),xh(L,E.frame),L.viewport(0,0,E.width,E.height),L.clearColor(0,0,0,1),L.clear(L.COLOR_BUFFER_BIT);var N=ws(Z),w=gi(Z);t.setFromNormalAndCoplanarPoint(C,u),t.applyMatrix4(M.fromArray(w)),A.set(t.normal.x,t.normal.y,t.normal.z,t.constant),g.x=(Math.sign(A.x)+N[8])/N[0],g.y=(Math.sign(A.y)+N[9])/N[5],g.z=-1,g.w=(1+N[10])/N[14],A.multiplyScalar(2/A.dot(g));var P=i.s("shape3d.reflector.clip"),c=P===d?.003:P;N[2]=A.x,N[6]=A.y,N[10]=A.z+1-c,N[14]=A.w;var x=Z._computedProjectMatrix;Z._computedProjectMatrix=N,i._reflecting=!0,_(),Z._computedProjectMatrix=x,B.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),B.multiply(M.fromArray(Z._projectMatrix)),B.multiply(M.fromArray(Z._viewMatrix)),oe(L),G(l,Z);var F=L._compiledShader.reflector;return F||(F=L._compiledShader.reflector=new ii.Shader(L,Rq.Reflector.vs,Rq.Reflector.fs)),F.bind(),L.activeTexture(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,E.texture),F.uniforms.tDiffuse=0,F.uniforms.color=id(i.s("shape3d.reflector.color")||"rgb(128,128,128)"),F.uniforms.textureMatrix=B.toArray(),F.uniforms.modelMatrix=No(i),F.uniforms.viewMatrix=gi(Z),F.uniforms.projectionMatrix=ws(Z),J._reflectorVbuffer.upload(),F.attributes.pos.pointer(J._reflectorVbuffer),L.drawArrays(L.TRIANGLES,0,6),i._reflecting=!1,L.useProgram(Z._prg),!0}}()}),Rq.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var Ji=function(L,t){$d(Ji,this,[L,t])};an(Ji,Cb,{_25Q:1,validate:function(U){var e=this,R=e.gv,z=e.data,t=e.s,w=t("edge.width"),c=z._40I,j=z._41I;if(e.shapeModel=e.info=s,c&&j){var H,G,V,y,b,S,Z,N,M,q,x=z.isLooped(),o=t(Oe),E=k.getEdgeType(o);if(E){var u=E(z,Aq(e,R,z,x,o),R,e._19Q);if(!u.points||u.points.isEmpty())return;S=e.info={},Z=u.segments,b=u.points,N=b.size();for(var C=c.getElevation(),i=j.getElevation(),K=0;N>K;K++){var Q=b.get(K);Q.e==s&&(Q.e=C+(i-C)*K/(N-1))}M=nf(b.get(0)),q=nf(b.get(N-1));var d=N%2;0===d?(S.c1=nf(b.get(N/2-1)),S.c2=nf(b.get(N/2))):S.p3=nf(b.get((N-d)/2)),S.s1=M,S.s2=nf(b.get(1)),S.t1=nf(b.get(N-2)),S.t2=q}else{b=new bm,S=e.info={};var v=t("edge.offset"),r=t("edge.center"),I=t("edge.source.t3"),f=t("edge.target.t3"),D=e._getEdge3dHostPoint(c,"source"),J=e._getEdge3dHostPoint(j,"target");if(I&&(D[0]+=I[0],D[1]+=I[1],D[2]+=I[2]),f&&(J[0]+=f[0],J[1]+=f[1],J[2]+=f[2]),o===Xh){Z=t("edge.segments");var O=S.points=t(fd)||Qc;if(N=O.size()){M=nf(O.get(0)),q=nf(O.get(N-1)),!r&&v&&(V=ke(M,D,!0),v=B(v,Qd(D,M)),D=[D[0]+V[0]*v,D[1]+V[1]*v,D[2]+V[2]*v],V=ke(J,q,!0),v=B(v,Qd(q,J)),J=[J[0]-V[0]*v,J[1]-V[1]*v,J[2]-V[2]*v]);var d=N%2;0===d?(H=nf(O.get(N/2-1)),G=nf(O.get(N/2))):S.p3=nf(O.get((N-d)/2)),S.s1=D,S.s2=M,S.t1=q,S.t2=J}else!r&&v&&(V=ke(J,D,!0),y=Qd(D,J),v=mf(v,y),D=[D[0]+V[0]*v,D[1]+V[1]*v,D[2]+V[2]*v],J=[J[0]-V[0]*v,J[1]-V[1]*v,J[2]-V[2]*v]),H=D,G=J;b.add({x:D[0],y:D[2],e:D[1]}),b.addAll(O),b.add({x:J[0],y:J[2],e:J[1]})}else{var F=Aq(e,R,z,x,o);if(e._19Q||(F=-F),x){var p=D[0],W=D[1],L=D[2],T=c.getTall()/2+F;H=[p-F,W+T,L],G=[p+F,W+T,L],b.add({x:p-F,y:L,e:W}),b.add({x:p-F,y:L,e:W+T}),b.add({x:p+F,y:L,e:W+T}),b.add({x:p+F,y:L,e:W})}else{V=ke(J,D,!0),y=Qd(D,J);var l={x:D[0],y:D[2]},a={x:J[0],y:J[2]},_=zi(s,l,a,F),$=_.x-l.x,P=_.y-l.y;v=mf(v,y),V[0]*=v,V[1]*=v,V[2]*=v,H=[D[0]+V[0]+$,D[1]+V[1],D[2]+V[2]+P],G=[J[0]-V[0]+$,J[1]-V[1],J[2]-V[2]+P],r?(b.add({x:D[0],y:D[2],e:D[1]}),b.add({x:H[0],y:H[2],e:H[1]}),b.add({x:G[0],y:G[2],e:G[1]}),b.add({x:J[0],y:J[2],e:J[1]})):(b.add({x:H[0],y:H[2],e:H[1]}),b.add({x:G[0],y:G[2],e:G[1]}))}}S.c1=H,S.c2=G}S.list=t(vl)===Zp?e.createTubeModel(b,Z,w/2,U):e.createLineModel(b,Z,w,"edge","edge.dash")}},_getEdge3dHostPoint:function(A,H){if(!rn(A))return A.p3();var y=this;H="edge."+H+".anchor.";var m=y.s(H+"x"),S=y.s(H+"elevation"),Y=y.s(H+"y"),o=No(A,y.gv.getMat(A)),V=A.getAnchor3d();return hs([(m===d?.5:m)-V.x,(S===d?.5:S)-V.y,(Y===d?.5:Y)-V.z],o)}});var nk=function(W,d){$d(nk,this,[W,d])};an(nk,xi,{_80o:function(y,G,Q){var $=this,U=$.gv,j=$.shapeModel;ll(U,$.mat),j?Wh(U,$.data,j,$,$.getBodyColor(),Q):(Kc($,y,G,$.left,Q),Kc($,y,G,$.front,Q),Kc($,y,G,$.right,Q),Kc($,y,G,$.back,Q),Kc($,y,G,$.top,Q),Kc($,y,G,$.bottom,Q)),li(U)},validate:function(K,Y){var G,A,u=this,_=u.s,U=u.data,Z=U.p3(),D=U._thickness/2,P=U.isClosePath(),r=U.getPoints(),$=U.getSegments(),N=_(Kd),j=K&&K.uv;if(u.clear(),0>D){try{A=u.shapeModel=Gq(r,$,_(xc),_(Cg),N,_(Sb),U.getTall(),U.getShapeElevation(),P)}catch(H){A=u.shapeModel={}}_(Bj)?_("shape3d.image")||delete A.uv:(delete A.vs,delete A.ns,delete A.uv),_("shape3d.top.image")||delete A.top_uv,_("shape3d.bottom.image")||delete A.bottom_uv}else if(_(vl)===Zp)G=Si(r,$,N,P),A=u.shapeModel={vs:[]},_("shape3d.image")&&(A.uv=[],A.sum=_(Sb)||nm(G)||1,A.len=0),_(xc)&&!P&&(A.top_vs=[],_("shape3d.top.image")&&(A.top_uv=[])),_(Cg)&&!P&&(A.bottom_vs=[],_("shape3d.bottom.image")&&(A.bottom_uv=[])),u._12O(G,D);else{var f,C,Q,h,R,y,o,v,b,O;if(G=Si(r,$,N,P),R=u.vf(Oh,j,!1,Y),D&&(y=u.vf(ss,j,!1,Y),o=P?s:u.vf(xb,j,!1,Y),v=P?s:u.vf(cr,j,!1,Y),b=u.vf(rg,j,!1,Y),O=u.vf(Rc,j,!1,Y)),D){for(var x=0,B=G.length;B>x;x++)G[x]=u._tryRemoveBezierPoints(G[x],D);u._12O(G,D)}else R&&G.forEach(function(O){if(h=O.length,h>0)for(f=O[0],Q=1;h>Q;Q++)C=O[Q],u.addV(R.vs,f,C),f=C});u._20Q(G),K||(R&&(R.ns=Pk(R.vs),je(R,"vs"),je(R,_p)),D&&(y&&(y.ns=Pk(y.vs),je(y,"vs"),je(y,_p)),o&&(o.ns=Pk(o.vs),je(o,"vs"),je(o,_p)),v&&(v.ns=Pk(v.vs),je(v,"vs"),je(v,_p)),b&&(b.ns=Pk(b.vs),je(b,"vs"),je(b,_p)),O&&(O.ns=Pk(O.vs),je(O,"vs"),je(O,_p))))}var d=u.mat=Il();Vf(d,Z),kk(d,U.getFinalRotation3d(),U.getRotationMode());var E=U.getScale3d(),V=U._dynamicScale3d;V&&(E[0]*=V[0],E[1]*=V[1],E[2]*=V[2]),ig(d,E),Vf(d,dg(Z)),K&&(Gp(u,d,K,A),u.clear())},_20Q:function(j){var Y,N,V,p,t,K,z,Z=this,E=Z.front,B=Z.back,P=Z.top,R=Z.bottom,r=E?E.tuv:s,A=B?B.tuv:s,D=P?P.tuv:s,c=R?R.tuv:s,w=0;(r||A||D||c)&&(Y=Z.s(Sb)||nm(j)||1,j.forEach(function(L){if(N=L.length,N>0)for(K=L[0],V=1;N>V;V++)z=L[V],p=w/Y,w+=Qd(K,z),t=w/Y,Z._14O(E,p,t),Z._14O(B,1-t,1-p),Z._14O(P,p,t),Z._14O(R,p,t),K=z}))},_14O:function(c,n,f){if(c){var m=c.uv,M=c.tuv;if(M){if(m)var u=m[0]+(m[6]-m[0])*n,A=m[1]+(m[7]-m[1])*n,x=m[2]+(m[4]-m[2])*n,O=m[3]+(m[5]-m[3])*n,N=m[2]+(m[4]-m[2])*f,K=m[3]+(m[5]-m[3])*f,I=m[0]+(m[6]-m[0])*f,J=m[1]+(m[7]-m[1])*f;else u=n,A=0,x=n,O=1,N=f,K=1,I=f,J=0;M.push(x,O,N,K,I,J,I,J,u,A,x,O)}}},_13O:function(H){var Y=H.uv,M=H.tuv;M&&(Y?M.push(Y[2],Y[3],Y[4],Y[5],Y[6],Y[7],Y[6],Y[7],Y[0],Y[1],Y[2],Y[3]):M.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(S,k){var e=S.length;if(4>e)return S;var D,g,E,B,v,i,j=!1,q=function(k){return S[k]},p=function(f){return S[e-1-f]};for(v=0;1>=v;v++)for(i=v?p:q,g=i(0),E=i(1),D=2;e-1>D;D++)if(B=i(D),!B.remove)if(B.b){var h=zi(g,E,B,k);h.adjust?(B.remove=!0,j=!0):(g=E,E=B)}else g=E,E=B;if(!j)return S;var b=[];for(D=0;e>D;D++)S[D].remove||b.push(S[D]);return b},_12O:function($,u){var J,q,i,z,L,j=this.s("shape3d.point.epsilon"),k=this;$.forEach(function(K){if(L=K.length,L>0)for(J={p:K[0],n:!0},z=1;L>z;z++)q=K[z],i=L-1>z?K[z+1]:s,i&&Math.abs(q.x-i.x)<j&&Math.abs(q.y-i.y)<j||k.addPoint(J,q,i,u,K)})},addPoint:function(X,z,b,V,O){var d,u,n,D,B,g,A,M,G,U=this,Q=X.p,l=X.f,j=X.b,R=U.s("shape3d.side")||cc,c=U.s("shape3d.start.angle"),e=U.s("shape3d.sweep.angle"),f=U.shapeModel,J=U.data.isClosePath();if(X.n&&(X.n=!1,l=J&&O.length>2?zi(O[O.length-2],Q,z,V):zi(s,Q,z,V),j=Ij(Q,l),f?f.top_vs&&U._10O(j,l,R,c,e,f.top_vs,f.top_uv):(d=U.left)&&(U.addV(d.vs,j,l),U._13O(d))),u=b?zi(Q,z,b,V):J&&O.length>2?zi(Q,z,O[1],V):zi(Q,z,s,V),n=Ij(z,u),f){var y,w,C=f.vs,p=f.uv,T=f.sum;for(p&&(y=f.len/T,f.len+=Qd(Q,z),w=f.len/T),g=U._9O(j,l,R,c,e),A=U._9O(n,u,R,c,e),M=0;R>M;M++)G=M+1,Hi(C,g[G]),Hi(C,A[M]),Hi(C,g[M]),Hi(C,A[M]),Hi(C,g[G]),Hi(C,A[G]),p&&(D=M/R,B=G/R,p.push(y,B,w,D,y,D,w,D,y,B,w,B));!b&&f.bottom_vs&&U._10O(n,u,R,c,e,f.bottom_vs,f.bottom_uv,!0)}else!b&&(d=U.right)&&(U.addV(d.vs,u,n),U._13O(d)),(d=U.front)&&U.addV(d.vs,l,u),(d=U.back)&&U.addV(d.vs,n,j),(d=U.top)&&U.addH(d.vs,l,u,n,j,!0),(d=U.bottom)&&U.addH(d.vs,j,n,u,l);X.p=z,X.f=u,X.b=n},_10O:function(y,v,o,f,C,D,Y,N){var l,d,T=this,b=T.data,Q=T._9O(y,v,o,f,C),S=(y.x+v.x)/2,m=(y.y+v.y)/2,x=b.getShapeElevation(),B=0;for(B=0;o>B;B++)N?(Hi(D,Q[B]),Hi(D,Q[B+1])):(Hi(D,Q[B+1]),Hi(D,Q[B])),Hi(D,[S,x,m]),Y&&(N?(l=p*(B+1)/o+f,d=p*B/o+f):(l=p*B/o+f,d=p*(B+1)/o+f),Y.push(.5-.5*O(d),.5-.5*L(d),.5-.5*O(l),.5-.5*L(l),.5,.5))},_9O:function(v,g,w,$,F){var t,K,f=this,G=f.data,k=[],d=(v.x+g.x)/2,b=(v.y+g.y)/2,V=G.getTall()/2,E=G.getShapeElevation(),D=0;for(F=F||p;w>=D;D++)t=F*D/w+$,K=O(t),k.push([d+(v.x-d)*K,E+V*L(t),b+(v.y-b)*K]);return k},addV:function(c,P,o){var g=P.x,l=P.y,E=o.x,b=o.y,X=this.data,j=X.getShapeElevation(),u=X.getTall()/2;c.push(g,j-u,l,E,j-u,b,E,j+u,b,E,j+u,b,g,j+u,l,g,j-u,l)},addH:function(E,F,V,h,m,q){var I=this.data,i=I.getTall()/2,D=I.getShapeElevation()+(q?i:-i);E.push(F.x,D,F.y,V.x,D,V.y,h.x,D,h.y,h.x,D,h.y,m.x,D,m.y,F.x,D,F.y)},vf:function(v,l,Q,D){var b,K=this,z=K.gv.getFaceVisible(K.data,v);return(Q||z)&&(b=Nd(K,v,D),b.vs=[],b.tuv=z&&(b.texture||l)?[]:s,b.visible=z),b}});var Zk=function(w,o){$d(Zk,this,[w,o])};an(Zk,Cb,{_25Q:1,validate:function(W){var Y=this,k=Y.data,X=Y.s,S=k.getPoints(),N=S.size();if((!Y.s("shape3d.geometry.cache")||!Y.shapeModel)&&(Y.shapeModel=Y.info=s,N>1)){var D=Y.info={},I=k.getSegments(),r=k.getThickness(),U=nf(S.get(0)),Z=nf(S.get(N-1)),g=N%2;0===g?(D.c1=nf(S.get(N/2-1)),D.c2=nf(S.get(N/2))):D.p3=nf(S.get((N-g)/2)),D.s1=U,D.s2=nf(S.get(1)),D.t1=nf(S.get(N-2)),D.t2=Z,D.list=X(vl)===Zp?Y.createTubeModel(S,I,r/2,W):Y.createLineModel(S,I,r,"shape.border","shape.dash")}var z=k.p3(),b=Y.mat=Il();Vf(b,z),kk(b,k.getFinalRotation3d(),k.getRotationMode());var O=k.getScale3d(),j=k._dynamicScale3d;j&&(O[0]*=j[0],O[1]*=j[1],O[2]*=j[2]),ig(b,O),Vf(b,dg(z))},_80o:function(d,n,x){var p=this,q=p.shapeModel;if(q){var I=p.gv;ll(I,p.mat),Wh(I,p.data,q,p,p.getBodyColor(),x),li(I)}}});var yj=l.graph3d.VR=function(b){var Q=this;Q.gv=b,Q._controllers=[],Q.switch=new Ir(Q),Q._enable=!1,Q._defaultCallLater=l.Default.callLater,Q._defaultCancelLater=An,"undefined"!=typeof g&&"VRFrameData"in g&&(Q._frameData=new g.VRFrameData),Q.measureOflength=1,Q.eyesOffset=[0,0,0],Q._orientation=new l.Math.Quaternion,Q._lastHeadPose=[0,0,0],Q._offsetToBeAdd=[0,0,0],Q._fpsInfo={time:0,fps:0,frames:0}};an(yj,e,{ms_fire:!0,_42:function(x,N,s,R){var a=this,S=a.gv;if(!S.drawFilter&&a._deviceInAction){var X=a._device;if(X){var M=a._measureOflength;X.depthNear=S.getNear()*M,X.depthFar=S.getFar()*M;var c=a._offsetToBeAdd;if(a.eyesOffset[0]+=c[0],a.eyesOffset[1]+=c[1],a.eyesOffset[2]+=c[2],c[0]=0,c[1]=0,c[2]=0,X.isPresenting===!1)return a._controllers.forEach(function(N){N&&N.update()}),S.iv(),!1;var T=a._frameData;X.getFrameData(T);var A=T.pose.position;if(A){var H=a.toViewPosition(A);S.setEye(H),a._orientation.fromArray(T.pose.orientation);var P=new l.Math.Vector3(0,0,-10*a._scaleFactor);P.applyQuaternion(a._orientation),S.setCenter([H[0]+P.x,H[1]+P.y,H[2]+P.z])}a._controllers.forEach(function(v){v&&v.update()}),S.setViewport(x,0,0,N/2,s),a._viewMatrix=a._copyViewMatrix(T.leftViewMatrix),a._projectMatrix=a._copyProjectMatrix(T.leftProjectionMatrix),R(),S.setViewport(x,N/2,0,N/2,s),a._viewMatrix=a._copyViewMatrix(T.rightViewMatrix),a._projectMatrix=a._copyProjectMatrix(T.rightProjectionMatrix),R(),a._lastViewMatrix=a._viewMatrix,a._lastProjectMatrix=a._projectMatrix,a._viewMatrix=null,a._projectMatrix=null,a.submitFrame();var Z=Date.now(),E=a._fpsInfo;return Z-E.time>1e3?(E.fps=Math.round(1e3*(E.frames+1)/(Z-E.time)),E.time=Z,E.frames=0):E.frames++,!0}}},onVRDisplayPresentChange:function(){var o=this.isPresenting();this._injectGraphView(o),this.fp("present",!o,o)},getOrientation:function(){return this._orientation},addController:function(e){e=e||0;var D=this,Z=D.getController(e);return Z?Z:(Z=new Wf(D,e),D._controllers.push(Z),Z)},getController:function(s){s=s||0;for(var H=this._controllers,o=0,T=H.length;T>o;o++)if(H[o]&&H[o].id===s)return H[o];return null},removeController:function(C){C=C||0;for(var X=this._controllers,$=0,G=X.length;G>$;$++)if(X[$]&&X[$].id===C)return X.splice($,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(D,A){var w=this,G=w._scaleFactor,E=w._eyesOffset,p=w._lastHeadPose;return p[0]=D[0]*G,p[1]=D[1]*G,p[2]=D[2]*G,A?(A[0]=p[0]+E[0],A[1]=p[1]+E[1],A[2]=p[2]+E[2],A):[p[0]+E[0],p[1]+E[1],p[2]+E[2]]},addEyesOffset:function(d,J,q){var M=this._offsetToBeAdd;M[0]+=d,M[1]+=J,M[2]+=q},_copyViewMatrix:function(W){var T=this.dup(W),q=this._scaleFactor;T[12]*=q,T[13]*=q,T[14]*=q;var r=this._eyesOffset;if(r&&(r[0]||r[1]||r[2])){var d=r[0],K=r[1],G=r[2];T[12]-=T[0]*d+T[4]*K+T[8]*G,T[13]-=T[1]*d+T[5]*K+T[9]*G,T[14]-=T[2]*d+T[6]*K+T[10]*G}return T},shutdown:function(){var A=this._device;A&&A.isPresenting&&A.exitPresent()},isPresenting:function(){var N=this._device;return N&&N.isPresenting},_copyProjectMatrix:function(b){var g=this.dup(b),F=this._scaleFactor;return g[14]*=F,g},dup:function(c,q){for(var u=c.length,i=q||new Array(u);u--;)i[u]=c[u];return i},getViewMatrix:function(y){var v=this._viewMatrix;return v?this.dup(v,y):void 0},getProjectMatrix:function(){var k=this._projectMatrix;return k?this.dup(k):void 0},submitFrame:function(){var R=this;if(R._enable&&R._deviceInAction){var F=R._device;F&&F.isPresenting&&(F.submitFrame(),R.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(o){var J=this.gv;return J.intersectObjects(o,J.dm().getDatas())},setDevice:function(W){var o=this;o._device=W},_injectGraphView:function(){var S,C,g;return function(Z){var p=this.gv;if(!Z)return S&&(p.getWidth=S,p.getHeight=C,p.getDevicePixelRatio=g),void 0;var y=this._device,J=y.getEyeParameters("left"),e=J.renderWidth,T=J.renderHeight;S=p.getWidth,C=p.getHeight,g=p.getDevicePixelRatio,p.getWidth=function(){return 2*e},p.getHeight=function(){return T},p.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(Z){var Y=this;if(!Z)return Ag=l.Default.callLater=Y._defaultCallLater,An=l.Default.cancelLater=Y._defaultCancelLater,void 0;var Y=this;Ag=l.Default.callLater=function(v,G,D,f){var A=Y._device;return A&&A.isPresenting?f?j(function(){Ag(v,G,D)},f):A.requestAnimationFrame(function(){Y._deviceInAction=!0,v.apply(G,D),Y._deviceInAction=!1}):Y._defaultCallLater(v,G,D,f)},An=l.Default.cancelLater=function(c,o){var M=Y._device;return M&&M.isPresenting?o?n(c):M.cancelAnimationFrame(c):Y._defaultCancelLater(c,o)}}}),e.defineProperties(yj.prototype,{enable:{get:function(){return this._enable},set:function(x){var K=this;K._enable!==x&&(K._enable=x,x?(K.switch.showButton(),K._injectCallLaterFunc(!0)):(K.shutdown(),K.switch.hideButton(),K._injectCallLaterFunc(!1)),K.fp("enable",!x,x))}},measureOflength:{get:function(){return this._measureOflength},set:function(u){this._measureOflength=u;var L=this._scaleFactor=1/u;this._controllers.forEach(function(K){K&&K._setScaleFactor(L)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(x){this._eyesOffset=x}},controllerModel:{get:function(){return this._controllerModel},set:function(v){var Q;"object"==typeof v?(Q=v.mtl,v=v.obj):(Q=v+".mtl",v+=".obj");var P=this,N=P._controllerModel;N&&N.obj===v&&N.mtl===Q||(N=P._controllerModel={obj:v,mtl:Q},k.loadObj(v,Q,{finishFunc:function(M,U){P._controllerModel===N&&k.setShape3dModel("vrControllerModel",U)}}))}},interactive:{get:function(){return!!this._interactive},set:function(v){!!v!=!!this._interactive&&(this._interactive=v,v&&this.addController(0),this.gv.getCoreInteractor().enableVR(v))}}});var Wf=function(V,X){function p(m){var D=navigator.getGamepads&&navigator.getGamepads();if(D)for(var Y=0,s=0,i=D.length;i>Y;Y++){var M=D[Y];if(M){var I=M.id;if("OpenVR Gamepad"===I||0===I.indexOf("Oculus Touch")||I.indexOf("Controller")>=0){if(s===m)return M;s++}}}}function U(y,a,u){return Math.abs(y[0]-a[0])<u&&Math.abs(y[1]-a[1])<u&&Math.abs(y[2]-a[2])<u?!0:!1}var l=this;l.vr=V,l.id=X;var r,t,F=[0,0],w=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],o=new Hr;o.s("shape3d","vrControllerModel"),o.isController=!0,o.s("intersect",!1),l.getGamepad=function(){return t},l.isButtonPressed=function(I){for(var V,g=0,c=w.length;c>g;g++)if(V=w[g],V.id===I)return V.pressed;return!1},l.getNode=function(){return o};var y=.003;l.setRotationEpsilon=function(Z){y=Z};var G=5e-4,m=G;l.setPositionEpsilon=function(S){G=S,m=S*l.vr._scaleFactor},l._setScaleFactor=function(y){o.s3(y,y,y),m=G*y},l._setScaleFactor(l.vr._scaleFactor);var Z,A=new tl,Q=new pl,P=[0,0,0],N=[0,0,0],J=new sr,g=new wo,c=new Sp;l.getRay=function(){return Z?(c.origin.fromArray(P),c.direction.copy(g),Z=!1,c):c},l.update=function(){if(r=t,t=p(X),r!=t&&console.log("gamepad changed",t),!t||t.pose===d)return t=null,o.s("3d.visible",!1),void 0;if(k.getShape3dModel("vrControllerModel")){o.dm()||V.gv.dm().add(o),o.s("3d.visible",!0);var E=t.pose;if(null!==E){E.position&&(l.vr.toViewPosition(E.position,P),U(o.p3(),P,m)||(Z=!0,o.p3(P))),E.orientation&&(A.fromArray(E.orientation),g.set(0,0,-1).applyQuaternion(A).normalize(),Q.makeRotationFromQuaternion(A),J.set(0,0,0,o.getRotationMode(),!0).setFromRotationMatrix(Q),N[0]=J.x,N[1]=J.y,N[2]=J.z,U(o.r3(),N,y)||(Z=!0,o.r3(N))),Z&&V.fp("gamepad.pose",null,{position:P,rotation:N,id:X});var W=t.axes;(F[0]!==W[0]||F[1]!==W[1])&&(F=[W[0],W[1]],V.fp("gamepad.axes",null,{id:X,axes:F}));var B,v,L,u,i=t.buttons;for(B=0,v=i.length;v>B;B++)if(L=i[B],u=L.pressed,u!==w[B].pressed){w[B].pressed=u;var R={id:X},b="state";R[b]=R._62O=u?"down":"up",V.fp("gamepad.button."+w[B].id,null,R)}}}}},Ir=function(C){this.vr=C,this._button=null};an(Ir,e,{showButton:function(){var C=this.assureButton();if(!C.parentNode){var q=this.vr.gv,D=q.getView();q._79O?D.insertBefore(C,q._79O):D.appendChild(C)}},hideButton:function(){var i=this._button;i&&i.parentNode&&i.parentNode.removeChild(i)},assureButton:function(){var X=this._button;return X?X:this._button=this.createButton(this.vr.gv)},createButton:function(W){function p(h,u){h.textContent=u&&u.isPresenting?" VR ":" VR "}function u(y){z.style.display="",z.style.cursor="pointer",z.style.left="calc(50% - 50px)",z.style.width="100px",p(z,y),z.onmouseenter=function(){z.style.opacity="1.0"},z.onmouseleave=function(){z.style.opacity="0.5"},z.onclick=function(){y.isPresenting?y.exitPresent():y.requestPresent([{source:W.getCanvas()}])},W.vr.setDevice(y)}function A(){z.style.display="",z.style.cursor="auto",z.style.left="calc(50% - 75px)",z.style.width="150px",p(z,null),z.onmouseenter=null,z.onmouseleave=null,z.onclick=null,W.vr.setDevice(null)}function d(S){S.style.position="absolute",S.style.bottom="20px",S.style.padding="12px 6px",S.style.border="1px solid #fff",S.style.borderRadius="4px",S.style.color="#000",S.style.font="normal 13px sans-serif",S.style.textAlign="center",S.style.opacity="0.5",S.style.outline="none",S.style.zIndex="999"}if("getVRDisplays"in navigator){var z=this._button=m.createElement("button");return z.style.display="none",d(z),K(g,"vrdisplayconnect",function(z){u(z.display)}),K(g,"vrdisplaydisconnect",function(){A()}),K(g,"vrdisplaypresentchange",function(d){p(z,d.display),W.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(g){g.length>0?u(g[0]):A()}),z}var B=m.createElement("a");return B.href="https://webvr.info",B.innerHTML=" webvr",B.style.left="calc(50% - 90px)",B.style.width="180px",B.style.textDecoration="none",d(B),B}}),e.defineProperties(Ir.prototype,{});var Gk=l.graph3d.PostProcessing=function(z){function o(){if(!j){var f=z.getGL();j=new gd.RenderTarget(z,f,null,null,{samples:i.renderTextureSamples||1}),y=new ii.Shader(f,u.vs,u.fs),c=ii.Buffer.createIndexBuffer(f,new Uint16Array([0,2,1,1,2,3])),_=ii.Buffer.createVertexBuffer(f,new Float32Array([0,0,1,0,0,1,1,1]))}}var j,y,c,_,T=this,D={},p=!1;!function(){e.keys(Gk).forEach(function(r){D[r]=new Gk[r](z)})}(),T.getModule=function(E){return E?D[E]:T},T.getModuleList=function(){return e.keys(D)},T.handleDataModleChange=function(_,J){_&&(_.setPostProcessingData(T.serialize()),_.removeSerializeListener(T.onDataModelSerialize,T)),J&&(J.addSerializeListener(T.onDataModelSerialize,T),T.deserialize(J.getPostProcessingData()))},T.onDataModelSerialize=function(Q){"serialize"===Q.type?z.dm()._postProcessingData=T.serialize():"deserialize"===Q.type&&T.deserialize(z.dm().getPostProcessingData())},T.serialize=function(){var X,P,v,k,A={};for(P in D)if(v=D[P],k=v.serializeProperties){X={},v.enable&&(X.enable=!0);for(var w in k){var o=v[w];o!=k[w]&&(X[w]=o)}e.keys(X).length&&(A[P.toLowerCase()]=X)}return A},T.deserialize=function(c){var x,N,r,w,v,a={};if(c)for(N in c)if(N&&(x=N[0].toUpperCase()+N.slice(1),r=D[x])){a[x]=!0,w=c[N],T.enableModule(x,!!w.enable),r.resetProperties&&r.resetProperties();for(v in w)"enable"!==v&&(r[v]=w[v])}for(x in D)a[x]||(r=D[x],r.enable=!1,r.resetProperties&&r.resetProperties())},T.decodeShader=function(N){var h,S,m,g="",F="";for(m=0;m<N.length;m++)h=N[m],"%"===h?h="'":"a"===h?h='"':"]"===h&&(h="\\"),S=String.fromCharCode(h.charCodeAt(0)-1),m%2?F+=S:g=S+g;return F+g},T.createShader=function(p,J,G){var e=J.indexOf("^#"),l=T.decodeShader(J.substr(0,e)),U=T.decodeShader(J.substr(e+2));if(G){var m=G(l,U);m&&m.vs&&(l=m.vs),m&&m.fs&&(U=m.fs)}return new ii.Shader(p,l,U)},T.enableModule=function(t,$){var B,f,b,L=t.split(",");for(B=0,f=L.length;f>B;B++)b=L[B].trim(),D[b]&&(D[b].enable=$);p=!1;for(b in D)if(D[b].enable){p=!0;break}p&&o()};var u={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};T._42=function(o,g,B,E,e){if(p&&!e){j.setSize(o,g,B),j.bind(o),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),z.setViewport(o,0,0,g,B),E(),j.unbind(o);for(var l=0,k=z._glCapabilities.maxAttributes;k>l;l++)o.disableVertexAttribArray(l);var $,Q=j;for($ in D)Q=D[$]._42(o,Q)||Q;return z.setViewport(o,0,0,g,B),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),y.bind(),o.activeTexture(o.TEXTURE0+0),o.bindTexture(o.TEXTURE_2D,Q.texture),y.uniforms.image=0,c.upload(),_.upload(),y.attributes.pos.pointer(_),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),o.bindTexture(o.TEXTURE_2D,null),o.useProgram(z._prg),!0}}},cs=l.graph3d.PostProcessing.Bloom=function(s){function I(){var b=s.getGL();if(b)for(var l=s._postProcessing,j=0;N>j;j++)K[j]=l.createShader(b,cs._35Q,function(Y,N){return{fs:N.replace(/DEFINE_VALUE/g,v[j]).replace("%OVERRIDE_ALPHA_DEFINE%",$?"#define OVERRIDE_ALPHA":"")}})}function m(){var E=s.getWidth(),p=s.getHeight();if(E&&p){P=[E,p],J=!0;var d,n=s.getGL(),T=Math.round(P[0]/2),i=Math.round(P[1]/2);for(r=new gd.RenderTarget(s,n,T,i),d=0;N>d;d++)M.push(new gd.RenderTarget(s,n,T,i)),F.push(new gd.RenderTarget(s,n,T,i)),T=Math.round(T/2),i=Math.round(i/2);var R=s._postProcessing;x=R.createShader(n,cs._34Q),I(),u=R.createShader(n,cs._36Q,function(f,Q){return{fs:Q.replace(/NUM_MIPS/g,N)}}),h=R.createShader(n,cs.finalShader),l=ii.Buffer.createIndexBuffer(n,new Uint16Array([0,2,1,1,2,3])),o=ii.Buffer.createVertexBuffer(n,new Float32Array([0,0,1,0,0,1,1,1]))}}var i,T,D,$,l,o,Y=this,B=!1,J=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var K=this.serializeProperties;for(var u in K)this[u]=K[u]},e.defineProperties(Y,{enable:{get:function(){return B},set:function(N){!!B!=!!N&&(B=N,N&&!J&&m())}},strength:{get:function(){return i},set:function(U){i=U}},threshold:{get:function(){return T},set:function(Q){T=Q}},radius:{get:function(){return D},set:function(g){D=g}},overrideAlpha:{get:function(){return $},set:function(E){!!$!=!!E&&($=E,J&&I())}}}),this.resetProperties();var r,x,u,h,P=[256,256],M=[],F=[],N=5,v=[3,5,7,9,11],K=[];Y._42=function(y,A){function R(X,i,D,_){xh(y,i.frame),s.setViewport(y,0,0,i.width,i.height),_?_(y):y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),v!==X&&X.bind();var r=0;for(var L in D){var x=D[L];x instanceof WebGLTexture&&(y.activeTexture(y.TEXTURE0+r),y.bindTexture(y.TEXTURE_2D,x),x=r,r++),X.uniforms[L]=x}for(v!==X&&(l.upload(),o.upload(),X.attributes.pos.pointer(o),v=X),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0);r--;)y.activeTexture(y.TEXTURE0+r),y.bindTexture(y.TEXTURE_2D,null);oe(y)}if(B&&(J||(m(),J))){var v;R(x,r,{smoothWidth:.01,luminosityThreshold:T,tDiffuse:A.texture});var O,$=r,d=Math.round(P[0]/2),Q=Math.round(P[1]/2);for(O=0;N>O;O++)R(K[O],M[O],{colorTexture:$.texture,direction:[1,0],texSize:[d,Q]}),R(K[O],F[O],{colorTexture:M[O].texture,direction:[0,1],texSize:[d,Q]}),d=Math.round(d/2),Q=Math.round(Q/2),$=F[O];return R(u,M[0],{blurTexture1:F[0].texture,blurTexture2:F[1].texture,blurTexture3:F[2].texture,blurTexture4:F[3].texture,blurTexture5:F[4].texture,bloomStrength:i,bloomRadius:D,bloomTintColor:[1,1,1]}),R(h,A,{image:M[0].texture},function(w){w.enable(w.BLEND),w.blendEquation(w.FUNC_ADD),w.blendFunc(w.SRC_ALPHA,w.ONE)}),y.blendEquationSeparate(y.FUNC_ADD,y.FUNC_ADD),y.blendFuncSeparate(y.SRC_ALPHA,y.ONE_MINUS_SRC_ALPHA,y.ONE,y.ONE_MINUS_SRC_ALPHA),A}}};cs._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",cs._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",cs._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",cs.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";
var dj=l.graph3d.PostProcessing.Dof=function(G){function j(){Y=!0;var w=G.getGL();c=new gd.RenderTarget(G,w),g=G._postProcessing.createShader(w,dj._38Q),p=ii.Buffer.createIndexBuffer(w,new Uint16Array([0,2,1,1,2,3])),S=ii.Buffer.createVertexBuffer(w,new Float32Array([0,0,1,0,0,1,1,1]))}var c,g,p,S,W,X,s,r,z=this,m=!1,Y=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var Y=this.serializeProperties;for(var R in Y)this[R]=Y[R]},e.defineProperties(z,{enable:{get:function(){return m},set:function(f){!!m!=!!f&&(m=f,f&&!Y&&j())}},image:{get:function(){return X},set:function(S){X!==S&&(X=S,W&&(G.getGL().deleteTexture(W),W=null),G.iv())}},maxblur:{get:function(){return s},set:function(X){s!==X&&(s=X,G.iv())}},aperture:{get:function(){return r},set:function(K){r!==K&&(r=K,G.iv())}}}),this.resetProperties(),z._42=function(d,R){function e($,o,B,u){xh(d,o.frame),G.setViewport(d,0,0,o.width,o.height),u?u(d):d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),k!==$&&$.bind();var g=0;for(var n in B){var c=B[n];c instanceof WebGLTexture&&(d.activeTexture(d.TEXTURE0+g),d.bindTexture(d.TEXTURE_2D,c),c=g,g++),$.uniforms[n]=c}for(k!==$&&(p.upload(),S.upload(),$.attributes.pos.pointer(S),k=$),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0);g--;)d.activeTexture(d.TEXTURE0+g),d.bindTexture(d.TEXTURE_2D,null);oe(d)}if(m){Y||j();var k;if(!W){var n=Qf(this.image);if(!n||!n.tagName)return R;W=yq(d,n)}var b=R.width,$=R.height;if(b&&$)return c.setSize(d,b,$),e(g,c,{tColor:R.texture,tDepth:W,aspect:b/$,aperture:this.aperture,maxblur:this.maxblur}),c}}};dj._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",ag(k,{accordionViewExpandIcon:pn(Dr),accordionViewCollapseIcon:pn(Dr,!0),accordionViewLabelColor:we,accordionViewLabelFont:Uj,accordionViewTitleBackground:qj,accordionViewSelectBackground:xr,accordionViewSelectWidth:3,accordionViewSeparatorColor:d,splitViewDividerSize:1,splitViewDividerBackground:qj,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:_c,rect:[2,2,12,12],background:Dr}]},propertyViewLabelColor:Vj,propertyViewLabelSelectColor:we,propertyViewLabelFont:Uj,propertyViewExpandIcon:pn(Wq),propertyViewCollapseIcon:pn(Wq,!0),propertyViewBackground:Pb,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Pf,propertyViewColumnLineColor:Pf,propertyViewSelectBackground:xr,listViewLabelColor:Vj,listViewLabelSelectColor:we,listViewLabelFont:Uj,listViewRowLineVisible:!1,listViewRowLineColor:Pf,listViewSelectBackground:xr,treeViewLabelColor:Vj,treeViewLabelSelectColor:we,treeViewLabelFont:Uj,treeViewExpandIcon:pn(Ql),treeViewCollapseIcon:pn(Ql,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Pf,treeViewSelectBackground:xr,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Vj,tableViewLabelSelectColor:we,tableViewLabelFont:Uj,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Pf,tableViewColumnLineColor:Pf,tableViewSelectBackground:xr,treeTableViewLabelColor:Vj,treeTableViewLabelSelectColor:we,treeTableViewLabelFont:Uj,treeTableViewExpandIcon:pn(Ql),treeTableViewCollapseIcon:pn(Ql,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Pf,treeTableViewColumnLineColor:Pf,treeTableViewSelectBackground:xr,tableHeaderLabelColor:Vj,tableHeaderLabelFont:Uj,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:$p,tableHeaderBackground:Pb,tableHeaderMoveBackground:eq,tableHeaderInsertColor:xr,tableHeaderSortDescIcon:Qi(Wq,!0),tableHeaderSortAscIcon:Qi(Wq),tabViewTabGap:1,tabViewLabelColor:we,tabViewLabelFont:Uj,tabViewTabBackground:qj,tabViewSelectWidth:3,tabViewSelectBackground:xr,tabViewMoveBackground:eq,tabViewInsertColor:xr,toolbarLabelColor:Vj,toolbarLabelSelectColor:we,toolbarLabelFont:Uj,toolbarBackground:Pb,toolbarSelectBackground:xr,toolbarItemGap:8,toolbarSeparatorColor:Lh},!0);var Yl={translateX:1,sortColumn:1},yf={sortable:1,sortOrder:1,sortFunc:1},Vb={focusData:1},vh={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},ui={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Dm=function(n,p){p.add(n),n.hasChildren()&&n.eachChild(function(f){Dm(f,p)})},rr=function(Z,A,e,o,R,$,r,M,P,K,n){var H,h=e.getValueType(K),j=e.getAlign(K);if(e.getEnumValues(K)){var f=e.toEnumLabel(A,K),O=Wo||0,t=0,U=$,D=k.getTextSize(o,f).width;return H=Qf(e.toEnumIcon(A,K)),H&&(t=$+Wo/2,"center"===j?t+=(M-(O+D))/2:"right"===j&&(t=t+M-(O+D)),Yr(Z,H,t,r+P/2,K,n),U=t+Wo/2),f!=s&&(H?xg(Z,f,o,R,U,r,M-(U-$),P):xg(Z,f,o,R,$,r,M,P,j)),void 0}return A=e.formatValue(A),A!=s?h===Ld?(Gn(Z,$,r,M,P,A),void 0):h===hm||!h&&Zl(A)?(H=Qf(A?de:dk),Yr(Z,H,$+M/2,r+P/2,K,n),void 0):(xg(Z,A,o,R,$,r,M,P,j),void 0):void 0},Ll=function(v,p){var u=p.view,t=Zd(v),$=p.column||p.property;u.getDataModel().beginTransaction(),p.editor=v,v.info=p,u.setCurrentEditor(v),u.getView().insertBefore(t,u._79O),ci(v,p.editorRect),v.setFocus?v.setFocus():Ep(v),v.commitValue=function(J,Y){v._17Q&&(v=v._17Q),Y||u.setValue(p.data,$,v.getValue?v.getValue():v.value),v.close&&v.close(),Zb(t)},$.onEditorCreated&&$.onEditorCreated(p)},_h=function(w,B,f,V,e){var o=Xn(w,f),$=B.value,h=B.view,P=e.getValueType(B.data);return o.onblur=o.onchange=function(){h.endEditing()},"input"===w?($=e.formatValue($),$!=s&&(o.value=$),o.onkeydown=function(Q){Cr(Q)?h.endEditing():ti(Q)&&h.endEditing(!0)},(P===af||P===br)&&K(o,bi,k.numberListener)):w===Xb&&V.forEach(function(F){var S=m.createElement("option");S.innerHTML=e.toEnumLabel(F),S.value=F,e.isEnumEqual($,F)&&(S.selected=!0),Dj(o,S)}),Ll(o,B),o},Wl=l.widget={},_e=function(u,s,o){an(A+".widget."+u,s,o)};ag(lr,{ms_value:function(l){l.getValue=function(o){var V=this.getItemById(o),W=V.element;return Or(W)?W:W?W.getValue?W.getValue():W.value:V.selected},l.setValue=function(U,R){var O=this.getItemById(U);if(O){var h=O.element;h&&!Or(h)?h.setValue?h.setValue(R):h.value=R:Zl(R)?(O.selected=R,this.iv()):(O.element=R,this.iv())}},l.v=function(N,d){var z=this;if(2===arguments.length)z.setValue(N,d);else{if(!qr(N))return z.getValue(N);for(var F in N)z.setValue(F,N[F])}return z}},_46o:function($){$._icon=s,$._accessType=s,$._valueType=s,$._editable=!1,$._batchEditable=!0,$._align=xb,$._nullable=!0,$._emptiable=!1,$.setParent=pb,$.formatValue=function(l){var E=this,h=E._valueType;return E.getEnumValues()?E.toEnumLabel(l):h===hm?!!l:l!=s&&h===af?t(l):l},$.setEnum=function(d,x,J,S,Y,F,G){var k=this;d&&!Cq(d)&&d.values&&(S=d.editable,J=d.icons,x=d.labels,Y=d.strict,F=d.maxHeight,G=d.dropDownWidth,d=d.values),us(d)&&(d=d._as),us(x)&&(x=x._as),us(J)&&(J=J._as),k._enumValues=d,k._enumLabels=x,k._enumIcons=J,k._enumEditable=S,k._enumStrict=Y==s?!0:Y,k._enumMaxHeight=F,k._enumDropDownWidth=G,d&&d.length&&hk(d[0])&&(k._valueType=br),k.fp("enum",!1,!0)},$.getEnumDropDownWidth=function(){return this._enumDropDownWidth},$.getEnumMaxHeight=function(){return this._enumMaxHeight},$.isEnumEditable=function(){return this._enumEditable},$.getEnumValues=function(){return this._enumValues},$.getEnumLabels=function(){return this._enumLabels},$.getEnumIcons=function(){return this._enumIcons},$.isEnumStrict=function(){return this._enumStrict},$.isEnumEqual=function(x,P){return this._enumStrict?x===P:x==P},$.toEnumLabel=function(J,$){var V=this,D=V.getEnumValues($),B=V.getEnumLabels($);if(D&&B)for(var Z=0;Z<D.length;Z++)if(V.isEnumEqual(J,D[Z]))return B[Z];return J},$.toEnumIcon=function(h,C){var w=this,A=w.getEnumValues(C),B=w.getEnumIcons(C);if(A&&B)for(var N=0;N<A.length;N++)if(w.isEnumEqual(h,A[N]))return B[N];return d}},_45o:function(l){l._87o=function(B,x,p,A,N,m){if(B){var h=this,O=h._90I,H=Lp(1);h._columnLineVisible&&(N-=1),h._rowLineVisible&&(m-=1),0>=N||0>=m||(h._90I||(O=h._90I={}),O[x]||(O[x]=new bm),ci(H,h.tx()+p,h.ty()+A,N,m),Dj(H,B),h._view.insertBefore(H,h._79O),B.onParentAdded&&B.onParentAdded(H),O[x].add(H))}},l._76o=function(){var u=this,R=u._90I;if(R){for(var z in R)R[z].each(function(t){Zb(t)});delete u._90I}},l._77o=function(W){var R=this;if(R._90I){var Q=R._90I[W];Q&&(Q.each(function(Q){Zb(Q)}),delete R._90I[W])}}},_47o:function(D){D.getValue=function(H,v){return v.getValue?v.getValue(H,v,this):Wi(H,v.getAccessType(),v.getName())},D.setValue=function(M,R,p){if(R.isEmptiable(M)||""!==p||(p=d),R.isNullable(M)||p!=s){var c=this,A=R.getName(M),v=R.getAccessType(M),e=R.getValueType(M);e===af&&Or(p)?p=H(p):e===br&&Or(p)?p=parseFloat(p):e===hm&&Or(p)&&(p="true"===p),c._batchEditable&&R._batchEditable&&c.isSelected(M)?c.sm().each(function(t){R.setValue?R.setValue(t,R,p,c):Bn(t,v,A,p)}):R.setValue?R.setValue(M,R,p,c):Bn(M,v,A,p)}},D.setCurrentEditor=function(s){this.endEditing(),this._currentEditor=s,this.redraw()},D.isEditing=function(D,C){var v=this,B=v._currentEditor;if(!B)return!1;if(C){var J=B.info;return J?(J.column||J.property)===C&&J.data===D:!1}return!0},D.endEditing=function(k){var m=this,D=m._currentEditor;D&&(delete m._currentEditor,D.commitValue&&D.commitValue(D.info,k),m.redraw(),m.getDataModel().endTransaction())},D.beginEditing=function(q){this.endEditing();var $=this,b=q.column||q.property;if(b.beginEditing)b.beginEditing(q);else{var e=q.data,Q=q.value,T=$.getSelectBackground(e),w=b.getEnumValues(e),a=b.getSlider(e),h=b.getColorPicker(e);if(a){var k=In(Wl.Slider,a);return k.setValue(Q),k.getView().onblur=function(){$.endEditing()},k.isInstant()&&(k.onValueChanged=function(){$.setValue(e,b,k.getValue())}),Ll(k,q),void 0}if(h||b.getValueType(e)===Ld){var Y=In(Wl.ColorPicker,h);return Y.setValue(Q),Y.onClosed=function(){$.endEditing()},Y.isInstant()&&(Y.onValueChanged=function(E,y){$.setValue(e,b,y)}),Ll(Y,q),Y.open(),void 0}if(w){if(Wl.ComboBox){var V=new Wl.ComboBox;V.setValue(Q),V.setValues(w),V.setLabels(b.getEnumLabels(e)),V.setIcons(b.getEnumIcons(e)),V.setEditable(b.isEnumEditable(e)),V.setStrict(b.isEnumStrict(e)),V.setMaxHeight(b.getEnumMaxHeight(e)),V.setDropDownWidth(b.getEnumDropDownWidth(e)),V.onClosed=function(){$.endEditing()},Ll(V,q),V.open()}else _h(Xb,q,T,w,b);return}var H=b.getValueType(e);if(H===hm||Zl(Q))return $.setValue(e,b,!Q),void 0;if(b.getItemEditor(e)){var X=iq(b.getItemEditor(e)),U=new X(e,b,$,q),E=U.getView();return E._17Q=U,U.setValue(Q),Sj(E),Ll(E,q),U.editBeginning&&U.editBeginning(),void 0}_h("input",q,T,s,b)}}},_44o:function(z){z.init=function(s){var F=this,i=F.th=new Qe(s),w=F._view=Eq(1,F);F.tv=F._tableView=s,Dj(w,i.getView()),Dj(w,s.getView()),i.mp(function(V){V.property===Vk&&F.iv()}),F.iv()},z.getTableView=function(){return this.tv},z.getTableHeader=function(){return this.th},z.getDataModel=function(){return this.tv.dm()},z.getColumnModel=function(){return this.tv.getColumnModel()},z.setColumns=function(M){this.tv.setColumns(M)},z.addColumns=function($){this.tv.addColumns($)},z.endEditing=function(){this.tv.endEditing()},z.validateImpl=function(){var d=this,w=d.th,c=_d(w),E={x:0,y:0,width:d.getWidth(),height:c};ci(w,E),E.y=c,E.height=I(0,d.getHeight()-c),ci(d.tv,E)}},ms_vs:function(t){t._41o=function(){return this._29I.height<this._59I},t._43o=function(){var U=this;U._41o()&&(U._58I||(j(function(){U._94O()},uk),U.iv()),U._58I=new Date)},t._94O=function(){var k=this;if(k._58I){var A=new Date;A.getTime()-k._58I.getTime()>=uk?(delete k._58I,k.iv()):j(function(){k._94O()},uk)}},t._93I=function(){var x=this,f=x._27I;if(x._58I||!x._autoHideScrollBar){f||Dj(x._79O,f=x._27I=Lp());var F=x._29I,p=F.height,n=x._59I,d=x.getScrollBarSize(),R=F.width-d-2,j=p*(-x.ty()/n),q=p*(p/n),P=f.style;n>p?(Hb>q&&(j=j+q/2-Hb/2,0>j&&(j=0),j+Hb>p&&(j=p-Hb),q=Hb),P.visibility=Wm,P.background=x.getScrollBarColor(),P.borderRadius=d/2+Se,ci(f,R,j,d,q)):P.visibility=_n}else f&&(f.style.visibility=_n)}},ms_hs:function(A){A._40o=function(){return this._29I.width<this._91I},A._42o=function(){var R=this;R._40o()&&(R._95O||(j(function(){R._94I()},uk),R.iv()),R._95O=new Date)},A._94I=function(){var d=this;if(d._95O){var n=new Date;n.getTime()-d._95O.getTime()>=uk?(delete d._95O,d.iv()):j(function(){d._94I()},uk)}},A._92I=function(){var B=this,j=B._28I;if(B._95O||!B._autoHideScrollBar){j||Dj(B._79O,j=B._28I=Lp());var d=B._29I,T=d.width,t=B._91I,G=B.getScrollBarSize(),x=d.height-G-2,$=T*(-B.tx()/t),y=T*(T/t),w=j.style;t>T?(Hb>y&&($=$+y/2-Hb/2,0>$&&($=0),$+Hb>T&&($=T-Hb),y=Hb),w.visibility=Wm,w.background=B.getScrollBarColor(),w.borderRadius=G/2+Se,ci(j,$,x,y,G)):w.visibility=_n}else j&&(j.style.visibility=_n)}}}),$m(de,Up(16,16,[{type:Vc,rect:[1,1,14,14],background:xr},{type:kp,rect:[1,1,14,14],width:1,color:Te},{type:mj,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),$m(dk,Up(16,16,{type:kp,rect:[1,1,14,14],width:1,color:Te})),$m(Hd,Up(16,16,[{type:Lm,rect:[2,2,12,12],borderWidth:1,borderColor:Te,background:"#FFF"},{type:Lm,rect:[4,4,8,8],background:xr}])),$m(kr,Up(16,16,{type:Lm,rect:[2,2,12,12],borderWidth:1,borderColor:Te})),lr._15Q=function(x){x._29I=sc,x._59I=0,x._91I=0,x._5o=function(Z){var G=this;G._30I=new bm,G._rows=new bm,G._rowMap={},G._31I=0,G._14I=0,G._view=Eq(1,G),G._canvas=sb(G._view),Dj(G._view,G._79O=Lp()),G.dm(Z?Z:new Yg)},x.getCheckIcon=function(W){var R=this.sm(),z=R.co(W);return R.sg()?Qf(z?Hd:kr):Qf(z?de:dk)},x.checkData=function(v){var V=this.sm(),I=V.co(v);V.sg()&&I||(this._32o=1,I?V.rs(v):V.as(v),delete this._32o)},x.getDataAt=function(d){d.target&&(d=this.lp(d));var Q=G(d.y/this._rowHeight),I=this._rows;return 0>Q||Q>=I.size()?s:I.get(Q)},x.onDataDoubleClicked=function(){},x.onDataClicked=function(){},x.adjustTranslateX=function(){return 0},x.adjustTranslateY=function(B){var K=this.getHeight()-this._59I;return K>B&&(B=K),B>0?0:t(B)},x.onPropertyChanged=function(I){var l=this,f=I.property;vh[f]?l.ivm():Vb[f]||l.redraw(),f===Mi?l._42o():f===qc&&l._43o()},x.getLabel=function(F){return F.toLabel()},x.getLabelFont=function(){return this._labelFont},x.getLabelColor=function(C){var E=this;if(E.isCheckMode()){if(E._focusData===C)return E._labelSelectColor}else if(E.isSelected(C))return E._labelSelectColor;return E._labelColor},x.getStartRowIndex=function(){return this._31I},x.getEndRowIndex=function(){return this._14I},x.getRowDatas=function(){return this._rows},x.getRowIndex=function(d){return this._rowMap[d._id]},x.getRowSize=function(){return this._rows.size()},x.getViewRect=function(){return Tm(this._29I)},x.isVisible=function(c){return this._visibleFunc?this._visibleFunc(c):!0},x.getCurrentSortFunc=function(){return this._sortFunc},x.setDataModel=function(D){var S=this,n=S._dataModel,J=S._selectionModel;n!==D&&(n&&(n.umm(S.handleDataModelChange,S),n.umd(S.handleDataPropertyChange,S),n.umh(S.handleHierarchyChange,S),J||n.sm().ums(S.handleSelectionChange,S)),S._dataModel=D,D.mm(S.handleDataModelChange,S),D.md(S.handleDataPropertyChange,S),D.mh(S.handleHierarchyChange,S),J?J._21I(D):D.sm().ms(S.handleSelectionChange,S),S.fp("dataModel",n,D))},x.validateModel=function(){var p=this;p._rows.clear(),p._rowMap={},p.buildChildren(p._dataModel._roots);var w=p._rows=p._rows.toList(p.isVisible,p),d=0,Q=p.getCurrentSortFunc(),R=w.size();for(Q&&w.sort(Q);R>d;d++)p._rowMap[w.get(d)._id]=d},x.buildChildren=function(M){var o=this;M.each(function(f){o._rows.add(f),o.buildChildren(f._children)})},x.handleDataModelChange=function(){this.ivm()},x.handleDataPropertyChange=function(Y){"parent"===Y.property?this.ivm():this.invalidateData(Y.data)},x.handleHierarchyChange=function(){this.ivm()},x.handleSelectionChange=function(c){c.datas.each(this.invalidateData,this),this.onSelectionChanged(c)},x.onSelectionChanged=function(x){var L=this,r=L.sm();!L.isAutoMakeVisible()||1!==r.size()||"set"!==x.kind&&"append"!==x.kind||L._32o||L.makeVisible(r.ld())},x.handleBackgroundClick=function(l){ee(l)&&!this.isCheckMode()&&this.sm().cs()},x.makeVisible=function(l){l&&(this._23I=l,this.iv())},x.scrollToIndex=function(Q){var z=this,d=z._29I,Y=d.height,G=z._rowHeight,v=G*Q;Q>=0&&Q<z._rows.size()&&Y>0&&(v+G>d.y+Y?z.ty(-v+Y-G):v<d.y&&z.ty(-v))},x.autoScroll=function(A,w){var R=this,q=R._rowHeight,v=q,f=q/4,H=R._29I,C=R.lp(A),T={x:R.tx(),y:R.ty()};return q>0&&H&&(C.x-H.x<v?R.translate(f,0):H.x+H.width-C.x<v&&R.translate(-f,0),C.y-H.y<v?R.translate(0,f):H.y+H.height-C.y<v&&R.translate(0,-f)),T.x=R.tx()-T.x,T.y=R.ty()-T.y,w&&(w.x+=T.x,w.y+=T.y),T},x.getTopRowOrderSelection=function(){var B=this.sm().getTopSelection(),v={},C=new bm;return B.each(function(T){v[T._id]=T}),this._rows.each(function(I){v[I._id]&&C.add(I)}),C},x.getRowOrderSelection=function(){var j=new bm;return this._rows.each(function(k){this.isSelected(k)&&j.add(k)},this),j},x.ivm=function(){this.invalidateModel()},x.invalidateModel=function(){var I=this;I._96I||(I._96I=1,I._32I=1,delete I._24I),I.iv()},x.redraw=function(){var p=this;p._32I||(p._32I=1,delete p._24I,p.iv())},x.invalidateData=function(r){var t=this;Kp?t.redraw():t._32I||(t._24I||(t._24I={}),t._24I[r._id]=r,t.iv())},x.getFocusData=function(){return this._focusData},x.setFocusDataById=function(Y){this.setFocusData(this.dm().getDataById(Y))},x.setFocusData=function(e){var C=this,u=C._focusData;u!==e&&(C._focusData=e,C.fp("focusData",u,e),u&&C.invalidateData(u),e&&(C.invalidateData(e),C.isAutoMakeVisible()&&C.makeVisible(e)))},x.drawRowBackground=function(O,m,W,U,n,$,J){var l=this,F=l.isCheckMode();(m===l._focusData&&F||W&&!F)&&Gn(O,U,n,$,J,l.getSelectBackground(m))},x.drawData=function(F,G,n){var I=this,K=I._rowHeight,g=K*n,Y=I._29I,L=Y.x,s=Y.width;F.save(),F.beginPath(),F.rect(L,g,s,K),F.clip(),I._87o(I.drawRow(F,G,I.isSelected(G),L,g,s,K),n,L,g,s,K),F.restore(),I._rowLineVisible&&Gn(F,L,g+K-1,s,1,I._rowLineColor)},x._12I=function($){var _=this,y=_._31I,c=_._29I,K=c.x,z=c.y,t=c.width,r=c.height;for($.beginPath(),$.rect(K,z,t,r),$.clip(),$.clearRect(K,z,t,r),_._76o(),_._93db($);y<_._14I;y++)_.drawData($,_._rows.get(y),y);_._92db($)},x._13I=function(e){for(var x,C=this,A=C._rowHeight,i=C._29I,y=i.x,l=i.width,E=C._31I,F=C._30I;E<C._14I;E++)x=C._rows.get(E),C._24I[x._id]&&F.add({data:x,index:E});F.isEmpty()||(e.beginPath(),F.each(function(S){e.rect(y,S.index*A,l,A)}),e.clip(),F.each(function(U){e.clearRect(y,U.index*A,l,A)}),F.each(function(B){C._77o(B.index)}),C._93db(e),F.each(function(h){C.drawData(e,h.data,h.index)}),C._92db(e),F.clear())},x.preValidateModel=function(){this.endEditing&&this.endEditing()},x.validateImpl=function(){var m=this,R=m._canvas,k=m.getWidth(),n=m.getHeight(),d=m._rowHeight,X=m._32I;(k!==R.clientWidth||n!==R.clientHeight)&&(Cd(R,k,n),X=1);var L=U&&!Z;m._96I&&!L&&(m.preValidateModel(),m.validateModel());var P=m._29I,Q={x:-m.tx(),y:-m.ty(),width:k,height:n},b=m._rows.size(),o=wi(R),V=m._23I;X||Ai(Q,P)||(X=1),m._29I=Q,m._59I=b*d+m.getScrollBarSize(),m._31I=G(Q.y/d),m._14I=y((Q.y+Q.height)/d),m._31I<0&&(m._31I=0),m._14I>b&&(m._14I=b),m._99I&&X&&m._99I(),gh(o,m.tx(),m.ty(),1),X?m._12I(o):m._24I&&m._13I(o),m._93I(),m._92I(),o.restore(),m._32I=m._24I=m._96I=s,V&&(m.scrollToIndex(m.getRowIndex(V)),delete m._23I),m.tx(m.tx()),m.ty(m.ty())}},lr._48o=function(r){r._rootVisible=!0,r._rootData=s,r._35o=function(){this._expandMap={},this._levelMap={}},r.validateModel=function(){var O=this,t=O._rootData;O._rows.clear(),O._levelMap={},O._rowMap={},O._currentLevel=0,t?O._rootVisible?O.isVisible(t)&&O.buildData(t):O.buildChildren(t):O.buildChildren(),delete O._currentLevel},r.buildData=function(H){var S=this,f=H._id,X=S._rows;S._rowMap[f]=X.size(),X.add(H),S._levelMap[f]=S._currentLevel,S.isExpanded(H)&&(S._currentLevel++,S.buildChildren(H),S._currentLevel--)},r.buildChildren=function(l){var K=this,h=l?l._children:K._dataModel._roots,q=K.getCurrentSortFunc();q&&K.isChildrenSortable(l)?h.toList(K.isVisible,K).sort(q).each(K.buildData,K):h.each(function(n){K.isVisible(n)&&K.buildData(n)})},r.getLevel=function(Q){return this._levelMap[Q._id]},r.getToggleIcon=function(T){var O=this,G=O._loader,$=O._collapseIcon;return G&&!G.isLoaded(T)?$:T.hasChildren()?O.isExpanded(T)?O._expandIcon:$:s},r.isCheckMode=function(){return this._checkMode!=s},r.isChildrenSortable=function(){return!0},r.handleDataModelChange=function(y){var S=this;y.kind===ij?delete S._expandMap[y.data._id]:y.kind===vj&&(S._expandMap={}),S.ivm()},r.toggle=function(b){var G=this;G.isExpanded(b)?G.collapse(b):G.expand(b)},r.isExpanded=function(H){return 1===this._expandMap[H._id]},r.expand=function(j){var S=this,$=S._loader;S.isExpanded(j)||($&&!$.isLoaded(j)&&$.load(j),S._expandMap[j._id]=1,S.ivm(),S.onExpanded(j))},r.onExpanded=function(){},r.collapse=function(P){var n=this;n.isExpanded(P)&&(delete n._expandMap[P._id],n.ivm(),n.onCollapsed(P))},r.onCollapsed=function(){},r.expandAll=function(I){if(I)this.expand(I),I.eachChild(function(Z){this.expandAll(Z)},this);else{var y=this;y._dataModel.each(function(I){I.hasChildren()&&(y._expandMap[I._id]=1)}),y.ivm()}},r.collapseAll=function(){this._expandMap={},this.ivm()},r.makeVisible=function(w){if(w){var v=this;if(!v._rootData||w.isDescendantOf(v._rootData)){for(var U=w._parent;U;)v.expand(U),U=U._parent;v._23I=w,v.iv()}}},r.checkData=function(K){var L,A=this,q=A._checkMode,$=A.sm(),m=$.co(K);if(!$.sg()||!m){if(A._32o=1,q===ef)m?$.rs(K):$.as(K);else if(q===Qq)L=new bm(K),L.addAll(K._children);else if("descendant"===q)L=new bm,Dm(K,L);else if("all"===q&&(L=new bm,Dm(K,L),!m))for(var h=K._parent;h;)L.add(h),h=h._parent;L&&(m?$.rs(L):$.as(L)),delete A._32o}},r._97I=function(N,O,r,Y,w,X,i){var B=this,k=B._indent,m=B._levelMap[O._id],W=B.getIconWidth(O),Z=Qf(B.getToggleIcon(O));Z?(Y+=k*m,Yr(N,Z,Y+k/2,w+i/2,O,B),Y+=k):Y+=k*(m+1),B._checkMode&&(Yr(N,B.getCheckIcon(O),Y+k/2,w+i/2,O,B),Y+=k),B.drawIcon(N,O,Y,w,W,i),B.drawLabel(N,O,Y+W,w,i)}},lr._14Q=function(V){V.getIcon=function(M){return M.getIcon()},V.getIconWidth=function(T){return this.getIcon(T)?this._indent:0},V.drawIcon=function(J,j,O,n,W,$){if(W){var d=this,z=d.getBodyColor(j),c=Qf(d.getIcon(j),z);c&&($-=d.isRowLineVisible()?1:0,Iq(J,c,Gl,O,n,W,$,j,d,z),Gr(J,d.getBorderColor(j),O,n,W,$))}},V.drawLabel=function(j,g,P,e,X){var K=this;xg(j,K.getLabel(g),K.getLabelFont(g),K.getLabelColor(g),P,e,0,X)}},lr._50o=function(l){l._98I=function(){var G=this,N=G._39o=new Yg;G._60I=new bm,N.mm(G._17o,G),N.md(G._18o,G),N.mh(G._19o,G)},l.setColumns=function(Q){this._39o.clear(),this.addColumns(Q)},l.addColumns=function($){var T=this._39o;$.forEach(function(L){if(!(L instanceof ge)){var t=iq(L.className);L=In(t?t:ge,L)}T.add(L)})},l.onColumnClicked=function(){},l.onCheckColumnClicked=function(){},l._3Q=function(K){for(var Z,a=0,y=this._60I,D=y.size();D>a;a++)if(Z=y.get(a),Z.column===K)return Z;return s},l.getColumnAt=function($){var a=this._4Q($);return a?a.column:s},l._4Q=function(n){for(var i=this,C=n.target?i.lp(n).x:n.x,j=i._60I,p=0;p<j.size();p++){var P=j.get(p),u=P.startX;if(C>=u&&C<u+P.column.getWidth())return P}return s},l.getToolTip=function(T){var l=this,k=l.getDataAt(T),A=l.getColumnAt(T);return k&&A?A.getToolTip(k,l):s},l.adjustTranslateX=function(u){var H=this.getWidth()-this._91I;return H>u&&(u=H),u>0?0:t(u)},l._99I=function(){var h=this,G=h._29I,W=h._60I;W.clear(),h._91I=0,h._39o._roots.each(function(O){if(O.isVisible()){var S=h._91I+O.getWidth();h._91I<=G.x+G.width&&S>=G.x&&W.add({column:O,startX:h._91I}),h._91I=S}}),h._91I+=h.getScrollBarSize()},l.drawData=function(h,L,v){var s=this,M=s._rowHeight,G=M*v,p=s.isSelected(L),W=s._29I,Y=W.x,Q=W.width;s.drawRowBackground(h,L,p,Y,G,Q,M),s._60I.each(function(Y){var d=Y.column,O=Y.startX,X=d.getWidth();X>0&&!s.isEditing(L,d)&&(h.save(),h.beginPath(),h.rect(O,G,X,M),h.clip(),s._87o(s.drawCell(h,L,p,d,O,G,X,M),v,O,G,X,M),s._columnLineVisible&&Gn(h,O+X-1,G,1,M,s._columnLineColor),h.restore())}),s._rowLineVisible&&Gn(h,Y,G+M-1,Q,1,s._rowLineColor)},l.drawCell=function(q,p,B,C,i,J,a,g){var Q=this;if(C.drawCell)return C.drawCell(q,p,B,C,i,J,a,g,Q);var v=Q.getValue(p,C);rr(q,v,C,Q.getLabelFont(p,C,v),Q.getLabelColor(p,C,v),i,J,a,g,p,Q)},l.getColumnModel=function(){return this._39o},l._17o=function(){this.redraw()},l._18o=function(b){var l=this;b.data===l._sortColumn&&yf[b.property]?l.ivm():(l._42o(),l.redraw())},l._19o=function(){this.redraw()},l.getCurrentSortFunc=function(){var l=this,$=l._sortColumn;if($&&$.isSortable()){var O=$.getSortFunc(),q=rd===$.getSortOrder()?1:-1;return O||(O=Pn),function(R,x){return O.call(l,l.getValue(R,$),l.getValue(x,$),R,x)*q}}return l._sortFunc},l.isCellEditable=function(P,D,G){return D.isEditable()&&this.isEditable()?D.isCellEditable?D.isCellEditable(P,D,G,this):!0:!1},l._37O=function(u,W){if(ee(W))for(var V=this,w=V.lp(W),X=V._60I,Q=V._rowHeight,$=V._29I,q=$.x,s=$.y,J=$.width,U=$.height,v=0;v<X.size();v++){var R=X.get(v),i=R.startX,b=R.column,r=b.getWidth();if(b!==V._31o&&b!==V._4o&&w.x>=i&&w.x<i+r&&V.isCellEditable(u,b,W)){var A={x:i,y:V.getRowIndex(u)*Q,width:r,height:Q},t={x:A.x+V.tx(),y:A.y+V.ty(),width:A.width,height:A.height},c=0,H=0;return A.x<q?c=A.x-q:A.x+A.width>q+J&&(c=A.x+A.width-q-J),c&&(V.tx(V.tx()-c),t.x-=c),A.y<s?H=A.y-s:A.y+Q>s+U&&(H=A.y+Q-s-U),H&&(V.ty(V.ty()-H),t.y-=H),V.beginEditing({data:u,column:b,value:V.getValue(u,b),event:W,rect:A,editorRect:t,view:V}),void 0}}}},Wl.BaseItemEditor=function(w,I,Z,J){this._data=w,this._column=I,this._master=Z,this._editInfo=J},_e("BaseItemEditor",e,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var zk=l.Tab=function(){$d(zk,this)};tf("Tab",ih,{ms_ac:["view","closable","disabled","visible"],_icon:s,_closable:!1,_disabled:!1,_visible:!0,setParent:pb});var ge=l.Column=function(){$d(ge,this)};tf("Column",ih,{_46o:1,ms_ac:["accessType","valueType",Wm,fs,Io,vs,"align",Ld,"sortOrder",Ch,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:rd,_sortFunc:s,_sortable:!0,_clickable:!0,setWidth:function(N){16>N&&(N=16);var s=this._width;this._width=N,this.fp(vs,s,N)},getToolTip:function(E,f){return this.formatValue(f.getValue(E,this))}});var mn=l.Property=function(){$d(mn,this)};tf("Property",ih,{_46o:1,ms_ac:["accessType","valueType",fs,Io,"categoryName",Ld,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:s,getToolTip:function(L,j,N){var R=this;return j?R.formatValue(N.getValue(L,R)):N.getPropertyName(R)}}),Wl.AccordionView=function(){var I=this;I._20o={},I._21o=new bm,I._10o=s,I._9o=s,I._11o=s,I._view=Eq(0,I),I.iv()},_e("AccordionView",e,{ms_v:1,ms_fire:1,ms_ac:[gl,Jc,"titleHeight",_b,Bf,"titleBackground","selectWidth",ul,"orientation","separatorColor"],_expandIcon:k.accordionViewExpandIcon,_collapseIcon:k.accordionViewCollapseIcon,_titleHeight:Kn,_labelColor:k.accordionViewLabelColor,_labelFont:k.accordionViewLabelFont,_titleBackground:k.accordionViewTitleBackground,_selectBackground:k.accordionViewSelectBackground,_selectWidth:k.accordionViewSelectWidth,_orientation:"v",_separatorColor:k.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o
},add:function(W,T,i,O){var q=this,l=Lp();if(q._20o[W])throw W+" already exists";l.onmousedown=yc,l.style.cursor=ro,K(l,mo?Oq:sd,function(v){yc(v)}),K(l,mo?pq:Un,function(i){yc(i),ee(i)&&(q._10o===W?q.collapse():q.expand(W))}),Dj(q._view,l),q._20o[W]={content:T,div:l,canvas:sb(l),icon:O},q._21o.add(W),i&&q.expand(W),q.iv()},remove:function(R){var x=this,W=x._20o[R];W&&(Zb(W.div),delete x._20o[R],x._21o.remove(R),x.iv())},clear:function(){var Q=this;Q._21o.toArray().forEach(Q.remove,Q),Q._20o={},Q._21o.clear(),Q.iv()},isExpanded:function(L){return this._10o===L},expand:function(n){var u=this;u._20o[n]&&u._10o!==n&&(u._10o=n,u.onExpanded(n),u.iv())},onExpanded:function(){},collapse:function(){var M=this;M._10o&&(M.onCollapsed(M._10o),delete M._10o,M.iv())},onCollapsed:function(){},initCanvas:function(I,Y,U){Cd(I,Y,U);var d=wi(I);return gh(d,0,0,1),d.clearRect(0,0,Y,U),d},drawTitle:function(r,X,c,H,q){var G=this,F=Qf(q.icon),E=G.isExpanded(X),o=G._titleHeight,_=G._titleBackground,T=G._selectWidth,K=G._separatorColor,d=Qf(E?G._expandIcon:G._collapseIcon),p=T+4;Gn(r,0,0,c,H,_),E&&T&&Gn(r,0,0,T,H,G._selectBackground),(E||G._21o.get(G._21o.size()-1)!==X)&&Gn(r,0,H-1,c,1,K?K:Dc(_)),F&&(Yr(r,F,p+Tb(F)/2,o/2),p+=Tb(F)+2),xg(r,X,G.getLabelFont(X),G.getLabelColor(X),p,0,0,o),d&&Yr(r,d,c-Tb(d)/2-4,o/2)},validateImpl:function(){var W=this,P=W._view,e=0,r=0,M=W.getWidth(),x=W.getHeight(),$=W._titleHeight,j=W._21o.size()*$,d=W._11o,R=W._9o;delete W._11o,delete W._9o,W._21o.each(function(J){var V,y,p=W._20o[J],b=p.content,m=W._10o===J;op(W)?(ci(p.div,e,0,$,x),V=W.initCanvas(p.canvas,$,x),bs(V,0,x),Dn(V,-X),W.drawTitle(V,J,x,$,p),V.restore(),m?(y=I(0,M-j),b&&(W._11o=b,W._9o=Zd(b),ci(b,e+$,0,y,x)),e+=$+y):e+=$):(ci(p.div,0,r,M,$),V=W.initCanvas(p.canvas,M,$),W.drawTitle(V,J,M,$,p),V.restore(),m?(y=I(0,x-j),b&&(W._11o=b,W._9o=Zd(b),ci(b,0,r+$,M,y)),r+=$+y):r+=$)});var D=W._9o;d&&d!==W._11o&&d.endEditing&&d.endEditing(),D&&D!==R&&Dj(P,D),R&&R!==D&&Zb(R)}}),Wl.SplitView=function(K,f,l,h){var $=this,O=$._dividerDiv=Lp(),G=$._60O=sb(),b=$._61O=sb(),W=G.style,J=b.style;$._view=Eq(1,$),Dj($._view,O),W.msTouchAction=ye,W.pointerEvents=ye,W.cursor=ro,J.msTouchAction=ye,J.pointerEvents=ye,J.cursor=ro,K&&$.setLeftView(K),f&&$.setRightView(f),l&&$.setOrientation(l),h!=s&&$.setPosition(h),$.setStatus(Xe),new sj($)},_e("SplitView",e,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:k.splitViewDividerSize,_dividerBackground:k.splitViewDividerBackground,_dragOpacity:k.splitViewDragOpacity,_toggleIcon:k.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(T,J){var B=this,I=B._position;isNaN(T)||(J||(B._82O=0>T?-1:T>1?1:0),B._position=T,B.fp(go,I,T))},getLeftView:function(){return this._leftView},setLeftView:function(L){var v=this,q=v._leftView,J=v._view;if(v._leftView!==L){if(q&&q!==v._rightView){var t=Zd(q);t.parentNode===J&&Zb(t)}if(v._leftView=L,L){var l=Zd(L);l.parentNode!==J&&J.insertBefore(l,v._dividerDiv)}v.fp("leftView",q,L)}},getRightView:function(){return this._rightView},setRightView:function(o){var b=this,c=b._rightView,j=b._view;if(b._rightView!==o){if(c&&c!==b._leftView){var v=Zd(c);v.parentNode===j&&Zb(v)}if(b._rightView=o,o){var w=Zd(o);w.parentNode!==j&&j.insertBefore(w,b._dividerDiv)}b.fp("rightView",c,o)}},validateImpl:function(){var R=this,Q=R._draggable,E=R._position,z=R.getWidth(),w=R.getHeight(),S=R._dividerSize,J=R._dividerBackground,L=mo?18:8,C=R._dividerDiv,o=R._82O,x=R._60O,r=R._61O,W=R._toggleIcon,$=R._status,O=C.style,g=null,i=mo?20:4,h=W.comps[0];S>=L||0===S?R._coverDiv&&(Zb(R._coverDiv),delete R._coverDiv):R._coverDiv||(R._coverDiv=Lp(),$l&&(R._coverDiv.style.background=sf),Dj(C,R._coverDiv)),R._togglable?x.parentNode||(Dj(C,x),Dj(C,r)):(Zb(x),Zb(r));var b=R._coverDiv,Y=R._leftView,a=R._rightView;if(op(R)){if(S>z&&(S=z),$===Xe)if(1===o)var m=B(E,z),c=I(0,z-S-m);else-1===o?(c=B(-E,z),m=I(0,z-S-c)):(m=t((z-S)*E),c=I(0,z-S-m));else"cl"===$?(m=0,c=I(0,z-S)):"cr"===$&&(c=0,m=I(0,z-S));Y&&ci(Y,0,0,m,w),a&&ci(a,m+S,0,c,w),ci(C,m,0,S,w),R._22o=m,b&&(ci(b,S/2-L/2,0,L,w),b.style.cursor=Q?up:""),C.style.cursor=Q?up:"";var j=C.clientHeight/2,k=C.clientWidth;Cd(x,k,k),ci(x,0,j-k-i,k,k),g=wi(x),gh(g,0,0,1),h.rotation=-X,Jq(g,W,0,0,k,k),g.restore(),Cd(r,k,k),ci(r,0,j+i,k,k),g=wi(r),gh(g,0,0,1),h.rotation=X,Jq(g,W,0,0,k,k),g.restore()}else{if(S>w&&(S=w),$===Xe)if(1===o)var U=B(E,w),e=I(0,w-S-U);else-1===o?(e=B(-E,w),U=I(0,w-S-e)):(U=t((w-S)*E),e=I(0,w-S-U));else"cl"===$?(U=0,e=I(0,w-S)):"cr"===$&&(e=0,U=I(0,w-S));Y&&ci(Y,0,0,z,U),a&&ci(a,0,U+S,z,e),ci(C,0,U,z,S),R._22o=U,b&&(ci(b,0,S/2-L/2,z,L),b.style.cursor=Q?Sk:""),O.cursor=Q?Sk:"";var s=C.clientWidth/2,k=C.clientHeight;Cd(x,k,k),ci(x,s-k-i,0,k,k),g=wi(x),gh(g,0,0,1),h.rotation=0,Jq(g,W,0,0,k,k),g.restore(),Cd(r,k,k),ci(r,s+i,0,k,k),g=wi(r),gh(g,0,0,1),h.rotation=N,Jq(g,W,0,0,k,k),g.restore()}O.background=J}});var sj=function(H){this.sv=H,this.addListeners()};an(sj,e,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(h){var N=this,x=N.sv,G=x._dividerDiv,i=x._60O,j=x._61O,M=x._status,U=h.target;if(U===i)M===Xe?x.setStatus("cl"):"cr"===M&&x.setStatus(Xe);else if(U===j)M===Xe?x.setStatus("cr"):"cl"===M&&x.setStatus(Xe);else if(Yj(h)&&(U===G||U===x._coverDiv)&&(yc(h),x.isDraggable())){x.getLeftView(),x.getRightView();var T=N.maskDiv=Lp();if(T.style.left=0,T.style.top=0,T.style.width=x.getWidth()+"px",T.style.height=x.getHeight()+"px",x.getView().appendChild(T),!x.isContinuousLayout()){var l=N.resizeDiv=Lp();l.style.left=G.style.left,l.style.top=G.style.top,l.style.width=G.style.width,l.style.height=G.style.height,l.style.opacity=x.getDragOpacity(),l.style.background=x.getDividerBackground(),Dj(N.getView(),l)}N._lastAbsPosition=x._22o,N._86o=op(x)?xl(h).x:xl(h).y,Fh(N,h)}},handleWindowTouchMove:function(m){Yj(m)&&this.update(m,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(f){var w=this;w.update(f,!0),w.sv.setStatus(Xe),w.maskDiv&&Zb(w.maskDiv),w.resizeDiv&&Zb(w.resizeDiv),w.maskDiv=w.resizeDiv=s},handle_mousedown:function(Q){ee(Q)&&this.handle_touchstart(Q)},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},update:function(l,p){var $=this,X=$.sv,j=op(X)?X.getWidth():X.getHeight(),R=X._dividerSize,q=$._lastAbsPosition-$._86o;op(X)?(q+=xl(l).x,q>j-R&&(q=j-R),0>q&&(q=0),$.resizeDiv&&($.resizeDiv.style.left=q+Se)):(q+=xl(l).y,q>j-R&&(q=j-R),0>q&&(q=0),$.resizeDiv&&($.resizeDiv.style.top=q+Se)),p&&j!==R&&(1===X._82O?X.setPosition(q,1):-1===X._82O?X.setPosition(q-j+R,1):X.setPosition(q/(j-R),1))}}),Wl.TabView=function(){var D=this,C=D._view=Eq(1,D),u=D._91O=Lp(1),n=D._tabModel=new Yg,e=n.sm(),z=D.invalidate;D._7o=new bm,D._canvas=sb(u),Dj(C,u),Dj(C,D._92O=Lp(1)),e.setSelectionMode(Vd),e.ms(D.handleSelectionChange,D),n.mm(z,D),n.mh(z,D),n.md(z,D),D._interactor=new ve(D),D.iv()},_e("TabView",e,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",_b,Bf,"tabHPadding","tabBackground","selectWidth",ul,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:rg,_tabHeight:Kn,_tabGap:k.tabViewTabGap,_labelColor:k.tabViewLabelColor,_labelFont:k.tabViewLabelFont,_tabBackground:k.tabViewTabBackground,_selectWidth:k.tabViewSelectWidth,_selectBackground:k.tabViewSelectBackground,_moveBackground:k.tabViewMoveBackground,_insertColor:k.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(J,r,l){var u,w=this._tabModel;return J instanceof zk?(u=J,r&&u.setView(r)):(u=new zk,u.setName(J),u.setView(r)),w.add(u),l&&w.sm().ss(u),u},getLabel:function(p){return p.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(Q){this._23o=Q,this.iv()},get:function(w){var d=this,g=d._tabModel;if(hk(w))return g._roots.get(w);if(Or(w)){var T;return g.each(function(t){w===d.getLabel(t)&&(T=t)}),T}return w instanceof zk?w:s},select:function(I){this._tabModel.sm().ss(this.get(I))},remove:function(s){var q=this;if(s=q.get(s)){var V=q._tabModel,j=V._roots.indexOf(s);q._tabModel.remove(s),q.selectByIndex(--j)}},getCurrentTab:function(){return this._8o},hideTabView:function($,q){q.parentNode===this._92O&&(Pd(q)?(q.style.display=Xo,q._tab_=$):Zb(q),en())},showTabView:function(t,A){Pd(A)&&(A.style.display="block",A._tab_=t),A.parentNode!==this._92O&&(Dj(this._92O,A),en())},_24o:function(){var x,j=this,P=j._8o,C=j._9o,s=j._tabModel.sm().ld();s&&(x=Zd(s.getView())),x!==C&&(C&&(P.getView()&&P.getView().endEditing&&P.getView().endEditing(),j.hideTabView(P,C)),x&&j.showTabView(s,x)),j._8o=s,j._9o=x,P!==s&&j.onTabChanged(P,s)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(L,I){this.selectByIndex(--I)},selectByIndex:function(X){var n=this,O=n._tabModel,u=O.size();if(u&&!O.sm().ld()){X==s&&(X=0),X>=u&&(X=u-1),0>X&&(X=0);for(var B=X;B>=0;B--){var U=n.get(B);if(!U.isDisabled())return n.select(U),U}for(B=X+1;u>B;B++)if(U=n.get(B),!U.isDisabled())return n.select(U),U}},getTabWidth:function(G){var k=this.getTabHPadding(),D=4+2*k,N=Qf(G.getIcon());N&&(D+=Tb(N,G)+4);var W=this.getLabel(G);return W&&(D+=bk(this.getLabelFont(G),W).width+4),G.isClosable()&&(D+=10),D},drawTab:function(a,x,E,v,k,C,y){var u,L=this,Q=L._tabPosition,O=this.getTabHPadding(),j=E+4+O,V=L._selectWidth,I=Qf(x.getIcon()),A=x.isDisabled(),d=L.getLabelColor(x),G=L.getLabelFont(x),K=L.getLabel(x),R=L._selectBackground,s=Q===xb+"-vertical",F=Q===cr+"-vertical";(s||F)&&(j=v+4+O),A&&(a.globalAlpha=Aj),Gn(a,E,v,k,C,y),x===L._8o&&V&&(Q===rg?Gn(a,E,v+C-V,k,V,R):Q===xb?Gn(a,E+k-V,v,V,C,R):Q===cr?Gn(a,E,v,V,C,R):s?Gn(a,E+k-V,v,V,C,R):F?Gn(a,E,v,V,C,R):Gn(a,E,v,k,V,R));var D=k/2;if(s&&(bs(a,D,v+C/2),Dn(a,N),bs(a,-D,-v-C/2)),I){var T=hd(I,x),M=Tb(I,x);if(s||F){var i=E+k/2,S=j+T/2;bs(a,i,S),Dn(a,X),bs(a,-i,-S),Yr(a,I,E+k/2,j+T/2,x,L),bs(a,i,S),Dn(a,-X),bs(a,-i,-S),j+=T+4}else Yr(a,I,j+M/2,v+C/2,x,L),j+=M+4}return s||F?(bs(a,k/2,j+k/2),Dn(a,X),bs(a,-k/2,-j-k/2),xg(a,K,G,d,E,j,C,k),bs(a,k/2,j+k/2),Dn(a,-X),bs(a,-k/2,-j-k/2)):xg(a,K,G,d,j,v,k,C),s&&(bs(a,D,v+C/2),Dn(a,-N),bs(a,-D,-v-C/2)),x.isClosable()&&(u=F?{x:E+k-12,y:v+C-12,width:12,height:12}:{x:E+k-12,y:v+2,width:12,height:12},this.drawCloseIcon(x,a,d,u)),A&&(a.globalAlpha=1),u},drawCloseIcon:function(l,D,f,w){var H=w.x,h=w.y;D.strokeStyle=f,D.lineWidth=1,D.beginPath(),D.moveTo(H+2,h+8),D.lineTo(H+8,h+2),D.moveTo(H+8,h+8),D.lineTo(H+2,h+2),D.stroke()},getTabAt:function(G){var n=this._interactor._8Q(G);return n?n.tab:null},validateImpl:function(){var D=this;D._24o();var n,$=D._canvas,k=D._tabPosition,K=D._91O,i=D._92O,T=D._tabModel,X=D.getWidth(),h=D.getHeight(),O=D._tabHeight,P=D._7o,l=D._tabGap,Q=k===rg,A=k===xb,F=k===cr,J=k===xb+"-vertical",G=k===cr+"-vertical",t=D._23o,W=0;if((A||F)&&T._roots.each(function(q){W=I(D.getTabWidth(q),W)}),Q?(ci(K,0,0,X,O),n={x:0,y:O,width:X,height:I(0,h-O)}):A?(ci(K,0,0,W,h),n={x:W,y:0,width:I(0,X-W),height:h}):F?(ci(K,X-W,0,W,h),n={x:0,y:0,width:I(0,X-W),height:h}):J?(ci(K,0,0,O,h),n={x:O,y:0,width:I(0,X-O),height:h}):G?(ci(K,X-O,0,O,h),n={x:0,y:0,width:I(0,X-O),height:h}):(ci(K,0,h-O,X,O),n={x:0,y:0,width:X,height:I(0,h-O)}),ci(i,n),J||G){D._9o&&(n.x=0,ci(D._8o.getView(),n)),Cd($,O,h);var E=wi($),m=0;if(gh(E,0,D.ty(),1),E.clearRect(0,0,O,h),P.clear(),T._roots.each(function(p){if(p.isVisible()){var C,z=D.getTabWidth(p);t&&t.tab===p||(C=D.drawTab(E,p,0,m,O,z,D._tabBackground)),P.add({_75o:C,tab:p,startY:m,endY:m+z,height:z}),m+=z+l}}),D._23Q=I(0,m-l),t){var B=t.position;D.drawTab(E,t.tab,0,t.startY,O,t.height,D._moveBackground),Gn(E,0,B,O,1,D._insertColor)}if(E.restore(),D._selectionChanged){D._selectionChanged=!1;for(var g=D.ty(),q=0;q<P.size();q++){var p=P.get(q);if(p.tab===D._8o){if(p.endY+g<0){D.ty(-p.startY);break}if(p.startY+g>h){D.ty(h-p.endY);break}}}}D.ty(D.ty())}else if(A||F){D._9o&&(n.x=0,ci(D._8o.getView(),n)),Cd($,W,h);var E=wi($),m=0;if(gh(E,0,D.ty(),1),E.clearRect(0,0,W,h),P.clear(),T._roots.each(function(v){if(v.isVisible()){var k;t&&t.tab===v||(k=D.drawTab(E,v,0,m,W,O,D._tabBackground)),P.add({_75o:k,tab:v,startY:m,endY:m+O,height:O}),m+=O+l}}),D._23Q=I(0,m-l),t){var B=t.position;D.drawTab(E,t.tab,0,t.startY,W,t.height,D._moveBackground),Gn(E,0,B,W,1,D._insertColor)}if(E.restore(),D._selectionChanged){D._selectionChanged=!1;for(var g=D.ty(),q=0;q<P.size();q++){var p=P.get(q);if(p.tab===D._8o){if(p.endY+g<0){D.ty(-p.startY);break}if(p.startY+g>h){D.ty(h-p.endY);break}}}}D.ty(D.ty())}else{D._9o&&(n.y=0,ci(D._8o.getView(),n)),Cd($,X,O);var E=wi($),r=0;if(gh(E,D.tx(),0,1),E.clearRect(0,0,X,O),P.clear(),T._roots.each(function(m){if(m.isVisible()){var h,L=D.getTabWidth(m);t&&t.tab===m||(h=D.drawTab(E,m,r,0,L,O,D._tabBackground)),P.add({_75o:h,tab:m,startX:r,endX:r+L,width:L}),r+=L+l}}),D._64I=I(0,r-l),t){var B=t.position;D.drawTab(E,t.tab,t.startX,0,t.width,O,D._moveBackground),Fp(E,D._insertColor,B,0,O)}if(E.restore(),D._selectionChanged){D._selectionChanged=!1;for(var z=D.tx(),q=0;q<P.size();q++){var p=P.get(q);if(p.tab===D._8o){if(p.endX+z<0){D.tx(-p.startX);break}if(p.startX+z>X){D.tx(X-p.endX);break}}}}D.tx(D.tx())}for(var N=[],R=i.children,q=0;q<R.length;q++){var o=R[q],j=o._tab_;j&&!T.contains(j)&&N.push(o)}N.forEach(function(H){i.removeChild(H)})}});var ve=function(j){this.tv=j,this.addListeners()};an(ve,e,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(c){this.handleScroll(c,10*(c.wheelDelta/40))},handle_DOMMouseScroll:function(j){this.handleScroll(j,10*-j.detail)},handleScroll:function(D,h){yc(D);var k=this.tv,n=k._tabPosition;!k._40o()||n!==rg&&n!==Rc||k.tx(this.tv.tx()+h),!k._41o()||n!==xb&&n!==cr&&n!==xb+"-vertical"&&n!==cr+"-vertical"||k.ty(this.tv.ty()+h)},_8Q:function(E){var l,U,y=this.tv,g=y._tabPosition,P=y._7o;if(g===rg||g===Rc){var C=y.lp(E).x;for(l=0;l<P.size();l++)if(U=P.get(l),U.startX<=C&&C<=U.endX)return U}else if(g===xb||g===cr||g===xb+"-vertical"||g===cr+"-vertical"){var w=y.lp(E).y;for(l=0;l<P.size();l++)if(U=P.get(l),U.startY<=w&&w<=U.endY)return U}return s},isClickable:function(h){var m=this.tv,C=m._tabPosition,M=this._73o=this._8Q(h);return!m._40o()||C!==rg&&C!==Rc?!m._41o()||C!==xb&&C!==cr&&C!==xb+"-vertical"&&C!==cr+"-vertical"?M&&(!M.tab.isDisabled()||m.isMovable()):!0:!0},handle_mousemove:function(z){var h=this;uj?h._74o=h._8Q(z):h.getView().style.cursor=h.isClickable(z)?ro:""},handle_mousedown:function(q){this.handle_mousemove(q),this.handle_touchstart(q)},handle_touchstart:function(G){var I=this,n=I.tv,s=n._tabPosition;yc(G),ee(G)&&I.isClickable(G)&&(s===rg||s===Rc?(I.x=xl(G).x,I.lp=n.lp(G),I.tx=n.tx()):(I.y=xl(G).y,I.lp=n.lp(G),I.ty=n.ty()),Fh(I,G))},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(Z){var H,a=this,f=a.tv,C=f._tabPosition,u=a._73o;if(C===rg||C===Rc){if(H=xl(Z).x-a.x,!a._25o&&!a.moving&&J(H)>2&&(f._40o()&&!oo(Z)?a._25o=1:u&&f.isMovable()&&(a.moving=1)),a._25o)f.tx(a.tx+H);else if(a.moving){var i=a.lp.x+H,P=f._tabGap/2;f._7o.each(function(g){var K=g.endX,l=i-g.startX<K-i;i>=g.startX&&K>=i&&f._7Q({tab:u.tab,startX:u.startX+H,width:u.width,front:l,insertTab:g.tab,position:l?I(0,g.startX-P):B(f._64I,K+P)})})}}else if(H=xl(Z).y-a.y,!a._25o&&!a.moving&&J(H)>2&&(f._41o()&&!oo(Z)?a._25o=1:u&&f.isMovable()&&(a.moving=1)),a._25o)f.ty(a.ty+H);else if(a.moving){var y=a.lp.y+H,P=f._tabGap/2;f._7o.each(function(T){var K=T.endY,z=y-T.startY<K-y;y>=T.startY&&K>=y&&f._7Q({tab:u.tab,startY:u.startY+H,height:u.height,front:z,insertTab:T.tab,position:z?I(0,T.startY-P):B(f._23Q,K+P)})})}},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(){var r=this,W=r.tv,J=W._tabPosition,V=W.getTabModel(),A=V._roots,G=r._73o;if(r.moving){var Y=W._23o;if(Y&&Y.insertTab!==Y.tab){var m=Y.tab,M=A.remove(m),L=A.indexOf(Y.insertTab);L>=0&&(Y.front||L++,L<=A.size()&&(A.add(m,L),V._38I(m,M,L)))}W._7Q(s),delete r.moving}else if(!r._25o&&G){m=G.tab;var $=r._74o;if(!$||$.tab===m)if(!m.isDisabled()&&Sn(G._75o,r.lp)){var j=function(){var L=A.indexOf(m);V.remove(m),W.onTabClosed(m,L)};W.onTabClosing(m,j)&&j()}else m.isDisabled()||W._8o===m||V.sm().ss(m)}r._25o=r._73o=r._74o=J===rg||J===Rc?r.x=r.lp=r.tx=s:r.y=r.lp=r.ty=s}}),Wl.PropertyView=function(t){var T=this;T._view=Eq(1,T),T._canvas=sb(T._view),Dj(T._view,T._79O=Lp()),T._rows=new bm,T._28o=new bm,T._26o={},T._26Q={};var B=T._propertyModel=new Yg,i=T.ivm;B.mm(i,T),B.md(i,T),B.mh(i,T),T.dm(t?t:new Yg),new Tj(T)},_e("PropertyView",e,{ms_ac:[_b,Fi,Bf,fs,Io,"categorizable",Rk,Ch,mb,gl,Jc,Ce,mm,jm,"selectRowIndex",ul,"background",es,Jo,pm,Qn,vd],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:sc,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Wo,_background:k.propertyViewBackground,_expandIcon:k.propertyViewExpandIcon,_collapseIcon:k.propertyViewCollapseIcon,_scrollBarColor:zo,_scrollBarSize:Ah,_autoHideScrollBar:nl,_selectBackground:k.propertyViewSelectBackground,_rowHeight:pp,_rowLineVisible:k.propertyViewRowLineVisible,_rowLineColor:k.propertyViewRowLineColor,_10I:.5,_columnLineVisible:k.propertyViewColumnLineVisible,_columnLineColor:k.propertyViewColumnLineColor,_labelColor:k.propertyViewLabelColor,_labelSelectColor:k.propertyViewLabelSelectColor,_labelFont:k.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(l){0>l&&(l=0),l>1&&(l=1);var T=this,O=T._10I;T._10I=l,T.fp("columnPosition",O,l)},getPropertyName:function(K){return K.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(s,n,N){return N===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(U,i){return i===this._selectRowIndex?this._labelSelectColor:U.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(V){var i=this.getHeight()-this._59I;return i>V&&(V=i),V>0?0:t(V)},isExpanded:function(f){if(!f)return!0;var Y=this._26o[f];return Y?Y.isExpanded:!(this._26Q[f]===!1)},toggle:function(g){var X=this;X.isExpanded(g)?X.collapse(g):X.expand(g)},expandAll:function(){this.validate();for(var Q in this._26o)this.expand(Q)},expand:function(X){if(X&&X!==Xo){var E=this,_=E._26o[X];_&&!_.isExpanded&&(_.isExpanded=!0,E.onExpanded(X),E.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var c in this._26o)this.collapse(c)},collapse:function(J){if(J&&J!==Xo){var y=this,Q=y._26o[J];Q&&Q.isExpanded&&(Q.isExpanded=!1,y.onCollapsed(J),y.ivm())}},onCollapsed:function(){},getCategoryName:function(J){if(!this.isCategorizable())return Xo;var R=J.getCategoryName();return R?R:Xo},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(s){var m=this,Y=m._dataModel;Y!==s&&(Y&&(Y.umd(m.handlePropertyChange,m),m._selectionModel||Y.sm().ums(m.handleSelectionChange,m)),m._dataModel=s,s.md(m.handlePropertyChange,m),m._selectionModel?m._selectionModel._21I(s):s.sm().ms(m.handleSelectionChange,m),m.fp(df,Y,s))},isVisible:function(_){return this._visibleFunc?this._visibleFunc(_):!0},onPropertyChanged:function(T){var y=this,Z=T.property;ui[Z]?y.ivm():y.iv(),Z===qc&&y._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Qc},handlePropertyChange:function(d){this._27o===d.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var z=this;z._96I||(z.setSelectRowIndex(-1),z._96I=1,z.iv())},redraw:function(){this.iv()},validateModel:function(){var C=this,b=C._rows,D=C._28o,n={},g=new bm,l=C._27o;C.updateCurrentData(),l!==C._27o&&C.endEditing(),b.clear(),D.clear(),C.getRawProperties().each(function(I){if(C.isVisible(I)){g.add(I);var l=C.getCategoryName(I);n[l]||(D.add(l,l===Xo?0:d),n[l]={isExpanded:C.isExpanded(l),properties:new bm})}}),C._sortFunc&&g.sort(C._sortFunc);for(var A in C._26o)C._26Q[A]=C.isExpanded(A);C._26o=n,D.each(function(e){e!==Xo&&b.add(e);var h=n[e];h.isExpanded&&g.each(function(o){C.getCategoryName(o)===e&&(h.properties.add(o),b.add({property:o,data:C._27o}))},C)})},validateImpl:function(){var v=this;v._76o(),v._96I&&(v.validateModel(),delete v._96I);var r=v._canvas,x=v.getWidth(),o=v.getHeight(),u=-v.ty(),F=v._rowHeight,D=v._indent,i=x-D,O=v._rows,l=O.size(),R=v._9I=D+i*v._10I,m=v._59I=l*F;Cd(r,x,o),v._29I={x:0,y:u,width:x,height:o},v._31I=G(u/F),v._14I=y((u+o)/F),v._31I<0&&(v._31I=0),v._14I>l&&(v._14I=l);var Z,Q=wi(r),K=v._background;gh(Q,0,-u,1),Q.beginPath(),Q.rect(0,u,x,o),Q.clip(),Q.clearRect(0,u,x,o),v._93db(Q),K&&Gn(Q,0,0,D,m,K);for(var T=v._31I;T<v._14I;T++){var d=O.get(T),u=F*T;if(Or(d))K&&Gn(Q,D,u,i,F,K),Z=Qf(v.isExpanded(d)?v._expandIcon:v._collapseIcon),Z&&Iq(Q,Z,Gl,0,u,D,F),Q.save(),Q.beginPath(),Q.rect(D,u,i,F),Q.clip(),v.drawCategoryName(Q,d,T,D,u,i,F),Q.restore();else{var B=d.property,V=d.data,Z=Qf(B.getIcon()),g=v._selectRowIndex===T?v.getSelectBackground():s;if(Z&&Iq(Q,Z,Gl,0,u,D,F),g&&Gn(Q,D,u,i,F,g),Q.save(),Q.beginPath(),Q.rect(D,u,R-D,F),Q.clip(),v.drawPropertyName(Q,B,T,D,u,R-D,F),Q.restore(),!v.isEditing(V,B)){var A=R+1,J=x-R-1;Q.save(),Q.beginPath(),Q.rect(A,u,J,F),Q.clip(),v._87o(v.drawPropertyValue(Q,B,v.getValue(V,B),T,A,u,J,F,V),T,A,u,J,F),Q.restore()}}v._rowLineVisible&&Gn(Q,D,u+F-1,i,1,v._rowLineColor)}v._columnLineVisible&&(Gn(Q,R,0,1,m,v._columnLineColor),Gn(Q,x-1,0,1,m)),v._92db(Q),v._93I(),Q.restore(),v.ty(v.ty())},drawCategoryName:function(f,D,E,X,R,H,t){xg(f,D,this.getCategoryFont(D),this.getCategoryColor(D),X,R,H,t)},drawPropertyName:function(L,m,W,J,t,A,k){return m.drawPropertyName?(m.drawPropertyName(L,m,W,J,t,A,k,this),void 0):(xg(L,this.getPropertyName(m),this.getPropertyFont(m,W),this.getPropertyColor(m,W),J,t,A,k),void 0)},drawPropertyValue:function(o,w,D,u,m,J,Q,t,n){return w.drawPropertyValue?w.drawPropertyValue(o,w,D,u,m,J,Q,t,n,this):(rr(o,D,w,this.getLabelFont(w,D,u),this.getLabelColor(w,D,u),m,J,Q,t,n,this),void 0)},isPropertyEditable:function(X){return X.isEditable()&&this.isEditable()},setProperties:function(O){this._propertyModel.clear(),this.addProperties(O)},addProperties:function(d){if(d){var t=this._propertyModel;d.forEach(function(J){if(!(J instanceof mn)){var m=iq(J.className);J=In(m?m:mn,J)}t.add(J)})}},getRowIndexAt:function(P){var l=this,g=G(l.lp(P).y/l._rowHeight);return g>=0&&g<l._rows.size()?g:-1},getPropertyAt:function(T){var N=this,c=N.getRowIndexAt(T);return c>=0?N._rows.get(c).property:s},getToolTip:function(X){var u=this,l=u.getPropertyAt(X),B=u._27o;return l&&B?l.getToolTip(B,u._9I<u.lp(X).x,u):s}});var Tj=function(V){this.pv=V,this.addListeners()};an(Tj,e,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(Q){this.getView().style.cursor=Q},clear:function(){var $=this;$._62O=$.cp=$.ty=$.p=s,$.setCursor(ef)},handle_mousedown:function($){this.handle_touchstart($)},handle_touchstart:function(J){var k=this,z=k.pv;yc(J),z.setFocus(J)&&(ee(J)?(k.cp=xl(J),k.ty=z.ty(),k.p=z.getColumnPosition(),k.handle_touchmove(J)):z.setSelectRowIndex(z.getRowIndexAt(J)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(I){this.handle_touchend(I)},handle_touchend:function(Q){var r=this;if(r.cp&&!r._62O){var u=r.pv,y=u.lp(Q),k=y.x,A=y.y,H=u._indent,R=u.getRowIndexAt(Q),V=u._9I;if(R>=0){var c=u._rowHeight,C=c*R,j=u._rows.get(R),g=j.property;if(Or(j))Qf(u.isExpanded(j)?u._expandIcon:u._collapseIcon)&&k>=0&&H>=k&&A>=C&&C+c>=A?u.toggle(j):Ec(Q)&&u.toggle(j);else if(k>V&&u.isPropertyEditable(g,Q)){var x={x:V+1,y:C,width:u.getWidth()-V-1,height:c},L={x:x.x+u.tx(),y:x.y+u.ty(),width:x.width,height:x.height},F=0,n=u._29I;x.y<n.y?F=x.y-n.y:x.y+c>n.y+n.height&&(F=x.y+c-n.y-n.height),F&&(u.ty(u.ty()-F),L.y-=F),u.beginEditing({data:j.data,property:g,value:u.getValue(j.data,g),event:Q,rect:x,editorRect:L,view:u})}}u.setSelectRowIndex(R)}r.clear()},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowTouchMove:function(v){var s=this,b=s.pv,r=s.ty,g=s.cp,X=xl(v),Z=s._62O;if("p"===Z)b.setTranslateY(r+X.y-g.y);else if("c"===Z){var E=b.getWidth()-b._indent;if(E>16){var f=s.p-(g.x-X.x)/E,M=16/E;M>f&&(f=M),f>1-M&&(f=1-M),b.setColumnPosition(f)}}else"s"===Z&&b.setTranslateY(r+(g.y-X.y)*b._59I/b._29I.height)},handle_mousemove:function(r){this.handle_touchmove(r)},handle_touchmove:function(b){if(!uj&&ee(b)){var P=this,c=P.pv,Z=J(c.lp(b).x-c._9I)<=(mo?8:3);P.cp?P._62O||(Z?(P._62O="c",Fh(P)):J(xl(b).y-P.cp.y)>=2&&(P._62O=P.isV(b)?"s":"p",Fh(P))):(Z?P.setCursor(up):P.setCursor(ef),P.isV(b)&&c._43o())}},isV:function(Q){var u=this.pv,L=u._29I;return u._41o()&&L.x+L.width-u.lp(Q).x<ji},handle_mousewheel:function(C){this.handleScroll(C,C.wheelDelta/40)},handle_DOMMouseScroll:function(X){2===X.axis&&this.handleScroll(X,-X.detail)},handleScroll:function(s,N){var q=this.pv;yc(s),q.endEditing(),q.translate(0,N*q.getRowHeight())},handle_keydown:function(R){var T=this.pv,P=T._rows.size(),B=T._selectRowIndex+(Gj(R)?-1:1);(Gj(R)||ub(R))&&(0>B&&(B=0),B>=P&&(B=P-1),T.setSelectRowIndex(B))}}),Wl.ListView=function(q){this._5o(q),new gg(this)},_e("ListView",e,{ms_ac:[_b,Fi,Bf,es,Rk,Jo,pm,Ch,mb,Ce,mm,jm,Yb,ul],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Wo,_rowHeight:pp,_rowLineVisible:k.listViewRowLineVisible,_rowLineColor:k.listViewRowLineColor,_scrollBarColor:zo,_scrollBarSize:Ah,_autoMakeVisible:Pr,_autoHideScrollBar:nl,_selectBackground:k.listViewSelectBackground,_labelColor:k.listViewLabelColor,_labelSelectColor:k.listViewLabelSelectColor,_labelFont:k.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(S){var V=this,j=V._checkMode;V._checkMode=S,V.fp(vq,j,S)},drawRow:function(c,B,Q,S,V,Z,a){var o=this,C=0,x=o._indent,Y=o.getIconWidth(B);o.drawRowBackground(c,B,Q,S,V,Z,a),o._checkMode&&(Yr(c,Qf(o.getCheckIcon(B)),C+x/2,V+a/2,B,o),C+=x),o.drawIcon(c,B,C,V,Y,a),o.drawLabel(c,B,C+Y,V,a)}});var gg=function(v){this.list=v,this._lastSelectDataTime=Xl(),this.addListeners()};an(gg,e,{ms_listener:1,getView:function(){return this.list._view},clear:function(j){var I=this,W=I.list;j&&"d"===I._62O&&!I.dragCancel&&W.handleDragAndDrop(j,"end"),W.draggingData&&(W.draggingData=null,W.redraw()),I.dragCancel=I._62O=I._isV=I._isH=I.cp=I.tx=I.ty=s},handle_mousedown:function(X){this.handle_touchstart(X)},handle_touchstart:function(g){var T=this,c=T.list;if(yc(g),c.setFocus(g)){var w=c.getDataAt(g);T.cp=xl(g),T.tx=c.tx(),T.ty=c.ty(),ee(g)?w&&c.handleDragAndDrop&&!T.isV(g)&&!T.isH(g)&&(c.draggingData=w,c.redraw(),c.handleDragAndDrop(g,"prepare")):(w&&T._33o(g,w),T.clear(g))}},handleWindowMouseUp:function(U){this.clear(U)},handleWindowTouchEnd:function(i){this.clear(i)},handle_mouseup:function(S){this.handle_touchend(S)},handle_touchend:function(g){var i=this,L=i.list;if(!i._isV&&!i._isH&&i.cp&&!i._62O){var z=L.getDataAt(g);z?(L.isCheckMode()?i._34o(g,z):i._33o(g,z),Ec(g)?L.onDataDoubleClicked(z,g):L.onDataClicked(z,g)):L.handleBackgroundClick(g)}i.clear(g)},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowTouchMove:function(T){var V=this,S=V.list,F=V._62O,E=V.tx,r=V.ty,Q=V.cp,d=xl(T),o=S._29I;"p"===F?S.setTranslate(E+d.x-Q.x,r+d.y-Q.y):"v"===F?S.ty(r+(Q.y-d.y)*S._59I/o.height):"h"===F?S.tx(E+(Q.x-d.x)*S._91I/o.width):"d"===F&&(V.dragCancel||S.handleDragAndDrop(T,"between"))},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(Q){if(!uj&&ee(Q)){var b=this,I=b.list;if(b._isV=b.isV(Q),b._isH=b.isH(Q),b.cp){if(!b._62O){if(Qd(xl(Q),b.cp)<2)return;b._isV?b._62O="v":b._isH?b._62O="h":I.draggingData&&!this.dragCancel?(b._62O="d",I.handleDragAndDrop(Q,"begin")):b._62O="p",b._62O&&"d"!==b._62O&&I.draggingData&&(I.draggingData=null,I.redraw()),Fh(b)}}else b._isV&&I._43o(),b._isH&&I._42o()}},isV:function(B){var b=this.list,g=b._29I;return b._41o()&&g.x+g.width-b.lp(B).x<ji},isH:function(i){var d=this.list,a=d._29I;return d._40o()&&a.y+a.height-d.lp(i).y<ji},handle_mousewheel:function(B){this.handleScroll(B,B.wheelDelta/40,B.wheelDelta!==B.wheelDeltaX)},handle_DOMMouseScroll:function(f){this.handleScroll(f,-f.detail,1)},handleScroll:function(P,a,s){var l=this.list;yc(P),l.endEditing&&l.endEditing(),s&&l._41o()?l.translate(0,a*l.getRowHeight()):l._40o()&&l.translate(10*a,0)},handle_keydown:function(U){if(!k.isInput(U.target)){var v,N=this.list,w=N.sm(),g=N._rows,$=g.size();if(mg(U))N.selectAll();else if(hj(U))N.handleDelete&&N.handleDelete(U);else if(ti(U))"d"!==this._62O||this.dragCancel||(N.handleDragAndDrop(U,"cancel"),this.dragCancel=!0);else if(Af(U))N.isCheckMode()&&(v=N.getFocusData(),v&&N.checkData(v));else if(Gj(U)||ub(U)){var m=N.isCheckMode();if(v=m?N.getFocusData():w.ld()){var t=N.getRowIndex(v);t>=0&&(Gj(U)?0!==t&&(v=g.get(t-1),m?N.setFocusData(v):w.ss(v)):t!==$-1&&(v=g.get(t+1),m?N.setFocusData(v):w.ss(v)))}else $>0&&(v=g.get(0),m?N.setFocusData(v):w.ss(v))}}},_34o:function(F,k){var W=this.list,$=W.lp(F).x;return $>=0&&$<=W._indent?(W.checkData(k),void 0):(W.setFocusData(k),void 0)},_33o:function(U,f){var o=this.list,H=o.sm(),c=H.ld();if(oo(U))o.isSelected(f)?H.rs(f):H.as(f);else if(km(U))if(c)for(var z=o.getRowIndex(c),P=o.getRowIndex(f);z!==P;)z+=P>z?1:-1,H.as(o._rows.get(z));else H.ss(f);else if(ee(U)){var O=Xl();if(H.contains(f)){var s=O-this._lastSelectDataTime;o.handleDataDoubleSelect&&s>500&&1500>s&&o.handleDataDoubleSelect(U,f)}H.ss(f),this._lastSelectDataTime=O}else H.contains(f)||H.ss(f)}}),Wl.TreeView=function(x){var z=this;z._35o(),z._5o(x),new So(z)},_e("TreeView",e,{ms_ac:[_b,Fi,Bf,"rootVisible",vq,"rootData",Ch,mb,Ce,mm,jm,Rk,es,Jo,pm,gl,Jc,Yb,ul,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:s,_indent:Wo,_rowHeight:pp,_rowLineVisible:k.treeViewRowLineVisible,_rowLineColor:k.treeViewRowLineColor,_scrollBarColor:zo,_scrollBarSize:Ah,_autoHideScrollBar:nl,_expandIcon:k.treeViewExpandIcon,_collapseIcon:k.treeViewCollapseIcon,_autoMakeVisible:Pr,_selectBackground:k.treeViewSelectBackground,_labelColor:k.treeViewLabelColor,_labelSelectColor:k.treeViewLabelSelectColor,_labelFont:k.treeViewLabelFont,_doubleClickToToggle:k.treeViewDoubleClickToToggle,drawRow:function(C,_,y,M,D,a,R){var z=this;z.drawRowBackground(C,_,y,M,D,a,R),z._97I(C,_,y,0,D,a,R)},isOnToggleIcon:function(t){var n=this.getDataAt(t);if(n){var F=this.getIndent(),r=this.lp(t).x;if(Qf(this.getToggleIcon(n))){var s=F*this.getLevel(n);if(r>=s&&s+F>=r)return!0}}return!1}});var So=function(J){$d(So,this,[J])};an(So,gg,{toggle:function(v,R,K,O){var F=this.list,N=F.lp(v).x;if(Qf(F.getToggleIcon(R))){var H=K*O;if(N>=H&&H+K>=N)return F.toggle(R),!0}return F.isDoubleClickToToggle()&&Ec(v)?(F.toggle(R),!0):!1},_34o:function(V,B){var Y=this.list,j=Y.lp(V).x,U=Y._levelMap[B._id],I=Y._indent,A=I*(U+1);return j>=A&&A+I>=j?(Y.checkData(B),void 0):(this.toggle(V,B,I,U)||Y.setFocusData(B),void 0)},_33o:function(u,T){var d=this,H=d.list;if(!d.toggle(u,T,H._indent,H.getLevel(T)))if(km(u)){var D=H.sm();if(D.size()>0){for(var k=H._rows,K=null,E=0,e=k.size();e>E;E++)if(H.isSelected(k.get(E))){K=E;break}for(var f=null,E=k.size()-1;E>=0;E--)if(H.isSelected(k.get(E))){f=E;break}var h,S,C=H.getRowIndex(T);for(K>C?(h=C-1,S=K):C>f?(h=f,S=C):(h=K,S=f);h!==S;)h++,D.as(H._rows.get(h))
}else D.ss(T)}else So.superClass._33o.call(d,u,T)},handle_keydown:function(u){if(lb(u)||si(u)){var P=this.list,x=P._rows,v=P.isCheckMode(),Y=P.sm(),R=v?P.getFocusData():Y.ld();R?R.hasChildren()&&(lb(u)?P.collapse(R):P.expand(R)):x.size()>0&&(R=x.get(0),v?P.setFocusData(R):Y.ss(R))}else So.superClass.handle_keydown.call(this,u)}});var $c=Wl.TableView=function($){this._98I(),this._5o($),new yr(this)};_e("TableView",e,{ms_ac:[_b,Fi,Bf,"sortMode",fs,Io,es,Jo,pm,Qn,vd,"sortColumn",Ch,mb,Ce,mm,jm,Yb,ul],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Nb,_editable:!0,_batchEditable:!1,_rowHeight:pp,_rowLineVisible:k.tableViewRowLineVisible,_rowLineColor:k.tableViewRowLineColor,_columnLineVisible:k.tableViewColumnLineVisible,_columnLineColor:k.tableViewColumnLineColor,_scrollBarColor:zo,_scrollBarSize:Ah,_autoHideScrollBar:nl,_autoMakeVisible:Pr,_selectBackground:k.tableViewSelectBackground,_labelColor:k.tableViewLabelColor,_labelSelectColor:k.tableViewLabelSelectColor,_labelFont:k.tableViewLabelFont,getCheckColumn:function(){var c=this;if(!c._31o){var k=c._31o=new ge;k.setEditable(!0),k.setWidth(40),k.getValue=c.getCheckColumValue,k.drawCell=c.drawCheckColumnCell}return c._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(J){var b=this,R=b._39o,z=b.getCheckColumn();J!==b.isCheckMode()&&(J?R.add(z,0):R.remove(z),b.fp(vq,!J,J))},getCheckColumValue:function(y,$,W){return W.isSelected(y)},drawCheckColumnCell:function(M,g,u,A,b,y,e,_,n){Yr(M,n.getCheckIcon(g),b+e/2,y+_/2,g,n)}});var yr=function(H){$d(yr,this,[H])};an(yr,gg,{_34o:function(M,I){var y=this.list,n=y._31o;if(y.isCellEditable(I,n,M)){var T=y._3Q(n),B=y.lp(M).x;if(T&&B>=T.startX&&B<T.startX+n.getWidth())return y.checkData(I),void 0}y._37O(I,M),y.setFocusData(I)},_33o:function(r,H){this.list._37O(H,r),yr.superClass._33o.apply(this,arguments)}});var Al=Wl.TreeTableView=function(K){var z=this,X=z._4o=new ge;z._35o(),z._98I(),z._5o(K),X.setDisplayName("Name"),X.setEditable(!0),X.setWidth(180),X.drawCell=qo,X.getValue=Xd,z._39o.add(X),new Tk(z)},qo=function(e,V,i,b,f,u,G,a,Z){Z._97I(e,V,i,f,u,G,a)},Xd=function(p,$,q){return q.getLabel(p)};_e("TreeTableView",e,{ms_ac:[_b,Fi,Bf,"sortMode",fs,Io,Rk,vq,"rootData","rootVisible",Ch,mb,"sortColumn",gl,Jc,Ce,mm,jm,Yb,pm,es,Jo,Qn,vd,ul,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Nb,_checkMode:s,_editable:!0,_batchEditable:!1,_indent:Wo,_rowHeight:pp,_rowLineVisible:k.treeTableViewRowLineVisible,_rowLineColor:k.treeTableViewRowLineColor,_columnLineVisible:k.treeTableViewColumnLineVisible,_columnLineColor:k.treeTableViewColumnLineColor,_expandIcon:k.treeTableViewExpandIcon,_collapseIcon:k.treeTableViewCollapseIcon,_scrollBarColor:zo,_scrollBarSize:Ah,_autoHideScrollBar:nl,_autoMakeVisible:Pr,_selectBackground:k.treeTableViewSelectBackground,_labelColor:k.treeTableViewLabelColor,_labelSelectColor:k.treeTableViewLabelSelectColor,_labelFont:k.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Tk=function(B){$d(Tk,this,[B])};an(Tk,gg,{_34o:function($,X){var k=this.list,w=k._4o,q=k._3Q(w),B=k.lp($).x;if(q){var G=k._indent,z=q.startX+G*k.getLevel(X);if(Qf(k.getToggleIcon(X))&&B>=z&&z+G>=B)return k.toggle(X),void 0;if(k.isCellEditable(X,w)&&(z+=G,B>=z&&z+G>=B))return k.checkData(X),void 0}k._37O(X,$),k.setFocusData(X)},_33o:function(X,I){var C=this.list,G=C.lp(X).x;if(Qf(C.getToggleIcon(I))){var U=C._3Q(C._4o);if(U){var K=C._indent,V=U.startX+K*C.getLevel(I);if(G>=V&&V+K>=G)return C.toggle(I),void 0}}C._37O(I,X),Tk.superClass._33o.apply(this,arguments)}});var Qe=Wl.TableHeader=function(K){var c=this,r=c._view=Eq(1,c),Y=c._39o=K.getColumnModel(),f=c.iv;c.tv=c._tableView=K,c._60I=new bm,c._canvas=sb(r),r.style.background=k.tableHeaderBackground||"",r.style.height=Yf+Se,Y.mm(f,c),Y.md(f,c),Y.mh(f,c),K.mp(function(s){Yl[s.property]&&c.iv()},c),new Xr(c),c.iv()};_e("TableHeader",e,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",_b,Bf,Rk,"moveBackground","insertColor",Qn,vd,"resizable","movable"],_checkIcon:dk,_movable:!0,_resizable:!0,_labelColor:k.tableHeaderLabelColor,_labelFont:k.tableHeaderLabelFont,_columnLineColor:k.tableHeaderColumnLineColor,_columnLineVisible:k.tableHeaderColumnLineVisible,_sortDescIcon:k.tableHeaderSortDescIcon,_sortAscIcon:k.tableHeaderSortAscIcon,_moveBackground:k.tableHeaderMoveBackground,_insertColor:k.tableHeaderInsertColor,_indent:Wo,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(S){return S.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(X){return X.getColor()||this._labelColor},getLabelAlign:function(b){return b._align},onPropertyChanged:function(){this.iv()},_5Q:function(t){this._61I=t,this.iv()},getLogicalPoint:function(S){return Pp(S,this._canvas,this.tv.tx())},validateImpl:function(){var O=this,x=O._canvas,D=O.getWidth(),d=O.getHeight(),P=O.tv,N=O._60I,m=O._61I,$=-P.tx(),X=0;(D!==x.clientWidth||d!==x.clientHeight)&&Cd(x,D,d),N.clear(),O._39o._roots.each(function(t){if(t.isVisible()){var P=X+t.getWidth();$+D>=X&&P>=$&&N.add({column:t,startX:X}),X=P}});var h=wi(x);if(gh(h,-$,0,1),h.beginPath(),h.rect($,0,D,d),h.clip(),h.clearRect($,0,D,d),N.each(function(M){var Q=M.column,W=M.startX,D=Q.getWidth();D>0&&(h.save(),h.beginPath(),h.rect(W,0,D,d),h.clip(),m&&m.column===Q||O.drawColumn(h,Q,W,0,D,d),O._columnLineVisible&&Gn(h,W+D-1,0,1,d,O._columnLineColor),h.restore())}),m){var a=m.column,X=m.startX,t=m.position,y=a.getWidth();h.save(),h.beginPath(),h.rect(X,0,y,d),h.clip(),h.fillStyle=O._moveBackground,h.fill(),O.drawColumn(h,a,X,0,y,d),h.restore(),Fp(h,O._insertColor,t,0,d)}h.restore()},_6Q:function(R){var j=this.tv;return j._31o===R&&j.sm().getSelectionMode()===Rn},drawColumn:function(C,x,U,E,Z,S){var G=this,M=G.tv,R=Qf(x.getIcon()),p=G.getLabelAlign(x);if(G._6Q(x)){var o=Qf(G._checkIcon);Yr(C,o,U+Z/2,E+S/2,x,G)}else{var F=G.getLabel(x),a=G.getLabelFont(x),v=G.getLabelColor(x),T=bk(a,F).width,d=R?G._indent:0;p===xb?(R&&Iq(C,R,Gl,U,E,d,S),xg(C,F,a,v,U+d,E,Z,S,xb)):p===cr?(R&&Iq(C,R,Gl,U+Z-T-d,E,d,S),xg(C,F,a,v,U,E,Z,S,cr)):(R&&Iq(C,R,Gl,U+(Z-T-d)/2,E,d,S),xg(C,F,a,v,U+(Z-T+d)/2,E,0,S,xb))}if(x.isSortable()&&M.getSortColumn()===x&&(R=Qf(x.getSortOrder()===rd?G._sortAscIcon:G._sortDescIcon))){var b=Tb(R,x)/2+2;Yr(C,R,p===cr?U+b:U+Z-b,E+S/2,x,M)}}});var Xr=function(s){var t=this;t.th=s,t.tv=s._tableView,t.addListeners()};an(Xr,e,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(w){this.getView().style.cursor=w},handle_mousemove:function(I){if(!uj){var _=this;delete _._29o,_.setCursor(ef);for(var M=_.th,u=M._60I,A=M.lp(I).x,d=u.size()-1;d>=0;d--){var o=u.get(d),H=o.column,k=o.startX+H.getWidth();if(M.isResizable()&&J(k-A)<=(mo?10:3))return _._29o=o,_.setCursor(up),void 0;A>o.startX&&k>A&&(_._29o=o),(H.isClickable()||H.isSortable()||M.isMovable()||_.tv.getCheckColumn&&H===_.tv.getCheckColumn())&&A>o.startX&&k>A&&_.setCursor(ro)}}},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(W){var H=this;yc(W),H.tv.endEditing(),H.handle_mousemove(W),H._29o&&(H.x=xl(W).x,H.lx=H.th.lp(W).x,H.w=H._29o.column.getWidth(),Fh(H,W))},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(c){var w=this,H=w.th,m=w.getView().style.cursor,q=w._29o,t=xl(c).x-w.x;if(w.resizing||w.moving||(m===up?w.resizing=1:H.isMovable()&&m===ro&&J(t)>2&&(w.moving=1)),w.resizing)q.column.setWidth(w.w+t);else if(w.moving){var p=w.lx+t;H._60I.each(function(x){var G=x.startX,O=G+x.column.getWidth();if(p>=G&&O>=p){var l={column:q.column,startX:q.startX+t,front:O-p>p-G,insertColumn:x.column};l.position=l.front?G:O,H._5Q(l)}})}},_16Q:function(A,B){var q=this,z=q.tv,g=q.th,b=g._checkIcon;if(g._6Q(A)){var y=Qf(b),Q=q.lx,n=A.getWidth(),u=Tb(y,A);if(Q>=B+n/2-u&&B+n/2+u>=Q){g.setCheckIcon(b===de?dk:de);var I=z.sm(),x=z._rows;return b===de?I.rs(x):I.ss(x),z.onCheckColumnClicked(A),!0}}return!1},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(B){var a=this,S=a.tv,V=a.th,t=a._29o;if(a.moving){var N=V._61I;if(N&&N.insertColumn!==N.column){var I=N.column,b=S.getColumnModel()._roots,J=b.remove(I),w=b.indexOf(N.insertColumn);w>=0&&(N.front||w++,w<=b.size()&&(b.add(I,w),S.getColumnModel()._38I(I,J,w)))}V._5Q(s),delete a.moving}else if(!a.resizing&&t){I=t.column;var l=V.lp(B).x,M=t.startX,X=!0;if(V.onColumnClicked){var D=V.onColumnClicked(I,B,M);D===!1&&(X=!1)}if(X&&l>=M&&l<=M+I.getWidth()&&!a._16Q(I,M)){if(I.isSortable()){var O=S.getSortMode(),j=I.getSortOrder();O===Nb?S.getSortColumn()===I?(j===xe&&S.setSortColumn(s),I.setSortOrder(j===rd?xe:rd)):S.setSortColumn(I):"bistate"===O&&(S.getSortColumn()===I?I.setSortOrder(j===rd?xe:rd):S.setSortColumn(I))}S.onColumnClicked(I,B,M)}}a._29o=a.resizing=a.x=a.lx=a.w=s}}),Wl.TablePane=function(j){this.init(new $c(j))},_e("TablePane",e,{ms_v:1,_44o:1}),Wl.TreeTablePane=function(J){this.init(new Al(J))},_e("TreeTablePane",e,{ms_v:1,_44o:1}),Wl.Toolbar=function(I){var L=this,W=L._view=Eq(1,L),Y=W.style;Y.background=k.toolbarBackground||"",Y.height=Kn+Se,L._canvas=sb(W),L._30o=new bm,L._90I=new bm,L.setItems(I||[]),W.handleGroupSelectedChanged=function(C){if(C.isSelected()){var u=C.getGroupId();null!=u&&L._items.forEach(function(W){var F=W.element;F&&F!==C&&F.setSelected&&F.getGroupId&&F.getGroupId()===u&&F.setSelected(!1)})}},new $j(L)},_e("Toolbar",e,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Mr,_b,Bf,Fi,ul,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:k.toolbarLabelColor,_labelSelectColor:k.toolbarLabelSelectColor,_labelFont:k.toolbarLabelFont,_selectBackground:k.toolbarSelectBackground,_itemGap:k.toolbarItemGap,_separatorColor:k.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(b){var M=this.getItemInfoAt(b);return M?M.item.toolTip:s},getLabelColor:function(d){return d&&d.selected&&d.type!==de&&d.type!==il?this._labelSelectColor:this._labelColor},onPropertyChanged:function(d){this.iv(),d.property===Mr&&this._items.forEach(function(z){Fo(z)})},redraw:function(){this.iv()},addItem:function(Q,e){var Y=this._items;e==s?Y.push(Q):Y.splice(e,0,Q),this.fp(Mr,s,Y)},removeItem:function(m){if(m)for(var w=this._items,A=0;A<w.length;A++)m===w[A]&&(w.splice(A,1),this.fp(Mr,s,w))},removeItemById:function(N){if(N!=s)for(var m=this._items,c=0;c<m.length;c++)if(N===m[c].id){var t=m.splice(c,1)[0];return this.fp(Mr,s,m),t}},getItemById:function(x){if(x!=s)for(var u=this._items,b=0;b<u.length;b++){var S=u[b];if(x===S.id)return S}},setItemVisible:function(u,Y){var W=this.getItemById(u);W&&(W.visible=Y)},getItemInfos:function(){return this._30o},getItemInfoAt:function(t){var I=this,H=0,h=I._30o,A=I.lp(t),b=A.x,$=A.y;if($>=0&&$<=I.getHeight())for(;H<h.size();H++){var o=h.get(H);if(o.startX<=b&&b<=o.endX)return o}return s},drawItem:function(n,s,O,c,q){if(s.visible===!1)return 0;if(Lo(s.visible)&&!s.visible())return 0;var m=this,v=s.disabled;v&&(n.globalAlpha=Aj);var L=m.drawItemImpl(n,s,O,c,q),F=m._itemGap;return v&&(n.globalAlpha=1),this._currentItem!==s||"separator"===s||s.separator===!0||s.unfocusable||Gr(n,m._separatorColor,O-F/2,0,L+F,c),L},drawItemImpl:function(b,t,z,Q,J){var A=this,m=A._view,y=A._itemGap,F=Q/2,g=t.type,$=t.element,N=t.label;Or($)&&(N=$,$=s);var h,O=A.getLabelFont(t),o=A.getLabelColor(t),B=t.selected,G=Qf(t.icon),T=Tb(G,t),j=0,L=T+(N?bk(O,N).width:0);if("separator"===t||t.separator===!0)return Fp(b,A._separatorColor,z,Q/4,F),1;if($){G&&Yr(b,G,z+T/2,F,t,A),xg(b,N,O,o,z+T,0,0,Q);var n=Zd($);J||A._90I.add(n),n.parentNode!==m&&Dj(m,n),$.iv&&$.iv(),$.validate&&$.validate();var Y=n.getBoundingClientRect(),R=Y.width,_=n.style;return Sj(n),_.left=A.tx()+z+L+Se,_.top=(Q-Y.height)/2+Se,L+R}return g===il?h=Qf(B?Hd:kr):g===de&&(h=Qf(B?de:dk)),h?(j=Tb(h,t),Yr(b,h,z+j/2,F,t,A),z+=j,L+=j):B&&Gn(b,z-y/2,0,L+y,Q,A.getSelectBackground(t)),G&&Yr(b,G,z+T/2,F,t,A),xg(b,N,O,o,z+T,0,0,Q),L},validateImpl:function(){var k=this,O=k._canvas,s=k.getWidth(),G=k.getHeight(),v=k._30o,X=k._items;Cd(O,s,G);var B=wi(O),H=k._itemGap,g=H/2;gh(B,k.tx(),0,1),B.clearRect(0,0,s,G);var P=k._90I;k._90I=new bm,v.clear(),X.forEach(function(S){var Y=k.drawItem(B,S,g,G);v.add({item:S,startX:g,endX:g+Y,width:Y}),Y&&(g+=Y+H)}),P.each(function(f){k._90I.contains(f)||Zb(f)});var i=k._64I;k._64I=I(0,g),B.restore(),k._stickToRight?(k._65O=0,B=wi(O),g=s-k._64I+H,gh(B,0,0,1),B.clearRect(0,0,s,G),v.clear(),X.forEach(function(q){var F=k.drawItem(B,q,g,G,!0);v.add({item:q,startX:g,endX:g+F,width:F}),F&&(g+=F+H)}),B.restore()):k.tx(k.tx()),i!==k._64I&&k.onSumWidthChanged(i,k._64I)},onSumWidthChanged:function(){},handleClick:function(O,C){var K=this,t=O.type,G=O.action,N=O.groupId,h=O.selected;O.disabled||(N!=s?h||(O.selected=!0,this._items.forEach(function(F){F.groupId===N&&O!==F&&(F.selected=!1)}),G&&O.action(O,K,C)):t===de||"toggle"===t?(O.selected=!h,G&&O.action(O,K,C)):G&&O.action(O,K,C)),en(),K.iv()}});var $j=function(J){this.tb=J,this.addListeners()};an($j,e,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(X){this.handleScroll(X,10*(X.wheelDelta/40))},handle_DOMMouseScroll:function(T){this.handleScroll(T,10*-T.detail)},handleScroll:function(P,t){yc(P);var U=this.tb;U.isScrollable()&&!U._stickToRight&&(U.tx(U.tx()+t),fi())},handle_mousemove:function(y){var S=this;uj||S.setItem(y)},handle_mouseout:function(R){var j=this;R.target===j.getView()?j.tb.setCurrentItem(s):j.handle_mousemove(R)},handle_mousedown:function(Y){this.handle_mousemove(Y),this.handle_touchstart(Y)},handle_touchstart:function(Y){var Z=this,q=Z.tb,D=Y.target;ee(Y)&&(D===Z.getView()||D===q._canvas)&&(yc(Y),q.setFocus(Y)&&(this.setItem(Y,!0),(q.isScrollable()||Z.info&&!Z.info.item.disabled)&&(Z.x=xl(Y).x,Z.tx=q.tx(),Fh(Z,Y))))},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(a){var w=this,$=w.tb;if(!$._stickToRight){var E=xl(a).x-w.x;!w._25o&&J(E)>2&&$.isScrollable()&&(w._25o=1),w._25o&&$.tx(w.tx+E)}},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function(E){var k=this,A=k.tb,K=k.info,P=k.tb.getItemInfoAt(E);if(!k._25o&&K){var i=K.item;P&&P.item===i&&A.handleClick(i,E)}k._25o=k.x=k.tx=s,k.setItem()},setItem:function(z,i){var d=this,q=d.tb,A=d.info=z?q.getItemInfoAt(z):s,$=A?A.item:s;q.setCurrentItem($),i&&$&&Lo($.onDown)&&$.onDown(z)}}),Wl.BorderPane=function(){this._view=Eq(1,this),this.iv()},_e("BorderPane",e,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(X,k){this._12o("leftView",X),k!=s&&this.setLeftWidth(k)},getRightView:function(){return this._rightView},setRightView:function(T,I){this._12o("rightView",T),I!=s&&this.setRightWidth(I)},getTopView:function(){return this._topView},setTopView:function(y,g){this._12o("topView",y),g!=s&&this.setTopHeight(g)},getBottomView:function(){return this._bottomView},setBottomView:function(i,n){this._12o("bottomView",i),n!=s&&this.setBottomHeight(n)},getCenterView:function(){return this._centerView},setCenterView:function($){this._12o("centerView",$)},_12o:function(e,t){var V=this,H="_"+e,h=V._view,D=V[H];D!==t&&(D&&(D.getView?Zb(D.getView()):Zb(D)),V[H]=t,t&&(t.getView?Dj(h,t.getView(),1):Dj(h,t,1)),V.fp(e,D,t))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var f=this,M=f._topView,L=f._bottomView,u=f._leftView,W=f._rightView,w=f._centerView,$=f.getWidth(),y=f.getHeight(),P=0,T=0,q=$,d=y,G=0,o=0,O=0,B=0;M&&(G=f._topHeight==s?_d(M):f._topHeight,T=G),L&&(o=f._bottomHeight==s?_d(L):f._bottomHeight,d=y-o),u&&(O=f._leftWidth==s?wn(u):f._leftWidth,P=O),W&&(B=f._rightWidth==s?wn(W):f._rightWidth,q=$-B);var m=I(0,q-P),b=I(0,d-T);M&&ci(M,0,0,$,G),L&&ci(L,0,d,$,o),u&&ci(u,0,T,O,b),W&&ci(W,q,T,B,b),w&&ci(w,P,T,m,b)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);